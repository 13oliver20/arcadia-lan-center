function sN(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function aN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Iw={exports:{}},hd={},Fw={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A0=Symbol.for("react.element"),iN=Symbol.for("react.portal"),oN=Symbol.for("react.fragment"),lN=Symbol.for("react.strict_mode"),cN=Symbol.for("react.profiler"),uN=Symbol.for("react.provider"),fN=Symbol.for("react.context"),hN=Symbol.for("react.forward_ref"),dN=Symbol.for("react.suspense"),pN=Symbol.for("react.memo"),mN=Symbol.for("react.lazy"),Rv=Symbol.iterator;function xN(e){return e===null||typeof e!="object"?null:(e=Rv&&e[Rv]||e["@@iterator"],typeof e=="function"?e:null)}var Rw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pw=Object.assign,Dw={};function kc(e,t,r){this.props=e,this.context=t,this.refs=Dw,this.updater=r||Rw}kc.prototype.isReactComponent={};kc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};kc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ow(){}Ow.prototype=kc.prototype;function Px(e,t,r){this.props=e,this.context=t,this.refs=Dw,this.updater=r||Rw}var Dx=Px.prototype=new Ow;Dx.constructor=Px;Pw(Dx,kc.prototype);Dx.isPureReactComponent=!0;var Pv=Array.isArray,jw=Object.prototype.hasOwnProperty,Ox={current:null},Lw={key:!0,ref:!0,__self:!0,__source:!0};function Mw(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)jw.call(t,n)&&!Lw.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:A0,type:e,key:a,ref:i,props:s,_owner:Ox.current}}function gN(e,t){return{$$typeof:A0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function jx(e){return typeof e=="object"&&e!==null&&e.$$typeof===A0}function vN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Dv=/\/+/g;function ap(e,t){return typeof e=="object"&&e!==null&&e.key!=null?vN(""+e.key):t.toString(36)}function Gf(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case A0:case iN:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+ap(i,0):n,Pv(s)?(r="",e!=null&&(r=e.replace(Dv,"$&/")+"/"),Gf(s,t,r,"",function(c){return c})):s!=null&&(jx(s)&&(s=gN(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Dv,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Pv(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+ap(a,o);i+=Gf(a,t,r,l,s)}else if(l=xN(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+ap(a,o++),i+=Gf(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function uf(e,t,r){if(e==null)return e;var n=[],s=0;return Gf(e,n,"","",function(a){return t.call(r,a,s++)}),n}function _N(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Cn={current:null},Xf={transition:null},yN={ReactCurrentDispatcher:Cn,ReactCurrentBatchConfig:Xf,ReactCurrentOwner:Ox};function Vw(){throw Error("act(...) is not supported in production builds of React.")}it.Children={map:uf,forEach:function(e,t,r){uf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return uf(e,function(){t++}),t},toArray:function(e){return uf(e,function(t){return t})||[]},only:function(e){if(!jx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};it.Component=kc;it.Fragment=oN;it.Profiler=cN;it.PureComponent=Px;it.StrictMode=lN;it.Suspense=dN;it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yN;it.act=Vw;it.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Pw({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Ox.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)jw.call(t,l)&&!Lw.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:A0,type:e.type,key:s,ref:a,props:n,_owner:i}};it.createContext=function(e){return e={$$typeof:fN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:uN,_context:e},e.Consumer=e};it.createElement=Mw;it.createFactory=function(e){var t=Mw.bind(null,e);return t.type=e,t};it.createRef=function(){return{current:null}};it.forwardRef=function(e){return{$$typeof:hN,render:e}};it.isValidElement=jx;it.lazy=function(e){return{$$typeof:mN,_payload:{_status:-1,_result:e},_init:_N}};it.memo=function(e,t){return{$$typeof:pN,type:e,compare:t===void 0?null:t}};it.startTransition=function(e){var t=Xf.transition;Xf.transition={};try{e()}finally{Xf.transition=t}};it.unstable_act=Vw;it.useCallback=function(e,t){return Cn.current.useCallback(e,t)};it.useContext=function(e){return Cn.current.useContext(e)};it.useDebugValue=function(){};it.useDeferredValue=function(e){return Cn.current.useDeferredValue(e)};it.useEffect=function(e,t){return Cn.current.useEffect(e,t)};it.useId=function(){return Cn.current.useId()};it.useImperativeHandle=function(e,t,r){return Cn.current.useImperativeHandle(e,t,r)};it.useInsertionEffect=function(e,t){return Cn.current.useInsertionEffect(e,t)};it.useLayoutEffect=function(e,t){return Cn.current.useLayoutEffect(e,t)};it.useMemo=function(e,t){return Cn.current.useMemo(e,t)};it.useReducer=function(e,t,r){return Cn.current.useReducer(e,t,r)};it.useRef=function(e){return Cn.current.useRef(e)};it.useState=function(e){return Cn.current.useState(e)};it.useSyncExternalStore=function(e,t,r){return Cn.current.useSyncExternalStore(e,t,r)};it.useTransition=function(){return Cn.current.useTransition()};it.version="18.3.1";Fw.exports=it;var te=Fw.exports;const Bw=aN(te),wN=sN({__proto__:null,default:Bw},[te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EN=te,TN=Symbol.for("react.element"),kN=Symbol.for("react.fragment"),SN=Object.prototype.hasOwnProperty,bN=EN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,AN={key:!0,ref:!0,__self:!0,__source:!0};function Uw(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)SN.call(t,n)&&!AN.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:TN,type:e,key:a,ref:i,props:s,_owner:bN.current}}hd.Fragment=kN;hd.jsx=Uw;hd.jsxs=Uw;Iw.exports=hd;var u=Iw.exports,sm={},zw={exports:{}},ss={},Ww={exports:{}},$w={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,X){var oe=ie.length;ie.push(X);e:for(;0<oe;){var Pe=oe-1>>>1,U=ie[Pe];if(0<s(U,X))ie[Pe]=X,ie[oe]=U,oe=Pe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var X=ie[0],oe=ie.pop();if(oe!==X){ie[0]=oe;e:for(var Pe=0,U=ie.length,q=U>>>1;Pe<q;){var H=2*(Pe+1)-1,G=ie[H],ne=H+1,me=ie[ne];if(0>s(G,oe))ne<U&&0>s(me,G)?(ie[Pe]=me,ie[ne]=oe,Pe=ne):(ie[Pe]=G,ie[H]=oe,Pe=H);else if(ne<U&&0>s(me,oe))ie[Pe]=me,ie[ne]=oe,Pe=ne;else break e}}return X}function s(ie,X){var oe=ie.sortIndex-X.sortIndex;return oe!==0?oe:ie.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,p=3,m=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ie){for(var X=r(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=ie)n(c),X.sortIndex=X.expirationTime,t(l,X);else break;X=r(c)}}function R(ie){if(x=!1,w(ie),!g)if(r(l)!==null)g=!0,we(V);else{var X=r(c);X!==null&&ke(R,X.startTime-ie)}}function V(ie,X){g=!1,x&&(x=!1,y(S),S=-1),m=!0;var oe=p;try{for(w(X),d=r(l);d!==null&&(!(d.expirationTime>X)||ie&&!N());){var Pe=d.callback;if(typeof Pe=="function"){d.callback=null,p=d.priorityLevel;var U=Pe(d.expirationTime<=X);X=e.unstable_now(),typeof U=="function"?d.callback=U:d===r(l)&&n(l),w(X)}else n(l);d=r(l)}if(d!==null)var q=!0;else{var H=r(c);H!==null&&ke(R,H.startTime-X),q=!1}return q}finally{d=null,p=oe,m=!1}}var L=!1,T=null,S=-1,b=5,F=-1;function N(){return!(e.unstable_now()-F<b)}function C(){if(T!==null){var ie=e.unstable_now();F=ie;var X=!0;try{X=T(!0,ie)}finally{X?P():(L=!1,T=null)}}else L=!1}var P;if(typeof E=="function")P=function(){E(C)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ye=ce.port2;ce.port1.onmessage=C,P=function(){ye.postMessage(null)}}else P=function(){_(C,0)};function we(ie){T=ie,L||(L=!0,P())}function ke(ie,X){S=_(function(){ie(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,we(V))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ie){switch(p){case 1:case 2:case 3:var X=3;break;default:X=p}var oe=p;p=X;try{return ie()}finally{p=oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,X){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var oe=p;p=ie;try{return X()}finally{p=oe}},e.unstable_scheduleCallback=function(ie,X,oe){var Pe=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Pe+oe:Pe):oe=Pe,ie){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=oe+U,ie={id:f++,callback:X,priorityLevel:ie,startTime:oe,expirationTime:U,sortIndex:-1},oe>Pe?(ie.sortIndex=oe,t(c,ie),r(l)===null&&ie===r(c)&&(x?(y(S),S=-1):x=!0,ke(R,oe-Pe))):(ie.sortIndex=U,t(l,ie),g||m||(g=!0,we(V))),ie},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(ie){var X=p;return function(){var oe=p;p=X;try{return ie.apply(this,arguments)}finally{p=oe}}}})($w);Ww.exports=$w;var NN=Ww.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CN=te,rs=NN;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hw=new Set,Vu={};function Ko(e,t){ic(e,t),ic(e+"Capture",t)}function ic(e,t){for(Vu[e]=t,e=0;e<t.length;e++)Hw.add(t[e])}var Xa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),am=Object.prototype.hasOwnProperty,IN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ov={},jv={};function FN(e){return am.call(jv,e)?!0:am.call(Ov,e)?!1:IN.test(e)?jv[e]=!0:(Ov[e]=!0,!1)}function RN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function PN(e,t,r,n){if(t===null||typeof t>"u"||RN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function In(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Zr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zr[e]=new In(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zr[t]=new In(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zr[e]=new In(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zr[e]=new In(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zr[e]=new In(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zr[e]=new In(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zr[e]=new In(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zr[e]=new In(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zr[e]=new In(e,5,!1,e.toLowerCase(),null,!1,!1)});var Lx=/[\-:]([a-z])/g;function Mx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Lx,Mx);Zr[t]=new In(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Lx,Mx);Zr[t]=new In(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Lx,Mx);Zr[t]=new In(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zr[e]=new In(e,1,!1,e.toLowerCase(),null,!1,!1)});Zr.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zr[e]=new In(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vx(e,t,r,n){var s=Zr.hasOwnProperty(t)?Zr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(PN(t,r,s,n)&&(r=null),n||s===null?FN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ti=CN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ff=Symbol.for("react.element"),Dl=Symbol.for("react.portal"),Ol=Symbol.for("react.fragment"),Bx=Symbol.for("react.strict_mode"),im=Symbol.for("react.profiler"),Gw=Symbol.for("react.provider"),Xw=Symbol.for("react.context"),Ux=Symbol.for("react.forward_ref"),om=Symbol.for("react.suspense"),lm=Symbol.for("react.suspense_list"),zx=Symbol.for("react.memo"),gi=Symbol.for("react.lazy"),Kw=Symbol.for("react.offscreen"),Lv=Symbol.iterator;function Xc(e){return e===null||typeof e!="object"?null:(e=Lv&&e[Lv]||e["@@iterator"],typeof e=="function"?e:null)}var er=Object.assign,ip;function su(e){if(ip===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ip=t&&t[1]||""}return`
`+ip+e}var op=!1;function lp(e,t){if(!e||op)return"";op=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{op=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?su(e):""}function DN(e){switch(e.tag){case 5:return su(e.type);case 16:return su("Lazy");case 13:return su("Suspense");case 19:return su("SuspenseList");case 0:case 2:case 15:return e=lp(e.type,!1),e;case 11:return e=lp(e.type.render,!1),e;case 1:return e=lp(e.type,!0),e;default:return""}}function cm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ol:return"Fragment";case Dl:return"Portal";case im:return"Profiler";case Bx:return"StrictMode";case om:return"Suspense";case lm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Xw:return(e.displayName||"Context")+".Consumer";case Gw:return(e._context.displayName||"Context")+".Provider";case Ux:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zx:return t=e.displayName||null,t!==null?t:cm(e.type)||"Memo";case gi:t=e._payload,e=e._init;try{return cm(e(t))}catch{}}return null}function ON(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cm(t);case 8:return t===Bx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qw(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jN(e){var t=qw(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function hf(e){e._valueTracker||(e._valueTracker=jN(e))}function Yw(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=qw(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function uh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function um(e,t){var r=t.checked;return er({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function Mv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Vi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Qw(e,t){t=t.checked,t!=null&&Vx(e,"checked",t,!1)}function fm(e,t){Qw(e,t);var r=Vi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hm(e,t.type,r):t.hasOwnProperty("defaultValue")&&hm(e,t.type,Vi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vv(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function hm(e,t,r){(t!=="number"||uh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var au=Array.isArray;function Xl(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Vi(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function dm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return er({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(au(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Vi(r)}}function Jw(e,t){var r=Vi(t.value),n=Vi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Uv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zw(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var df,eE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=df.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Bu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var xu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LN=["Webkit","ms","Moz","O"];Object.keys(xu).forEach(function(e){LN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xu[t]=xu[e]})});function tE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||xu.hasOwnProperty(e)&&xu[e]?(""+t).trim():t+"px"}function rE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=tE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var MN=er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mm(e,t){if(t){if(MN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function xm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gm=null;function Wx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vm=null,Kl=null,ql=null;function zv(e){if(e=I0(e)){if(typeof vm!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=gd(t),vm(e.stateNode,e.type,t))}}function nE(e){Kl?ql?ql.push(e):ql=[e]:Kl=e}function sE(){if(Kl){var e=Kl,t=ql;if(ql=Kl=null,zv(e),t)for(e=0;e<t.length;e++)zv(t[e])}}function aE(e,t){return e(t)}function iE(){}var cp=!1;function oE(e,t,r){if(cp)return e(t,r);cp=!0;try{return aE(e,t,r)}finally{cp=!1,(Kl!==null||ql!==null)&&(iE(),sE())}}function Uu(e,t){var r=e.stateNode;if(r===null)return null;var n=gd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var _m=!1;if(Xa)try{var Kc={};Object.defineProperty(Kc,"passive",{get:function(){_m=!0}}),window.addEventListener("test",Kc,Kc),window.removeEventListener("test",Kc,Kc)}catch{_m=!1}function VN(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var gu=!1,fh=null,hh=!1,ym=null,BN={onError:function(e){gu=!0,fh=e}};function UN(e,t,r,n,s,a,i,o,l){gu=!1,fh=null,VN.apply(BN,arguments)}function zN(e,t,r,n,s,a,i,o,l){if(UN.apply(this,arguments),gu){if(gu){var c=fh;gu=!1,fh=null}else throw Error(Ee(198));hh||(hh=!0,ym=c)}}function qo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function lE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wv(e){if(qo(e)!==e)throw Error(Ee(188))}function WN(e){var t=e.alternate;if(!t){if(t=qo(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Wv(s),e;if(a===n)return Wv(s),t;a=a.sibling}throw Error(Ee(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(Ee(189))}}if(r.alternate!==n)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function cE(e){return e=WN(e),e!==null?uE(e):null}function uE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=uE(e);if(t!==null)return t;e=e.sibling}return null}var fE=rs.unstable_scheduleCallback,$v=rs.unstable_cancelCallback,$N=rs.unstable_shouldYield,HN=rs.unstable_requestPaint,dr=rs.unstable_now,GN=rs.unstable_getCurrentPriorityLevel,$x=rs.unstable_ImmediatePriority,hE=rs.unstable_UserBlockingPriority,dh=rs.unstable_NormalPriority,XN=rs.unstable_LowPriority,dE=rs.unstable_IdlePriority,dd=null,pa=null;function KN(e){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(dd,e,void 0,(e.current.flags&128)===128)}catch{}}var Hs=Math.clz32?Math.clz32:QN,qN=Math.log,YN=Math.LN2;function QN(e){return e>>>=0,e===0?32:31-(qN(e)/YN|0)|0}var pf=64,mf=4194304;function iu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ph(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=iu(o):(a&=i,a!==0&&(n=iu(a)))}else i=r&~s,i!==0?n=iu(i):a!==0&&(n=iu(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Hs(t),s=1<<r,n|=e[r],t&=~s;return n}function JN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Hs(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=JN(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function wm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function pE(){var e=pf;return pf<<=1,!(pf&4194240)&&(pf=64),e}function up(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function N0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Hs(t),e[t]=r}function eC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Hs(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function Hx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Hs(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var It=0;function mE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xE,Gx,gE,vE,_E,Em=!1,xf=[],Ai=null,Ni=null,Ci=null,zu=new Map,Wu=new Map,_i=[],tC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hv(e,t){switch(e){case"focusin":case"focusout":Ai=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":Ci=null;break;case"pointerover":case"pointerout":zu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wu.delete(t.pointerId)}}function qc(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=I0(t),t!==null&&Gx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function rC(e,t,r,n,s){switch(t){case"focusin":return Ai=qc(Ai,e,t,r,n,s),!0;case"dragenter":return Ni=qc(Ni,e,t,r,n,s),!0;case"mouseover":return Ci=qc(Ci,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return zu.set(a,qc(zu.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Wu.set(a,qc(Wu.get(a)||null,e,t,r,n,s)),!0}return!1}function yE(e){var t=wo(e.target);if(t!==null){var r=qo(t);if(r!==null){if(t=r.tag,t===13){if(t=lE(r),t!==null){e.blockedOn=t,_E(e.priority,function(){gE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Kf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Tm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gm=n,r.target.dispatchEvent(n),gm=null}else return t=I0(r),t!==null&&Gx(t),e.blockedOn=r,!1;t.shift()}return!0}function Gv(e,t,r){Kf(e)&&r.delete(t)}function nC(){Em=!1,Ai!==null&&Kf(Ai)&&(Ai=null),Ni!==null&&Kf(Ni)&&(Ni=null),Ci!==null&&Kf(Ci)&&(Ci=null),zu.forEach(Gv),Wu.forEach(Gv)}function Yc(e,t){e.blockedOn===t&&(e.blockedOn=null,Em||(Em=!0,rs.unstable_scheduleCallback(rs.unstable_NormalPriority,nC)))}function $u(e){function t(s){return Yc(s,e)}if(0<xf.length){Yc(xf[0],e);for(var r=1;r<xf.length;r++){var n=xf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ai!==null&&Yc(Ai,e),Ni!==null&&Yc(Ni,e),Ci!==null&&Yc(Ci,e),zu.forEach(t),Wu.forEach(t),r=0;r<_i.length;r++)n=_i[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<_i.length&&(r=_i[0],r.blockedOn===null);)yE(r),r.blockedOn===null&&_i.shift()}var Yl=ti.ReactCurrentBatchConfig,mh=!0;function sC(e,t,r,n){var s=It,a=Yl.transition;Yl.transition=null;try{It=1,Xx(e,t,r,n)}finally{It=s,Yl.transition=a}}function aC(e,t,r,n){var s=It,a=Yl.transition;Yl.transition=null;try{It=4,Xx(e,t,r,n)}finally{It=s,Yl.transition=a}}function Xx(e,t,r,n){if(mh){var s=Tm(e,t,r,n);if(s===null)yp(e,t,n,xh,r),Hv(e,n);else if(rC(s,e,t,r,n))n.stopPropagation();else if(Hv(e,n),t&4&&-1<tC.indexOf(e)){for(;s!==null;){var a=I0(s);if(a!==null&&xE(a),a=Tm(e,t,r,n),a===null&&yp(e,t,n,xh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else yp(e,t,n,null,r)}}var xh=null;function Tm(e,t,r,n){if(xh=null,e=Wx(n),e=wo(e),e!==null)if(t=qo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=lE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xh=e,null}function wE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GN()){case $x:return 1;case hE:return 4;case dh:case XN:return 16;case dE:return 536870912;default:return 16}default:return 16}}var wi=null,Kx=null,qf=null;function EE(){if(qf)return qf;var e,t=Kx,r=t.length,n,s="value"in wi?wi.value:wi.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return qf=s.slice(e,1<n?1-n:void 0)}function Yf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gf(){return!0}function Xv(){return!1}function as(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?gf:Xv,this.isPropagationStopped=Xv,this}return er(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=gf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=gf)},persist:function(){},isPersistent:gf}),t}var Sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qx=as(Sc),C0=er({},Sc,{view:0,detail:0}),iC=as(C0),fp,hp,Qc,pd=er({},C0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qc&&(Qc&&e.type==="mousemove"?(fp=e.screenX-Qc.screenX,hp=e.screenY-Qc.screenY):hp=fp=0,Qc=e),fp)},movementY:function(e){return"movementY"in e?e.movementY:hp}}),Kv=as(pd),oC=er({},pd,{dataTransfer:0}),lC=as(oC),cC=er({},C0,{relatedTarget:0}),dp=as(cC),uC=er({},Sc,{animationName:0,elapsedTime:0,pseudoElement:0}),fC=as(uC),hC=er({},Sc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dC=as(hC),pC=er({},Sc,{data:0}),qv=as(pC),mC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gC[e])?!!t[e]:!1}function Yx(){return vC}var _C=er({},C0,{key:function(e){if(e.key){var t=mC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Yf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yx,charCode:function(e){return e.type==="keypress"?Yf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),yC=as(_C),wC=er({},pd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yv=as(wC),EC=er({},C0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yx}),TC=as(EC),kC=er({},Sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),SC=as(kC),bC=er({},pd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),AC=as(bC),NC=[9,13,27,32],Qx=Xa&&"CompositionEvent"in window,vu=null;Xa&&"documentMode"in document&&(vu=document.documentMode);var CC=Xa&&"TextEvent"in window&&!vu,TE=Xa&&(!Qx||vu&&8<vu&&11>=vu),Qv=" ",Jv=!1;function kE(e,t){switch(e){case"keyup":return NC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jl=!1;function IC(e,t){switch(e){case"compositionend":return SE(t);case"keypress":return t.which!==32?null:(Jv=!0,Qv);case"textInput":return e=t.data,e===Qv&&Jv?null:e;default:return null}}function FC(e,t){if(jl)return e==="compositionend"||!Qx&&kE(e,t)?(e=EE(),qf=Kx=wi=null,jl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return TE&&t.locale!=="ko"?null:t.data;default:return null}}var RC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!RC[e.type]:t==="textarea"}function bE(e,t,r,n){nE(n),t=gh(t,"onChange"),0<t.length&&(r=new qx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var _u=null,Hu=null;function PC(e){LE(e,0)}function md(e){var t=Vl(e);if(Yw(t))return e}function DC(e,t){if(e==="change")return t}var AE=!1;if(Xa){var pp;if(Xa){var mp="oninput"in document;if(!mp){var e_=document.createElement("div");e_.setAttribute("oninput","return;"),mp=typeof e_.oninput=="function"}pp=mp}else pp=!1;AE=pp&&(!document.documentMode||9<document.documentMode)}function t_(){_u&&(_u.detachEvent("onpropertychange",NE),Hu=_u=null)}function NE(e){if(e.propertyName==="value"&&md(Hu)){var t=[];bE(t,Hu,e,Wx(e)),oE(PC,t)}}function OC(e,t,r){e==="focusin"?(t_(),_u=t,Hu=r,_u.attachEvent("onpropertychange",NE)):e==="focusout"&&t_()}function jC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return md(Hu)}function LC(e,t){if(e==="click")return md(t)}function MC(e,t){if(e==="input"||e==="change")return md(t)}function VC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qs=typeof Object.is=="function"?Object.is:VC;function Gu(e,t){if(qs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!am.call(t,s)||!qs(e[s],t[s]))return!1}return!0}function r_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function n_(e,t){var r=r_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=r_(r)}}function CE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function IE(){for(var e=window,t=uh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=uh(e.document)}return t}function Jx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BC(e){var t=IE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&CE(r.ownerDocument.documentElement,r)){if(n!==null&&Jx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=n_(r,a);var i=n_(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UC=Xa&&"documentMode"in document&&11>=document.documentMode,Ll=null,km=null,yu=null,Sm=!1;function s_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sm||Ll==null||Ll!==uh(n)||(n=Ll,"selectionStart"in n&&Jx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yu&&Gu(yu,n)||(yu=n,n=gh(km,"onSelect"),0<n.length&&(t=new qx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ll)))}function vf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ml={animationend:vf("Animation","AnimationEnd"),animationiteration:vf("Animation","AnimationIteration"),animationstart:vf("Animation","AnimationStart"),transitionend:vf("Transition","TransitionEnd")},xp={},FE={};Xa&&(FE=document.createElement("div").style,"AnimationEvent"in window||(delete Ml.animationend.animation,delete Ml.animationiteration.animation,delete Ml.animationstart.animation),"TransitionEvent"in window||delete Ml.transitionend.transition);function xd(e){if(xp[e])return xp[e];if(!Ml[e])return e;var t=Ml[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in FE)return xp[e]=t[r];return e}var RE=xd("animationend"),PE=xd("animationiteration"),DE=xd("animationstart"),OE=xd("transitionend"),jE=new Map,a_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qi(e,t){jE.set(e,t),Ko(t,[e])}for(var gp=0;gp<a_.length;gp++){var vp=a_[gp],zC=vp.toLowerCase(),WC=vp[0].toUpperCase()+vp.slice(1);Qi(zC,"on"+WC)}Qi(RE,"onAnimationEnd");Qi(PE,"onAnimationIteration");Qi(DE,"onAnimationStart");Qi("dblclick","onDoubleClick");Qi("focusin","onFocus");Qi("focusout","onBlur");Qi(OE,"onTransitionEnd");ic("onMouseEnter",["mouseout","mouseover"]);ic("onMouseLeave",["mouseout","mouseover"]);ic("onPointerEnter",["pointerout","pointerover"]);ic("onPointerLeave",["pointerout","pointerover"]);Ko("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ko("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ko("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ko("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ko("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$C=new Set("cancel close invalid load scroll toggle".split(" ").concat(ou));function i_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zN(n,t,void 0,e),e.currentTarget=null}function LE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;i_(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;i_(s,o,c),a=l}}}if(hh)throw e=ym,hh=!1,ym=null,e}function Bt(e,t){var r=t[Im];r===void 0&&(r=t[Im]=new Set);var n=e+"__bubble";r.has(n)||(ME(t,e,2,!1),r.add(n))}function _p(e,t,r){var n=0;t&&(n|=4),ME(r,e,n,t)}var _f="_reactListening"+Math.random().toString(36).slice(2);function Xu(e){if(!e[_f]){e[_f]=!0,Hw.forEach(function(r){r!=="selectionchange"&&($C.has(r)||_p(r,!1,e),_p(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_f]||(t[_f]=!0,_p("selectionchange",!1,t))}}function ME(e,t,r,n){switch(wE(t)){case 1:var s=sC;break;case 4:s=aC;break;default:s=Xx}r=s.bind(null,t,r,e),s=void 0,!_m||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function yp(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=wo(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}oE(function(){var c=a,f=Wx(r),d=[];e:{var p=jE.get(e);if(p!==void 0){var m=qx,g=e;switch(e){case"keypress":if(Yf(r)===0)break e;case"keydown":case"keyup":m=yC;break;case"focusin":g="focus",m=dp;break;case"focusout":g="blur",m=dp;break;case"beforeblur":case"afterblur":m=dp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=TC;break;case RE:case PE:case DE:m=fC;break;case OE:m=SC;break;case"scroll":m=iC;break;case"wheel":m=AC;break;case"copy":case"cut":case"paste":m=dC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Yv}var x=(t&4)!==0,_=!x&&e==="scroll",y=x?p!==null?p+"Capture":null:p;x=[];for(var E=c,w;E!==null;){w=E;var R=w.stateNode;if(w.tag===5&&R!==null&&(w=R,y!==null&&(R=Uu(E,y),R!=null&&x.push(Ku(E,R,w)))),_)break;E=E.return}0<x.length&&(p=new m(p,g,null,r,f),d.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==gm&&(g=r.relatedTarget||r.fromElement)&&(wo(g)||g[Ka]))break e;if((m||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?wo(g):null,g!==null&&(_=qo(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(x=Kv,R="onMouseLeave",y="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(x=Yv,R="onPointerLeave",y="onPointerEnter",E="pointer"),_=m==null?p:Vl(m),w=g==null?p:Vl(g),p=new x(R,E+"leave",m,r,f),p.target=_,p.relatedTarget=w,R=null,wo(f)===c&&(x=new x(y,E+"enter",g,r,f),x.target=w,x.relatedTarget=_,R=x),_=R,m&&g)t:{for(x=m,y=g,E=0,w=x;w;w=El(w))E++;for(w=0,R=y;R;R=El(R))w++;for(;0<E-w;)x=El(x),E--;for(;0<w-E;)y=El(y),w--;for(;E--;){if(x===y||y!==null&&x===y.alternate)break t;x=El(x),y=El(y)}x=null}else x=null;m!==null&&o_(d,p,m,x,!1),g!==null&&_!==null&&o_(d,_,g,x,!0)}}e:{if(p=c?Vl(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var V=DC;else if(Zv(p))if(AE)V=MC;else{V=jC;var L=OC}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(V=LC);if(V&&(V=V(e,c))){bE(d,V,r,f);break e}L&&L(e,p,c),e==="focusout"&&(L=p._wrapperState)&&L.controlled&&p.type==="number"&&hm(p,"number",p.value)}switch(L=c?Vl(c):window,e){case"focusin":(Zv(L)||L.contentEditable==="true")&&(Ll=L,km=c,yu=null);break;case"focusout":yu=km=Ll=null;break;case"mousedown":Sm=!0;break;case"contextmenu":case"mouseup":case"dragend":Sm=!1,s_(d,r,f);break;case"selectionchange":if(UC)break;case"keydown":case"keyup":s_(d,r,f)}var T;if(Qx)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else jl?kE(e,r)&&(S="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(TE&&r.locale!=="ko"&&(jl||S!=="onCompositionStart"?S==="onCompositionEnd"&&jl&&(T=EE()):(wi=f,Kx="value"in wi?wi.value:wi.textContent,jl=!0)),L=gh(c,S),0<L.length&&(S=new qv(S,e,null,r,f),d.push({event:S,listeners:L}),T?S.data=T:(T=SE(r),T!==null&&(S.data=T)))),(T=CC?IC(e,r):FC(e,r))&&(c=gh(c,"onBeforeInput"),0<c.length&&(f=new qv("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=T))}LE(d,t)})}function Ku(e,t,r){return{instance:e,listener:t,currentTarget:r}}function gh(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Uu(e,r),a!=null&&n.unshift(Ku(e,a,s)),a=Uu(e,t),a!=null&&n.push(Ku(e,a,s))),e=e.return}return n}function El(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function o_(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Uu(r,a),l!=null&&i.unshift(Ku(r,l,o))):s||(l=Uu(r,a),l!=null&&i.push(Ku(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var HC=/\r\n?/g,GC=/\u0000|\uFFFD/g;function l_(e){return(typeof e=="string"?e:""+e).replace(HC,`
`).replace(GC,"")}function yf(e,t,r){if(t=l_(t),l_(e)!==t&&r)throw Error(Ee(425))}function vh(){}var bm=null,Am=null;function Nm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Cm=typeof setTimeout=="function"?setTimeout:void 0,XC=typeof clearTimeout=="function"?clearTimeout:void 0,c_=typeof Promise=="function"?Promise:void 0,KC=typeof queueMicrotask=="function"?queueMicrotask:typeof c_<"u"?function(e){return c_.resolve(null).then(e).catch(qC)}:Cm;function qC(e){setTimeout(function(){throw e})}function wp(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),$u(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);$u(t)}function Ii(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function u_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var bc=Math.random().toString(36).slice(2),ha="__reactFiber$"+bc,qu="__reactProps$"+bc,Ka="__reactContainer$"+bc,Im="__reactEvents$"+bc,YC="__reactListeners$"+bc,QC="__reactHandles$"+bc;function wo(e){var t=e[ha];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ka]||r[ha]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=u_(e);e!==null;){if(r=e[ha])return r;e=u_(e)}return t}e=r,r=e.parentNode}return null}function I0(e){return e=e[ha]||e[Ka],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function gd(e){return e[qu]||null}var Fm=[],Bl=-1;function Ji(e){return{current:e}}function Wt(e){0>Bl||(e.current=Fm[Bl],Fm[Bl]=null,Bl--)}function Lt(e,t){Bl++,Fm[Bl]=e.current,e.current=t}var Bi={},vn=Ji(Bi),Bn=Ji(!1),Oo=Bi;function oc(e,t){var r=e.type.contextTypes;if(!r)return Bi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Un(e){return e=e.childContextTypes,e!=null}function _h(){Wt(Bn),Wt(vn)}function f_(e,t,r){if(vn.current!==Bi)throw Error(Ee(168));Lt(vn,t),Lt(Bn,r)}function VE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Ee(108,ON(e)||"Unknown",s));return er({},r,n)}function yh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bi,Oo=vn.current,Lt(vn,e),Lt(Bn,Bn.current),!0}function h_(e,t,r){var n=e.stateNode;if(!n)throw Error(Ee(169));r?(e=VE(e,t,Oo),n.__reactInternalMemoizedMergedChildContext=e,Wt(Bn),Wt(vn),Lt(vn,e)):Wt(Bn),Lt(Bn,r)}var Ma=null,vd=!1,Ep=!1;function BE(e){Ma===null?Ma=[e]:Ma.push(e)}function JC(e){vd=!0,BE(e)}function Zi(){if(!Ep&&Ma!==null){Ep=!0;var e=0,t=It;try{var r=Ma;for(It=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ma=null,vd=!1}catch(s){throw Ma!==null&&(Ma=Ma.slice(e+1)),fE($x,Zi),s}finally{It=t,Ep=!1}}return null}var Ul=[],zl=0,wh=null,Eh=0,vs=[],_s=0,jo=null,Va=1,Ba="";function go(e,t){Ul[zl++]=Eh,Ul[zl++]=wh,wh=e,Eh=t}function UE(e,t,r){vs[_s++]=Va,vs[_s++]=Ba,vs[_s++]=jo,jo=e;var n=Va;e=Ba;var s=32-Hs(n)-1;n&=~(1<<s),r+=1;var a=32-Hs(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Va=1<<32-Hs(t)+s|r<<s|n,Ba=a+e}else Va=1<<a|r<<s|n,Ba=e}function Zx(e){e.return!==null&&(go(e,1),UE(e,1,0))}function eg(e){for(;e===wh;)wh=Ul[--zl],Ul[zl]=null,Eh=Ul[--zl],Ul[zl]=null;for(;e===jo;)jo=vs[--_s],vs[_s]=null,Ba=vs[--_s],vs[_s]=null,Va=vs[--_s],vs[_s]=null}var ts=null,es=null,Kt=!1,Bs=null;function zE(e,t){var r=Es(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function d_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ts=e,es=Ii(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ts=e,es=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=jo!==null?{id:Va,overflow:Ba}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Es(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ts=e,es=null,!0):!1;default:return!1}}function Rm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Pm(e){if(Kt){var t=es;if(t){var r=t;if(!d_(e,t)){if(Rm(e))throw Error(Ee(418));t=Ii(r.nextSibling);var n=ts;t&&d_(e,t)?zE(n,r):(e.flags=e.flags&-4097|2,Kt=!1,ts=e)}}else{if(Rm(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,Kt=!1,ts=e}}}function p_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ts=e}function wf(e){if(e!==ts)return!1;if(!Kt)return p_(e),Kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nm(e.type,e.memoizedProps)),t&&(t=es)){if(Rm(e))throw WE(),Error(Ee(418));for(;t;)zE(e,t),t=Ii(t.nextSibling)}if(p_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){es=Ii(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}es=null}}else es=ts?Ii(e.stateNode.nextSibling):null;return!0}function WE(){for(var e=es;e;)e=Ii(e.nextSibling)}function lc(){es=ts=null,Kt=!1}function tg(e){Bs===null?Bs=[e]:Bs.push(e)}var ZC=ti.ReactCurrentBatchConfig;function Jc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var n=r.stateNode}if(!n)throw Error(Ee(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function Ef(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function m_(e){var t=e._init;return t(e._payload)}function $E(e){function t(y,E){if(e){var w=y.deletions;w===null?(y.deletions=[E],y.flags|=16):w.push(E)}}function r(y,E){if(!e)return null;for(;E!==null;)t(y,E),E=E.sibling;return null}function n(y,E){for(y=new Map;E!==null;)E.key!==null?y.set(E.key,E):y.set(E.index,E),E=E.sibling;return y}function s(y,E){return y=Di(y,E),y.index=0,y.sibling=null,y}function a(y,E,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<E?(y.flags|=2,E):w):(y.flags|=2,E)):(y.flags|=1048576,E)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,E,w,R){return E===null||E.tag!==6?(E=Cp(w,y.mode,R),E.return=y,E):(E=s(E,w),E.return=y,E)}function l(y,E,w,R){var V=w.type;return V===Ol?f(y,E,w.props.children,R,w.key):E!==null&&(E.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===gi&&m_(V)===E.type)?(R=s(E,w.props),R.ref=Jc(y,E,w),R.return=y,R):(R=nh(w.type,w.key,w.props,null,y.mode,R),R.ref=Jc(y,E,w),R.return=y,R)}function c(y,E,w,R){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=Ip(w,y.mode,R),E.return=y,E):(E=s(E,w.children||[]),E.return=y,E)}function f(y,E,w,R,V){return E===null||E.tag!==7?(E=Ao(w,y.mode,R,V),E.return=y,E):(E=s(E,w),E.return=y,E)}function d(y,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Cp(""+E,y.mode,w),E.return=y,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ff:return w=nh(E.type,E.key,E.props,null,y.mode,w),w.ref=Jc(y,null,E),w.return=y,w;case Dl:return E=Ip(E,y.mode,w),E.return=y,E;case gi:var R=E._init;return d(y,R(E._payload),w)}if(au(E)||Xc(E))return E=Ao(E,y.mode,w,null),E.return=y,E;Ef(y,E)}return null}function p(y,E,w,R){var V=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return V!==null?null:o(y,E,""+w,R);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ff:return w.key===V?l(y,E,w,R):null;case Dl:return w.key===V?c(y,E,w,R):null;case gi:return V=w._init,p(y,E,V(w._payload),R)}if(au(w)||Xc(w))return V!==null?null:f(y,E,w,R,null);Ef(y,w)}return null}function m(y,E,w,R,V){if(typeof R=="string"&&R!==""||typeof R=="number")return y=y.get(w)||null,o(E,y,""+R,V);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case ff:return y=y.get(R.key===null?w:R.key)||null,l(E,y,R,V);case Dl:return y=y.get(R.key===null?w:R.key)||null,c(E,y,R,V);case gi:var L=R._init;return m(y,E,w,L(R._payload),V)}if(au(R)||Xc(R))return y=y.get(w)||null,f(E,y,R,V,null);Ef(E,R)}return null}function g(y,E,w,R){for(var V=null,L=null,T=E,S=E=0,b=null;T!==null&&S<w.length;S++){T.index>S?(b=T,T=null):b=T.sibling;var F=p(y,T,w[S],R);if(F===null){T===null&&(T=b);break}e&&T&&F.alternate===null&&t(y,T),E=a(F,E,S),L===null?V=F:L.sibling=F,L=F,T=b}if(S===w.length)return r(y,T),Kt&&go(y,S),V;if(T===null){for(;S<w.length;S++)T=d(y,w[S],R),T!==null&&(E=a(T,E,S),L===null?V=T:L.sibling=T,L=T);return Kt&&go(y,S),V}for(T=n(y,T);S<w.length;S++)b=m(T,y,S,w[S],R),b!==null&&(e&&b.alternate!==null&&T.delete(b.key===null?S:b.key),E=a(b,E,S),L===null?V=b:L.sibling=b,L=b);return e&&T.forEach(function(N){return t(y,N)}),Kt&&go(y,S),V}function x(y,E,w,R){var V=Xc(w);if(typeof V!="function")throw Error(Ee(150));if(w=V.call(w),w==null)throw Error(Ee(151));for(var L=V=null,T=E,S=E=0,b=null,F=w.next();T!==null&&!F.done;S++,F=w.next()){T.index>S?(b=T,T=null):b=T.sibling;var N=p(y,T,F.value,R);if(N===null){T===null&&(T=b);break}e&&T&&N.alternate===null&&t(y,T),E=a(N,E,S),L===null?V=N:L.sibling=N,L=N,T=b}if(F.done)return r(y,T),Kt&&go(y,S),V;if(T===null){for(;!F.done;S++,F=w.next())F=d(y,F.value,R),F!==null&&(E=a(F,E,S),L===null?V=F:L.sibling=F,L=F);return Kt&&go(y,S),V}for(T=n(y,T);!F.done;S++,F=w.next())F=m(T,y,S,F.value,R),F!==null&&(e&&F.alternate!==null&&T.delete(F.key===null?S:F.key),E=a(F,E,S),L===null?V=F:L.sibling=F,L=F);return e&&T.forEach(function(C){return t(y,C)}),Kt&&go(y,S),V}function _(y,E,w,R){if(typeof w=="object"&&w!==null&&w.type===Ol&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ff:e:{for(var V=w.key,L=E;L!==null;){if(L.key===V){if(V=w.type,V===Ol){if(L.tag===7){r(y,L.sibling),E=s(L,w.props.children),E.return=y,y=E;break e}}else if(L.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===gi&&m_(V)===L.type){r(y,L.sibling),E=s(L,w.props),E.ref=Jc(y,L,w),E.return=y,y=E;break e}r(y,L);break}else t(y,L);L=L.sibling}w.type===Ol?(E=Ao(w.props.children,y.mode,R,w.key),E.return=y,y=E):(R=nh(w.type,w.key,w.props,null,y.mode,R),R.ref=Jc(y,E,w),R.return=y,y=R)}return i(y);case Dl:e:{for(L=w.key;E!==null;){if(E.key===L)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){r(y,E.sibling),E=s(E,w.children||[]),E.return=y,y=E;break e}else{r(y,E);break}else t(y,E);E=E.sibling}E=Ip(w,y.mode,R),E.return=y,y=E}return i(y);case gi:return L=w._init,_(y,E,L(w._payload),R)}if(au(w))return g(y,E,w,R);if(Xc(w))return x(y,E,w,R);Ef(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(r(y,E.sibling),E=s(E,w),E.return=y,y=E):(r(y,E),E=Cp(w,y.mode,R),E.return=y,y=E),i(y)):r(y,E)}return _}var cc=$E(!0),HE=$E(!1),Th=Ji(null),kh=null,Wl=null,rg=null;function ng(){rg=Wl=kh=null}function sg(e){var t=Th.current;Wt(Th),e._currentValue=t}function Dm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ql(e,t){kh=e,rg=Wl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vn=!0),e.firstContext=null)}function Ss(e){var t=e._currentValue;if(rg!==e)if(e={context:e,memoizedValue:t,next:null},Wl===null){if(kh===null)throw Error(Ee(308));Wl=e,kh.dependencies={lanes:0,firstContext:e}}else Wl=Wl.next=e;return t}var Eo=null;function ag(e){Eo===null?Eo=[e]:Eo.push(e)}function GE(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,ag(t)):(r.next=s.next,s.next=r),t.interleaved=r,qa(e,n)}function qa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var vi=!1;function ig(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function XE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function za(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,mt&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,qa(e,r)}return s=n.interleaved,s===null?(t.next=t,ag(n)):(t.next=s.next,s.next=t),n.interleaved=t,qa(e,r)}function Qf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Hx(e,r)}}function x_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Sh(e,t,r,n){var s=e.updateQueue;vi=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,f=c=l=null,o=a;do{var p=o.lane,m=o.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,x=o;switch(p=t,m=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){d=g.call(m,d,p);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,p=typeof g=="function"?g.call(m,d,p):g,p==null)break e;d=er({},d,p);break e;case 2:vi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=d):f=f.next=m,i|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;p=o,o=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Mo|=i,e.lanes=i,e.memoizedState=d}}function g_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ee(191,s));s.call(n)}}}var F0={},ma=Ji(F0),Yu=Ji(F0),Qu=Ji(F0);function To(e){if(e===F0)throw Error(Ee(174));return e}function og(e,t){switch(Lt(Qu,t),Lt(Yu,e),Lt(ma,F0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pm(t,e)}Wt(ma),Lt(ma,t)}function uc(){Wt(ma),Wt(Yu),Wt(Qu)}function KE(e){To(Qu.current);var t=To(ma.current),r=pm(t,e.type);t!==r&&(Lt(Yu,e),Lt(ma,r))}function lg(e){Yu.current===e&&(Wt(ma),Wt(Yu))}var qt=Ji(0);function bh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Tp=[];function cg(){for(var e=0;e<Tp.length;e++)Tp[e]._workInProgressVersionPrimary=null;Tp.length=0}var Jf=ti.ReactCurrentDispatcher,kp=ti.ReactCurrentBatchConfig,Lo=0,Zt=null,Cr=null,Mr=null,Ah=!1,wu=!1,Ju=0,e3=0;function an(){throw Error(Ee(321))}function ug(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!qs(e[r],t[r]))return!1;return!0}function fg(e,t,r,n,s,a){if(Lo=a,Zt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Jf.current=e===null||e.memoizedState===null?s3:a3,e=r(n,s),wu){a=0;do{if(wu=!1,Ju=0,25<=a)throw Error(Ee(301));a+=1,Mr=Cr=null,t.updateQueue=null,Jf.current=i3,e=r(n,s)}while(wu)}if(Jf.current=Nh,t=Cr!==null&&Cr.next!==null,Lo=0,Mr=Cr=Zt=null,Ah=!1,t)throw Error(Ee(300));return e}function hg(){var e=Ju!==0;return Ju=0,e}function ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?Zt.memoizedState=Mr=e:Mr=Mr.next=e,Mr}function bs(){if(Cr===null){var e=Zt.alternate;e=e!==null?e.memoizedState:null}else e=Cr.next;var t=Mr===null?Zt.memoizedState:Mr.next;if(t!==null)Mr=t,Cr=e;else{if(e===null)throw Error(Ee(310));Cr=e,e={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},Mr===null?Zt.memoizedState=Mr=e:Mr=Mr.next=e}return Mr}function Zu(e,t){return typeof t=="function"?t(e):t}function Sp(e){var t=bs(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=Cr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var f=c.lane;if((Lo&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Zt.lanes|=f,Mo|=f}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,qs(n,t.memoizedState)||(Vn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Zt.lanes|=a,Mo|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function bp(e){var t=bs(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);qs(a,t.memoizedState)||(Vn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function qE(){}function YE(e,t){var r=Zt,n=bs(),s=t(),a=!qs(n.memoizedState,s);if(a&&(n.memoizedState=s,Vn=!0),n=n.queue,dg(ZE.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Mr!==null&&Mr.memoizedState.tag&1){if(r.flags|=2048,e0(9,JE.bind(null,r,n,s,t),void 0,null),zr===null)throw Error(Ee(349));Lo&30||QE(r,t,s)}return s}function QE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Zt.updateQueue,t===null?(t={lastEffect:null,stores:null},Zt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function JE(e,t,r,n){t.value=r,t.getSnapshot=n,eT(t)&&tT(e)}function ZE(e,t,r){return r(function(){eT(t)&&tT(e)})}function eT(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!qs(e,r)}catch{return!0}}function tT(e){var t=qa(e,1);t!==null&&Gs(t,e,1,-1)}function v_(e){var t=ua();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zu,lastRenderedState:e},t.queue=e,e=e.dispatch=n3.bind(null,Zt,e),[t.memoizedState,e]}function e0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Zt.updateQueue,t===null?(t={lastEffect:null,stores:null},Zt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function rT(){return bs().memoizedState}function Zf(e,t,r,n){var s=ua();Zt.flags|=e,s.memoizedState=e0(1|t,r,void 0,n===void 0?null:n)}function _d(e,t,r,n){var s=bs();n=n===void 0?null:n;var a=void 0;if(Cr!==null){var i=Cr.memoizedState;if(a=i.destroy,n!==null&&ug(n,i.deps)){s.memoizedState=e0(t,r,a,n);return}}Zt.flags|=e,s.memoizedState=e0(1|t,r,a,n)}function __(e,t){return Zf(8390656,8,e,t)}function dg(e,t){return _d(2048,8,e,t)}function nT(e,t){return _d(4,2,e,t)}function sT(e,t){return _d(4,4,e,t)}function aT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function iT(e,t,r){return r=r!=null?r.concat([e]):null,_d(4,4,aT.bind(null,t,e),r)}function pg(){}function oT(e,t){var r=bs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&ug(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function lT(e,t){var r=bs();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&ug(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function cT(e,t,r){return Lo&21?(qs(r,t)||(r=pE(),Zt.lanes|=r,Mo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vn=!0),e.memoizedState=r)}function t3(e,t){var r=It;It=r!==0&&4>r?r:4,e(!0);var n=kp.transition;kp.transition={};try{e(!1),t()}finally{It=r,kp.transition=n}}function uT(){return bs().memoizedState}function r3(e,t,r){var n=Pi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fT(e))hT(t,r);else if(r=GE(e,t,r,n),r!==null){var s=An();Gs(r,e,n,s),dT(r,t,n)}}function n3(e,t,r){var n=Pi(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fT(e))hT(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,qs(o,i)){var l=t.interleaved;l===null?(s.next=s,ag(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=GE(e,t,s,n),r!==null&&(s=An(),Gs(r,e,n,s),dT(r,t,n))}}function fT(e){var t=e.alternate;return e===Zt||t!==null&&t===Zt}function hT(e,t){wu=Ah=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function dT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Hx(e,r)}}var Nh={readContext:Ss,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},s3={readContext:Ss,useCallback:function(e,t){return ua().memoizedState=[e,t===void 0?null:t],e},useContext:Ss,useEffect:__,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Zf(4194308,4,aT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Zf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Zf(4,2,e,t)},useMemo:function(e,t){var r=ua();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ua();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=r3.bind(null,Zt,e),[n.memoizedState,e]},useRef:function(e){var t=ua();return e={current:e},t.memoizedState=e},useState:v_,useDebugValue:pg,useDeferredValue:function(e){return ua().memoizedState=e},useTransition:function(){var e=v_(!1),t=e[0];return e=t3.bind(null,e[1]),ua().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Zt,s=ua();if(Kt){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),zr===null)throw Error(Ee(349));Lo&30||QE(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,__(ZE.bind(null,n,a,e),[e]),n.flags|=2048,e0(9,JE.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ua(),t=zr.identifierPrefix;if(Kt){var r=Ba,n=Va;r=(n&~(1<<32-Hs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ju++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=e3++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},a3={readContext:Ss,useCallback:oT,useContext:Ss,useEffect:dg,useImperativeHandle:iT,useInsertionEffect:nT,useLayoutEffect:sT,useMemo:lT,useReducer:Sp,useRef:rT,useState:function(){return Sp(Zu)},useDebugValue:pg,useDeferredValue:function(e){var t=bs();return cT(t,Cr.memoizedState,e)},useTransition:function(){var e=Sp(Zu)[0],t=bs().memoizedState;return[e,t]},useMutableSource:qE,useSyncExternalStore:YE,useId:uT,unstable_isNewReconciler:!1},i3={readContext:Ss,useCallback:oT,useContext:Ss,useEffect:dg,useImperativeHandle:iT,useInsertionEffect:nT,useLayoutEffect:sT,useMemo:lT,useReducer:bp,useRef:rT,useState:function(){return bp(Zu)},useDebugValue:pg,useDeferredValue:function(e){var t=bs();return Cr===null?t.memoizedState=e:cT(t,Cr.memoizedState,e)},useTransition:function(){var e=bp(Zu)[0],t=bs().memoizedState;return[e,t]},useMutableSource:qE,useSyncExternalStore:YE,useId:uT,unstable_isNewReconciler:!1};function Ms(e,t){if(e&&e.defaultProps){t=er({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Om(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:er({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var yd={isMounted:function(e){return(e=e._reactInternals)?qo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=An(),s=Pi(e),a=za(n,s);a.payload=t,r!=null&&(a.callback=r),t=Fi(e,a,s),t!==null&&(Gs(t,e,s,n),Qf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=An(),s=Pi(e),a=za(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Fi(e,a,s),t!==null&&(Gs(t,e,s,n),Qf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=An(),n=Pi(e),s=za(r,n);s.tag=2,t!=null&&(s.callback=t),t=Fi(e,s,n),t!==null&&(Gs(t,e,n,r),Qf(t,e,n))}};function y_(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Gu(r,n)||!Gu(s,a):!0}function pT(e,t,r){var n=!1,s=Bi,a=t.contextType;return typeof a=="object"&&a!==null?a=Ss(a):(s=Un(t)?Oo:vn.current,n=t.contextTypes,a=(n=n!=null)?oc(e,s):Bi),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function w_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&yd.enqueueReplaceState(t,t.state,null)}function jm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},ig(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Ss(a):(a=Un(t)?Oo:vn.current,s.context=oc(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Om(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&yd.enqueueReplaceState(s,s.state,null),Sh(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function fc(e,t){try{var r="",n=t;do r+=DN(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Ap(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function Lm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var o3=typeof WeakMap=="function"?WeakMap:Map;function mT(e,t,r){r=za(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ih||(Ih=!0,Xm=n),Lm(e,t)},r}function xT(e,t,r){r=za(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Lm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Lm(e,t),typeof n!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function E_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new o3;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=w3.bind(null,e,t,r),t.then(e,e))}function T_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function k_(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=za(-1,1),t.tag=2,Fi(r,t,1))),r.lanes|=1),e)}var l3=ti.ReactCurrentOwner,Vn=!1;function kn(e,t,r,n){t.child=e===null?HE(t,null,r,n):cc(t,e.child,r,n)}function S_(e,t,r,n,s){r=r.render;var a=t.ref;return Ql(t,s),n=fg(e,t,r,n,a,s),r=hg(),e!==null&&!Vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ya(e,t,s)):(Kt&&r&&Zx(t),t.flags|=1,kn(e,t,n,s),t.child)}function b_(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Eg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,gT(e,t,a,n,s)):(e=nh(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Gu,r(i,n)&&e.ref===t.ref)return Ya(e,t,s)}return t.flags|=1,e=Di(a,n),e.ref=t.ref,e.return=t,t.child=e}function gT(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Gu(a,n)&&e.ref===t.ref)if(Vn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Vn=!0);else return t.lanes=e.lanes,Ya(e,t,s)}return Mm(e,t,r,n,s)}function vT(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(Hl,qn),qn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Lt(Hl,qn),qn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Lt(Hl,qn),qn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Lt(Hl,qn),qn|=n;return kn(e,t,s,r),t.child}function _T(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Mm(e,t,r,n,s){var a=Un(r)?Oo:vn.current;return a=oc(t,a),Ql(t,s),r=fg(e,t,r,n,a,s),n=hg(),e!==null&&!Vn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ya(e,t,s)):(Kt&&n&&Zx(t),t.flags|=1,kn(e,t,r,s),t.child)}function A_(e,t,r,n,s){if(Un(r)){var a=!0;yh(t)}else a=!1;if(Ql(t,s),t.stateNode===null)eh(e,t),pT(t,r,n),jm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ss(c):(c=Un(r)?Oo:vn.current,c=oc(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&w_(t,i,n,c),vi=!1;var p=t.memoizedState;i.state=p,Sh(t,n,i,s),l=t.memoizedState,o!==n||p!==l||Bn.current||vi?(typeof f=="function"&&(Om(t,r,f,n),l=t.memoizedState),(o=vi||y_(t,r,o,n,p,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,XE(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ms(t.type,o),i.props=c,d=t.pendingProps,p=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ss(l):(l=Un(r)?Oo:vn.current,l=oc(t,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||p!==l)&&w_(t,i,n,l),vi=!1,p=t.memoizedState,i.state=p,Sh(t,n,i,s);var g=t.memoizedState;o!==d||p!==g||Bn.current||vi?(typeof m=="function"&&(Om(t,r,m,n),g=t.memoizedState),(c=vi||y_(t,r,c,n,p,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Vm(e,t,r,n,a,s)}function Vm(e,t,r,n,s,a){_T(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&h_(t,r,!1),Ya(e,t,a);n=t.stateNode,l3.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=cc(t,e.child,null,a),t.child=cc(t,null,o,a)):kn(e,t,o,a),t.memoizedState=n.state,s&&h_(t,r,!0),t.child}function yT(e){var t=e.stateNode;t.pendingContext?f_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&f_(e,t.context,!1),og(e,t.containerInfo)}function N_(e,t,r,n,s){return lc(),tg(s),t.flags|=256,kn(e,t,r,n),t.child}var Bm={dehydrated:null,treeContext:null,retryLane:0};function Um(e){return{baseLanes:e,cachePool:null,transitions:null}}function wT(e,t,r){var n=t.pendingProps,s=qt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Lt(qt,s&1),e===null)return Pm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Td(i,n,0,null),e=Ao(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Um(r),t.memoizedState=Bm,e):mg(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return c3(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Di(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Di(o,a):(a=Ao(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Um(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Bm,n}return a=e.child,e=a.sibling,n=Di(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function mg(e,t){return t=Td({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tf(e,t,r,n){return n!==null&&tg(n),cc(t,e.child,null,r),e=mg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function c3(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=Ap(Error(Ee(422))),Tf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Td({mode:"visible",children:n.children},s,0,null),a=Ao(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&cc(t,e.child,null,i),t.child.memoizedState=Um(i),t.memoizedState=Bm,a);if(!(t.mode&1))return Tf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Ee(419)),n=Ap(a,n,void 0),Tf(e,t,i,n)}if(o=(i&e.childLanes)!==0,Vn||o){if(n=zr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,qa(e,s),Gs(n,e,s,-1))}return wg(),n=Ap(Error(Ee(421))),Tf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=E3.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,es=Ii(s.nextSibling),ts=t,Kt=!0,Bs=null,e!==null&&(vs[_s++]=Va,vs[_s++]=Ba,vs[_s++]=jo,Va=e.id,Ba=e.overflow,jo=t),t=mg(t,n.children),t.flags|=4096,t)}function C_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Dm(e.return,t,r)}function Np(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function ET(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(kn(e,t,n.children,r),n=qt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&C_(e,r,t);else if(e.tag===19)C_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Lt(qt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&bh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Np(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&bh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Np(t,!0,r,null,a);break;case"together":Np(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function eh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ya(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Mo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=Di(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Di(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function u3(e,t,r){switch(t.tag){case 3:yT(t),lc();break;case 5:KE(t);break;case 1:Un(t.type)&&yh(t);break;case 4:og(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Lt(Th,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Lt(qt,qt.current&1),t.flags|=128,null):r&t.child.childLanes?wT(e,t,r):(Lt(qt,qt.current&1),e=Ya(e,t,r),e!==null?e.sibling:null);Lt(qt,qt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return ET(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Lt(qt,qt.current),n)break;return null;case 22:case 23:return t.lanes=0,vT(e,t,r)}return Ya(e,t,r)}var TT,zm,kT,ST;TT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zm=function(){};kT=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,To(ma.current);var a=null;switch(r){case"input":s=um(e,s),n=um(e,n),a=[];break;case"select":s=er({},s,{value:void 0}),n=er({},n,{value:void 0}),a=[];break;case"textarea":s=dm(e,s),n=dm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=vh)}mm(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Vu.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Vu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Bt("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};ST=function(e,t,r,n){r!==n&&(t.flags|=4)};function Zc(e,t){if(!Kt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function on(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function f3(e,t,r){var n=t.pendingProps;switch(eg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(t),null;case 1:return Un(t.type)&&_h(),on(t),null;case 3:return n=t.stateNode,uc(),Wt(Bn),Wt(vn),cg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(wf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bs!==null&&(Ym(Bs),Bs=null))),zm(e,t),on(t),null;case 5:lg(t);var s=To(Qu.current);if(r=t.type,e!==null&&t.stateNode!=null)kT(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ee(166));return on(t),null}if(e=To(ma.current),wf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ha]=t,n[qu]=a,e=(t.mode&1)!==0,r){case"dialog":Bt("cancel",n),Bt("close",n);break;case"iframe":case"object":case"embed":Bt("load",n);break;case"video":case"audio":for(s=0;s<ou.length;s++)Bt(ou[s],n);break;case"source":Bt("error",n);break;case"img":case"image":case"link":Bt("error",n),Bt("load",n);break;case"details":Bt("toggle",n);break;case"input":Mv(n,a),Bt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Bt("invalid",n);break;case"textarea":Bv(n,a),Bt("invalid",n)}mm(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&yf(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&yf(n.textContent,o,e),s=["children",""+o]):Vu.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Bt("scroll",n)}switch(r){case"input":hf(n),Vv(n,a,!0);break;case"textarea":hf(n),Uv(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=vh)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zw(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ha]=t,e[qu]=n,TT(e,t,!1,!1),t.stateNode=e;e:{switch(i=xm(r,n),r){case"dialog":Bt("cancel",e),Bt("close",e),s=n;break;case"iframe":case"object":case"embed":Bt("load",e),s=n;break;case"video":case"audio":for(s=0;s<ou.length;s++)Bt(ou[s],e);s=n;break;case"source":Bt("error",e),s=n;break;case"img":case"image":case"link":Bt("error",e),Bt("load",e),s=n;break;case"details":Bt("toggle",e),s=n;break;case"input":Mv(e,n),s=um(e,n),Bt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=er({},n,{value:void 0}),Bt("invalid",e);break;case"textarea":Bv(e,n),s=dm(e,n),Bt("invalid",e);break;default:s=n}mm(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?rE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&eE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Bu(e,l):typeof l=="number"&&Bu(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Vu.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Bt("scroll",e):l!=null&&Vx(e,a,l,i))}switch(r){case"input":hf(e),Vv(e,n,!1);break;case"textarea":hf(e),Uv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Vi(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Xl(e,!!n.multiple,a,!1):n.defaultValue!=null&&Xl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=vh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return on(t),null;case 6:if(e&&t.stateNode!=null)ST(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=To(Qu.current),To(ma.current),wf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ha]=t,(a=n.nodeValue!==r)&&(e=ts,e!==null))switch(e.tag){case 3:yf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ha]=t,t.stateNode=n}return on(t),null;case 13:if(Wt(qt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Kt&&es!==null&&t.mode&1&&!(t.flags&128))WE(),lc(),t.flags|=98560,a=!1;else if(a=wf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ee(317));a[ha]=t}else lc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;on(t),a=!1}else Bs!==null&&(Ym(Bs),Bs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||qt.current&1?Rr===0&&(Rr=3):wg())),t.updateQueue!==null&&(t.flags|=4),on(t),null);case 4:return uc(),zm(e,t),e===null&&Xu(t.stateNode.containerInfo),on(t),null;case 10:return sg(t.type._context),on(t),null;case 17:return Un(t.type)&&_h(),on(t),null;case 19:if(Wt(qt),a=t.memoizedState,a===null)return on(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Zc(a,!1);else{if(Rr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=bh(e),i!==null){for(t.flags|=128,Zc(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Lt(qt,qt.current&1|2),t.child}e=e.sibling}a.tail!==null&&dr()>hc&&(t.flags|=128,n=!0,Zc(a,!1),t.lanes=4194304)}else{if(!n)if(e=bh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Zc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Kt)return on(t),null}else 2*dr()-a.renderingStartTime>hc&&r!==1073741824&&(t.flags|=128,n=!0,Zc(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=dr(),t.sibling=null,r=qt.current,Lt(qt,n?r&1|2:r&1),t):(on(t),null);case 22:case 23:return yg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?qn&1073741824&&(on(t),t.subtreeFlags&6&&(t.flags|=8192)):on(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function h3(e,t){switch(eg(t),t.tag){case 1:return Un(t.type)&&_h(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return uc(),Wt(Bn),Wt(vn),cg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lg(t),null;case 13:if(Wt(qt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));lc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wt(qt),null;case 4:return uc(),null;case 10:return sg(t.type._context),null;case 22:case 23:return yg(),null;case 24:return null;default:return null}}var kf=!1,dn=!1,d3=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function $l(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){nr(e,t,n)}else r.current=null}function Wm(e,t,r){try{r()}catch(n){nr(e,t,n)}}var I_=!1;function p3(e,t){if(bm=mh,e=IE(),Jx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,p=null;t:for(;;){for(var m;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(m=d.firstChild)!==null;)p=d,d=m;for(;;){if(d===e)break t;if(p===r&&++c===s&&(o=i),p===a&&++f===n&&(l=i),(m=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Am={focusedElem:e,selectionRange:r},mh=!1,Oe=t;Oe!==null;)if(t=Oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Oe=e;else for(;Oe!==null;){t=Oe;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,_=g.memoizedState,y=t.stateNode,E=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:Ms(t.type,x),_);y.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(R){nr(t,t.return,R)}if(e=t.sibling,e!==null){e.return=t.return,Oe=e;break}Oe=t.return}return g=I_,I_=!1,g}function Eu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Wm(t,r,a)}s=s.next}while(s!==n)}}function wd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function $m(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function bT(e){var t=e.alternate;t!==null&&(e.alternate=null,bT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ha],delete t[qu],delete t[Im],delete t[YC],delete t[QC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function AT(e){return e.tag===5||e.tag===3||e.tag===4}function F_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||AT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=vh));else if(n!==4&&(e=e.child,e!==null))for(Hm(e,t,r),e=e.sibling;e!==null;)Hm(e,t,r),e=e.sibling}function Gm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Gm(e,t,r),e=e.sibling;e!==null;)Gm(e,t,r),e=e.sibling}var Xr=null,Vs=!1;function mi(e,t,r){for(r=r.child;r!==null;)NT(e,t,r),r=r.sibling}function NT(e,t,r){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(dd,r)}catch{}switch(r.tag){case 5:dn||$l(r,t);case 6:var n=Xr,s=Vs;Xr=null,mi(e,t,r),Xr=n,Vs=s,Xr!==null&&(Vs?(e=Xr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Xr.removeChild(r.stateNode));break;case 18:Xr!==null&&(Vs?(e=Xr,r=r.stateNode,e.nodeType===8?wp(e.parentNode,r):e.nodeType===1&&wp(e,r),$u(e)):wp(Xr,r.stateNode));break;case 4:n=Xr,s=Vs,Xr=r.stateNode.containerInfo,Vs=!0,mi(e,t,r),Xr=n,Vs=s;break;case 0:case 11:case 14:case 15:if(!dn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Wm(r,t,i),s=s.next}while(s!==n)}mi(e,t,r);break;case 1:if(!dn&&($l(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){nr(r,t,o)}mi(e,t,r);break;case 21:mi(e,t,r);break;case 22:r.mode&1?(dn=(n=dn)||r.memoizedState!==null,mi(e,t,r),dn=n):mi(e,t,r);break;default:mi(e,t,r)}}function R_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new d3),t.forEach(function(n){var s=T3.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Os(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Xr=o.stateNode,Vs=!1;break e;case 3:Xr=o.stateNode.containerInfo,Vs=!0;break e;case 4:Xr=o.stateNode.containerInfo,Vs=!0;break e}o=o.return}if(Xr===null)throw Error(Ee(160));NT(a,i,s),Xr=null,Vs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){nr(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)CT(t,e),t=t.sibling}function CT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Os(t,e),ia(e),n&4){try{Eu(3,e,e.return),wd(3,e)}catch(x){nr(e,e.return,x)}try{Eu(5,e,e.return)}catch(x){nr(e,e.return,x)}}break;case 1:Os(t,e),ia(e),n&512&&r!==null&&$l(r,r.return);break;case 5:if(Os(t,e),ia(e),n&512&&r!==null&&$l(r,r.return),e.flags&32){var s=e.stateNode;try{Bu(s,"")}catch(x){nr(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Qw(s,a),xm(o,i);var c=xm(o,a);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?rE(s,d):f==="dangerouslySetInnerHTML"?eE(s,d):f==="children"?Bu(s,d):Vx(s,f,d,c)}switch(o){case"input":fm(s,a);break;case"textarea":Jw(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Xl(s,!!a.multiple,m,!1):p!==!!a.multiple&&(a.defaultValue!=null?Xl(s,!!a.multiple,a.defaultValue,!0):Xl(s,!!a.multiple,a.multiple?[]:"",!1))}s[qu]=a}catch(x){nr(e,e.return,x)}}break;case 6:if(Os(t,e),ia(e),n&4){if(e.stateNode===null)throw Error(Ee(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(x){nr(e,e.return,x)}}break;case 3:if(Os(t,e),ia(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{$u(t.containerInfo)}catch(x){nr(e,e.return,x)}break;case 4:Os(t,e),ia(e);break;case 13:Os(t,e),ia(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(vg=dr())),n&4&&R_(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(dn=(c=dn)||f,Os(t,e),dn=c):Os(t,e),ia(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Oe=e,f=e.child;f!==null;){for(d=Oe=f;Oe!==null;){switch(p=Oe,m=p.child,p.tag){case 0:case 11:case 14:case 15:Eu(4,p,p.return);break;case 1:$l(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(x){nr(n,r,x)}}break;case 5:$l(p,p.return);break;case 22:if(p.memoizedState!==null){D_(d);continue}}m!==null?(m.return=p,Oe=m):D_(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=tE("display",i))}catch(x){nr(e,e.return,x)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(x){nr(e,e.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Os(t,e),ia(e),n&4&&R_(e);break;case 21:break;default:Os(t,e),ia(e)}}function ia(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(AT(r)){var n=r;break e}r=r.return}throw Error(Ee(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Bu(s,""),n.flags&=-33);var a=F_(e);Gm(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=F_(e);Hm(e,o,i);break;default:throw Error(Ee(161))}}catch(l){nr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function m3(e,t,r){Oe=e,IT(e)}function IT(e,t,r){for(var n=(e.mode&1)!==0;Oe!==null;){var s=Oe,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||kf;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||dn;o=kf;var c=dn;if(kf=i,(dn=l)&&!c)for(Oe=s;Oe!==null;)i=Oe,l=i.child,i.tag===22&&i.memoizedState!==null?O_(s):l!==null?(l.return=i,Oe=l):O_(s);for(;a!==null;)Oe=a,IT(a),a=a.sibling;Oe=s,kf=o,dn=c}P_(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Oe=a):P_(e)}}function P_(e){for(;Oe!==null;){var t=Oe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dn||wd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dn)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Ms(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&g_(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}g_(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&$u(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}dn||t.flags&512&&$m(t)}catch(p){nr(t,t.return,p)}}if(t===e){Oe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function D_(e){for(;Oe!==null;){var t=Oe;if(t===e){Oe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Oe=r;break}Oe=t.return}}function O_(e){for(;Oe!==null;){var t=Oe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wd(4,t)}catch(l){nr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){nr(t,s,l)}}var a=t.return;try{$m(t)}catch(l){nr(t,a,l)}break;case 5:var i=t.return;try{$m(t)}catch(l){nr(t,i,l)}}}catch(l){nr(t,t.return,l)}if(t===e){Oe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Oe=o;break}Oe=t.return}}var x3=Math.ceil,Ch=ti.ReactCurrentDispatcher,xg=ti.ReactCurrentOwner,Ts=ti.ReactCurrentBatchConfig,mt=0,zr=null,Er=null,Jr=0,qn=0,Hl=Ji(0),Rr=0,t0=null,Mo=0,Ed=0,gg=0,Tu=null,Mn=null,vg=0,hc=1/0,La=null,Ih=!1,Xm=null,Ri=null,Sf=!1,Ei=null,Fh=0,ku=0,Km=null,th=-1,rh=0;function An(){return mt&6?dr():th!==-1?th:th=dr()}function Pi(e){return e.mode&1?mt&2&&Jr!==0?Jr&-Jr:ZC.transition!==null?(rh===0&&(rh=pE()),rh):(e=It,e!==0||(e=window.event,e=e===void 0?16:wE(e.type)),e):1}function Gs(e,t,r,n){if(50<ku)throw ku=0,Km=null,Error(Ee(185));N0(e,r,n),(!(mt&2)||e!==zr)&&(e===zr&&(!(mt&2)&&(Ed|=r),Rr===4&&yi(e,Jr)),zn(e,n),r===1&&mt===0&&!(t.mode&1)&&(hc=dr()+500,vd&&Zi()))}function zn(e,t){var r=e.callbackNode;ZN(e,t);var n=ph(e,e===zr?Jr:0);if(n===0)r!==null&&$v(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&$v(r),t===1)e.tag===0?JC(j_.bind(null,e)):BE(j_.bind(null,e)),KC(function(){!(mt&6)&&Zi()}),r=null;else{switch(mE(n)){case 1:r=$x;break;case 4:r=hE;break;case 16:r=dh;break;case 536870912:r=dE;break;default:r=dh}r=MT(r,FT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function FT(e,t){if(th=-1,rh=0,mt&6)throw Error(Ee(327));var r=e.callbackNode;if(Jl()&&e.callbackNode!==r)return null;var n=ph(e,e===zr?Jr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Rh(e,n);else{t=n;var s=mt;mt|=2;var a=PT();(zr!==e||Jr!==t)&&(La=null,hc=dr()+500,bo(e,t));do try{_3();break}catch(o){RT(e,o)}while(!0);ng(),Ch.current=a,mt=s,Er!==null?t=0:(zr=null,Jr=0,t=Rr)}if(t!==0){if(t===2&&(s=wm(e),s!==0&&(n=s,t=qm(e,s))),t===1)throw r=t0,bo(e,0),yi(e,n),zn(e,dr()),r;if(t===6)yi(e,n);else{if(s=e.current.alternate,!(n&30)&&!g3(s)&&(t=Rh(e,n),t===2&&(a=wm(e),a!==0&&(n=a,t=qm(e,a))),t===1))throw r=t0,bo(e,0),yi(e,n),zn(e,dr()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Ee(345));case 2:vo(e,Mn,La);break;case 3:if(yi(e,n),(n&130023424)===n&&(t=vg+500-dr(),10<t)){if(ph(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){An(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Cm(vo.bind(null,e,Mn,La),t);break}vo(e,Mn,La);break;case 4:if(yi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-Hs(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=dr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*x3(n/1960))-n,10<n){e.timeoutHandle=Cm(vo.bind(null,e,Mn,La),n);break}vo(e,Mn,La);break;case 5:vo(e,Mn,La);break;default:throw Error(Ee(329))}}}return zn(e,dr()),e.callbackNode===r?FT.bind(null,e):null}function qm(e,t){var r=Tu;return e.current.memoizedState.isDehydrated&&(bo(e,t).flags|=256),e=Rh(e,t),e!==2&&(t=Mn,Mn=r,t!==null&&Ym(t)),e}function Ym(e){Mn===null?Mn=e:Mn.push.apply(Mn,e)}function g3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!qs(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function yi(e,t){for(t&=~gg,t&=~Ed,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Hs(t),n=1<<r;e[r]=-1,t&=~n}}function j_(e){if(mt&6)throw Error(Ee(327));Jl();var t=ph(e,0);if(!(t&1))return zn(e,dr()),null;var r=Rh(e,t);if(e.tag!==0&&r===2){var n=wm(e);n!==0&&(t=n,r=qm(e,n))}if(r===1)throw r=t0,bo(e,0),yi(e,t),zn(e,dr()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vo(e,Mn,La),zn(e,dr()),null}function _g(e,t){var r=mt;mt|=1;try{return e(t)}finally{mt=r,mt===0&&(hc=dr()+500,vd&&Zi())}}function Vo(e){Ei!==null&&Ei.tag===0&&!(mt&6)&&Jl();var t=mt;mt|=1;var r=Ts.transition,n=It;try{if(Ts.transition=null,It=1,e)return e()}finally{It=n,Ts.transition=r,mt=t,!(mt&6)&&Zi()}}function yg(){qn=Hl.current,Wt(Hl)}function bo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,XC(r)),Er!==null)for(r=Er.return;r!==null;){var n=r;switch(eg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_h();break;case 3:uc(),Wt(Bn),Wt(vn),cg();break;case 5:lg(n);break;case 4:uc();break;case 13:Wt(qt);break;case 19:Wt(qt);break;case 10:sg(n.type._context);break;case 22:case 23:yg()}r=r.return}if(zr=e,Er=e=Di(e.current,null),Jr=qn=t,Rr=0,t0=null,gg=Ed=Mo=0,Mn=Tu=null,Eo!==null){for(t=0;t<Eo.length;t++)if(r=Eo[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Eo=null}return e}function RT(e,t){do{var r=Er;try{if(ng(),Jf.current=Nh,Ah){for(var n=Zt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ah=!1}if(Lo=0,Mr=Cr=Zt=null,wu=!1,Ju=0,xg.current=null,r===null||r.return===null){Rr=1,t0=t,Er=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=Jr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=T_(i);if(m!==null){m.flags&=-257,k_(m,i,o,a,t),m.mode&1&&E_(a,c,t),t=m,l=c;var g=t.updateQueue;if(g===null){var x=new Set;x.add(l),t.updateQueue=x}else g.add(l);break e}else{if(!(t&1)){E_(a,c,t),wg();break e}l=Error(Ee(426))}}else if(Kt&&o.mode&1){var _=T_(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),k_(_,i,o,a,t),tg(fc(l,o));break e}}a=l=fc(l,o),Rr!==4&&(Rr=2),Tu===null?Tu=[a]:Tu.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=mT(a,l,t);x_(a,y);break e;case 1:o=l;var E=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ri===null||!Ri.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var R=xT(a,o,t);x_(a,R);break e}}a=a.return}while(a!==null)}OT(r)}catch(V){t=V,Er===r&&r!==null&&(Er=r=r.return);continue}break}while(!0)}function PT(){var e=Ch.current;return Ch.current=Nh,e===null?Nh:e}function wg(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),zr===null||!(Mo&268435455)&&!(Ed&268435455)||yi(zr,Jr)}function Rh(e,t){var r=mt;mt|=2;var n=PT();(zr!==e||Jr!==t)&&(La=null,bo(e,t));do try{v3();break}catch(s){RT(e,s)}while(!0);if(ng(),mt=r,Ch.current=n,Er!==null)throw Error(Ee(261));return zr=null,Jr=0,Rr}function v3(){for(;Er!==null;)DT(Er)}function _3(){for(;Er!==null&&!$N();)DT(Er)}function DT(e){var t=LT(e.alternate,e,qn);e.memoizedProps=e.pendingProps,t===null?OT(e):Er=t,xg.current=null}function OT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=h3(r,t),r!==null){r.flags&=32767,Er=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Rr=6,Er=null;return}}else if(r=f3(r,t,qn),r!==null){Er=r;return}if(t=t.sibling,t!==null){Er=t;return}Er=t=e}while(t!==null);Rr===0&&(Rr=5)}function vo(e,t,r){var n=It,s=Ts.transition;try{Ts.transition=null,It=1,y3(e,t,r,n)}finally{Ts.transition=s,It=n}return null}function y3(e,t,r,n){do Jl();while(Ei!==null);if(mt&6)throw Error(Ee(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(eC(e,a),e===zr&&(Er=zr=null,Jr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sf||(Sf=!0,MT(dh,function(){return Jl(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ts.transition,Ts.transition=null;var i=It;It=1;var o=mt;mt|=4,xg.current=null,p3(e,r),CT(r,e),BC(Am),mh=!!bm,Am=bm=null,e.current=r,m3(r),HN(),mt=o,It=i,Ts.transition=a}else e.current=r;if(Sf&&(Sf=!1,Ei=e,Fh=s),a=e.pendingLanes,a===0&&(Ri=null),KN(r.stateNode),zn(e,dr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ih)throw Ih=!1,e=Xm,Xm=null,e;return Fh&1&&e.tag!==0&&Jl(),a=e.pendingLanes,a&1?e===Km?ku++:(ku=0,Km=e):ku=0,Zi(),null}function Jl(){if(Ei!==null){var e=mE(Fh),t=Ts.transition,r=It;try{if(Ts.transition=null,It=16>e?16:e,Ei===null)var n=!1;else{if(e=Ei,Ei=null,Fh=0,mt&6)throw Error(Ee(331));var s=mt;for(mt|=4,Oe=e.current;Oe!==null;){var a=Oe,i=a.child;if(Oe.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Oe=c;Oe!==null;){var f=Oe;switch(f.tag){case 0:case 11:case 15:Eu(8,f,a)}var d=f.child;if(d!==null)d.return=f,Oe=d;else for(;Oe!==null;){f=Oe;var p=f.sibling,m=f.return;if(bT(f),f===c){Oe=null;break}if(p!==null){p.return=m,Oe=p;break}Oe=m}}}var g=a.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}Oe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Oe=i;else e:for(;Oe!==null;){if(a=Oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Eu(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,Oe=y;break e}Oe=a.return}}var E=e.current;for(Oe=E;Oe!==null;){i=Oe;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Oe=w;else e:for(i=E;Oe!==null;){if(o=Oe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wd(9,o)}}catch(V){nr(o,o.return,V)}if(o===i){Oe=null;break e}var R=o.sibling;if(R!==null){R.return=o.return,Oe=R;break e}Oe=o.return}}if(mt=s,Zi(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(dd,e)}catch{}n=!0}return n}finally{It=r,Ts.transition=t}}return!1}function L_(e,t,r){t=fc(r,t),t=mT(e,t,1),e=Fi(e,t,1),t=An(),e!==null&&(N0(e,1,t),zn(e,t))}function nr(e,t,r){if(e.tag===3)L_(e,e,r);else for(;t!==null;){if(t.tag===3){L_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ri===null||!Ri.has(n))){e=fc(r,e),e=xT(t,e,1),t=Fi(t,e,1),e=An(),t!==null&&(N0(t,1,e),zn(t,e));break}}t=t.return}}function w3(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=An(),e.pingedLanes|=e.suspendedLanes&r,zr===e&&(Jr&r)===r&&(Rr===4||Rr===3&&(Jr&130023424)===Jr&&500>dr()-vg?bo(e,0):gg|=r),zn(e,t)}function jT(e,t){t===0&&(e.mode&1?(t=mf,mf<<=1,!(mf&130023424)&&(mf=4194304)):t=1);var r=An();e=qa(e,t),e!==null&&(N0(e,t,r),zn(e,r))}function E3(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),jT(e,r)}function T3(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(t),jT(e,r)}var LT;LT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Bn.current)Vn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vn=!1,u3(e,t,r);Vn=!!(e.flags&131072)}else Vn=!1,Kt&&t.flags&1048576&&UE(t,Eh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;eh(e,t),e=t.pendingProps;var s=oc(t,vn.current);Ql(t,r),s=fg(null,t,n,e,s,r);var a=hg();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Un(n)?(a=!0,yh(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ig(t),s.updater=yd,t.stateNode=s,s._reactInternals=t,jm(t,n,e,r),t=Vm(null,t,n,!0,a,r)):(t.tag=0,Kt&&a&&Zx(t),kn(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(eh(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=S3(n),e=Ms(n,e),s){case 0:t=Mm(null,t,n,e,r);break e;case 1:t=A_(null,t,n,e,r);break e;case 11:t=S_(null,t,n,e,r);break e;case 14:t=b_(null,t,n,Ms(n.type,e),r);break e}throw Error(Ee(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ms(n,s),Mm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ms(n,s),A_(e,t,n,s,r);case 3:e:{if(yT(t),e===null)throw Error(Ee(387));n=t.pendingProps,a=t.memoizedState,s=a.element,XE(e,t),Sh(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=fc(Error(Ee(423)),t),t=N_(e,t,n,r,s);break e}else if(n!==s){s=fc(Error(Ee(424)),t),t=N_(e,t,n,r,s);break e}else for(es=Ii(t.stateNode.containerInfo.firstChild),ts=t,Kt=!0,Bs=null,r=HE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(lc(),n===s){t=Ya(e,t,r);break e}kn(e,t,n,r)}t=t.child}return t;case 5:return KE(t),e===null&&Pm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Nm(n,s)?i=null:a!==null&&Nm(n,a)&&(t.flags|=32),_T(e,t),kn(e,t,i,r),t.child;case 6:return e===null&&Pm(t),null;case 13:return wT(e,t,r);case 4:return og(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=cc(t,null,n,r):kn(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ms(n,s),S_(e,t,n,s,r);case 7:return kn(e,t,t.pendingProps,r),t.child;case 8:return kn(e,t,t.pendingProps.children,r),t.child;case 12:return kn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Lt(Th,n._currentValue),n._currentValue=i,a!==null)if(qs(a.value,i)){if(a.children===s.children&&!Bn.current){t=Ya(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=za(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Dm(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Ee(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Dm(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}kn(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ql(t,r),s=Ss(s),n=n(s),t.flags|=1,kn(e,t,n,r),t.child;case 14:return n=t.type,s=Ms(n,t.pendingProps),s=Ms(n.type,s),b_(e,t,n,s,r);case 15:return gT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Ms(n,s),eh(e,t),t.tag=1,Un(n)?(e=!0,yh(t)):e=!1,Ql(t,r),pT(t,n,s),jm(t,n,s,r),Vm(null,t,n,!0,e,r);case 19:return ET(e,t,r);case 22:return vT(e,t,r)}throw Error(Ee(156,t.tag))};function MT(e,t){return fE(e,t)}function k3(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Es(e,t,r,n){return new k3(e,t,r,n)}function Eg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function S3(e){if(typeof e=="function")return Eg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ux)return 11;if(e===zx)return 14}return 2}function Di(e,t){var r=e.alternate;return r===null?(r=Es(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function nh(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Eg(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ol:return Ao(r.children,s,a,t);case Bx:i=8,s|=8;break;case im:return e=Es(12,r,t,s|2),e.elementType=im,e.lanes=a,e;case om:return e=Es(13,r,t,s),e.elementType=om,e.lanes=a,e;case lm:return e=Es(19,r,t,s),e.elementType=lm,e.lanes=a,e;case Kw:return Td(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Gw:i=10;break e;case Xw:i=9;break e;case Ux:i=11;break e;case zx:i=14;break e;case gi:i=16,n=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=Es(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Ao(e,t,r,n){return e=Es(7,e,n,t),e.lanes=r,e}function Td(e,t,r,n){return e=Es(22,e,n,t),e.elementType=Kw,e.lanes=r,e.stateNode={isHidden:!1},e}function Cp(e,t,r){return e=Es(6,e,null,t),e.lanes=r,e}function Ip(e,t,r){return t=Es(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function b3(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=up(0),this.expirationTimes=up(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=up(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Tg(e,t,r,n,s,a,i,o,l){return e=new b3(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Es(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ig(a),e}function A3(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function VT(e){if(!e)return Bi;e=e._reactInternals;e:{if(qo(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(Un(r))return VE(e,r,t)}return t}function BT(e,t,r,n,s,a,i,o,l){return e=Tg(r,n,!0,e,s,a,i,o,l),e.context=VT(null),r=e.current,n=An(),s=Pi(r),a=za(n,s),a.callback=t!=null?t:null,Fi(r,a,s),e.current.lanes=s,N0(e,s,n),zn(e,n),e}function kd(e,t,r,n){var s=t.current,a=An(),i=Pi(s);return r=VT(r),t.context===null?t.context=r:t.pendingContext=r,t=za(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fi(s,t,i),e!==null&&(Gs(e,s,i,a),Qf(e,s,i)),i}function Ph(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function M_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function kg(e,t){M_(e,t),(e=e.alternate)&&M_(e,t)}function N3(){return null}var UT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Sg(e){this._internalRoot=e}Sd.prototype.render=Sg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));kd(e,t,null,null)};Sd.prototype.unmount=Sg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Vo(function(){kd(null,e,null,null)}),t[Ka]=null}};function Sd(e){this._internalRoot=e}Sd.prototype.unstable_scheduleHydration=function(e){if(e){var t=vE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<_i.length&&t!==0&&t<_i[r].priority;r++);_i.splice(r,0,e),r===0&&yE(e)}};function bg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function bd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function V_(){}function C3(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Ph(i);a.call(c)}}var i=BT(t,n,e,0,null,!1,!1,"",V_);return e._reactRootContainer=i,e[Ka]=i.current,Xu(e.nodeType===8?e.parentNode:e),Vo(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ph(l);o.call(c)}}var l=Tg(e,0,!1,null,null,!1,!1,"",V_);return e._reactRootContainer=l,e[Ka]=l.current,Xu(e.nodeType===8?e.parentNode:e),Vo(function(){kd(t,l,r,n)}),l}function Ad(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Ph(i);o.call(l)}}kd(t,i,e,s)}else i=C3(r,t,e,s,n);return Ph(i)}xE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=iu(t.pendingLanes);r!==0&&(Hx(t,r|1),zn(t,dr()),!(mt&6)&&(hc=dr()+500,Zi()))}break;case 13:Vo(function(){var n=qa(e,1);if(n!==null){var s=An();Gs(n,e,1,s)}}),kg(e,1)}};Gx=function(e){if(e.tag===13){var t=qa(e,134217728);if(t!==null){var r=An();Gs(t,e,134217728,r)}kg(e,134217728)}};gE=function(e){if(e.tag===13){var t=Pi(e),r=qa(e,t);if(r!==null){var n=An();Gs(r,e,t,n)}kg(e,t)}};vE=function(){return It};_E=function(e,t){var r=It;try{return It=e,t()}finally{It=r}};vm=function(e,t,r){switch(t){case"input":if(fm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=gd(n);if(!s)throw Error(Ee(90));Yw(n),fm(n,s)}}}break;case"textarea":Jw(e,r);break;case"select":t=r.value,t!=null&&Xl(e,!!r.multiple,t,!1)}};aE=_g;iE=Vo;var I3={usingClientEntryPoint:!1,Events:[I0,Vl,gd,nE,sE,_g]},eu={findFiberByHostInstance:wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},F3={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ti.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=cE(e),e===null?null:e.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||N3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bf.isDisabled&&bf.supportsFiber)try{dd=bf.inject(F3),pa=bf}catch{}}ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I3;ss.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bg(t))throw Error(Ee(200));return A3(e,t,null,r)};ss.createRoot=function(e,t){if(!bg(e))throw Error(Ee(299));var r=!1,n="",s=UT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Tg(e,1,!1,null,null,r,!1,n,s),e[Ka]=t.current,Xu(e.nodeType===8?e.parentNode:e),new Sg(t)};ss.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=cE(t),e=e===null?null:e.stateNode,e};ss.flushSync=function(e){return Vo(e)};ss.hydrate=function(e,t,r){if(!bd(t))throw Error(Ee(200));return Ad(null,e,t,!0,r)};ss.hydrateRoot=function(e,t,r){if(!bg(e))throw Error(Ee(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=UT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=BT(t,null,e,1,r!=null?r:null,s,!1,a,i),e[Ka]=t.current,Xu(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Sd(t)};ss.render=function(e,t,r){if(!bd(t))throw Error(Ee(200));return Ad(null,e,t,!1,r)};ss.unmountComponentAtNode=function(e){if(!bd(e))throw Error(Ee(40));return e._reactRootContainer?(Vo(function(){Ad(null,null,e,!1,function(){e._reactRootContainer=null,e[Ka]=null})}),!0):!1};ss.unstable_batchedUpdates=_g;ss.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!bd(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return Ad(e,t,r,!1,n)};ss.version="18.3.1-next-f1338f8080-20240426";function zT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zT)}catch(e){console.error(e)}}zT(),zw.exports=ss;var R3=zw.exports,B_=R3;sm.createRoot=B_.createRoot,sm.hydrateRoot=B_.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function r0(){return r0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r0.apply(this,arguments)}var Ti;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ti||(Ti={}));const U_="popstate";function P3(e){e===void 0&&(e={});function t(s,a){let{pathname:i="/",search:o="",hash:l=""}=Yo(s.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Qm("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){let i=s.document.querySelector("base"),o="";if(i&&i.getAttribute("href")){let l=s.location.href,c=l.indexOf("#");o=c===-1?l:l.slice(0,c)}return o+"#"+(typeof a=="string"?a:WT(a))}function n(s,a){Nd(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return O3(t,r,n,e)}function kr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Nd(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function D3(){return Math.random().toString(36).substr(2,8)}function z_(e,t){return{usr:e.state,key:e.key,idx:t}}function Qm(e,t,r,n){return r===void 0&&(r=null),r0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Yo(t):t,{state:r,key:t&&t.key||n||D3()})}function WT(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Yo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function O3(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Ti.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(r0({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Ti.Pop;let _=f(),y=_==null?null:_-c;c=_,l&&l({action:o,location:x.location,delta:y})}function p(_,y){o=Ti.Push;let E=Qm(x.location,_,y);r&&r(E,_),c=f()+1;let w=z_(E,c),R=x.createHref(E);try{i.pushState(w,"",R)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(R)}a&&l&&l({action:o,location:x.location,delta:1})}function m(_,y){o=Ti.Replace;let E=Qm(x.location,_,y);r&&r(E,_),c=f();let w=z_(E,c),R=x.createHref(E);i.replaceState(w,"",R),a&&l&&l({action:o,location:x.location,delta:0})}function g(_){let y=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof _=="string"?_:WT(_);return E=E.replace(/ $/,"%20"),kr(y,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,y)}let x={get action(){return o},get location(){return e(s,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(U_,d),l=_,()=>{s.removeEventListener(U_,d),l=null}},createHref(_){return t(s,_)},createURL:g,encodeLocation(_){let y=g(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:m,go(_){return i.go(_)}};return x}var W_;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(W_||(W_={}));function j3(e,t,r){return r===void 0&&(r="/"),L3(e,t,r)}function L3(e,t,r,n){let s=typeof t=="string"?Yo(t):t,a=GT(s.pathname||"/",r);if(a==null)return null;let i=$T(e);M3(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=Y3(a);o=X3(i[l],c)}return o}function $T(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(kr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=No([n,l.relativePath]),f=r.concat(l);a.children&&a.children.length>0&&(kr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),$T(a.children,t,f,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:H3(c,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of HT(a.path))s(a,i,l)}),t}function HT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=HT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function M3(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:G3(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const V3=/^:[\w-]+$/,B3=3,U3=2,z3=1,W3=10,$3=-2,$_=e=>e==="*";function H3(e,t){let r=e.split("/"),n=r.length;return r.some($_)&&(n+=$3),t&&(n+=U3),r.filter(s=>!$_(s)).reduce((s,a)=>s+(V3.test(a)?B3:a===""?z3:W3),n)}function G3(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function X3(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",d=K3({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),p=l.route;if(!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:No([a,d.pathname]),pathnameBase:tI(No([a,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(a=No([a,d.pathnameBase]))}return i}function K3(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=q3(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:p,isOptional:m}=f;if(p==="*"){let x=o[d]||"";i=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const g=o[d];return m&&!g?c[p]=void 0:c[p]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function q3(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Nd(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Y3(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Nd(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function GT(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const Q3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J3=e=>Q3.test(e);function Z3(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Yo(e):e,a;if(r)if(J3(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),Nd(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=H_(r.substring(1),"/"):a=H_(r,t)}else a=t;return{pathname:a,search:rI(n),hash:nI(s)}}function H_(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Fp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function eI(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function XT(e,t){let r=eI(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function KT(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Yo(e):(s=r0({},e),kr(!s.pathname||!s.pathname.includes("?"),Fp("?","pathname","search",s)),kr(!s.pathname||!s.pathname.includes("#"),Fp("#","pathname","hash",s)),kr(!s.search||!s.search.includes("#"),Fp("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;s.pathname=p.join("/")}o=d>=0?t[d]:"/"}let l=Z3(s,o),c=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const No=e=>e.join("/").replace(/\/\/+/g,"/"),tI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),rI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,nI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function sI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const qT=["post","put","patch","delete"];new Set(qT);const aI=["get",...qT];new Set(aI);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function n0(){return n0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n0.apply(this,arguments)}const Ag=te.createContext(null),iI=te.createContext(null),R0=te.createContext(null),Cd=te.createContext(null),Qo=te.createContext({outlet:null,matches:[],isDataRoute:!1}),YT=te.createContext(null);function P0(){return te.useContext(Cd)!=null}function Ng(){return P0()||kr(!1),te.useContext(Cd).location}function QT(e){te.useContext(R0).static||te.useLayoutEffect(e)}function Cg(){let{isDataRoute:e}=te.useContext(Qo);return e?_I():oI()}function oI(){P0()||kr(!1);let e=te.useContext(Ag),{basename:t,future:r,navigator:n}=te.useContext(R0),{matches:s}=te.useContext(Qo),{pathname:a}=Ng(),i=JSON.stringify(XT(s,r.v7_relativeSplatPath)),o=te.useRef(!1);return QT(()=>{o.current=!0}),te.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=KT(c,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:No([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,a,e])}function lI(e,t){return cI(e,t)}function cI(e,t,r,n){P0()||kr(!1);let{navigator:s}=te.useContext(R0),{matches:a}=te.useContext(Qo),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Ng(),f;if(t){var d;let _=typeof t=="string"?Yo(t):t;l==="/"||(d=_.pathname)!=null&&d.startsWith(l)||kr(!1),f=_}else f=c;let p=f.pathname||"/",m=p;if(l!=="/"){let _=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let g=j3(e,{pathname:m}),x=pI(g&&g.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:No([l,s.encodeLocation?s.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?l:No([l,s.encodeLocation?s.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),a,r,n);return t&&x?te.createElement(Cd.Provider,{value:{location:n0({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Ti.Pop}},x):x}function uI(){let e=vI(),t=sI(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return te.createElement(te.Fragment,null,te.createElement("h2",null,"Unexpected Application Error!"),te.createElement("h3",{style:{fontStyle:"italic"}},t),r?te.createElement("pre",{style:s},r):null,null)}const fI=te.createElement(uI,null);class hI extends te.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?te.createElement(Qo.Provider,{value:this.props.routeContext},te.createElement(YT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dI(e){let{routeContext:t,match:r,children:n}=e,s=te.useContext(Ag);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),te.createElement(Qo.Provider,{value:t},n)}function pI(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||kr(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:p,errors:m}=r,g=d.route.loader&&p[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,p)=>{let m,g=!1,x=null,_=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,x=d.route.errorElement||fI,l&&(c<0&&p===0?(yI("route-fallback"),g=!0,_=null):c===p&&(g=!0,_=d.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,p+1)),E=()=>{let w;return m?w=x:g?w=_:d.route.Component?w=te.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=f,te.createElement(dI,{match:d,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?te.createElement(hI,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:E(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):E()},null)}var JT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(JT||{}),ZT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ZT||{});function mI(e){let t=te.useContext(Ag);return t||kr(!1),t}function xI(e){let t=te.useContext(iI);return t||kr(!1),t}function gI(e){let t=te.useContext(Qo);return t||kr(!1),t}function e4(e){let t=gI(),r=t.matches[t.matches.length-1];return r.route.id||kr(!1),r.route.id}function vI(){var e;let t=te.useContext(YT),r=xI(),n=e4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function _I(){let{router:e}=mI(JT.UseNavigateStable),t=e4(ZT.UseNavigateStable),r=te.useRef(!1);return QT(()=>{r.current=!0}),te.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,n0({fromRouteId:t},a)))},[e,t])}const G_={};function yI(e,t,r){G_[e]||(G_[e]=!0)}function wI(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function t4(e){let{to:t,replace:r,state:n,relative:s}=e;P0()||kr(!1);let{future:a,static:i}=te.useContext(R0),{matches:o}=te.useContext(Qo),{pathname:l}=Ng(),c=Cg(),f=KT(t,XT(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(f);return te.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function Nl(e){kr(!1)}function EI(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Ti.Pop,navigator:a,static:i=!1,future:o}=e;P0()&&kr(!1);let l=t.replace(/^\/*/,"/"),c=te.useMemo(()=>({basename:l,navigator:a,static:i,future:n0({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=Yo(n));let{pathname:f="/",search:d="",hash:p="",state:m=null,key:g="default"}=n,x=te.useMemo(()=>{let _=GT(f,l);return _==null?null:{location:{pathname:_,search:d,hash:p,state:m,key:g},navigationType:s}},[l,f,d,p,m,g,s]);return x==null?null:te.createElement(R0.Provider,{value:c},te.createElement(Cd.Provider,{children:r,value:x}))}function TI(e){let{children:t,location:r}=e;return lI(Jm(t),r)}new Promise(()=>{});function Jm(e,t){t===void 0&&(t=[]);let r=[];return te.Children.forEach(e,(n,s)=>{if(!te.isValidElement(n))return;let a=[...t,s];if(n.type===te.Fragment){r.push.apply(r,Jm(n.props.children,a));return}n.type!==Nl&&kr(!1),!n.props.index||!n.props.children||kr(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Jm(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const kI="6";try{window.__reactRouterVersion=kI}catch{}const SI="startTransition",X_=wN[SI];function bI(e){let{basename:t,children:r,future:n,window:s}=e,a=te.useRef();a.current==null&&(a.current=P3({window:s,v5Compat:!0}));let i=a.current,[o,l]=te.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},f=te.useCallback(d=>{c&&X_?X_(()=>l(d)):l(d)},[l,c]);return te.useLayoutEffect(()=>i.listen(f),[i,f]),te.useEffect(()=>wI(n),[n]),te.createElement(EI,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var K_;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(K_||(K_={}));var q_;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(q_||(q_={}));function Ig({particleCount:e=150}){const t=te.useRef(null);return te.useEffect(()=>{const r=t.current,n=r.getContext("2d");let s;const a=150,i=a*a,o=["#ffffff"];let l=window.innerWidth,c=window.innerHeight;r.width=l,r.height=c;let f={x:null,y:null};const d=()=>{l=window.innerWidth,c=window.innerHeight,r.width=l,r.height=c},p=y=>{f.x=y.clientX,f.y=y.clientY},m=()=>{f.x=null,f.y=null};window.addEventListener("resize",d),window.addEventListener("mousemove",p),window.addEventListener("mouseleave",m);class g{constructor(){this.x=Math.random()*l,this.y=Math.random()*c,this.vx=(Math.random()-.5)*.5,this.vy=(Math.random()-.5)*.5,this.size=Math.random()*2,this.color=o[0],this.baseX=this.x,this.baseY=this.y,this.density=Math.random()*30+1}update(){if(this.x+=this.vx,this.y+=this.vy,(this.x<0||this.x>l)&&(this.vx=-this.vx),(this.y<0||this.y>c)&&(this.vy=-this.vy),f.x!=null){let E=f.x-this.x,w=f.y-this.y,R=E*E+w*w;if(R<i){let V=Math.sqrt(R);const L=E/V,T=w/V,S=(a-V)/a,b=L*S*this.density,F=T*S*this.density;this.x-=b*2,this.y-=F*2}}}draw(){n.beginPath(),n.arc(this.x,this.y,this.size,0,Math.PI*2),n.fillStyle=this.color,n.fill()}}const x=[];for(let y=0;y<e;y++)x.push(new g);const _=()=>{n.clearRect(0,0,l,c),x.forEach(y=>{y.update(),y.draw()}),s=requestAnimationFrame(_)};return _(),()=>{window.removeEventListener("resize",d),window.removeEventListener("mousemove",p),window.removeEventListener("mouseleave",m),cancelAnimationFrame(s)}},[e]),u.jsx("canvas",{ref:t,className:"fixed top-0 left-0 w-full h-full -z-10 bg-[radial-gradient(circle_at_center,_#0f172a_0%,_#000000_100%)]"})}function AI(){const[e,t]=te.useState(new Date);te.useEffect(()=>{const n=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(n)},[]);const r=n=>n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});return u.jsx("div",{className:"flex flex-col items-end text-white font-mono select-none",children:u.jsx("div",{className:"text-4xl font-bold tracking-widest drop-shadow-[0_0_15px_rgba(0,243,255,0.9)]",children:r(e)})})}const r4=({text:e})=>u.jsxs("div",{className:"relative group cursor-default flex justify-center items-center transform scale-125",children:[u.jsx("h1",{className:"absolute text-4xl md:text-6xl font-black animate-rgb-flow-css blur-2xl opacity-75 select-none pb-4 tracking-tighter","aria-hidden":"true",children:e}),u.jsx("h1",{className:"relative z-10 text-4xl md:text-6xl font-black animate-rgb-flow-css select-none pb-4 tracking-tighter drop-shadow-sm",children:e})]}),NI=()=>{};var Y_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},CI=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},s4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,f=a>>2,d=(a&3)<<4|o>>4;let p=(o&15)<<2|c>>6,m=c&63;l||(m=64,i||(p=64)),n.push(r[f],r[d],r[p],r[m])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(n4(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):CI(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const c=s<e.length?r[e.charAt(s)]:64;++s;const d=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||c==null||d==null)throw new II;const p=a<<2|o>>4;if(n.push(p),c!==64){const m=o<<4&240|c>>2;if(n.push(m),d!==64){const g=c<<6&192|d;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class II extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FI=function(e){const t=n4(e);return s4.encodeByteArray(t,!0)},Dh=function(e){return FI(e).replace(/\./g,"")},RI=function(e){try{return s4.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=()=>PI().__FIREBASE_DEFAULTS__,OI=()=>{if(typeof process>"u"||typeof Y_>"u")return;const e=Y_.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},jI=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&RI(e[1]);return t&&JSON.parse(t)},Fg=()=>{try{return NI()||DI()||OI()||jI()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},LI=e=>{var t,r;return(r=(t=Fg())==null?void 0:t.emulatorHosts)==null?void 0:r[e]},a4=e=>{const t=LI(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},i4=()=>{var e;return(e=Fg())==null?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function o4(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...e};return[Dh(JSON.stringify(r)),Dh(JSON.stringify(i)),""].join(".")}const Su={};function VI(){const e={prod:[],emulator:[]};for(const t of Object.keys(Su))Su[t]?e.emulator.push(t):e.prod.push(t);return e}function BI(e){let t=document.getElementById(e),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),r=!0),{created:r,element:t}}let Q_=!1;function c4(e,t){if(typeof window>"u"||typeof document>"u"||!Id(window.location.host)||Su[e]===t||Su[e]||Q_)return;Su[e]=t;function r(p){return`__firebase__banner__${p}`}const n="__firebase__banner",a=VI().prod.length>0;function i(){const p=document.getElementById(n);p&&p.remove()}function o(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function c(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Q_=!0,i()},p}function f(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=BI(n),m=r("text"),g=document.getElementById(m)||document.createElement("span"),x=r("learnmore"),_=document.getElementById(x)||document.createElement("a"),y=r("preprendIcon"),E=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;o(w),f(_,x);const R=c();l(E,y),w.append(E,g,_,R),document.body.appendChild(w)}a?(g.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zI(){var t;const e=(t=Fg())==null?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WI(){return!zI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $I(){try{return typeof indexedDB=="object"}catch{return!1}}function HI(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)==null?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="FirebaseError";class Jo extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=GI,Object.setPrototypeOf(this,Jo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u4.prototype.create)}}class u4{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?XI(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new Jo(s,o,n)}}function XI(e,t){return e.replace(KI,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const KI=/\{\$([^}]+)}/g;function Oh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(J_(a)&&J_(i)){if(!Oh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function J_(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(e){return e&&e._delegate?e._delegate:e}class pc{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new MI;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var s;const r=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),n=(s=t==null?void 0:t.optional)!=null?s:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(QI(t))try{this.getOrInitializeService({instanceIdentifier:_o})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=_o){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=_o){return this.instances.has(t)}getOptions(t=_o){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var i;const n=this.normalizeInstanceIdentifier(r),s=(i=this.onInitCallbacks.get(n))!=null?i:new Set;s.add(t),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&t(a,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:YI(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=_o){return this.component?this.component.multipleInstances?t:_o:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YI(e){return e===_o?void 0:e}function QI(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new qI(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(dt||(dt={}));const ZI={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},e6=dt.INFO,t6={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},r6=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=t6[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class f4{constructor(t){this.name=t,this._logLevel=e6,this._logHandler=r6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in dt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?ZI[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...t),this._logHandler(this,dt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...t),this._logHandler(this,dt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...t),this._logHandler(this,dt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...t),this._logHandler(this,dt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...t),this._logHandler(this,dt.ERROR,...t)}}const n6=(e,t)=>t.some(r=>e instanceof r);let Z_,e2;function s6(){return Z_||(Z_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function a6(){return e2||(e2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h4=new WeakMap,Zm=new WeakMap,d4=new WeakMap,Rp=new WeakMap,Rg=new WeakMap;function i6(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(Oi(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&h4.set(r,e)}).catch(()=>{}),Rg.set(t,e),t}function o6(e){if(Zm.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});Zm.set(e,t)}let ex={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Zm.get(e);if(t==="objectStoreNames")return e.objectStoreNames||d4.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Oi(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function l6(e){ex=e(ex)}function c6(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(Pp(this),t,...r);return d4.set(n,t.sort?t.sort():[t]),Oi(n)}:a6().includes(e)?function(...t){return e.apply(Pp(this),t),Oi(h4.get(this))}:function(...t){return Oi(e.apply(Pp(this),t))}}function u6(e){return typeof e=="function"?c6(e):(e instanceof IDBTransaction&&o6(e),n6(e,s6())?new Proxy(e,ex):e)}function Oi(e){if(e instanceof IDBRequest)return i6(e);if(Rp.has(e))return Rp.get(e);const t=u6(e);return t!==e&&(Rp.set(e,t),Rg.set(t,e)),t}const Pp=e=>Rg.get(e);function f6(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=Oi(i);return n&&i.addEventListener("upgradeneeded",l=>{n(Oi(i.result),l.oldVersion,l.newVersion,Oi(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const h6=["get","getKey","getAll","getAllKeys","count"],d6=["put","add","delete","clear"],Dp=new Map;function t2(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(Dp.get(t))return Dp.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=d6.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||h6.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return Dp.set(t,a),a}l6(e=>({...e,get:(t,r,n)=>t2(t,r)||e.get(t,r,n),has:(t,r)=>!!t2(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(m6(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function m6(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const tx="@firebase/app",r2="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=new f4("@firebase/app"),x6="@firebase/app-compat",g6="@firebase/analytics-compat",v6="@firebase/analytics",_6="@firebase/app-check-compat",y6="@firebase/app-check",w6="@firebase/auth",E6="@firebase/auth-compat",T6="@firebase/database",k6="@firebase/data-connect",S6="@firebase/database-compat",b6="@firebase/functions",A6="@firebase/functions-compat",N6="@firebase/installations",C6="@firebase/installations-compat",I6="@firebase/messaging",F6="@firebase/messaging-compat",R6="@firebase/performance",P6="@firebase/performance-compat",D6="@firebase/remote-config",O6="@firebase/remote-config-compat",j6="@firebase/storage",L6="@firebase/storage-compat",M6="@firebase/firestore",V6="@firebase/ai",B6="@firebase/firestore-compat",U6="firebase",z6="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="[DEFAULT]",W6={[tx]:"fire-core",[x6]:"fire-core-compat",[v6]:"fire-analytics",[g6]:"fire-analytics-compat",[y6]:"fire-app-check",[_6]:"fire-app-check-compat",[w6]:"fire-auth",[E6]:"fire-auth-compat",[T6]:"fire-rtdb",[k6]:"fire-data-connect",[S6]:"fire-rtdb-compat",[b6]:"fire-fn",[A6]:"fire-fn-compat",[N6]:"fire-iid",[C6]:"fire-iid-compat",[I6]:"fire-fcm",[F6]:"fire-fcm-compat",[R6]:"fire-perf",[P6]:"fire-perf-compat",[D6]:"fire-rc",[O6]:"fire-rc-compat",[j6]:"fire-gcs",[L6]:"fire-gcs-compat",[M6]:"fire-fst",[B6]:"fire-fst-compat",[V6]:"fire-vertex","fire-js":"fire-js",[U6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh=new Map,$6=new Map,nx=new Map;function n2(e,t){try{e.container.addComponent(t)}catch(r){Qa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function s0(e){const t=e.name;if(nx.has(t))return Qa.debug(`There were multiple attempts to register component ${t}.`),!1;nx.set(t,e);for(const r of jh.values())n2(r,e);for(const r of $6.values())n2(r,e);return!0}function p4(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function m4(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ji=new u4("app","Firebase",H6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(t,r,n){this._isDeleted=!1,this._options={...t},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ji.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=z6;function g4(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n={name:rx,automaticDataCollectionEnabled:!0,...t},s=n.name;if(typeof s!="string"||!s)throw ji.create("bad-app-name",{appName:String(s)});if(r||(r=i4()),!r)throw ji.create("no-options");const a=jh.get(s);if(a){if(Oh(r,a.options)&&Oh(n,a.config))return a;throw ji.create("duplicate-app",{appName:s})}const i=new JI(s);for(const l of nx.values())i.addComponent(l);const o=new G6(r,n,i);return jh.set(s,o),o}function v4(e=rx){const t=jh.get(e);if(!t&&e===rx&&i4())return g4();if(!t)throw ji.create("no-app",{appName:e});return t}function Li(e,t,r){var i;let n=(i=W6[e])!=null?i:e;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${t}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Qa.warn(o.join(" "));return}s0(new pc(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6="firebase-heartbeat-database",K6=1,a0="firebase-heartbeat-store";let Op=null;function _4(){return Op||(Op=f6(X6,K6,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(a0)}catch(r){console.warn(r)}}}}).catch(e=>{throw ji.create("idb-open",{originalErrorMessage:e.message})})),Op}async function q6(e){try{const r=(await _4()).transaction(a0),n=await r.objectStore(a0).get(y4(e));return await r.done,n}catch(t){if(t instanceof Jo)Qa.warn(t.message);else{const r=ji.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Qa.warn(r.message)}}}async function s2(e,t){try{const n=(await _4()).transaction(a0,"readwrite");await n.objectStore(a0).put(t,y4(e)),await n.done}catch(r){if(r instanceof Jo)Qa.warn(r.message);else{const n=ji.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Qa.warn(n.message)}}}function y4(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=1024,Q6=30;class J6{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new e5(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=a2();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>Q6){const i=t5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Qa.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=a2(),{heartbeatsToSend:n,unsentEntries:s}=Z6(this._heartbeatsCache.heartbeats),a=Dh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Qa.warn(r),""}}}function a2(){return new Date().toISOString().substring(0,10)}function Z6(e,t=Y6){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),i2(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),i2(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class e5{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $I()?HI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await q6(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return s2(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!=null?n:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return s2(this.app,{lastSentHeartbeatDate:(n=t.lastSentHeartbeatDate)!=null?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function i2(e){return Dh(JSON.stringify({version:2,heartbeats:e})).length}function t5(e){if(e.length===0)return-1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r5(e){s0(new pc("platform-logger",t=>new p6(t),"PRIVATE")),s0(new pc("heartbeat",t=>new J6(t),"PRIVATE")),Li(tx,r2,e),Li(tx,r2,"esm2020"),Li("fire-js","")}r5("");var n5="firebase",s5="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Li(n5,s5,"app");var o2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mi,w4;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(T,S){function b(){}b.prototype=S.prototype,T.F=S.prototype,T.prototype=new b,T.prototype.constructor=T,T.D=function(F,N,C){for(var P=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)P[ce-2]=arguments[ce];return S.prototype[N].apply(F,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,S,b){b||(b=0);const F=Array(16);if(typeof S=="string")for(var N=0;N<16;++N)F[N]=S.charCodeAt(b++)|S.charCodeAt(b++)<<8|S.charCodeAt(b++)<<16|S.charCodeAt(b++)<<24;else for(N=0;N<16;++N)F[N]=S[b++]|S[b++]<<8|S[b++]<<16|S[b++]<<24;S=T.g[0],b=T.g[1],N=T.g[2];let C=T.g[3],P;P=S+(C^b&(N^C))+F[0]+3614090360&4294967295,S=b+(P<<7&4294967295|P>>>25),P=C+(N^S&(b^N))+F[1]+3905402710&4294967295,C=S+(P<<12&4294967295|P>>>20),P=N+(b^C&(S^b))+F[2]+606105819&4294967295,N=C+(P<<17&4294967295|P>>>15),P=b+(S^N&(C^S))+F[3]+3250441966&4294967295,b=N+(P<<22&4294967295|P>>>10),P=S+(C^b&(N^C))+F[4]+4118548399&4294967295,S=b+(P<<7&4294967295|P>>>25),P=C+(N^S&(b^N))+F[5]+1200080426&4294967295,C=S+(P<<12&4294967295|P>>>20),P=N+(b^C&(S^b))+F[6]+2821735955&4294967295,N=C+(P<<17&4294967295|P>>>15),P=b+(S^N&(C^S))+F[7]+4249261313&4294967295,b=N+(P<<22&4294967295|P>>>10),P=S+(C^b&(N^C))+F[8]+1770035416&4294967295,S=b+(P<<7&4294967295|P>>>25),P=C+(N^S&(b^N))+F[9]+2336552879&4294967295,C=S+(P<<12&4294967295|P>>>20),P=N+(b^C&(S^b))+F[10]+4294925233&4294967295,N=C+(P<<17&4294967295|P>>>15),P=b+(S^N&(C^S))+F[11]+2304563134&4294967295,b=N+(P<<22&4294967295|P>>>10),P=S+(C^b&(N^C))+F[12]+1804603682&4294967295,S=b+(P<<7&4294967295|P>>>25),P=C+(N^S&(b^N))+F[13]+4254626195&4294967295,C=S+(P<<12&4294967295|P>>>20),P=N+(b^C&(S^b))+F[14]+2792965006&4294967295,N=C+(P<<17&4294967295|P>>>15),P=b+(S^N&(C^S))+F[15]+1236535329&4294967295,b=N+(P<<22&4294967295|P>>>10),P=S+(N^C&(b^N))+F[1]+4129170786&4294967295,S=b+(P<<5&4294967295|P>>>27),P=C+(b^N&(S^b))+F[6]+3225465664&4294967295,C=S+(P<<9&4294967295|P>>>23),P=N+(S^b&(C^S))+F[11]+643717713&4294967295,N=C+(P<<14&4294967295|P>>>18),P=b+(C^S&(N^C))+F[0]+3921069994&4294967295,b=N+(P<<20&4294967295|P>>>12),P=S+(N^C&(b^N))+F[5]+3593408605&4294967295,S=b+(P<<5&4294967295|P>>>27),P=C+(b^N&(S^b))+F[10]+38016083&4294967295,C=S+(P<<9&4294967295|P>>>23),P=N+(S^b&(C^S))+F[15]+3634488961&4294967295,N=C+(P<<14&4294967295|P>>>18),P=b+(C^S&(N^C))+F[4]+3889429448&4294967295,b=N+(P<<20&4294967295|P>>>12),P=S+(N^C&(b^N))+F[9]+568446438&4294967295,S=b+(P<<5&4294967295|P>>>27),P=C+(b^N&(S^b))+F[14]+3275163606&4294967295,C=S+(P<<9&4294967295|P>>>23),P=N+(S^b&(C^S))+F[3]+4107603335&4294967295,N=C+(P<<14&4294967295|P>>>18),P=b+(C^S&(N^C))+F[8]+1163531501&4294967295,b=N+(P<<20&4294967295|P>>>12),P=S+(N^C&(b^N))+F[13]+2850285829&4294967295,S=b+(P<<5&4294967295|P>>>27),P=C+(b^N&(S^b))+F[2]+4243563512&4294967295,C=S+(P<<9&4294967295|P>>>23),P=N+(S^b&(C^S))+F[7]+1735328473&4294967295,N=C+(P<<14&4294967295|P>>>18),P=b+(C^S&(N^C))+F[12]+2368359562&4294967295,b=N+(P<<20&4294967295|P>>>12),P=S+(b^N^C)+F[5]+4294588738&4294967295,S=b+(P<<4&4294967295|P>>>28),P=C+(S^b^N)+F[8]+2272392833&4294967295,C=S+(P<<11&4294967295|P>>>21),P=N+(C^S^b)+F[11]+1839030562&4294967295,N=C+(P<<16&4294967295|P>>>16),P=b+(N^C^S)+F[14]+4259657740&4294967295,b=N+(P<<23&4294967295|P>>>9),P=S+(b^N^C)+F[1]+2763975236&4294967295,S=b+(P<<4&4294967295|P>>>28),P=C+(S^b^N)+F[4]+1272893353&4294967295,C=S+(P<<11&4294967295|P>>>21),P=N+(C^S^b)+F[7]+4139469664&4294967295,N=C+(P<<16&4294967295|P>>>16),P=b+(N^C^S)+F[10]+3200236656&4294967295,b=N+(P<<23&4294967295|P>>>9),P=S+(b^N^C)+F[13]+681279174&4294967295,S=b+(P<<4&4294967295|P>>>28),P=C+(S^b^N)+F[0]+3936430074&4294967295,C=S+(P<<11&4294967295|P>>>21),P=N+(C^S^b)+F[3]+3572445317&4294967295,N=C+(P<<16&4294967295|P>>>16),P=b+(N^C^S)+F[6]+76029189&4294967295,b=N+(P<<23&4294967295|P>>>9),P=S+(b^N^C)+F[9]+3654602809&4294967295,S=b+(P<<4&4294967295|P>>>28),P=C+(S^b^N)+F[12]+3873151461&4294967295,C=S+(P<<11&4294967295|P>>>21),P=N+(C^S^b)+F[15]+530742520&4294967295,N=C+(P<<16&4294967295|P>>>16),P=b+(N^C^S)+F[2]+3299628645&4294967295,b=N+(P<<23&4294967295|P>>>9),P=S+(N^(b|~C))+F[0]+4096336452&4294967295,S=b+(P<<6&4294967295|P>>>26),P=C+(b^(S|~N))+F[7]+1126891415&4294967295,C=S+(P<<10&4294967295|P>>>22),P=N+(S^(C|~b))+F[14]+2878612391&4294967295,N=C+(P<<15&4294967295|P>>>17),P=b+(C^(N|~S))+F[5]+4237533241&4294967295,b=N+(P<<21&4294967295|P>>>11),P=S+(N^(b|~C))+F[12]+1700485571&4294967295,S=b+(P<<6&4294967295|P>>>26),P=C+(b^(S|~N))+F[3]+2399980690&4294967295,C=S+(P<<10&4294967295|P>>>22),P=N+(S^(C|~b))+F[10]+4293915773&4294967295,N=C+(P<<15&4294967295|P>>>17),P=b+(C^(N|~S))+F[1]+2240044497&4294967295,b=N+(P<<21&4294967295|P>>>11),P=S+(N^(b|~C))+F[8]+1873313359&4294967295,S=b+(P<<6&4294967295|P>>>26),P=C+(b^(S|~N))+F[15]+4264355552&4294967295,C=S+(P<<10&4294967295|P>>>22),P=N+(S^(C|~b))+F[6]+2734768916&4294967295,N=C+(P<<15&4294967295|P>>>17),P=b+(C^(N|~S))+F[13]+1309151649&4294967295,b=N+(P<<21&4294967295|P>>>11),P=S+(N^(b|~C))+F[4]+4149444226&4294967295,S=b+(P<<6&4294967295|P>>>26),P=C+(b^(S|~N))+F[11]+3174756917&4294967295,C=S+(P<<10&4294967295|P>>>22),P=N+(S^(C|~b))+F[2]+718787259&4294967295,N=C+(P<<15&4294967295|P>>>17),P=b+(C^(N|~S))+F[9]+3951481745&4294967295,T.g[0]=T.g[0]+S&4294967295,T.g[1]=T.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,T.g[2]=T.g[2]+N&4294967295,T.g[3]=T.g[3]+C&4294967295}n.prototype.v=function(T,S){S===void 0&&(S=T.length);const b=S-this.blockSize,F=this.C;let N=this.h,C=0;for(;C<S;){if(N==0)for(;C<=b;)s(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<S;)if(F[N++]=T.charCodeAt(C++),N==this.blockSize){s(this,F),N=0;break}}else for(;C<S;)if(F[N++]=T[C++],N==this.blockSize){s(this,F),N=0;break}}this.h=N,this.o+=S},n.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var S=1;S<T.length-8;++S)T[S]=0;S=this.o*8;for(var b=T.length-8;b<T.length;++b)T[b]=S&255,S/=256;for(this.v(T),T=Array(16),S=0,b=0;b<4;++b)for(let F=0;F<32;F+=8)T[S++]=this.g[b]>>>F&255;return T};function a(T,S){var b=o;return Object.prototype.hasOwnProperty.call(b,T)?b[T]:b[T]=S(T)}function i(T,S){this.h=S;const b=[];let F=!0;for(let N=T.length-1;N>=0;N--){const C=T[N]|0;F&&C==S||(b[N]=C,F=!1)}this.g=b}var o={};function l(T){return-128<=T&&T<128?a(T,function(S){return new i([S|0],S<0?-1:0)}):new i([T|0],T<0?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return d;if(T<0)return _(c(-T));const S=[];let b=1;for(let F=0;T>=b;F++)S[F]=T/b|0,b*=4294967296;return new i(S,0)}function f(T,S){if(T.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(T.charAt(0)=="-")return _(f(T.substring(1),S));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=c(Math.pow(S,8));let F=d;for(let C=0;C<T.length;C+=8){var N=Math.min(8,T.length-C);const P=parseInt(T.substring(C,C+N),S);N<8?(N=c(Math.pow(S,N)),F=F.j(N).add(c(P))):(F=F.j(b),F=F.add(c(P)))}return F}var d=l(0),p=l(1),m=l(16777216);e=i.prototype,e.m=function(){if(x(this))return-_(this).m();let T=0,S=1;for(let b=0;b<this.g.length;b++){const F=this.i(b);T+=(F>=0?F:4294967296+F)*S,S*=4294967296}return T},e.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(g(this))return"0";if(x(this))return"-"+_(this).toString(T);const S=c(Math.pow(T,6));var b=this;let F="";for(;;){const N=R(b,S).g;b=y(b,N.j(S));let C=((b.g.length>0?b.g[0]:b.h)>>>0).toString(T);if(b=N,g(b))return C+F;for(;C.length<6;)C="0"+C;F=C+F}},e.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function g(T){if(T.h!=0)return!1;for(let S=0;S<T.g.length;S++)if(T.g[S]!=0)return!1;return!0}function x(T){return T.h==-1}e.l=function(T){return T=y(this,T),x(T)?-1:g(T)?0:1};function _(T){const S=T.g.length,b=[];for(let F=0;F<S;F++)b[F]=~T.g[F];return new i(b,~T.h).add(p)}e.abs=function(){return x(this)?_(this):this},e.add=function(T){const S=Math.max(this.g.length,T.g.length),b=[];let F=0;for(let N=0;N<=S;N++){let C=F+(this.i(N)&65535)+(T.i(N)&65535),P=(C>>>16)+(this.i(N)>>>16)+(T.i(N)>>>16);F=P>>>16,C&=65535,P&=65535,b[N]=P<<16|C}return new i(b,b[b.length-1]&-2147483648?-1:0)};function y(T,S){return T.add(_(S))}e.j=function(T){if(g(this)||g(T))return d;if(x(this))return x(T)?_(this).j(_(T)):_(_(this).j(T));if(x(T))return _(this.j(_(T)));if(this.l(m)<0&&T.l(m)<0)return c(this.m()*T.m());const S=this.g.length+T.g.length,b=[];for(var F=0;F<2*S;F++)b[F]=0;for(F=0;F<this.g.length;F++)for(let N=0;N<T.g.length;N++){const C=this.i(F)>>>16,P=this.i(F)&65535,ce=T.i(N)>>>16,ye=T.i(N)&65535;b[2*F+2*N]+=P*ye,E(b,2*F+2*N),b[2*F+2*N+1]+=C*ye,E(b,2*F+2*N+1),b[2*F+2*N+1]+=P*ce,E(b,2*F+2*N+1),b[2*F+2*N+2]+=C*ce,E(b,2*F+2*N+2)}for(T=0;T<S;T++)b[T]=b[2*T+1]<<16|b[2*T];for(T=S;T<2*S;T++)b[T]=0;return new i(b,0)};function E(T,S){for(;(T[S]&65535)!=T[S];)T[S+1]+=T[S]>>>16,T[S]&=65535,S++}function w(T,S){this.g=T,this.h=S}function R(T,S){if(g(S))throw Error("division by zero");if(g(T))return new w(d,d);if(x(T))return S=R(_(T),S),new w(_(S.g),_(S.h));if(x(S))return S=R(T,_(S)),new w(_(S.g),S.h);if(T.g.length>30){if(x(T)||x(S))throw Error("slowDivide_ only works with positive integers.");for(var b=p,F=S;F.l(T)<=0;)b=V(b),F=V(F);var N=L(b,1),C=L(F,1);for(F=L(F,2),b=L(b,2);!g(F);){var P=C.add(F);P.l(T)<=0&&(N=N.add(b),C=P),F=L(F,1),b=L(b,1)}return S=y(T,N.j(S)),new w(N,S)}for(N=d;T.l(S)>=0;){for(b=Math.max(1,Math.floor(T.m()/S.m())),F=Math.ceil(Math.log(b)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),C=c(b),P=C.j(S);x(P)||P.l(T)>0;)b-=F,C=c(b),P=C.j(S);g(C)&&(C=p),N=N.add(C),T=y(T,P)}return new w(N,T)}e.B=function(T){return R(this,T).h},e.and=function(T){const S=Math.max(this.g.length,T.g.length),b=[];for(let F=0;F<S;F++)b[F]=this.i(F)&T.i(F);return new i(b,this.h&T.h)},e.or=function(T){const S=Math.max(this.g.length,T.g.length),b=[];for(let F=0;F<S;F++)b[F]=this.i(F)|T.i(F);return new i(b,this.h|T.h)},e.xor=function(T){const S=Math.max(this.g.length,T.g.length),b=[];for(let F=0;F<S;F++)b[F]=this.i(F)^T.i(F);return new i(b,this.h^T.h)};function V(T){const S=T.g.length+1,b=[];for(let F=0;F<S;F++)b[F]=T.i(F)<<1|T.i(F-1)>>>31;return new i(b,T.h)}function L(T,S){const b=S>>5;S%=32;const F=T.g.length-b,N=[];for(let C=0;C<F;C++)N[C]=S>0?T.i(C+b)>>>S|T.i(C+b+1)<<32-S:T.i(C+b);return new i(N,T.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,w4=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=f,Mi=i}).apply(typeof o2<"u"?o2:typeof self<"u"?self:typeof window<"u"?window:{});var Af=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var E4,lu,T4,sh,sx,k4,S4,b4;(function(){var e,t=Object.defineProperty;function r(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Af=="object"&&Af];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function s(h,v){if(v)e:{var k=n;h=h.split(".");for(var D=0;D<h.length-1;D++){var Q=h[D];if(!(Q in k))break e;k=k[Q]}h=h[h.length-1],D=k[h],v=v(D),v!=D&&v!=null&&t(k,h,{configurable:!0,writable:!0,value:v})}}s("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(h){return h||function(v){var k=[],D;for(D in v)Object.prototype.hasOwnProperty.call(v,D)&&k.push([D,v[D]]);return k}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},i=this||self;function o(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function l(h,v,k){return h.call.apply(h.bind,arguments)}function c(h,v,k){return c=l,c.apply(null,arguments)}function f(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var D=k.slice();return D.push.apply(D,arguments),h.apply(this,D)}}function d(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(D,Q,se){for(var be=Array(arguments.length-2),et=2;et<arguments.length;et++)be[et-2]=arguments[et];return v.prototype[Q].apply(D,be)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function m(h){const v=h.length;if(v>0){const k=Array(v);for(let D=0;D<v;D++)k[D]=h[D];return k}return[]}function g(h,v){for(let D=1;D<arguments.length;D++){const Q=arguments[D];var k=typeof Q;if(k=k!="object"?k:Q?Array.isArray(Q)?"array":k:"null",k=="array"||k=="object"&&typeof Q.length=="number"){k=h.length||0;const se=Q.length||0;h.length=k+se;for(let be=0;be<se;be++)h[k+be]=Q[be]}else h.push(Q)}}class x{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function _(h){i.setTimeout(()=>{throw h},0)}function y(){var h=T;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class E{constructor(){this.h=this.g=null}add(v,k){const D=w.get();D.set(v,k),this.h?this.h.next=D:this.g=D,this.h=D}}var w=new x(()=>new R,h=>h.reset());class R{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let V,L=!1,T=new E,S=()=>{const h=Promise.resolve(void 0);V=()=>{h.then(b)}};function b(){for(var h;h=y();){try{h.h.call(h.g)}catch(k){_(k)}var v=w;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}L=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var C=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};i.addEventListener("test",k,v),i.removeEventListener("test",k,v)}catch{}return h}();function P(h){return/^[\s\xa0]*$/.test(h)}function ce(h,v){N.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}d(ce,N),ce.prototype.init=function(h,v){const k=this.type=h.type,D=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),we=0;function ke(h,v,k,D,Q){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!D,this.ha=Q,this.key=++we,this.da=this.fa=!1}function ie(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function X(h,v,k){for(const D in h)v.call(k,h[D],D,h)}function oe(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function Pe(h){const v={};for(const k in h)v[k]=h[k];return v}const U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(h,v){let k,D;for(let Q=1;Q<arguments.length;Q++){D=arguments[Q];for(k in D)h[k]=D[k];for(let se=0;se<U.length;se++)k=U[se],Object.prototype.hasOwnProperty.call(D,k)&&(h[k]=D[k])}}function H(h){this.src=h,this.g={},this.h=0}H.prototype.add=function(h,v,k,D,Q){const se=h.toString();h=this.g[se],h||(h=this.g[se]=[],this.h++);const be=ne(h,v,D,Q);return be>-1?(v=h[be],k||(v.fa=!1)):(v=new ke(v,this.src,se,!!D,Q),v.fa=k,h.push(v)),v};function G(h,v){const k=v.type;if(k in h.g){var D=h.g[k],Q=Array.prototype.indexOf.call(D,v,void 0),se;(se=Q>=0)&&Array.prototype.splice.call(D,Q,1),se&&(ie(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function ne(h,v,k,D){for(let Q=0;Q<h.length;++Q){const se=h[Q];if(!se.da&&se.listener==v&&se.capture==!!k&&se.ha==D)return Q}return-1}var me="closure_lm_"+(Math.random()*1e6|0),fe={};function ge(h,v,k,D,Q){if(Array.isArray(v)){for(let se=0;se<v.length;se++)ge(h,v[se],k,D,Q);return null}return k=kt(k),h&&h[ye]?h.J(v,k,o(D)?!!D.capture:!1,Q):ue(h,v,k,!1,D,Q)}function ue(h,v,k,D,Q,se){if(!v)throw Error("Invalid event type");const be=o(Q)?!!Q.capture:!!Q;let et=Le(h);if(et||(h[me]=et=new H(h)),k=et.add(v,k,D,be,se),k.proxy)return k;if(D=$e(),k.proxy=D,D.src=h,D.listener=k,h.addEventListener)C||(Q=be),Q===void 0&&(Q=!1),h.addEventListener(v.toString(),D,Q);else if(h.attachEvent)h.attachEvent(tt(v.toString()),D);else if(h.addListener&&h.removeListener)h.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return k}function $e(){function h(k){return v.call(h.src,h.listener,k)}const v=vt;return h}function W(h,v,k,D,Q){if(Array.isArray(v))for(var se=0;se<v.length;se++)W(h,v[se],k,D,Q);else D=o(D)?!!D.capture:!!D,k=kt(k),h&&h[ye]?(h=h.i,se=String(v).toString(),se in h.g&&(v=h.g[se],k=ne(v,k,D,Q),k>-1&&(ie(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[se],h.h--)))):h&&(h=Le(h))&&(v=h.g[v.toString()],h=-1,v&&(h=ne(v,k,D,Q)),(k=h>-1?v[h]:null)&&pt(k))}function pt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[ye])G(v.i,h);else{var k=h.type,D=h.proxy;v.removeEventListener?v.removeEventListener(k,D,h.capture):v.detachEvent?v.detachEvent(tt(k),D):v.addListener&&v.removeListener&&v.removeListener(D),(k=Le(v))?(G(k,h),k.h==0&&(k.src=null,v[me]=null)):ie(h)}}}function tt(h){return h in fe?fe[h]:fe[h]="on"+h}function vt(h,v){if(h.da)h=!0;else{v=new ce(v,this);const k=h.listener,D=h.ha||h.src;h.fa&&pt(h),h=k.call(D,v)}return h}function Le(h){return h=h[me],h instanceof H?h:null}var Ne="__closure_events_fn_"+(Math.random()*1e9>>>0);function kt(h){return typeof h=="function"?h:(h[Ne]||(h[Ne]=function(v){return h.handleEvent(v)}),h[Ne])}function Et(){F.call(this),this.i=new H(this),this.M=this,this.G=null}d(Et,F),Et.prototype[ye]=!0,Et.prototype.removeEventListener=function(h,v,k,D){W(this,h,v,k,D)};function _t(h,v){var k,D=h.G;if(D)for(k=[];D;D=D.G)k.push(D);if(h=h.M,D=v.type||v,typeof v=="string")v=new N(v,h);else if(v instanceof N)v.target=v.target||h;else{var Q=v;v=new N(D,h),q(v,Q)}Q=!0;let se,be;if(k)for(be=k.length-1;be>=0;be--)se=v.g=k[be],Q=tn(se,D,!0,v)&&Q;if(se=v.g=h,Q=tn(se,D,!0,v)&&Q,Q=tn(se,D,!1,v)&&Q,k)for(be=0;be<k.length;be++)se=v.g=k[be],Q=tn(se,D,!1,v)&&Q}Et.prototype.N=function(){if(Et.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let D=0;D<k.length;D++)ie(k[D]);delete h.g[v],h.h--}}this.G=null},Et.prototype.J=function(h,v,k,D){return this.i.add(String(h),v,!1,k,D)},Et.prototype.K=function(h,v,k,D){return this.i.add(String(h),v,!0,k,D)};function tn(h,v,k,D){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let Q=!0;for(let se=0;se<v.length;++se){const be=v[se];if(be&&!be.da&&be.capture==k){const et=be.listener,cr=be.ha||be.src;be.fa&&G(h.i,be),Q=et.call(cr,D)!==!1&&Q}}return Q&&!D.defaultPrevented}function Hn(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=c(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:i.setTimeout(h,v||0)}function Gn(h){h.g=Hn(()=>{h.g=null,h.i&&(h.i=!1,Gn(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class or extends F{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Gn(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wr(h){F.call(this),this.h=h,this.g={}}d(Wr,F);var $r=[];function Ys(h){X(h.g,function(v,k){this.g.hasOwnProperty(k)&&pt(v)},h),h.g={}}Wr.prototype.N=function(){Wr.Z.N.call(this),Ys(this)},Wr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mt=i.JSON.stringify,wn=i.JSON.parse,Ge=class{stringify(h){return i.JSON.stringify(h,void 0)}parse(h){return i.JSON.parse(h,void 0)}};function St(){}function rr(){}var Ft={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Gt(){N.call(this,"d")}d(Gt,N);function Qs(){N.call(this,"c")}d(Qs,N);var xr={},cl=null;function Ot(){return cl=cl||new Et}xr.Ia="serverreachability";function ba(h){N.call(this,xr.Ia,h)}d(ba,N);function jt(h){const v=Ot();_t(v,new ba(v))}xr.STAT_EVENT="statevent";function is(h,v){N.call(this,xr.STAT_EVENT,h),this.stat=v}d(is,N);function ot(h){const v=Ot();_t(v,new is(v,h))}xr.Ja="timingevent";function Cs(h,v){N.call(this,xr.Ja,h),this.size=v}d(Cs,N);function Rt(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){h()},v)}function rn(){this.g=!0}rn.prototype.ua=function(){this.g=!1};function ul(h,v,k,D,Q,se){h.info(function(){if(h.g)if(se){var be="",et=se.split("&");for(let bt=0;bt<et.length;bt++){var cr=et[bt].split("=");if(cr.length>1){const gr=cr[0];cr=cr[1];const fs=gr.split("_");be=fs.length>=2&&fs[1]=="type"?be+(gr+"="+cr+"&"):be+(gr+"=redacted&")}}}else be=null;else be=se;return"XMLHTTP REQ ("+D+") [attempt "+Q+"]: "+v+`
`+k+`
`+be})}function no(h,v,k,D,Q,se,be){h.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Q+"]: "+v+`
`+k+`
`+se+" "+be})}function Is(h,v,k,D){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+fl(h,k)+(D?" "+D:"")})}function so(h,v){h.info(function(){return"TIMEOUT: "+v})}rn.prototype.info=function(){};function fl(h,v){if(!h.g)return v;if(!v)return null;try{const se=JSON.parse(v);if(se){for(h=0;h<se.length;h++)if(Array.isArray(se[h])){var k=se[h];if(!(k.length<2)){var D=k[1];if(Array.isArray(D)&&!(D.length<1)){var Q=D[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(let be=1;be<D.length;be++)D[be]=""}}}}return Mt(se)}catch{return v}}var Js={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Aa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ai;function ii(){}d(ii,St),ii.prototype.g=function(){return new XMLHttpRequest},ai=new ii;function Zs(h){return encodeURIComponent(String(h))}function I(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function M(h,v,k,D){this.j=h,this.i=v,this.l=k,this.S=D||1,this.V=new Wr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new O}function O(){this.i=null,this.g="",this.h=!1}var j={},B={};function z(h,v,k){h.M=1,h.A=hl(Dn(v)),h.u=k,h.R=!0,J(h,null)}function J(h,v){h.F=Date.now(),ee(h),h.B=Dn(h.A);var k=h.B,D=h.S;Array.isArray(D)||(D=[String(D)]),Lc(k.i,"t",D),h.C=0,k=h.j.L,h.h=new O,h.g=ta(h.j,k?v:null,!h.u),h.P>0&&(h.O=new or(c(h.Y,h,h.g),h.P)),v=h.V,k=h.g,D=h.ba;var Q="readystatechange";Array.isArray(Q)||(Q&&($r[0]=Q.toString()),Q=$r);for(let se=0;se<Q.length;se++){const be=ge(k,Q[se],D||v.handleEvent,!1,v.h||v);if(!be)break;v.g[be.key]=be}v=h.J?Pe(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),jt(),ul(h.i,h.v,h.B,h.l,h.S,h.u)}M.prototype.ba=function(h){h=h.target;const v=this.O;v&&us(h)==3?v.j():this.Y(h)},M.prototype.Y=function(h){try{if(h==this.g)e:{const et=us(this.g),cr=this.g.ya(),bt=this.g.ca();if(!(et<3)&&(et!=3||this.g&&(this.h.h||this.g.la()||_l(this.g)))){this.K||et!=4||cr==7||(cr==8||bt<=0?jt(3):jt(2)),Te(this);var v=this.g.ca();this.X=v;var k=ae(this);if(this.o=v==200,no(this.i,this.v,this.B,this.l,this.S,et,v),this.o){if(this.U&&!this.L){t:{if(this.g){var D,Q=this.g;if((D=Q.g?Q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(D)){var se=D;break t}}se=null}if(h=se)Is(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ce(this,h);else{this.o=!1,this.m=3,ot(12),_e(this),Ie(this);break e}}if(this.R){h=!0;let gr;for(;!this.K&&this.C<k.length;)if(gr=re(this,k),gr==B){et==4&&(this.m=4,ot(14),h=!1),Is(this.i,this.l,null,"[Incomplete Response]");break}else if(gr==j){this.m=4,ot(15),Is(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Is(this.i,this.l,gr,null),Ce(this,gr);if(Z(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),et!=4||k.length!=0||this.h.h||(this.m=1,ot(16),h=!1),this.o=this.o&&h,!h)Is(this.i,this.l,k,"[Invalid Chunked Response]"),_e(this),Ie(this);else if(k.length>0&&!this.W){this.W=!0;var be=this.j;be.g==this&&be.aa&&!be.P&&(be.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),yl(be),be.P=!0,ot(11))}}else Is(this.i,this.l,k,null),Ce(this,k);et==4&&_e(this),this.o&&!this.K&&(et==4?hi(this.j,this):(this.o=!1,ee(this)))}else rp(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,ot(12)):(this.m=0,ot(13)),_e(this),Ie(this)}}}catch{}finally{}};function ae(h){if(!Z(h))return h.g.la();const v=_l(h.g);if(v==="")return"";let k="";const D=v.length,Q=us(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return _e(h),Ie(h),"";h.h.i=new i.TextDecoder}for(let se=0;se<D;se++)h.h.h=!0,k+=h.h.i.decode(v[se],{stream:!(Q&&se==D-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function Z(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function re(h,v){var k=h.C,D=v.indexOf(`
`,k);return D==-1?B:(k=Number(v.substring(k,D)),isNaN(k)?j:(D+=1,D+k>v.length?B:(v=v.slice(D,D+k),h.C=D+k,v)))}M.prototype.cancel=function(){this.K=!0,_e(this)};function ee(h){h.T=Date.now()+h.H,ve(h,h.H)}function ve(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Rt(c(h.aa,h),v)}function Te(h){h.D&&(i.clearTimeout(h.D),h.D=null)}M.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(so(this.i,this.B),this.M!=2&&(jt(),ot(17)),_e(this),this.m=2,Ie(this)):ve(this,this.T-h)};function Ie(h){h.j.I==0||h.K||hi(h.j,h)}function _e(h){Te(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,Ys(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Ce(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||nn(k.h,h))){if(!h.L&&nn(k.h,h)&&k.I==3){try{var D=k.Ba.g.parse(v)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Q=D;if(Q[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)Sr(k),fo(k);else break e;Wc(k),ot(18)}}else k.xa=Q[1],0<k.xa-k.K&&Q[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Rt(c(k.Va,k),6e3));Vt(k.h)<=1&&k.ta&&(k.ta=void 0)}else On(k,11)}else if((h.L||k.g==h)&&Sr(k),!P(v))for(Q=k.Ba.g.parse(v),v=0;v<Q.length;v++){let bt=Q[v];const gr=bt[0];if(!(gr<=k.K))if(k.K=gr,bt=bt[1],k.I==2)if(bt[0]=="c"){k.M=bt[1],k.ba=bt[2];const fs=bt[3];fs!=null&&(k.ka=fs,k.j.info("VER="+k.ka));const Pa=bt[4];Pa!=null&&(k.za=Pa,k.j.info("SVER="+k.za));const Ps=bt[5];Ps!=null&&typeof Ps=="number"&&Ps>0&&(D=1.5*Ps,k.O=D,k.j.info("backChannelRequestTimeoutMs_="+D)),D=k;const ra=h.g;if(ra){const mo=ra.g?ra.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(mo){var se=D.h;se.g||mo.indexOf("spdy")==-1&&mo.indexOf("quic")==-1&&mo.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(os(se,se.h),se.h=null))}if(D.G){const $c=ra.g?ra.g.getResponseHeader("X-HTTP-Session-Id"):null;$c&&(D.wa=$c,Dt(D.J,D.G,$c))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),D=k;var be=h;if(D.na=di(D,D.L?D.ba:null,D.W),be.L){Fn(D.h,be);var et=be,cr=D.O;cr&&(et.H=cr),et.D&&(Te(et),ee(et)),D.g=be}else Q0(D);k.i.length>0&&ho(k)}else bt[0]!="stop"&&bt[0]!="close"||On(k,7);else k.I==3&&(bt[0]=="stop"||bt[0]=="close"?bt[0]=="stop"?On(k,7):Bc(k):bt[0]!="noop"&&k.l&&k.l.qa(bt),k.A=0)}}jt(4)}catch{}}var Ue=class{constructor(h,v){this.g=h,this.map=v}};function yt(h){this.l=h||10,i.PerformanceNavigationTiming?(h=i.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ut(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Vt(h){return h.h?1:h.g?h.g.size:0}function nn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function os(h,v){h.g?h.g.add(v):h.h=v}function Fn(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}yt.prototype.cancel=function(){if(this.i=Rn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Rn(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return m(h.i)}var Xn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pn(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const D=h[k].indexOf("=");let Q,se=null;D>=0?(Q=h[k].substring(0,D),se=h[k].substring(D+1)):Q=h[k],v(Q,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Fs(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Fs?(this.l=h.l,ao(this,h.j),this.o=h.o,this.g=h.g,Na(this,h.u),this.h=h.h,Oc(this,xl(h.i)),this.m=h.m):h&&(v=String(h).match(Xn))?(this.l=!1,ao(this,v[1]||"",!0),this.o=io(v[2]||""),this.g=io(v[3]||"",!0),Na(this,v[4]),this.h=io(v[5]||"",!0),Oc(this,v[6]||"",!0),this.m=io(v[7]||"")):(this.l=!1,this.i=new ea(null,this.l))}Fs.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(lr(v,dl,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(lr(v,dl,!0),"@"),h.push(Zs(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(lr(k,k.charAt(0)=="/"?oo:Zd,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",lr(k,lo)),h.join("")},Fs.prototype.resolve=function(h){const v=Dn(this);let k=!!h.j;k?ao(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var D=h.h;if(k)Na(v,h.u);else if(k=!!h.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var Q=v.h.lastIndexOf("/");Q!=-1&&(D=v.h.slice(0,Q+1)+D)}if(Q=D,Q==".."||Q==".")D="";else if(Q.indexOf("./")!=-1||Q.indexOf("/.")!=-1){D=Q.lastIndexOf("/",0)==0,Q=Q.split("/");const se=[];for(let be=0;be<Q.length;){const et=Q[be++];et=="."?D&&be==Q.length&&se.push(""):et==".."?((se.length>1||se.length==1&&se[0]!="")&&se.pop(),D&&be==Q.length&&se.push("")):(se.push(et),D=!0)}D=se.join("/")}else D=Q}return k?v.h=D:k=h.i.toString()!=="",k?Oc(v,xl(h.i)):k=!!h.m,k&&(v.m=h.m),v};function Dn(h){return new Fs(h)}function ao(h,v,k){h.j=k?io(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Na(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Oc(h,v,k){v instanceof ea?(h.i=v,Mc(h.i,h.l)):(k||(v=lr(v,jc)),h.i=new ea(v,h.l))}function Dt(h,v,k){h.i.set(v,k)}function hl(h){return Dt(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function io(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function lr(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,oi),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function oi(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var dl=/[#\/\?@]/g,Zd=/[#\?:]/g,oo=/[#\?]/g,jc=/[#\?@]/g,lo=/#/g;function ea(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Rs(h){h.g||(h.g=new Map,h.h=0,h.i&&Pn(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}e=ea.prototype,e.add=function(h,v){Rs(this),this.i=null,h=ls(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function li(h,v){Rs(h),v=ls(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function pl(h,v){return Rs(h),v=ls(h,v),h.g.has(v)}e.forEach=function(h,v){Rs(this),this.g.forEach(function(k,D){k.forEach(function(Q){h.call(v,Q,D,this)},this)},this)};function ml(h,v){Rs(h);let k=[];if(typeof v=="string")pl(h,v)&&(k=k.concat(h.g.get(ls(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}e.set=function(h,v){return Rs(this),this.i=null,h=ls(this,h),pl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},e.get=function(h,v){return h?(h=ml(this,h),h.length>0?String(h[0]):v):v};function Lc(h,v,k){li(h,v),k.length>0&&(h.i=null,h.g.set(ls(h,v),m(k)),h.h+=k.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let D=0;D<v.length;D++){var k=v[D];const Q=Zs(k);k=ml(this,k);for(let se=0;se<k.length;se++){let be=Q;k[se]!==""&&(be+="="+Zs(k[se])),h.push(be)}}return this.i=h.join("&")};function xl(h){const v=new ea;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function ls(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Mc(h,v){v&&!h.j&&(Rs(h),h.i=null,h.g.forEach(function(k,D){const Q=D.toLowerCase();D!=Q&&(li(this,D),Lc(this,Q,k))},h)),h.j=v}function ep(h,v){const k=new rn;if(i.Image){const D=new Image;D.onload=f(En,k,"TestLoadImage: loaded",!0,v,D),D.onerror=f(En,k,"TestLoadImage: error",!1,v,D),D.onabort=f(En,k,"TestLoadImage: abort",!1,v,D),D.ontimeout=f(En,k,"TestLoadImage: timeout",!1,v,D),i.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=h}else v(!1)}function tp(h,v){const k=new rn,D=new AbortController,Q=setTimeout(()=>{D.abort(),En(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:D.signal}).then(se=>{clearTimeout(Q),se.ok?En(k,"TestPingServer: ok",!0,v):En(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Q),En(k,"TestPingServer: error",!1,v)})}function En(h,v,k,D,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),D(k)}catch{}}function X0(){this.g=new Ge}function gl(h){this.i=h.Sb||null,this.h=h.ab||!1}d(gl,St),gl.prototype.g=function(){return new vl(this.i,this.h)};function vl(h,v){Et.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(vl,Et),e=vl.prototype,e.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,cs(this)},e.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||i).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ca(this)),this.readyState=0},e.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof i.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;K0(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function K0(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}e.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?Ca(this):cs(this),this.readyState==3&&K0(this)}},e.Oa=function(h){this.g&&(this.response=this.responseText=h,Ca(this))},e.Na=function(h){this.g&&(this.response=h,Ca(this))},e.ga=function(){this.g&&Ca(this)};function Ca(h){h.readyState=4,h.l=null,h.j=null,h.B=null,cs(h)}e.setRequestHeader=function(h,v){this.A.append(h,v)},e.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function cs(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(vl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ci(h){let v="";return X(h,function(k,D){v+=D,v+=":",v+=k,v+=`\r
`}),v}function de(h,v,k){e:{for(D in k){var D=!1;break e}D=!0}D||(k=ci(k),typeof h=="string"?k!=null&&Zs(k):Dt(h,v,k))}function je(h){Et.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(je,Et);var ui=/^https?$/i,Vc=["POST","PUT"];e=je.prototype,e.Fa=function(h){this.H=h},e.ea=function(h,v,k,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ai.g(),this.g.onreadystatechange=p(c(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(se){Ia(this,se);return}if(h=k||"",k=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Q in D)k.set(Q,D[Q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const se of D.keys())k.set(se,D.get(se));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(k.keys()).find(se=>se.toLowerCase()=="content-type"),Q=i.FormData&&h instanceof i.FormData,!(Array.prototype.indexOf.call(Vc,v,void 0)>=0)||D||Q||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,be]of k)this.g.setRequestHeader(se,be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(se){Ia(this,se)}};function Ia(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,co(h),fi(h)}function co(h){h.A||(h.A=!0,_t(h,"complete"),_t(h,"error"))}e.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,_t(this,"complete"),_t(this,"abort"),fi(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fi(this,!0)),je.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Fa(this):this.Xa())},e.Xa=function(){Fa(this)};function Fa(h){if(h.h&&typeof a<"u"){if(h.v&&us(h)==4)setTimeout(h.Ca.bind(h),0);else if(_t(h,"readystatechange"),us(h)==4){h.h=!1;try{const se=h.ca();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var D;if(D=se===0){let be=String(h.D).match(Xn)[1]||null;!be&&i.self&&i.self.location&&(be=i.self.location.protocol.slice(0,-1)),D=!ui.test(be?be.toLowerCase():"")}k=D}if(k)_t(h,"complete"),_t(h,"success");else{h.o=6;try{var Q=us(h)>2?h.g.statusText:""}catch{Q=""}h.l=Q+" ["+h.ca()+"]",co(h)}}finally{fi(h)}}}}function fi(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||_t(h,"ready");try{k.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function us(h){return h.g?h.g.readyState:0}e.ca=function(){try{return us(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),wn(v)}};function _l(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function rp(h){const v={};h=(h.g&&us(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<h.length;D++){if(P(h[D]))continue;var k=I(h[D]);const Q=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const se=v[Q]||[];v[Q]=se,se.push(k)}oe(v,function(D){return D.join(", ")})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function uo(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function q0(h){this.za=0,this.i=[],this.j=new rn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=uo("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=uo("baseRetryDelayMs",5e3,h),this.Za=uo("retryDelaySeedMs",1e4,h),this.Ta=uo("forwardChannelMaxRetries",2,h),this.va=uo("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new yt(h&&h.concurrentRequestLimit),this.Ba=new X0,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=q0.prototype,e.ka=8,e.I=1,e.connect=function(h,v,k,D){ot(0),this.W=h,this.H=v||{},k&&D!==void 0&&(this.H.OSID=k,this.H.OAID=D),this.F=this.X,this.J=di(this,null,this.W),ho(this)};function Bc(h){if(Tn(h),h.I==3){var v=h.V++,k=Dn(h.J);if(Dt(k,"SID",h.M),Dt(k,"RID",v),Dt(k,"TYPE","terminate"),po(h,k),v=new M(h,h.j,v),v.M=2,v.A=hl(Dn(k)),k=!1,i.navigator&&i.navigator.sendBeacon)try{k=i.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&i.Image&&(new Image().src=v.A,k=!0),k||(v.g=ta(v.j,null),v.g.ea(v.A)),v.F=Date.now(),ee(v)}Ra(h)}function fo(h){h.g&&(yl(h),h.g.cancel(),h.g=null)}function Tn(h){fo(h),h.v&&(i.clearTimeout(h.v),h.v=null),Sr(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&i.clearTimeout(h.m),h.m=null)}function ho(h){if(!ut(h.h)&&!h.m){h.m=!0;var v=h.Ea;V||S(),L||(V(),L=!0),T.add(v,h),h.D=0}}function Y0(h,v){return Vt(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Rt(c(h.Ea,h,v),Kn(h,h.D)),h.D++,!0)}e.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Q=new M(this,this.j,h);let se=this.o;if(this.U&&(se?(se=Pe(se),q(se,this.U)):se=this.U),this.u!==null||this.R||(Q.J=se,se=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var D=this.i[k];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(v+=D,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=zc(this,Q,v),k=Dn(this.J),Dt(k,"RID",h),Dt(k,"CVER",22),this.G&&Dt(k,"X-HTTP-Session-Id",this.G),po(this,k),se&&(this.R?v="headers="+Zs(ci(se))+"&"+v:this.u&&de(k,this.u,se)),os(this.h,Q),this.Ra&&Dt(k,"TYPE","init"),this.S?(Dt(k,"$req",v),Dt(k,"SID","null"),Q.U=!0,z(Q,k,null)):z(Q,k,v),this.I=2}}else this.I==3&&(h?Uc(this,h):this.i.length==0||ut(this.h)||Uc(this))};function Uc(h,v){var k;v?k=v.l:k=h.V++;const D=Dn(h.J);Dt(D,"SID",h.M),Dt(D,"RID",k),Dt(D,"AID",h.K),po(h,D),h.u&&h.o&&de(D,h.u,h.o),k=new M(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=zc(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),os(h.h,k),z(k,D,v)}function po(h,v){h.H&&X(h.H,function(k,D){Dt(v,D,k)}),h.l&&X({},function(k,D){Dt(v,D,k)})}function zc(h,v,k){k=Math.min(h.i.length,k);const D=h.l?c(h.l.Ka,h.l,h):null;e:{var Q=h.i;let et=-1;for(;;){const cr=["count="+k];et==-1?k>0?(et=Q[0].g,cr.push("ofs="+et)):et=0:cr.push("ofs="+et);let bt=!0;for(let gr=0;gr<k;gr++){var se=Q[gr].g;const fs=Q[gr].map;if(se-=et,se<0)et=Math.max(0,Q[gr].g-100),bt=!1;else try{se="req"+se+"_"||"";try{var be=fs instanceof Map?fs:Object.entries(fs);for(const[Pa,Ps]of be){let ra=Ps;o(Ps)&&(ra=Mt(Ps)),cr.push(se+Pa+"="+encodeURIComponent(ra))}}catch(Pa){throw cr.push(se+"type="+encodeURIComponent("_badmap")),Pa}}catch{D&&D(fs)}}if(bt){be=cr.join("&");break e}}be=void 0}return h=h.i.splice(0,k),v.G=h,be}function Q0(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;V||S(),L||(V(),L=!0),T.add(v,h),h.A=0}}function Wc(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Rt(c(h.Da,h),Kn(h,h.A)),h.A++,!0)}e.Da=function(){if(this.v=null,ft(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Rt(c(this.Wa,this),h)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ot(10),fo(this),ft(this))};function yl(h){h.B!=null&&(i.clearTimeout(h.B),h.B=null)}function ft(h){h.g=new M(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=Dn(h.na);Dt(v,"RID","rpc"),Dt(v,"SID",h.M),Dt(v,"AID",h.K),Dt(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Dt(v,"TO",h.ia),Dt(v,"TYPE","xmlhttp"),po(h,v),h.u&&h.o&&de(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=hl(Dn(v)),k.u=null,k.R=!0,J(k,h)}e.Va=function(){this.C!=null&&(this.C=null,fo(this),Wc(this),ot(19))};function Sr(h){h.C!=null&&(i.clearTimeout(h.C),h.C=null)}function hi(h,v){var k=null;if(h.g==v){Sr(h),yl(h),h.g=null;var D=2}else if(nn(h.h,v))k=v.G,Fn(h.h,v),D=1;else return;if(h.I!=0){if(v.o)if(D==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var Q=h.D;D=Ot(),_t(D,new Cs(D,k)),ho(h)}else Q0(h);else if(Q=v.m,Q==3||Q==0&&v.X>0||!(D==1&&Y0(h,v)||D==2&&Wc(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),Q){case 1:On(h,5);break;case 4:On(h,10);break;case 3:On(h,6);break;default:On(h,2)}}}function Kn(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function On(h,v){if(h.j.info("Error code "+v),v==2){var k=c(h.bb,h),D=h.Ua;const Q=!D;D=new Fs(D||"//www.google.com/images/cleardot.gif"),i.location&&i.location.protocol=="http"||ao(D,"https"),hl(D),Q?ep(D.toString(),k):tp(D.toString(),k)}else ot(2);h.I=0,h.l&&h.l.pa(v),Ra(h),Tn(h)}e.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ot(2)):(this.j.info("Failed to ping google.com"),ot(1))};function Ra(h){if(h.I=0,h.ja=[],h.l){const v=Rn(h.h);(v.length!=0||h.i.length!=0)&&(g(h.ja,v),g(h.ja,h.i),h.h.i.length=0,m(h.i),h.i.length=0),h.l.oa()}}function di(h,v,k){var D=k instanceof Fs?Dn(k):new Fs(k);if(D.g!="")v&&(D.g=v+"."+D.g),Na(D,D.u);else{var Q=i.location;D=Q.protocol,v=v?v+"."+Q.hostname:Q.hostname,Q=+Q.port;const se=new Fs(null);D&&ao(se,D),v&&(se.g=v),Q&&Na(se,Q),k&&(se.h=k),D=se}return k=h.G,v=h.wa,k&&v&&Dt(D,k,v),Dt(D,"VER",h.ka),po(h,D),D}function ta(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new je(new gl({ab:k})):new je(h.ma),v.Fa(h.L),v}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function J0(){}e=J0.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function wl(){}wl.prototype.g=function(h,v){return new sn(h,v)};function sn(h,v){Et.call(this),this.g=new q0(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!P(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!P(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new pi(this)}d(sn,Et),sn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},sn.prototype.close=function(){Bc(this.g)},sn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=Mt(h),h=k);v.i.push(new Ue(v.Ya++,h)),v.I==3&&ho(v)},sn.prototype.N=function(){this.g.l=null,delete this.j,Bc(this.g),delete this.g,sn.Z.N.call(this)};function Z0(h){Gt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}d(Z0,Gt);function ef(){Qs.call(this),this.status=1}d(ef,Qs);function pi(h){this.g=h}d(pi,J0),pi.prototype.ra=function(){_t(this.g,"a")},pi.prototype.qa=function(h){_t(this.g,new Z0(h))},pi.prototype.pa=function(h){_t(this.g,new ef)},pi.prototype.oa=function(){_t(this.g,"b")},wl.prototype.createWebChannel=wl.prototype.g,sn.prototype.send=sn.prototype.o,sn.prototype.open=sn.prototype.m,sn.prototype.close=sn.prototype.close,b4=function(){return new wl},S4=function(){return Ot()},k4=xr,sx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Js.NO_ERROR=0,Js.TIMEOUT=8,Js.HTTP_ERROR=6,sh=Js,Aa.COMPLETE="complete",T4=Aa,rr.EventType=Ft,Ft.OPEN="a",Ft.CLOSE="b",Ft.ERROR="c",Ft.MESSAGE="d",Et.prototype.listen=Et.prototype.J,lu=rr,je.prototype.listenOnce=je.prototype.K,je.prototype.getLastError=je.prototype.Ha,je.prototype.getLastErrorCode=je.prototype.ya,je.prototype.getStatus=je.prototype.ca,je.prototype.getResponseJson=je.prototype.La,je.prototype.getResponseText=je.prototype.la,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Fa,E4=je}).apply(typeof Af<"u"?Af:typeof self<"u"?self:typeof window<"u"?window:{});const l2="@firebase/firestore",c2="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let un=class{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}};un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ac="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=new f4("@firebase/firestore");function Cl(){return Bo.logLevel}function De(e,...t){if(Bo.logLevel<=dt.DEBUG){const r=t.map(Pg);Bo.debug(`Firestore (${Ac}): ${e}`,...r)}}function Ja(e,...t){if(Bo.logLevel<=dt.ERROR){const r=t.map(Pg);Bo.error(`Firestore (${Ac}): ${e}`,...r)}}function mc(e,...t){if(Bo.logLevel<=dt.WARN){const r=t.map(Pg);Bo.warn(`Firestore (${Ac}): ${e}`,...r)}}function Pg(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(e,t,r){let n="Unexpected state";typeof t=="string"?n=t:r=t,A4(e,n,r)}function A4(e,t,r){let n=`FIRESTORE (${Ac}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ja(n),new Error(n)}function Tt(e,t,r,n){let s="Unexpected state";typeof r=="string"?s=r:n=r,e||A4(t,s,n)}function Ze(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends Jo{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class a5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(un.UNAUTHENTICATED))}shutdown(){}}class i5{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class o5{constructor(t){this.t=t,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){Tt(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new Co;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Co,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{De("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(De("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Co)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(De("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Tt(typeof n.accessToken=="string",31837,{l:n}),new N4(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Tt(t===null||typeof t=="string",2055,{h:t}),new un(t)}}class l5{constructor(t,r,n){this.P=t,this.T=r,this.I=n,this.type="FirstParty",this.user=un.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class c5{constructor(t,r,n){this.P=t,this.T=r,this.I=n}getToken(){return Promise.resolve(new l5(this.P,this.T,this.I))}start(t,r){t.enqueueRetryable(()=>r(un.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class u2{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class u5{constructor(t,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,m4(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,r){Tt(this.o===void 0,3512);const n=a=>{a.error!=null&&De("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.m;return this.m=a.token,De("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{De("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):De("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new u2(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(Tt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new u2(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=f5(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%62))}return n}}function lt(e,t){return e<t?-1:e>t?1:0}function ax(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const s=e.charAt(n),a=t.charAt(n);if(s!==a)return jp(s)===jp(a)?lt(s,a):jp(s)?1:-1}return lt(e.length,t.length)}const h5=55296,d5=57343;function jp(e){const t=e.charCodeAt(0);return t>=h5&&t<=d5}function xc(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2="__name__";class fa{constructor(t,r,n){r===void 0?r=0:r>t.length&&Ke(637,{offset:r,range:t.length}),n===void 0?n=t.length-r:n>t.length-r&&Ke(1746,{length:n,range:t.length-r}),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return fa.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof fa?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=fa.compareSegments(t.get(s),r.get(s));if(a!==0)return a}return lt(t.length,r.length)}static compareSegments(t,r){const n=fa.isNumericId(t),s=fa.isNumericId(r);return n&&!s?-1:!n&&s?1:n&&s?fa.extractNumericId(t).compare(fa.extractNumericId(r)):ax(t,r)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Mi.fromString(t.substring(4,t.length-2))}}class Yt extends fa{construct(t,r,n){return new Yt(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ve(xe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Yt(r)}static emptyPath(){return new Yt([])}}const p5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yr extends fa{construct(t,r,n){return new Yr(t,r,n)}static isValidIdentifier(t){return p5.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===f2}static keyField(){return new Yr([f2])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Ve(xe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new Ve(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ve(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Ve(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Yr(r)}static emptyPath(){return new Yr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(t){this.path=t}static fromPath(t){return new We(Yt.fromString(t))}static fromName(t){return new We(Yt.fromString(t).popFirst(5))}static empty(){return new We(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Yt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Yt.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new We(new Yt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m5(e,t,r){if(!r)throw new Ve(xe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function x5(e,t,r,n){if(t===!0&&n===!0)throw new Ve(xe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function h2(e){if(!We.isDocumentKey(e))throw new Ve(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function C4(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Og(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Ke(12329,{type:typeof e})}function Zl(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ve(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Og(e);throw new Ve(xe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(e,t){const r={typeString:e};return t&&(r.value=t),r}function D0(e,t){if(!C4(e))throw new Ve(xe.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in t)if(t[n]){const s=t[n].typeString,a="value"in t[n]?{value:t[n].value}:void 0;if(!(n in e)){r=`JSON missing required field: '${n}'`;break}const i=e[n];if(s&&typeof i!==s){r=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&i!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Ve(xe.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=-62135596800,p2=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(t){return zt.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor((t-1e3*r)*p2);return new zt(r,n)}constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<d2)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ve(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/p2}_compareTo(t){return this.seconds===t.seconds?lt(this.nanoseconds,t.nanoseconds):lt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(D0(t,zt._jsonSchema))return new zt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-d2;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:Tr("string",zt._jsonSchemaVersion),seconds:Tr("number"),nanoseconds:Tr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{static fromTimestamp(t){return new Ye(t)}static min(){return new Ye(new zt(0,0))}static max(){return new Ye(new zt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=-1;function g5(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=Ye.fromTimestamp(n===1e9?new zt(r+1,0):new zt(r,n));return new Ui(s,We.empty(),t)}function v5(e){return new Ui(e.readTime,e.key,i0)}class Ui{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new Ui(Ye.min(),We.empty(),i0)}static max(){return new Ui(Ye.max(),We.empty(),i0)}}function _5(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=We.comparator(e.documentKey,t.documentKey),r!==0?r:lt(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nc(e){if(e.code!==xe.FAILED_PRECONDITION||e.message!==y5)throw e;De("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new he((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof he?r:he.resolve(r)}catch(r){return he.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):he.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):he.reject(r)}static resolve(t){return new he((r,n)=>{r(t)})}static reject(t){return new he((r,n)=>{n(t)})}static waitFor(t){return new he((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=he.resolve(!1);for(const n of t)r=r.next(s=>s?he.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new he((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(t[c]).next(f=>{i[c]=f,++o,o===a&&n(i)},f=>s(f))}})}static doWhile(t,r){return new he((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function E5(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Cc(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Fd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg=-1;function Rd(e){return e==null}function Lh(e){return e===0&&1/e==-1/0}function T5(e){return typeof e=="number"&&Number.isInteger(e)&&!Lh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4="";function k5(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=m2(t)),t=S5(e.get(r),t);return m2(t)}function S5(e,t){let r=t;const n=e.length;for(let s=0;s<n;s++){const a=e.charAt(s);switch(a){case"\0":r+="";break;case I4:r+="";break;default:r+=a}}return r}function m2(e){return e+I4+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Zo(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function F4(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(t,r){this.comparator=t,this.root=r||Kr.EMPTY}insert(t,r){return new tr(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,Kr.BLACK,null,null))}remove(t){return new tr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Kr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Nf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Nf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Nf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Nf(this.root,t,this.comparator,!0)}}class Nf{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Kr{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n!=null?n:Kr.RED,this.left=s!=null?s:Kr.EMPTY,this.right=a!=null?a:Kr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new Kr(t!=null?t:this.key,r!=null?r:this.value,n!=null?n:this.color,s!=null?s:this.left,a!=null?a:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Kr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return Kr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Kr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Kr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Ke(27949);return t+(this.isRed()?0:1)}}Kr.EMPTY=null,Kr.RED=!0,Kr.BLACK=!1;Kr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(t,r,n,s,a){return this}insert(t,r,n){return new Kr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(t){this.comparator=t,this.data=new tr(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new g2(this.data.getIterator())}getIteratorFrom(t){return new g2(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof Pr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Pr(this.comparator);return r.data=t,r}}class g2{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(t){this.fields=t,t.sort(Yr.comparator)}static empty(){return new Us([])}unionWith(t){let r=new Pr(Yr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Us(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return xc(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new R4("Invalid base64 string: "+a):a}}(t);return new en(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new en(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return lt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}en.EMPTY_BYTE_STRING=new en("");const b5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zi(e){if(Tt(!!e,39018),typeof e=="string"){let t=0;const r=b5.exec(e);if(Tt(!!r,46558,{timestamp:e}),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:hr(e.seconds),nanos:hr(e.nanos)}}function hr(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Wi(e){return typeof e=="string"?en.fromBase64String(e):en.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="server_timestamp",D4="__type__",O4="__previous_value__",j4="__local_write_time__";function Lg(e){var r,n;return((n=(((r=e==null?void 0:e.mapValue)==null?void 0:r.fields)||{})[D4])==null?void 0:n.stringValue)===P4}function Pd(e){const t=e.mapValue.fields[O4];return Lg(t)?Pd(t):t}function o0(e){const t=zi(e.mapValue.fields[j4].timestampValue);return new zt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(t,r,n,s,a,i,o,l,c,f){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=f}}const Mh="(default)";class l0{constructor(t,r){this.projectId=t,this.database=r||Mh}static empty(){return new l0("","")}get isDefaultDatabase(){return this.database===Mh}isEqual(t){return t instanceof l0&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="__type__",N5="__max__",Cf={mapValue:{}},M4="__vector__",Vh="value";function $i(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Lg(e)?4:I5(e)?9007199254740991:C5(e)?10:11:Ke(28295,{value:e})}function ya(e,t){if(e===t)return!0;const r=$i(e);if(r!==$i(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return o0(e).isEqual(o0(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=zi(s.timestampValue),o=zi(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return Wi(s.bytesValue).isEqual(Wi(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return hr(s.geoPointValue.latitude)===hr(a.geoPointValue.latitude)&&hr(s.geoPointValue.longitude)===hr(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return hr(s.integerValue)===hr(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=hr(s.doubleValue),o=hr(a.doubleValue);return i===o?Lh(i)===Lh(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return xc(e.arrayValue.values||[],t.arrayValue.values||[],ya);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(x2(i)!==x2(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!ya(i[l],o[l])))return!1;return!0}(e,t);default:return Ke(52216,{left:e})}}function c0(e,t){return(e.values||[]).find(r=>ya(r,t))!==void 0}function gc(e,t){if(e===t)return 0;const r=$i(e),n=$i(t);if(r!==n)return lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lt(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=hr(a.integerValue||a.doubleValue),l=hr(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return v2(e.timestampValue,t.timestampValue);case 4:return v2(o0(e),o0(t));case 5:return ax(e.stringValue,t.stringValue);case 6:return function(a,i){const o=Wi(a),l=Wi(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=lt(o[c],l[c]);if(f!==0)return f}return lt(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=lt(hr(a.latitude),hr(i.latitude));return o!==0?o:lt(hr(a.longitude),hr(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return _2(e.arrayValue,t.arrayValue);case 10:return function(a,i){var p,m,g,x;const o=a.fields||{},l=i.fields||{},c=(p=o[Vh])==null?void 0:p.arrayValue,f=(m=l[Vh])==null?void 0:m.arrayValue,d=lt(((g=c==null?void 0:c.values)==null?void 0:g.length)||0,((x=f==null?void 0:f.values)==null?void 0:x.length)||0);return d!==0?d:_2(c,f)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===Cf.mapValue&&i===Cf.mapValue)return 0;if(a===Cf.mapValue)return 1;if(i===Cf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let d=0;d<l.length&&d<f.length;++d){const p=ax(l[d],f[d]);if(p!==0)return p;const m=gc(o[l[d]],c[f[d]]);if(m!==0)return m}return lt(l.length,f.length)}(e.mapValue,t.mapValue);default:throw Ke(23264,{he:r})}}function v2(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return lt(e,t);const r=zi(e),n=zi(t),s=lt(r.seconds,n.seconds);return s!==0?s:lt(r.nanos,n.nanos)}function _2(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=gc(r[s],n[s]);if(a)return a}return lt(r.length,n.length)}function vc(e){return ix(e)}function ix(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=zi(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Wi(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return We.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=ix(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${ix(r.fields[i])}`;return s+"}"}(e.mapValue):Ke(61005,{value:e})}function ah(e){switch($i(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Pd(e);return t?16+ah(t):16;case 5:return 2*e.stringValue.length;case 6:return Wi(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,a)=>s+ah(a),0)}(e.arrayValue);case 10:case 11:return function(n){let s=0;return Zo(n.fields,(a,i)=>{s+=a.length+ah(i)}),s}(e.mapValue);default:throw Ke(13486,{value:e})}}function ox(e){return!!e&&"integerValue"in e}function Mg(e){return!!e&&"arrayValue"in e}function y2(e){return!!e&&"nullValue"in e}function w2(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ih(e){return!!e&&"mapValue"in e}function C5(e){var r,n;return((n=(((r=e==null?void 0:e.mapValue)==null?void 0:r.fields)||{})[L4])==null?void 0:n.stringValue)===M4}function bu(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return Zo(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=bu(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=bu(e.arrayValue.values[r]);return t}return{...e}}function I5(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===N5}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(t){this.value=t}static empty(){return new ys({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!ih(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=bu(r)}setAll(t){let r=Yr.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=bu(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());ih(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return ya(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];ih(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){Zo(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new ys(bu(this.value))}}function V4(e){const t=[];return Zo(e.fields,(r,n)=>{const s=new Yr([r]);if(ih(n)){const a=V4(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new Us(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new pn(t,0,Ye.min(),Ye.min(),Ye.min(),ys.empty(),0)}static newFoundDocument(t,r,n,s){return new pn(t,1,r,Ye.min(),n,s,0)}static newNoDocument(t,r){return new pn(t,2,r,Ye.min(),Ye.min(),ys.empty(),0)}static newUnknownDocument(t,r){return new pn(t,3,r,Ye.min(),Ye.min(),ys.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ys.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ys.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof pn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(t,r){this.position=t,this.inclusive=r}}function E2(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=We.comparator(We.fromName(i.referenceValue),r.key):n=gc(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function T2(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!ya(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(t,r="asc"){this.field=t,this.dir=r}}function F5(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{}class Ir extends B4{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new P5(t,r,n):r==="array-contains"?new j5(t,n):r==="in"?new L5(t,n):r==="not-in"?new M5(t,n):r==="array-contains-any"?new V5(t,n):new Ir(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new D5(t,n):new O5(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(gc(r,this.value)):r!==null&&$i(this.value)===$i(r)&&this.matchesComparison(gc(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class wa extends B4{constructor(t,r){super(),this.filters=t,this.op=r,this.Pe=null}static create(t,r){return new wa(t,r)}matches(t){return U4(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function U4(e){return e.op==="and"}function z4(e){return R5(e)&&U4(e)}function R5(e){for(const t of e.filters)if(t instanceof wa)return!1;return!0}function lx(e){if(e instanceof Ir)return e.field.canonicalString()+e.op.toString()+vc(e.value);if(z4(e))return e.filters.map(t=>lx(t)).join(",");{const t=e.filters.map(r=>lx(r)).join(",");return`${e.op}(${t})`}}function W4(e,t){return e instanceof Ir?function(n,s){return s instanceof Ir&&n.op===s.op&&n.field.isEqual(s.field)&&ya(n.value,s.value)}(e,t):e instanceof wa?function(n,s){return s instanceof wa&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&W4(i,s.filters[o]),!0):!1}(e,t):void Ke(19439)}function $4(e){return e instanceof Ir?function(r){return`${r.field.canonicalString()} ${r.op} ${vc(r.value)}`}(e):e instanceof wa?function(r){return r.op.toString()+" {"+r.getFilters().map($4).join(" ,")+"}"}(e):"Filter"}class P5 extends Ir{constructor(t,r,n){super(t,r,n),this.key=We.fromName(n.referenceValue)}matches(t){const r=We.comparator(t.key,this.key);return this.matchesComparison(r)}}class D5 extends Ir{constructor(t,r){super(t,"in",r),this.keys=H4("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class O5 extends Ir{constructor(t,r){super(t,"not-in",r),this.keys=H4("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function H4(e,t){var r;return(((r=t.arrayValue)==null?void 0:r.values)||[]).map(n=>We.fromName(n.referenceValue))}class j5 extends Ir{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return Mg(r)&&c0(r.arrayValue,this.value)}}class L5 extends Ir{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&c0(this.value.arrayValue,r)}}class M5 extends Ir{constructor(t,r){super(t,"not-in",r)}matches(t){if(c0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&r.nullValue===void 0&&!c0(this.value.arrayValue,r)}}class V5 extends Ir{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!Mg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>c0(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.Te=null}}function k2(e,t=null,r=[],n=[],s=null,a=null,i=null){return new B5(e,t,r,n,s,a,i)}function Vg(e){const t=Ze(e);if(t.Te===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>lx(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Rd(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>vc(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>vc(n)).join(",")),t.Te=r}return t.Te}function Bg(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!F5(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!W4(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!T2(e.startAt,t.startAt)&&T2(e.endAt,t.endAt)}function cx(e){return We.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function U5(e,t,r,n,s,a,i,o){return new Dd(e,t,r,n,s,a,i,o)}function Ug(e){return new Dd(e)}function S2(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function z5(e){return e.collectionGroup!==null}function Au(e){const t=Ze(e);if(t.Ie===null){t.Ie=[];const r=new Set;for(const a of t.explicitOrderBy)t.Ie.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new Pr(Yr.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new Uh(a,n))}),r.has(Yr.keyField().canonicalString())||t.Ie.push(new Uh(Yr.keyField(),n))}return t.Ie}function xa(e){const t=Ze(e);return t.Ee||(t.Ee=W5(t,Au(e))),t.Ee}function W5(e,t){if(e.limitType==="F")return k2(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Uh(s.field,a)});const r=e.endAt?new Bh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Bh(e.startAt.position,e.startAt.inclusive):null;return k2(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function ux(e,t,r){return new Dd(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Od(e,t){return Bg(xa(e),xa(t))&&e.limitType===t.limitType}function G4(e){return`${Vg(xa(e))}|lt:${e.limitType}`}function Il(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>$4(s)).join(", ")}]`),Rd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>vc(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>vc(s)).join(",")),`Target(${n})`}(xa(e))}; limitType=${e.limitType})`}function jd(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):We.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of Au(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=E2(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,Au(n),s)||n.endAt&&!function(i,o,l){const c=E2(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,Au(n),s))}(e,t)}function $5(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function X4(e){return(t,r)=>{let n=!1;for(const s of Au(e)){const a=H5(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function H5(e,t,r){const n=e.field.isKeyField()?We.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?gc(l,c):Ke(42886)}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Ke(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Zo(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return F4(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G5=new tr(We.comparator);function Za(){return G5}const K4=new tr(We.comparator);function cu(...e){let t=K4;for(const r of e)t=t.insert(r.key,r);return t}function q4(e){let t=K4;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function ko(){return Nu()}function Y4(){return Nu()}function Nu(){return new el(e=>e.toString(),(e,t)=>e.isEqual(t))}const X5=new tr(We.comparator),K5=new Pr(We.comparator);function ct(...e){let t=K5;for(const r of e)t=t.add(r);return t}const q5=new Pr(lt);function Y5(){return q5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zg(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(t)?"-0":t}}function Q4(e){return{integerValue:""+e}}function Q5(e,t){return T5(t)?Q4(t):zg(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(){this._=void 0}}function J5(e,t,r){return e instanceof zh?function(s,a){const i={fields:{[D4]:{stringValue:P4},[j4]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&Lg(a)&&(a=Pd(a)),a&&(i.fields[O4]=a),{mapValue:i}}(r,t):e instanceof u0?Z4(e,t):e instanceof f0?ek(e,t):function(s,a){const i=J4(s,a),o=b2(i)+b2(s.Ae);return ox(i)&&ox(s.Ae)?Q4(o):zg(s.serializer,o)}(e,t)}function Z5(e,t,r){return e instanceof u0?Z4(e,t):e instanceof f0?ek(e,t):r}function J4(e,t){return e instanceof Wh?function(n){return ox(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class zh extends Ld{}class u0 extends Ld{constructor(t){super(),this.elements=t}}function Z4(e,t){const r=tk(t);for(const n of e.elements)r.some(s=>ya(s,n))||r.push(n);return{arrayValue:{values:r}}}class f0 extends Ld{constructor(t){super(),this.elements=t}}function ek(e,t){let r=tk(t);for(const n of e.elements)r=r.filter(s=>!ya(s,n));return{arrayValue:{values:r}}}class Wh extends Ld{constructor(t,r){super(),this.serializer=t,this.Ae=r}}function b2(e){return hr(e.integerValue||e.doubleValue)}function tk(e){return Mg(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function eF(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof u0&&s instanceof u0||n instanceof f0&&s instanceof f0?xc(n.elements,s.elements,ya):n instanceof Wh&&s instanceof Wh?ya(n.Ae,s.Ae):n instanceof zh&&s instanceof zh}(e.transform,t.transform)}class tF{constructor(t,r){this.version=t,this.transformResults=r}}class Wa{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Wa}static exists(t){return new Wa(void 0,t)}static updateTime(t){return new Wa(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function oh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Md{}function rk(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new sk(e.key,Wa.none()):new O0(e.key,e.data,Wa.none());{const r=e.data,n=ys.empty();let s=new Pr(Yr.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new tl(e.key,n,new Us(s.toArray()),Wa.none())}}function rF(e,t,r){e instanceof O0?function(s,a,i){const o=s.value.clone(),l=N2(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof tl?function(s,a,i){if(!oh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=N2(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(nk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function Cu(e,t,r,n){return e instanceof O0?function(a,i,o,l){if(!oh(a.precondition,i))return o;const c=a.value.clone(),f=C2(a.fieldTransforms,l,i);return c.setAll(f),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof tl?function(a,i,o,l){if(!oh(a.precondition,i))return o;const c=C2(a.fieldTransforms,l,i),f=i.data;return f.setAll(nk(a)),f.setAll(c),i.convertToFoundDocument(i.version,f).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(e,t,r,n):function(a,i,o){return oh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function nF(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=J4(n.transform,s||null);a!=null&&(r===null&&(r=ys.empty()),r.set(n.field,a))}return r||null}function A2(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&xc(n,s,(a,i)=>eF(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class O0 extends Md{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class tl extends Md{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function nk(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function N2(e,t,r){const n=new Map;Tt(e.length===r.length,32656,{Re:r.length,Ve:e.length});for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,Z5(i,o,r[s]))}return n}function C2(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,J5(a,i,t))}return n}class sk extends Md{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sF extends Md{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&rF(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Cu(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Cu(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=Y4();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=rk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Ye.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),ct())}isEqual(t){return this.batchId===t.batchId&&xc(this.mutations,t.mutations,(r,n)=>A2(r,n))&&xc(this.baseMutations,t.baseMutations,(r,n)=>A2(r,n))}}class Wg{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){Tt(t.mutations.length===n.length,58842,{me:t.mutations.length,fe:n.length});let s=function(){return X5}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new Wg(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _r,ht;function lF(e){switch(e){case xe.OK:return Ke(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return Ke(15467,{code:e})}}function ak(e){if(e===void 0)return Ja("GRPC error has no .code"),xe.UNKNOWN;switch(e){case _r.OK:return xe.OK;case _r.CANCELLED:return xe.CANCELLED;case _r.UNKNOWN:return xe.UNKNOWN;case _r.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case _r.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case _r.INTERNAL:return xe.INTERNAL;case _r.UNAVAILABLE:return xe.UNAVAILABLE;case _r.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case _r.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case _r.NOT_FOUND:return xe.NOT_FOUND;case _r.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case _r.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case _r.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case _r.ABORTED:return xe.ABORTED;case _r.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case _r.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case _r.DATA_LOSS:return xe.DATA_LOSS;default:return Ke(39323,{code:e})}}(ht=_r||(_r={}))[ht.OK=0]="OK",ht[ht.CANCELLED=1]="CANCELLED",ht[ht.UNKNOWN=2]="UNKNOWN",ht[ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ht[ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ht[ht.NOT_FOUND=5]="NOT_FOUND",ht[ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",ht[ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",ht[ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",ht[ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ht[ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ht[ht.ABORTED=10]="ABORTED",ht[ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",ht[ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",ht[ht.INTERNAL=13]="INTERNAL",ht[ht.UNAVAILABLE=14]="UNAVAILABLE",ht[ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=new Mi([4294967295,4294967295],0);function I2(e){const t=cF().encode(e),r=new w4;return r.update(t),new Uint8Array(r.digest())}function F2(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Mi([r,n],0),new Mi([s,a],0)]}class $g{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new uu(`Invalid padding: ${r}`);if(n<0)throw new uu(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new uu(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new uu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*t.length-r,this.pe=Mi.fromNumber(this.ge)}ye(t,r,n){let s=t.add(r.multiply(Mi.fromNumber(n)));return s.compare(uF)===1&&(s=new Mi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const r=I2(t),[n,s]=F2(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);if(!this.we(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new $g(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.ge===0)return;const r=I2(t),[n,s]=F2(r);for(let a=0;a<this.hashCount;a++){const i=this.ye(n,s,a);this.Se(i)}}Se(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class uu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,j0.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new Vd(Ye.min(),s,new tr(lt),Za(),ct())}}class j0{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new j0(n,r,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(t,r,n,s){this.be=t,this.removedTargetIds=r,this.key=n,this.De=s}}class ik{constructor(t,r){this.targetId=t,this.Ce=r}}class ok{constructor(t,r,n=en.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class R2{constructor(){this.ve=0,this.Fe=P2(),this.Me=en.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=ct(),r=ct(),n=ct();return this.Fe.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Ke(38017,{changeType:a})}}),new j0(this.Me,this.xe,t,r,n)}qe(){this.Oe=!1,this.Fe=P2()}Qe(t,r){this.Oe=!0,this.Fe=this.Fe.insert(t,r)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,Tt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class fF{constructor(t){this.Ge=t,this.ze=new Map,this.je=Za(),this.Je=If(),this.He=If(),this.Ye=new tr(lt)}Ze(t){for(const r of t.be)t.De&&t.De.isFoundDocument()?this.Xe(r,t.De):this.et(r,t.key,t.De);for(const r of t.removedTargetIds)this.et(r,t.key,t.De)}tt(t){this.forEachTarget(t,r=>{const n=this.nt(r);switch(t.state){case 0:this.rt(r)&&n.Le(t.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(t.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(t.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(t.resumeToken));break;default:Ke(56790,{state:t.state})}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.ze.forEach((n,s)=>{this.rt(s)&&r(s)})}st(t){const r=t.targetId,n=t.Ce.count,s=this.ot(r);if(s){const a=s.target;if(cx(a))if(n===0){const i=new We(a.path);this.et(r,i,pn.newNoDocument(i,Ye.min()))}else Tt(n===1,20013,{expectedCount:n});else{const i=this._t(r);if(i!==n){const o=this.ut(t),l=o?this.ct(o,t,i):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(t){const r=t.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Wi(n).toUint8Array()}catch(l){if(l instanceof R4)return mc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new $g(i,s,a)}catch(l){return mc(l instanceof uu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(t,r,n){return r.Ce.count===n-this.Pt(t,r.targetId)?0:2}Pt(t,r){const n=this.Ge.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Ge.ht(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.et(r,a,null),s++)}),s}Tt(t){const r=new Map;this.ze.forEach((a,i)=>{const o=this.ot(i);if(o){if(a.current&&cx(o.target)){const l=new We(o.target.path);this.It(l).has(i)||this.Et(i,l)||this.et(i,l,pn.newNoDocument(l,t))}a.Be&&(r.set(i,a.ke()),a.qe())}});let n=ct();this.He.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,i)=>i.setReadTime(t));const s=new Vd(t,r,this.Ye,this.je,n);return this.je=Za(),this.Je=If(),this.He=If(),this.Ye=new tr(lt),s}Xe(t,r){if(!this.rt(t))return;const n=this.Et(t,r.key)?2:0;this.nt(t).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(t)),this.He=this.He.insert(r.key,this.dt(r.key).add(t))}et(t,r,n){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,r)?s.Qe(r,1):s.$e(r),this.He=this.He.insert(r,this.dt(r).delete(t)),this.He=this.He.insert(r,this.dt(r).add(t)),n&&(this.je=this.je.insert(r,n))}removeTarget(t){this.ze.delete(t)}_t(t){const r=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let r=this.ze.get(t);return r||(r=new R2,this.ze.set(t,r)),r}dt(t){let r=this.He.get(t);return r||(r=new Pr(lt),this.He=this.He.insert(t,r)),r}It(t){let r=this.Je.get(t);return r||(r=new Pr(lt),this.Je=this.Je.insert(t,r)),r}rt(t){const r=this.ot(t)!==null;return r||De("WatchChangeAggregator","Detected inactive target",t),r}ot(t){const r=this.ze.get(t);return r&&r.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new R2),this.Ge.getRemoteKeysForTarget(t).forEach(r=>{this.et(t,r,null)})}Et(t,r){return this.Ge.getRemoteKeysForTarget(t).has(r)}}function If(){return new tr(We.comparator)}function P2(){return new tr(We.comparator)}const hF={asc:"ASCENDING",desc:"DESCENDING"},dF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pF={and:"AND",or:"OR"};class mF{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function fx(e,t){return e.useProto3Json||Rd(t)?t:{value:t}}function $h(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function lk(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xF(e,t){return $h(e,t.toTimestamp())}function ga(e){return Tt(!!e,49232),Ye.fromTimestamp(function(r){const n=zi(r);return new zt(n.seconds,n.nanos)}(e))}function Hg(e,t){return hx(e,t).canonicalString()}function hx(e,t){const r=function(s){return new Yt(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function ck(e){const t=Yt.fromString(e);return Tt(pk(t),10190,{key:t.toString()}),t}function dx(e,t){return Hg(e.databaseId,t.path)}function Lp(e,t){const r=ck(t);if(r.get(1)!==e.databaseId.projectId)throw new Ve(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Ve(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new We(fk(r))}function uk(e,t){return Hg(e.databaseId,t)}function gF(e){const t=ck(e);return t.length===4?Yt.emptyPath():fk(t)}function px(e){return new Yt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function fk(e){return Tt(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function D2(e,t,r){return{name:dx(e,t),fields:r.value.mapValue.fields}}function vF(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Ke(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(c,f){return c.useProto3Json?(Tt(f===void 0||typeof f=="string",58123),en.fromBase64String(f||"")):(Tt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),en.fromUint8Array(f||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(c){const f=c.code===void 0?xe.UNKNOWN:ak(c.code);return new Ve(f,c.message||"")}(i);r=new ok(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=Lp(e,n.document.name),a=ga(n.document.updateTime),i=n.document.createTime?ga(n.document.createTime):Ye.min(),o=new ys({mapValue:{fields:n.document.fields}}),l=pn.newFoundDocument(s,a,i,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new lh(c,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=Lp(e,n.document),a=n.readTime?ga(n.readTime):Ye.min(),i=pn.newNoDocument(s,a),o=n.removedTargetIds||[];r=new lh([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=Lp(e,n.document),a=n.removedTargetIds||[];r=new lh([],a,s,null)}else{if(!("filter"in t))return Ke(11601,{Rt:t});{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new oF(s,a),o=n.targetId;r=new ik(o,i)}}return r}function _F(e,t){let r;if(t instanceof O0)r={update:D2(e,t.key,t.value)};else if(t instanceof sk)r={delete:dx(e,t.key)};else if(t instanceof tl)r={update:D2(e,t.key,t.data),updateMask:NF(t.fieldMask)};else{if(!(t instanceof sF))return Ke(16599,{Vt:t.type});r={verify:dx(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof zh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof u0)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof f0)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Wh)return{fieldPath:i.field.canonicalString(),increment:o.Ae};throw Ke(20930,{transform:i.transform})}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:xF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ke(27497)}(e,t.precondition)),r}function yF(e,t){return e&&e.length>0?(Tt(t!==void 0,14353),e.map(r=>function(s,a){let i=s.updateTime?ga(s.updateTime):ga(a);return i.isEqual(Ye.min())&&(i=ga(a)),new tF(i,s.transformResults||[])}(r,t))):[]}function wF(e,t){return{documents:[uk(e,t.path)]}}function EF(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=uk(e,s);const a=function(c){if(c.length!==0)return dk(wa.create(c,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(f=>function(p){return{field:Fl(p.field),direction:SF(p.dir)}}(f))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=fx(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{ft:r,parent:s}}function TF(e){let t=gF(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Tt(n===1,65062);const f=r.from[0];f.allDescendants?s=f.collectionId:t=t.child(f.collectionId)}let a=[];r.where&&(a=function(d){const p=hk(d);return p instanceof wa&&z4(p)?p.getFilters():[p]}(r.where));let i=[];r.orderBy&&(i=function(d){return d.map(p=>function(g){return new Uh(Rl(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(p))}(r.orderBy));let o=null;r.limit&&(o=function(d){let p;return p=typeof d=="object"?d.value:d,Rd(p)?null:p}(r.limit));let l=null;r.startAt&&(l=function(d){const p=!!d.before,m=d.values||[];return new Bh(m,p)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const p=!d.before,m=d.values||[];return new Bh(m,p)}(r.endAt)),U5(t,s,i,a,o,"F",l,c)}function kF(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:s})}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function hk(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Rl(r.unaryFilter.field);return Ir.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Rl(r.unaryFilter.field);return Ir.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Rl(r.unaryFilter.field);return Ir.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Rl(r.unaryFilter.field);return Ir.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}}(e):e.fieldFilter!==void 0?function(r){return Ir.create(Rl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return wa.create(r.compositeFilter.filters.map(n=>hk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}}(r.compositeFilter.op))}(e):Ke(30097,{filter:e})}function SF(e){return hF[e]}function bF(e){return dF[e]}function AF(e){return pF[e]}function Fl(e){return{fieldPath:e.canonicalString()}}function Rl(e){return Yr.fromServerFormat(e.fieldPath)}function dk(e){return e instanceof Ir?function(r){if(r.op==="=="){if(w2(r.value))return{unaryFilter:{field:Fl(r.field),op:"IS_NAN"}};if(y2(r.value))return{unaryFilter:{field:Fl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(w2(r.value))return{unaryFilter:{field:Fl(r.field),op:"IS_NOT_NAN"}};if(y2(r.value))return{unaryFilter:{field:Fl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(r.field),op:bF(r.op),value:r.value}}}(e):e instanceof wa?function(r){const n=r.getFilters().map(s=>dk(s));return n.length===1?n[0]:{compositeFilter:{op:AF(r.op),filters:n}}}(e):Ke(54877,{filter:e})}function NF(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function pk(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(t,r,n,s,a=Ye.min(),i=Ye.min(),o=en.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new ki(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new ki(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(t){this.yt=t}}function IF(e){const t=TF({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?ux(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(){this.Cn=new RF}addToCollectionParentIndex(t,r){return this.Cn.add(r),he.resolve()}getCollectionParents(t,r){return he.resolve(this.Cn.getEntries(r))}addFieldIndex(t,r){return he.resolve()}deleteFieldIndex(t,r){return he.resolve()}deleteAllFieldIndexes(t){return he.resolve()}createTargetIndexes(t,r){return he.resolve()}getDocumentsMatchingTarget(t,r){return he.resolve(null)}getIndexType(t,r){return he.resolve(0)}getFieldIndexes(t,r){return he.resolve([])}getNextCollectionGroupToUpdate(t){return he.resolve(null)}getMinOffset(t,r){return he.resolve(Ui.min())}getMinOffsetFromCollectionGroup(t,r){return he.resolve(Ui.min())}updateCollectionGroup(t,r,n){return he.resolve()}updateIndexEntries(t,r){return he.resolve()}}class RF{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new Pr(Yt.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new Pr(Yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mk=41943040;class Ln{static withCacheSize(t){return new Ln(t,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,r,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(mk,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new _c(0)}static cr(){return new _c(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="LruGarbageCollector",PF=1048576;function L2([e,t],[r,n]){const s=lt(e,r);return s===0?lt(t,n):s}class DF{constructor(t){this.Ir=t,this.buffer=new Pr(L2),this.Er=0}dr(){return++this.Er}Ar(t){const r=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();L2(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class OF{constructor(t,r,n){this.garbageCollector=t,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){De(j2,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Cc(r)?De(j2,"Ignoring IndexedDB error during garbage collection: ",r):await Nc(r)}await this.Vr(3e5)})}}class jF{constructor(t,r){this.mr=t,this.params=r}calculateTargetCount(t,r){return this.mr.gr(t).next(n=>Math.floor(r/100*n))}nthSequenceNumber(t,r){if(r===0)return he.resolve(Fd.ce);const n=new DF(r);return this.mr.forEachTarget(t,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(t,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(t,r,n){return this.mr.removeTargets(t,r,n)}removeOrphanedDocuments(t,r){return this.mr.removeOrphanedDocuments(t,r)}collect(t,r){return this.params.cacheSizeCollectionThreshold===-1?(De("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(O2)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(De("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O2):this.yr(t,r))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,r){let n,s,a,i,o,l,c;const f=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(De("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,i=Date.now(),this.nthSequenceNumber(t,s))).next(d=>(n=d,o=Date.now(),this.removeTargets(t,n,r))).next(d=>(a=d,l=Date.now(),this.removeOrphanedDocuments(t,n))).next(d=>(c=Date.now(),Cl()<=dt.DEBUG&&De("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${i-f}ms
	Determined least recently used ${s} in `+(o-i)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-f}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:d})))}}function LF(e,t){return new jF(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(){this.changes=new el(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,pn.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?he.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VF{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&Cu(n.mutation,s,Us.empty(),zt.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,ct()).next(()=>n))}getLocalViewOfDocuments(t,r,n=ct()){const s=ko();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=cu();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=ko();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,ct()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=Za();const i=Nu(),o=function(){return Nu()}();return r.forEach((l,c)=>{const f=n.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof tl)?a=a.insert(c.key,c):f!==void 0?(i.set(c.key,f.mutation.getFieldMask()),Cu(f.mutation,c,f.mutation.getFieldMask(),zt.now())):i.set(c.key,Us.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((c,f)=>i.set(c,f)),r.forEach((c,f)=>{var d;return o.set(c,new VF(f,(d=i.get(c))!=null?d:null))}),o))}recalculateAndSaveOverlays(t,r){const n=Nu();let s=new tr((i,o)=>i-o),a=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||Us.empty();f=o.applyToLocalView(c,f),n.set(l,f);const d=(s.get(o.batchId)||ct()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,d=Y4();f.forEach(p=>{if(!a.has(p)){const m=rk(r.get(p),n.get(p));m!==null&&d.set(p,m),a=a.add(p)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,d))}return he.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return We.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):z5(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):he.resolve(ko());let o=i0,l=a;return i.next(c=>he.forEach(c,(f,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),a.get(f)?he.resolve():this.remoteDocumentCache.getEntry(t,f).next(p=>{l=l.insert(f,p)}))).next(()=>this.populateOverlays(t,c,a)).next(()=>this.computeViews(t,l,c,ct())).next(f=>({batchId:o,changes:q4(f)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new We(r)).next(n=>{let s=cu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=cu();return this.indexManager.getCollectionParents(t,a).next(o=>he.forEach(o,l=>{const c=function(d,p){return new Dd(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,c,n,s).next(f=>{f.forEach((d,p)=>{i=i.insert(d,p)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const f=c.getKey();i.get(f)===null&&(i=i.insert(f,pn.newInvalidDocument(f)))});let o=cu();return i.forEach((l,c)=>{const f=a.get(l);f!==void 0&&Cu(f.mutation,c,Us.empty(),zt.now()),jd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,r){return he.resolve(this.Lr.get(r))}saveBundleMetadata(t,r){return this.Lr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:ga(s.createTime)}}(r)),he.resolve()}getNamedQuery(t,r){return he.resolve(this.kr.get(r))}saveNamedQuery(t,r){return this.kr.set(r.name,function(s){return{name:s.name,query:IF(s.bundledQuery),readTime:ga(s.readTime)}}(r)),he.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(){this.overlays=new tr(We.comparator),this.qr=new Map}getOverlay(t,r){return he.resolve(this.overlays.get(r))}getOverlays(t,r){const n=ko();return he.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.St(t,r,a)}),he.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),he.resolve()}getOverlaysForCollection(t,r,n){const s=ko(),a=r.length+1,i=new We(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return he.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new tr((c,f)=>c-f);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=a.get(c.largestBatchId);f===null&&(f=ko(),a=a.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=ko(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=s)););return he.resolve(o)}St(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new iF(r,n));let a=this.qr.get(r);a===void 0&&(a=ct(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(){this.sessionToken=en.EMPTY_BYTE_STRING}getSessionToken(t){return he.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,he.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(){this.Qr=new Pr(jr.$r),this.Ur=new Pr(jr.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,r){const n=new jr(t,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Gr(new jr(t,r))}zr(t,r){t.forEach(n=>this.removeReference(n,r))}jr(t){const r=new We(new Yt([])),n=new jr(r,t),s=new jr(r,t+1),a=[];return this.Ur.forEachInRange([n,s],i=>{this.Gr(i),a.push(i.key)}),a}Jr(){this.Qr.forEach(t=>this.Gr(t))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const r=new We(new Yt([])),n=new jr(r,t),s=new jr(r,t+1);let a=ct();return this.Ur.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new jr(t,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class jr{constructor(t,r){this.key=t,this.Yr=r}static $r(t,r){return We.comparator(t.key,r.key)||lt(t.Yr,r.Yr)}static Kr(t,r){return lt(t.Yr,r.Yr)||We.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $F{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Pr(jr.$r)}checkEmpty(t){return he.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new aF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.Zr=this.Zr.add(new jr(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return he.resolve(i)}lookupMutationBatch(t,r){return he.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.ei(n),a=s<0?0:s;return he.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(this.mutationQueue.length===0?jg:this.tr-1)}getAllMutationBatches(t){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new jr(r,0),s=new jr(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,s],i=>{const o=this.Xr(i.Yr);a.push(o)}),he.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new Pr(lt);return r.forEach(s=>{const a=new jr(s,0),i=new jr(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,i],o=>{n=n.add(o.Yr)})}),he.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;We.isDocumentKey(a)||(a=a.child(""));const i=new jr(new We(a),0);let o=new Pr(lt);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.Yr)),!0)},i),he.resolve(this.ti(o))}ti(t){const r=[];return t.forEach(n=>{const s=this.Xr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){Tt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return he.forEach(r.mutations,s=>{const a=new jr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.Zr=n})}ir(t){}containsKey(t,r){const n=new jr(r,0),s=this.Zr.firstAfterOrEqual(n);return he.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,he.resolve()}ni(t,r){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const r=this.ei(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(t){this.ri=t,this.docs=function(){return new tr(We.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return he.resolve(n?n.document.mutableCopy():pn.newInvalidDocument(r))}getEntries(t,r){let n=Za();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():pn.newInvalidDocument(s))}),he.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=Za();const i=r.path,o=new We(i.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||_5(v5(f),n)<=0||(s.has(f.key)||jd(r,f))&&(a=a.insert(f.key,f.mutableCopy()))}return he.resolve(a)}getAllFromCollectionGroup(t,r,n,s){Ke(9500)}ii(t,r){return he.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new GF(this)}getSize(t){return he.resolve(this.size)}}class GF extends MF{constructor(t){super(),this.Nr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(n)}),he.waitFor(r)}getFromCache(t,r){return this.Nr.getEntry(t,r)}getAllFromCache(t,r){return this.Nr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(t){this.persistence=t,this.si=new el(r=>Vg(r),Bg),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.oi=0,this._i=new Gg,this.targetCount=0,this.ai=_c.ur()}forEachTarget(t,r){return this.si.forEach((n,s)=>r(s)),he.resolve()}getLastRemoteSnapshotVersion(t){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return he.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),he.resolve()}Pr(t){this.si.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.ai=new _c(r),this.highestTargetId=r),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,r){return this.Pr(r),this.targetCount+=1,he.resolve()}updateTargetData(t,r){return this.Pr(r),he.resolve()}removeTargetData(t,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,he.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),he.waitFor(a).next(()=>s)}getTargetCount(t){return he.resolve(this.targetCount)}getTargetData(t,r){const n=this.si.get(r)||null;return he.resolve(n)}addMatchingKeys(t,r,n){return this._i.Wr(r,n),he.resolve()}removeMatchingKeys(t,r,n){this._i.zr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),he.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this._i.jr(r),he.resolve()}getMatchingKeysForTargetId(t,r){const n=this._i.Hr(r);return he.resolve(n)}containsKey(t,r){return he.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xk{constructor(t,r){this.ui={},this.overlays={},this.ci=new Fd(0),this.li=!1,this.li=!0,this.hi=new WF,this.referenceDelegate=t(this),this.Pi=new XF(this),this.indexManager=new FF,this.remoteDocumentCache=function(s){return new HF(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new CF(r),this.Ii=new UF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new zF,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.ui[t.toKey()];return n||(n=new $F(r,this.referenceDelegate),this.ui[t.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,r,n){De("MemoryPersistence","Starting transaction:",t);const s=new KF(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(a=>this.referenceDelegate.di(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ai(t,r){return he.or(Object.values(this.ui).map(n=>()=>n.containsKey(t,r)))}}class KF extends w5{constructor(t){super(),this.currentSequenceNumber=t}}class Xg{constructor(t){this.persistence=t,this.Ri=new Gg,this.Vi=null}static mi(t){return new Xg(t)}get fi(){if(this.Vi)return this.Vi;throw Ke(60996)}addReference(t,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),he.resolve()}removeReference(t,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),he.resolve()}markPotentiallyOrphaned(t,r){return this.fi.add(r.toString()),he.resolve()}removeTarget(t,r){this.Ri.jr(r.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}Ei(){this.Vi=new Set}di(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.fi,n=>{const s=We.fromPath(n);return this.gi(t,s).next(a=>{a||r.removeEntry(s,Ye.min())})}).next(()=>(this.Vi=null,r.apply(t)))}updateLimboDocument(t,r){return this.gi(t,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(t){return 0}gi(t,r){return he.or([()=>he.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Ai(t,r)])}}class Hh{constructor(t,r){this.persistence=t,this.pi=new el(n=>k5(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=LF(this,r)}static mi(t,r){return new Hh(t,r)}Ei(){}di(t){return he.resolve()}forEachTarget(t,r){return this.persistence.getTargetCache().forEachTarget(t,r)}gr(t){const r=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next(n=>r.next(s=>n+s))}wr(t){let r=0;return this.pr(t,n=>{r++}).next(()=>r)}pr(t,r){return he.forEach(this.pi,(n,s)=>this.br(t,n,s).next(a=>a?he.resolve():r(s)))}removeTargets(t,r,n){return this.persistence.getTargetCache().removeTargets(t,r,n)}removeOrphanedDocuments(t,r){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(t,i=>this.br(t,i,r).next(o=>{o||(n++,a.removeEntry(i,Ye.min()))})).next(()=>a.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,r){return this.pi.set(r,t.currentSequenceNumber),he.resolve()}removeTarget(t,r){const n=r.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,r,n){return this.pi.set(n,t.currentSequenceNumber),he.resolve()}removeReference(t,r,n){return this.pi.set(n,t.currentSequenceNumber),he.resolve()}updateLimboDocument(t,r){return this.pi.set(r,t.currentSequenceNumber),he.resolve()}Ti(t){let r=t.key.toString().length;return t.isFoundDocument()&&(r+=ah(t.data.value)),r}br(t,r,n){return he.or([()=>this.persistence.Ai(t,r),()=>this.persistence.getTargetCache().containsKey(t,r),()=>{const s=this.pi.get(r);return he.resolve(s!==void 0&&s>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.Es=n,this.ds=s}static As(t,r){let n=ct(),s=ct();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Kg(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return WI()?8:E5(UI())>0?6:4}()}initialize(t,r){this.ps=t,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.ys(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.ws(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new qF;return this.Ss(t,r,i).next(o=>{if(a.result=o,this.Vs)return this.bs(t,r,i,o.size)})}).next(()=>a.result)}bs(t,r,n,s){return n.documentReadCount<this.fs?(Cl()<=dt.DEBUG&&De("QueryEngine","SDK will not create cache indexes for query:",Il(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),he.resolve()):(Cl()<=dt.DEBUG&&De("QueryEngine","Query:",Il(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Cl()<=dt.DEBUG&&De("QueryEngine","The SDK decides to create cache indexes for query:",Il(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,xa(r))):he.resolve())}ys(t,r){if(S2(r))return he.resolve(null);let n=xa(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ux(r,null,"F"),n=xa(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=ct(...a);return this.ps.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,i,l.readTime)?this.ys(t,ux(r,null,"F")):this.vs(t,c,r,l)}))})))}ws(t,r,n,s){return S2(r)||s.isEqual(Ye.min())?he.resolve(null):this.ps.getDocuments(t,n).next(a=>{const i=this.Ds(r,a);return this.Cs(r,i,n,s)?he.resolve(null):(Cl()<=dt.DEBUG&&De("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Il(r)),this.vs(t,i,r,g5(s,i0)).next(o=>o))})}Ds(t,r){let n=new Pr(X4(t));return r.forEach((s,a)=>{jd(t,a)&&(n=n.add(a))}),n}Cs(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(t,r,n){return Cl()<=dt.DEBUG&&De("QueryEngine","Using full collection scan to execute query:",Il(r)),this.ps.getDocumentsMatchingQuery(t,r,Ui.min(),n)}vs(t,r,n,s){return this.ps.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg="LocalStore",QF=3e8;class JF{constructor(t,r,n,s){this.persistence=t,this.Fs=r,this.serializer=s,this.Ms=new tr(lt),this.xs=new el(a=>Vg(a),Bg),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(n)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new BF(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.Ms))}}function ZF(e,t,r,n){return new JF(e,t,r,n)}async function gk(e,t){const r=Ze(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.Bs(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=ct();for(const c of s){i.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of a){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:i,addedBatchIds:o}))})})}function eR(e,t){const r=Ze(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const d=c.batch,p=d.keys();let m=he.resolve();return p.forEach(g=>{m=m.next(()=>f.getEntry(l,g)).next(x=>{const _=c.docVersions.get(g);Tt(_!==null,48541),x.version.compareTo(_)<0&&(d.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),f.addEntry(x)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=ct();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function vk(e){const t=Ze(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Pi.getLastRemoteSnapshotVersion(r))}function tR(e,t){const r=Ze(e),n=t.snapshotVersion;let s=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.Ns.newChangeBuffer({trackRemovals:!0});s=r.Ms;const o=[];t.targetChanges.forEach((f,d)=>{const p=s.get(d);if(!p)return;o.push(r.Pi.removeMatchingKeys(a,f.removedDocuments,d).next(()=>r.Pi.addMatchingKeys(a,f.addedDocuments,d)));let m=p.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(en.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),s=s.insert(d,m),function(x,_,y){return x.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=QF?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(p,m,f)&&o.push(r.Pi.updateTargetData(a,m))});let l=Za(),c=ct();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,f))}),o.push(rR(a,i,t.documentUpdates).next(f=>{l=f.ks,c=f.qs})),!n.isEqual(Ye.min())){const f=r.Pi.getLastRemoteSnapshotVersion(a).next(d=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(f)}return he.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=s,a))}function rR(e,t,r){let n=ct(),s=ct();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=Za();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ye.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):De(qg,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:i,qs:s}})}function nR(e,t){const r=Ze(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=jg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function sR(e,t){const r=Ze(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Pi.getTargetData(n,t).next(a=>a?(s=a,he.resolve(s)):r.Pi.allocateTargetId(n).next(i=>(s=new ki(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(t,n.targetId)),n})}async function mx(e,t,r){const n=Ze(e),s=n.Ms.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Cc(i))throw i;De(qg,`Failed to update sequence numbers for target ${t}: ${i}`)}n.Ms=n.Ms.remove(t),n.xs.delete(s.target)}function M2(e,t,r){const n=Ze(e);let s=Ye.min(),a=ct();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,f){const d=Ze(l),p=d.xs.get(f);return p!==void 0?he.resolve(d.Ms.get(p)):d.Pi.getTargetData(c,f)}(n,i,xa(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(i,t,r?s:Ye.min(),r?a:ct())).next(o=>(aR(n,$5(t),o),{documents:o,Qs:a})))}function aR(e,t,r){let n=e.Os.get(t)||Ye.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.Os.set(t,n)}class V2{constructor(){this.activeTargetIds=Y5()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class iR{constructor(){this.Mo=new V2,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,r,n){this.xo[t]=r}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new V2,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{Oo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="ConnectivityMonitor";class U2{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){De(B2,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){De(B2,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ff=null;function xx(){return Ff===null?Ff=function(){return 268435456+Math.round(2147483648*Math.random())}():Ff++,"0x"+Ff.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="RestConnection",lR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cR{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+t.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Mh?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(t,r,n,s,a){const i=xx(),o=this.zo(t,r.toUriEncodedString());De(Mp,`Sending RPC '${t}' ${i}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,a);const{host:c}=new URL(o),f=Id(c);return this.Jo(t,o,l,n,f).then(d=>(De(Mp,`Received RPC '${t}' ${i}: `,d),d),d=>{throw mc(Mp,`RPC '${t}' ${i} failed with error: `,d,"url: ",o,"request:",n),d})}Ho(t,r,n,s,a,i){return this.Go(t,r,n,s,a)}jo(t,r,n){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ac}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),n&&n.headers.forEach((s,a)=>t[a]=s)}zo(t,r){const n=lR[t];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln="WebChannelConnection";class fR extends cR{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,r,n,s,a){const i=xx();return new Promise((o,l)=>{const c=new E4;c.setWithCredentials(!0),c.listenOnce(T4.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case sh.NO_ERROR:const d=c.getResponseJson();De(ln,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(d)),o(d);break;case sh.TIMEOUT:De(ln,`RPC '${t}' ${i} timed out`),l(new Ve(xe.DEADLINE_EXCEEDED,"Request time out"));break;case sh.HTTP_ERROR:const p=c.getStatus();if(De(ln,`RPC '${t}' ${i} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(y){const E=y.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(E)>=0?E:xe.UNKNOWN}(g.status);l(new Ve(x,g.message))}else l(new Ve(xe.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Ve(xe.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{l_:t,streamId:i,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{De(ln,`RPC '${t}' ${i} completed.`)}});const f=JSON.stringify(s);De(ln,`RPC '${t}' ${i} sending request:`,s),c.send(r,"POST",f,n,15)})}T_(t,r,n){const s=xx(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=b4(),o=S4(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=a.join("");De(ln,`Creating RPC '${t}' stream ${s}: ${f}`,l);const d=i.createWebChannel(f,l);this.I_(d);let p=!1,m=!1;const g=new uR({Yo:_=>{m?De(ln,`Not sending because RPC '${t}' stream ${s} is closed:`,_):(p||(De(ln,`Opening RPC '${t}' stream ${s} transport.`),d.open(),p=!0),De(ln,`RPC '${t}' stream ${s} sending:`,_),d.send(_))},Zo:()=>d.close()}),x=(_,y,E)=>{_.listen(y,w=>{try{E(w)}catch(R){setTimeout(()=>{throw R},0)}})};return x(d,lu.EventType.OPEN,()=>{m||(De(ln,`RPC '${t}' stream ${s} transport opened.`),g.o_())}),x(d,lu.EventType.CLOSE,()=>{m||(m=!0,De(ln,`RPC '${t}' stream ${s} transport closed`),g.a_(),this.E_(d))}),x(d,lu.EventType.ERROR,_=>{m||(m=!0,mc(ln,`RPC '${t}' stream ${s} transport errored. Name:`,_.name,"Message:",_.message),g.a_(new Ve(xe.UNAVAILABLE,"The operation could not be completed")))}),x(d,lu.EventType.MESSAGE,_=>{var y;if(!m){const E=_.data[0];Tt(!!E,16349);const w=E,R=(w==null?void 0:w.error)||((y=w[0])==null?void 0:y.error);if(R){De(ln,`RPC '${t}' stream ${s} received error:`,R);const V=R.status;let L=function(b){const F=_r[b];if(F!==void 0)return ak(F)}(V),T=R.message;L===void 0&&(L=xe.INTERNAL,T="Unknown error status: "+V+" with message "+R.message),m=!0,g.a_(new Ve(L,T)),d.close()}else De(ln,`RPC '${t}' stream ${s} received:`,E),g.u_(E)}}),x(o,k4.STAT_EVENT,_=>{_.stat===sx.PROXY?De(ln,`RPC '${t}' stream ${s} detected buffering proxy`):_.stat===sx.NOPROXY&&De(ln,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.__()},0),g}terminate(){this.c_.forEach(t=>t.close()),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter(r=>r===t)}}function Vp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(e){return new mF(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(t,r,n=1e3,s=1.5,a=6e4){this.Mi=t,this.timerId=r,this.d_=n,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,r-n);s>0&&De("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),t())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="PersistentStream";class yk{constructor(t,r,n,s,a,i,o,l){this.Mi=t,this.S_=n,this.b_=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _k(t,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():r&&r.code===xe.RESOURCE_EXHAUSTED?(Ja(r.toString()),Ja("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(r)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===r&&this.G_(n,s)},n=>{t(()=>{const s=new Ve(xe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(t,r){const n=this.W_(this.D_);this.stream=this.j_(t,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(t){return De(z2,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return r=>{this.Mi.enqueueAndForget(()=>this.D_===t?r():(De(z2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hR extends yk{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}j_(t,r){return this.connection.T_("Listen",t,r)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const r=vF(this.serializer,t),n=function(a){if(!("targetChange"in a))return Ye.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Ye.min():i.readTime?ga(i.readTime):Ye.min()}(t);return this.listener.H_(r,n)}Y_(t){const r={};r.database=px(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=cx(l)?{documents:wF(a,l)}:{query:EF(a,l).ft},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=lk(a,i.resumeToken);const c=fx(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Ye.min())>0){o.readTime=$h(a,i.snapshotVersion.toTimestamp());const c=fx(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=kF(this.serializer,t);n&&(r.labels=n),this.q_(r)}Z_(t){const r={};r.database=px(this.serializer),r.removeTarget=t,this.q_(r)}}class dR extends yk{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,r){return this.connection.T_("Write",t,r)}J_(t){return Tt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,Tt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){Tt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const r=yF(t.writeResults,t.commitTime),n=ga(t.commitTime);return this.listener.na(n,r)}ra(){const t={};t.database=px(this.serializer),this.q_(t)}ea(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>_F(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{}class mR extends pR{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Ve(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,r,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Go(t,hx(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ve(xe.UNKNOWN,a.toString())})}Ho(t,r,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(t,hx(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ve(xe.UNKNOWN,i.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class xR{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ja(r),this.aa=!1):De("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="RemoteStore";class gR{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(i=>{n.enqueueAndForget(async()=>{rl(this)&&(De(Uo,"Restarting streams for network reachability change."),await async function(l){const c=Ze(l);c.Ea.add(4),await L0(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Ud(c)}(this))})}),this.Ra=new xR(n,s)}}async function Ud(e){if(rl(e))for(const t of e.da)await t(!0)}async function L0(e){for(const t of e.da)await t(!1)}function wk(e,t){const r=Ze(e);r.Ia.has(t.targetId)||(r.Ia.set(t.targetId,t),Zg(r)?Jg(r):Ic(r).O_()&&Qg(r,t))}function Yg(e,t){const r=Ze(e),n=Ic(r);r.Ia.delete(t),n.O_()&&Ek(r,t),r.Ia.size===0&&(n.O_()?n.L_():rl(r)&&r.Ra.set("Unknown"))}function Qg(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ye.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Ic(e).Y_(t)}function Ek(e,t){e.Va.Ue(t),Ic(e).Z_(t)}function Jg(e){e.Va=new fF({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Ic(e).start(),e.Ra.ua()}function Zg(e){return rl(e)&&!Ic(e).x_()&&e.Ia.size>0}function rl(e){return Ze(e).Ea.size===0}function Tk(e){e.Va=void 0}async function vR(e){e.Ra.set("Online")}async function _R(e){e.Ia.forEach((t,r)=>{Qg(e,t)})}async function yR(e,t){Tk(e),Zg(e)?(e.Ra.ha(t),Jg(e)):e.Ra.set("Unknown")}async function wR(e,t,r){if(e.Ra.set("Online"),t instanceof ok&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.Ia.delete(o),s.Va.removeTarget(o))}(e,t)}catch(n){De(Uo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Gh(e,n)}else if(t instanceof lh?e.Va.Ze(t):t instanceof ik?e.Va.st(t):e.Va.tt(t),!r.isEqual(Ye.min()))try{const n=await vk(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Va.Tt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=a.Ia.get(c);f&&a.Ia.set(c,f.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const f=a.Ia.get(l);if(!f)return;a.Ia.set(l,f.withResumeToken(en.EMPTY_BYTE_STRING,f.snapshotVersion)),Ek(a,l);const d=new ki(f.target,l,c,f.sequenceNumber);Qg(a,d)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){De(Uo,"Failed to raise snapshot:",n),await Gh(e,n)}}async function Gh(e,t,r){if(!Cc(t))throw t;e.Ea.add(1),await L0(e),e.Ra.set("Offline"),r||(r=()=>vk(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{De(Uo,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await Ud(e)})}function kk(e,t){return t().catch(r=>Gh(e,r,t))}async function zd(e){const t=Ze(e),r=Hi(t);let n=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:jg;for(;ER(t);)try{const s=await nR(t.localStore,n);if(s===null){t.Ta.length===0&&r.L_();break}n=s.batchId,TR(t,s)}catch(s){await Gh(t,s)}Sk(t)&&bk(t)}function ER(e){return rl(e)&&e.Ta.length<10}function TR(e,t){e.Ta.push(t);const r=Hi(e);r.O_()&&r.X_&&r.ea(t.mutations)}function Sk(e){return rl(e)&&!Hi(e).x_()&&e.Ta.length>0}function bk(e){Hi(e).start()}async function kR(e){Hi(e).ra()}async function SR(e){const t=Hi(e);for(const r of e.Ta)t.ea(r.mutations)}async function bR(e,t,r){const n=e.Ta.shift(),s=Wg.from(n,t,r);await kk(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await zd(e)}async function AR(e,t){t&&Hi(e).X_&&await async function(n,s){if(function(i){return lF(i)&&i!==xe.ABORTED}(s.code)){const a=n.Ta.shift();Hi(n).B_(),await kk(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await zd(n)}}(e,t),Sk(e)&&bk(e)}async function W2(e,t){const r=Ze(e);r.asyncQueue.verifyOperationInProgress(),De(Uo,"RemoteStore received new credentials");const n=rl(r);r.Ea.add(3),await L0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ea.delete(3),await Ud(r)}async function NR(e,t){const r=Ze(e);t?(r.Ea.delete(2),await Ud(r)):t||(r.Ea.add(2),await L0(r),r.Ra.set("Unknown"))}function Ic(e){return e.ma||(e.ma=function(r,n,s){const a=Ze(r);return a.sa(),new hR(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Xo:vR.bind(null,e),t_:_R.bind(null,e),r_:yR.bind(null,e),H_:wR.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Zg(e)?Jg(e):e.Ra.set("Unknown")):(await e.ma.stop(),Tk(e))})),e.ma}function Hi(e){return e.fa||(e.fa=function(r,n,s){const a=Ze(r);return a.sa(),new dR(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:kR.bind(null,e),r_:AR.bind(null,e),ta:SR.bind(null,e),na:bR.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await zd(e)):(await e.fa.stop(),e.Ta.length>0&&(De(Uo,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new Co,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new e1(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(xe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function t1(e,t){if(Ja("AsyncQueue",`${t}: ${e}`),Cc(e))return new Ve(xe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static emptySet(t){return new ec(t.comparator)}constructor(t){this.comparator=t?(r,n)=>t(r,n)||We.comparator(r.key,n.key):(r,n)=>We.comparator(r.key,n.key),this.keyedMap=cu(),this.sortedSet=new tr(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof ec)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new ec;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(){this.ga=new tr(We.comparator)}track(t){const r=t.doc.key,n=this.ga.get(r);n?t.type!==0&&n.type===3?this.ga=this.ga.insert(r,t):t.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.ga=this.ga.remove(r):t.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:t.doc}):Ke(63341,{Rt:t,pa:n}):this.ga=this.ga.insert(r,t)}ya(){const t=[];return this.ga.inorderTraversal((r,n)=>{t.push(n)}),t}}class yc{constructor(t,r,n,s,a,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new yc(t,r,ec.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Od(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(t=>t.Da())}}class IR{constructor(){this.queries=H2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const s=Ze(r),a=s.queries;s.queries=H2(),a.forEach((i,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new Ve(xe.ABORTED,"Firestore shutting down"))}}function H2(){return new el(e=>G4(e),Od)}async function FR(e,t){const r=Ze(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.ba()&&t.Da()&&(n=2):(a=new CR,n=t.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(s,!0);break;case 1:a.wa=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=t1(i,`Initialization of query '${Il(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.Sa.push(t),t.va(r.onlineState),a.wa&&t.Fa(a.wa)&&r1(r)}async function RR(e,t){const r=Ze(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.Sa.indexOf(t);i>=0&&(a.Sa.splice(i,1),a.Sa.length===0?s=t.Da()?0:1:!a.ba()&&t.Da()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function PR(e,t){const r=Ze(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.Sa)o.Fa(s)&&(n=!0);i.wa=s}}n&&r1(r)}function DR(e,t,r){const n=Ze(e),s=n.queries.get(t);if(s)for(const a of s.Sa)a.onError(r);n.queries.delete(t)}function r1(e){e.Ca.forEach(t=>{t.next()})}var gx,G2;(G2=gx||(gx={})).Ma="default",G2.Cache="cache";class OR{constructor(t,r,n){this.query=t,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new yc(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),r=!0):this.La(t,this.onlineState)&&(this.ka(t),r=!0),this.Na=t,r}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),r=!0),r}La(t,r){if(!t.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(t){t=yc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==gx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(t){this.key=t}}class Nk{constructor(t){this.key=t}}class jR{constructor(t,r){this.query=t,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ct(),this.mutatedKeys=ct(),this.eu=X4(t),this.tu=new ec(this.eu)}get nu(){return this.Ya}ru(t,r){const n=r?r.iu:new $2,s=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((f,d)=>{const p=s.get(f),m=jd(this.query,d)?d:null,g=!!p&&this.mutatedKeys.has(p.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let _=!1;p&&m?p.data.isEqual(m.data)?g!==x&&(n.track({type:3,doc:m}),_=!0):this.su(p,m)||(n.track({type:2,doc:m}),_=!0,(l&&this.eu(m,l)>0||c&&this.eu(m,c)<0)&&(o=!0)):!p&&m?(n.track({type:0,doc:m}),_=!0):p&&!m&&(n.track({type:1,doc:p}),_=!0,(l||c)&&(o=!0)),_&&(m?(i=i.add(m),a=x?a.add(f):a.delete(f)):(i=i.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{tu:i,iu:n,Cs:o,mutatedKeys:a}}su(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const i=t.iu.ya();i.sort((f,d)=>function(m,g){const x=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{Rt:_})}};return x(m)-x(g)}(f.type,d.type)||this.eu(f.doc,d.doc)),this.ou(n),s=s!=null?s:!1;const o=r&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,i.length!==0||c?{snapshot:new yc(this.query,t.tu,a,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $2,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=ct(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return t.forEach(n=>{this.Xa.has(n)||r.push(new Nk(n))}),this.Xa.forEach(n=>{t.has(n)||r.push(new Ak(n))}),r}cu(t){this.Ya=t.Qs,this.Xa=ct();const r=this.ru(t.documents);return this.applyChanges(r,!0)}lu(){return yc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const n1="SyncEngine";class LR{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class MR{constructor(t){this.key=t,this.hu=!1}}class VR{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new el(o=>G4(o),Od),this.Iu=new Map,this.Eu=new Set,this.du=new tr(We.comparator),this.Au=new Map,this.Ru=new Gg,this.Vu={},this.mu=new Map,this.fu=_c.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function BR(e,t,r=!0){const n=Dk(e);let s;const a=n.Tu.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await Ck(n,t,r,!0),s}async function UR(e,t){const r=Dk(e);await Ck(r,t,!0,!1)}async function Ck(e,t,r,n){const s=await sR(e.localStore,xa(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await zR(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&wk(e.remoteStore,s),o}async function zR(e,t,r,n,s){e.pu=(d,p,m)=>async function(x,_,y,E){let w=_.view.ru(y);w.Cs&&(w=await M2(x.localStore,_.query,!1).then(({documents:T})=>_.view.ru(T,w)));const R=E&&E.targetChanges.get(_.targetId),V=E&&E.targetMismatches.get(_.targetId)!=null,L=_.view.applyChanges(w,x.isPrimaryClient,R,V);return K2(x,_.targetId,L.au),L.snapshot}(e,d,p,m);const a=await M2(e.localStore,t,!0),i=new jR(t,a.Qs),o=i.ru(a.documents),l=j0.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),c=i.applyChanges(o,e.isPrimaryClient,l);K2(e,r,c.au);const f=new LR(t,r,i);return e.Tu.set(t,f),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),c.snapshot}async function WR(e,t,r){const n=Ze(e),s=n.Tu.get(t),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter(i=>!Od(i,t))),void n.Tu.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await mx(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Yg(n.remoteStore,s.targetId),vx(n,s.targetId)}).catch(Nc)):(vx(n,s.targetId),await mx(n.localStore,s.targetId,!0))}async function $R(e,t){const r=Ze(e),n=r.Tu.get(t),s=r.Iu.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Yg(r.remoteStore,n.targetId))}async function HR(e,t,r){const n=JR(e);try{const s=await function(i,o){const l=Ze(i),c=zt.now(),f=o.reduce((m,g)=>m.add(g.key),ct());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Za(),x=ct();return l.Ns.getEntries(m,f).next(_=>{g=_,g.forEach((y,E)=>{E.isValidDocument()||(x=x.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,g)).next(_=>{d=_;const y=[];for(const E of o){const w=nF(E,d.get(E.key).overlayedDocument);w!=null&&y.push(new tl(E.key,w,V4(w.value.mapValue),Wa.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,y,o)}).next(_=>{p=_;const y=_.applyToLocalDocumentSet(d,x);return l.documentOverlayCache.saveOverlays(m,_.batchId,y)})}).then(()=>({batchId:p.batchId,changes:q4(d)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Vu[i.currentUser.toKey()];c||(c=new tr(lt)),c=c.insert(o,l),i.Vu[i.currentUser.toKey()]=c}(n,s.batchId,r),await M0(n,s.changes),await zd(n.remoteStore)}catch(s){const a=t1(s,"Failed to persist write");r.reject(a)}}async function Ik(e,t){const r=Ze(e);try{const n=await tR(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Au.get(a);i&&(Tt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?i.hu=!0:s.modifiedDocuments.size>0?Tt(i.hu,14607):s.removedDocuments.size>0&&(Tt(i.hu,42227),i.hu=!1))}),await M0(r,n,t)}catch(n){await Nc(n)}}function X2(e,t,r){const n=Ze(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Tu.forEach((a,i)=>{const o=i.view.va(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Ze(i);l.onlineState=o;let c=!1;l.queries.forEach((f,d)=>{for(const p of d.Sa)p.va(o)&&(c=!0)}),c&&r1(l)}(n.eventManager,t),s.length&&n.Pu.H_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function GR(e,t,r){const n=Ze(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Au.get(t),a=s&&s.key;if(a){let i=new tr(We.comparator);i=i.insert(a,pn.newNoDocument(a,Ye.min()));const o=ct().add(a),l=new Vd(Ye.min(),new Map,new tr(lt),i,o);await Ik(n,l),n.du=n.du.remove(a),n.Au.delete(t),s1(n)}else await mx(n.localStore,t,!1).then(()=>vx(n,t,r)).catch(Nc)}async function XR(e,t){const r=Ze(e),n=t.batch.batchId;try{const s=await eR(r.localStore,t);Rk(r,n,null),Fk(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await M0(r,s)}catch(s){await Nc(s)}}async function KR(e,t,r){const n=Ze(e);try{const s=await function(i,o){const l=Ze(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(d=>(Tt(d!==null,37113),f=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,t);Rk(n,t,r),Fk(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await M0(n,s)}catch(s){await Nc(s)}}function Fk(e,t){(e.mu.get(t)||[]).forEach(r=>{r.resolve()}),e.mu.delete(t)}function Rk(e,t,r){const n=Ze(e);let s=n.Vu[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Vu[n.currentUser.toKey()]=s}}function vx(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Iu.get(t))e.Tu.delete(n),r&&e.Pu.yu(n,r);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(n=>{e.Ru.containsKey(n)||Pk(e,n)})}function Pk(e,t){e.Eu.delete(t.path.canonicalString());const r=e.du.get(t);r!==null&&(Yg(e.remoteStore,r),e.du=e.du.remove(t),e.Au.delete(r),s1(e))}function K2(e,t,r){for(const n of r)n instanceof Ak?(e.Ru.addReference(n.key,t),qR(e,n)):n instanceof Nk?(De(n1,"Document no longer in limbo: "+n.key),e.Ru.removeReference(n.key,t),e.Ru.containsKey(n.key)||Pk(e,n.key)):Ke(19791,{wu:n})}function qR(e,t){const r=t.key,n=r.path.canonicalString();e.du.get(r)||e.Eu.has(n)||(De(n1,"New document in limbo: "+r),e.Eu.add(n),s1(e))}function s1(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const r=new We(Yt.fromString(t)),n=e.fu.next();e.Au.set(n,new MR(r)),e.du=e.du.insert(r,n),wk(e.remoteStore,new ki(xa(Ug(r.path)),n,"TargetPurposeLimboResolution",Fd.ce))}}async function M0(e,t,r){const n=Ze(e),s=[],a=[],i=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{i.push(n.pu(l,t,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const d=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))==null?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=Kg.As(l.targetId,c);a.push(d)}}))}),await Promise.all(i),n.Pu.H_(s),await async function(l,c){const f=Ze(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>he.forEach(c,p=>he.forEach(p.Es,m=>f.persistence.referenceDelegate.addReference(d,p.targetId,m)).next(()=>he.forEach(p.ds,m=>f.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))}catch(d){if(!Cc(d))throw d;De(qg,"Failed to update sequence numbers: "+d)}for(const d of c){const p=d.targetId;if(!d.fromCache){const m=f.Ms.get(p),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);f.Ms=f.Ms.insert(p,x)}}}(n.localStore,a))}async function YR(e,t){const r=Ze(e);if(!r.currentUser.isEqual(t)){De(n1,"User change. New user:",t.toKey());const n=await gk(r.localStore,t);r.currentUser=t,function(a,i){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new Ve(xe.CANCELLED,i))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await M0(r,n.Ls)}}function QR(e,t){const r=Ze(e),n=r.Au.get(t);if(n&&n.hu)return ct().add(n.key);{let s=ct();const a=r.Iu.get(t);if(!a)return s;for(const i of a){const o=r.Tu.get(i);s=s.unionWith(o.view.nu)}return s}}function Dk(e){const t=Ze(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ik.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=QR.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=GR.bind(null,t),t.Pu.H_=PR.bind(null,t.eventManager),t.Pu.yu=DR.bind(null,t.eventManager),t}function JR(e){const t=Ze(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=XR.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=KR.bind(null,t),t}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Bd(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return ZF(this.persistence,new YF,t.initialUser,this.serializer)}Cu(t){return new xk(Xg.mi,this.serializer)}Du(t){return new iR}async terminate(){var t,r;(t=this.gcScheduler)==null||t.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class ZR extends Xh{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,r){Tt(this.persistence.referenceDelegate instanceof Hh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new OF(n,t.asyncQueue,r)}Cu(t){const r=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new xk(n=>Hh.mi(n,r),this.serializer)}}class _x{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>X2(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YR.bind(null,this.syncEngine),await NR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new IR}()}createDatastore(t){const r=Bd(t.databaseInfo.databaseId),n=function(a){return new fR(a)}(t.databaseInfo);return function(a,i,o,l){return new mR(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new gR(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>X2(this.syncEngine,r,0),function(){return U2.v()?new U2:new oR}())}createSyncEngine(t,r){return function(s,a,i,o,l,c,f){const d=new VR(s,a,i,o,l,c);return f&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=Ze(s);De(Uo,"RemoteStore shutting down."),a.Ea.add(5),await L0(a),a.Aa.shutdown(),a.Ra.set("Unknown")}(this.remoteStore),(t=this.datastore)==null||t.terminate(),(r=this.eventManager)==null||r.terminate()}}_x.provider={build:()=>new _x};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Ja("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi="FirestoreClient";class t8{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=un.UNAUTHENTICATED,this.clientId=Dg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{De(Gi,"Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(De(Gi,"Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Co;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=t1(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Bp(e,t){e.asyncQueue.verifyOperationInProgress(),De(Gi,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await gk(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function q2(e,t){e.asyncQueue.verifyOperationInProgress();const r=await r8(e);De(Gi,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>W2(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>W2(t.remoteStore,s)),e._onlineComponents=t}async function r8(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){De(Gi,"Using user provided OfflineComponentProvider");try{await Bp(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===xe.FAILED_PRECONDITION||s.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;mc("Error using user provided cache. Falling back to memory cache: "+r),await Bp(e,new Xh)}}else De(Gi,"Using default OfflineComponentProvider"),await Bp(e,new ZR(void 0));return e._offlineComponents}async function Ok(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(De(Gi,"Using user provided OnlineComponentProvider"),await q2(e,e._uninitializedComponentsProvider._online)):(De(Gi,"Using default OnlineComponentProvider"),await q2(e,new _x))),e._onlineComponents}function n8(e){return Ok(e).then(t=>t.syncEngine)}async function Y2(e){const t=await Ok(e),r=t.eventManager;return r.onListen=BR.bind(null,t.syncEngine),r.onUnlisten=WR.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=UR.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=$R.bind(null,t.syncEngine),r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk="firestore.googleapis.com",J2=!0;class Z2{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Ve(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Lk,this.ssl=J2}else this.host=t.host,this.ssl=(r=t.ssl)!=null?r:J2;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=mk;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<PF)throw new Ve(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}x5("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jk((n=t.experimentalLongPollingOptions)!=null?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ve(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class a1{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Z2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ve(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Z2(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new a5;switch(n.type){case"firstParty":return new c5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ve(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Q2.get(r);n&&(De("ComponentProvider","Removing Datastore"),Q2.delete(r),n.terminate())}(this),Promise.resolve()}}function s8(e,t,r,n={}){var c;e=Zl(e,a1);const s=Id(t),a=e._getSettings(),i={...a,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;s&&(o4(`https://${o}`),c4("Firestore",!0)),a.host!==Lk&&a.host!==o&&mc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:s,emulatorOptions:n};if(!Oh(l,i)&&(e._setSettings(l),n.mockUserToken)){let f,d;if(typeof n.mockUserToken=="string")f=n.mockUserToken,d=un.MOCK_USER;else{f=l4(n.mockUserToken,(c=e._app)==null?void 0:c.options.projectId);const p=n.mockUserToken.sub||n.mockUserToken.user_id;if(!p)throw new Ve(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new un(p)}e._authCredentials=new i5(new N4(f,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Wd(this.firestore,t,this._query)}}class Br{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new h0(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Br(this.firestore,t,this._key)}toJSON(){return{type:Br._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,r,n){if(D0(r,Br._jsonSchema))return new Br(t,n||null,new We(Yt.fromString(r.referencePath)))}}Br._jsonSchemaVersion="firestore/documentReference/1.0",Br._jsonSchema={type:Tr("string",Br._jsonSchemaVersion),referencePath:Tr("string")};class h0 extends Wd{constructor(t,r,n){super(t,r,Ug(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Br(this.firestore,null,new We(t))}withConverter(t){return new h0(this.firestore,t,this._path)}}function ey(e,t,...r){if(e=dc(e),arguments.length===1&&(t=Dg.newId()),m5("doc","path",t),e instanceof a1){const n=Yt.fromString(t,...r);return h2(n),new Br(e,null,new We(n))}{if(!(e instanceof Br||e instanceof h0))throw new Ve(xe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Yt.fromString(t,...r));return h2(n),new Br(e.firestore,e instanceof h0?e.converter:null,new We(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="AsyncQueue";class ry{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _k(this,"async_queue_retry"),this._c=()=>{const n=Vp();n&&De(ty,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=t;const r=Vp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const r=Vp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Co;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Xu.push(t),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Cc(t))throw t;De(ty,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(t){const r=this.ac.then(()=>(this.rc=!0,t().catch(n=>{throw this.nc=n,this.rc=!1,Ja("INTERNAL UNHANDLED ERROR: ",ny(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(t,r,n){this.uc(),this.oc.indexOf(t)>-1&&(r=0);const s=e1.createAndSchedule(this,t,r,n,a=>this.hc(a));return this.tc.push(s),s}uc(){this.nc&&Ke(47125,{Pc:ny(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const r of this.tc)if(r.timerId===t)return!0;return!1}Ec(t){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.Tc()})}dc(t){this.oc.push(t)}hc(t){const r=this.tc.indexOf(t);this.tc.splice(r,1)}}function ny(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class Kh extends a1{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new ry,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ry(t),this._firestoreClient=void 0,await t}}}function a8(e,t){const r=typeof e=="object"?e:v4(),n=typeof e=="string"?e:Mh,s=p4(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=a4("firestore");a&&s8(s,...a)}return s}function Mk(e){if(e._terminated)throw new Ve(xe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||i8(e),e._firestoreClient}function i8(e){var n,s,a;const t=e._freezeSettings(),r=function(o,l,c,f){return new A5(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,jk(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(e._databaseId,((n=e._app)==null?void 0:n.options.appId)||"",e._persistenceKey,t);e._componentsProvider||(s=t.localCache)!=null&&s._offlineComponentProvider&&((a=t.localCache)!=null&&a._onlineComponentProvider)&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new t8(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ws(en.fromBase64String(t))}catch(r){throw new Ve(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new ws(en.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(D0(t,ws._jsonSchema))return ws.fromBase64String(t.bytes)}}ws._jsonSchemaVersion="firestore/bytes/1.0",ws._jsonSchema={type:Tr("string",ws._jsonSchemaVersion),bytes:Tr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Ve(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Ve(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Ve(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return lt(this._lat,t._lat)||lt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:va._jsonSchemaVersion}}static fromJSON(t){if(D0(t,va._jsonSchema))return new va(t.latitude,t.longitude)}}va._jsonSchemaVersion="firestore/geoPoint/1.0",va._jsonSchema={type:Tr("string",va._jsonSchemaVersion),latitude:Tr("number"),longitude:Tr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}toJSON(){return{type:_a._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(D0(t,_a._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(r=>typeof r=="number"))return new _a(t.vectorValues);throw new Ve(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_a._jsonSchemaVersion="firestore/vectorValue/1.0",_a._jsonSchema={type:Tr("string",_a._jsonSchemaVersion),vectorValues:Tr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o8=/^__.*__$/;class l8{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new tl(t,this.data,this.fieldMask,r,this.fieldTransforms):new O0(t,this.data,r,this.fieldTransforms)}}function Bk(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ac:e})}}class o1{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new o1({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){var s;const r=(s=this.path)==null?void 0:s.child(t),n=this.Vc({path:r,fc:!1});return n.gc(t),n}yc(t){var s;const r=(s=this.path)==null?void 0:s.child(t),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return qh(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(Bk(this.Ac)&&o8.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class c8{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||Bd(t)}Cc(t,r,n,s=!1){return new o1({Ac:t,methodName:r,Dc:n,path:Yr.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function u8(e){const t=e._freezeSettings(),r=Bd(e._databaseId);return new c8(e._databaseId,!!t.ignoreUndefinedProperties,r)}function f8(e,t,r,n,s,a={}){const i=e.Cc(a.merge||a.mergeFields?2:0,t,r,s);$k("Data must be an object, but it was:",i,n);const o=zk(n,i);let l,c;if(a.merge)l=new Us(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const f=[];for(const d of a.mergeFields){const p=h8(t,d,r);if(!i.contains(p))throw new Ve(xe.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);p8(f,p)||f.push(p)}l=new Us(f),c=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=i.fieldTransforms;return new l8(new ys(o),l,c)}function Uk(e,t){if(Wk(e=dc(e)))return $k("Unsupported field value:",t,e),zk(e,t);if(e instanceof Vk)return function(n,s){if(!Bk(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Uk(o,s.wc(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=dc(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Q5(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=zt.fromDate(n);return{timestampValue:$h(s.serializer,a)}}if(n instanceof zt){const a=new zt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$h(s.serializer,a)}}if(n instanceof va)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ws)return{bytesValue:lk(s.serializer,n._byteString)};if(n instanceof Br){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Hg(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof _a)return function(i,o){return{mapValue:{fields:{[L4]:{stringValue:M4},[Vh]:{arrayValue:{values:i.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return zg(o.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${Og(n)}`)}(e,t)}function zk(e,t){const r={};return F4(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Zo(e,(n,s)=>{const a=Uk(s,t.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function Wk(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof zt||e instanceof va||e instanceof ws||e instanceof Br||e instanceof Vk||e instanceof _a)}function $k(e,t,r){if(!Wk(r)||!C4(r)){const n=Og(r);throw n==="an object"?t.Sc(e+" a custom object"):t.Sc(e+" "+n)}}function h8(e,t,r){if((t=dc(t))instanceof i1)return t._internalPath;if(typeof t=="string")return Hk(e,t);throw qh("Field path arguments must be of type string or ",e,!1,void 0,r)}const d8=new RegExp("[~\\*/\\[\\]]");function Hk(e,t,r){if(t.search(d8)>=0)throw qh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new i1(...t.split("."))._internalPath}catch{throw qh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function qh(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Ve(xe.INVALID_ARGUMENT,o+e+l)}function p8(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Br(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new m8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(Xk("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class m8 extends Gk{data(){return super.data()}}function Xk(e,t){return typeof t=="string"?Hk(e,t):t instanceof i1?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x8(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Ve(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class g8{convertValue(t,r="none"){switch($i(t)){case 0:return null;case 1:return t.booleanValue;case 2:return hr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Wi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Ke(62114,{value:t})}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return Zo(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var n,s,a;const r=(a=(s=(n=t.fields)==null?void 0:n[Vh].arrayValue)==null?void 0:s.values)==null?void 0:a.map(i=>hr(i.doubleValue));return new _a(r)}convertGeoPoint(t){return new va(hr(t.latitude),hr(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=Pd(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(o0(t));default:return null}}convertTimestamp(t){const r=zi(t);return new zt(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Yt.fromString(t);Tt(pk(n),9688,{name:t});const s=new l0(n.get(1),n.get(3)),a=new We(n.popFirst(5));return s.isEqual(r)||Ja(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v8(e,t,r){let n;return n=e?e.toFirestore(t):t,n}class fu{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Io extends Gk{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new ch(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(Xk("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,r={};return r.type=Io._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Io._jsonSchemaVersion="firestore/documentSnapshot/1.0",Io._jsonSchema={type:Tr("string",Io._jsonSchemaVersion),bundleSource:Tr("string","DocumentSnapshot"),bundleName:Tr("string"),bundle:Tr("string")};class ch extends Io{data(t={}){return super.data(t)}}class tc{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new fu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new ch(this._firestore,this._userDataWriter,n.key,n,new fu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ve(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new ch(s._firestore,s._userDataWriter,o.doc.key,o.doc,new fu(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new ch(s._firestore,s._userDataWriter,o.doc.key,o.doc,new fu(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),f=i.indexOf(o.doc.key)),{type:_8(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=tc._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Dg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],s=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function _8(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:e})}}tc._jsonSchemaVersion="firestore/querySnapshot/1.0",tc._jsonSchema={type:Tr("string",tc._jsonSchemaVersion),bundleSource:Tr("string","QuerySnapshot"),bundleName:Tr("string"),bundle:Tr("string")};class Kk extends g8{constructor(t){super(),this.firestore=t}convertBytes(t){return new ws(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Br(this.firestore,null,r)}}function y8(e,t,r){e=Zl(e,Br);const n=Zl(e.firestore,Kh),s=v8(e.converter,t);return E8(n,[f8(u8(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Wa.none())])}function w8(e,...t){var l,c,f;e=dc(e);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof t[n]!="object"||sy(t[n])||(r=t[n++]);const s={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(sy(t[n])){const d=t[n];t[n]=(l=d.next)==null?void 0:l.bind(d),t[n+1]=(c=d.error)==null?void 0:c.bind(d),t[n+2]=(f=d.complete)==null?void 0:f.bind(d)}let a,i,o;if(e instanceof Br)i=Zl(e.firestore,Kh),o=Ug(e._key.path),a={next:d=>{t[n]&&t[n](T8(i,e,d))},error:t[n+1],complete:t[n+2]};else{const d=Zl(e,Wd);i=Zl(d.firestore,Kh),o=d._query;const p=new Kk(i);a={next:m=>{t[n]&&t[n](new tc(i,p,d,m))},error:t[n+1],complete:t[n+2]},x8(e._query)}return function(p,m,g,x){const _=new e8(x),y=new OR(m,_,g);return p.asyncQueue.enqueueAndForget(async()=>FR(await Y2(p),y)),()=>{_.Nu(),p.asyncQueue.enqueueAndForget(async()=>RR(await Y2(p),y))}}(Mk(i),o,s,a)}function E8(e,t){return function(n,s){const a=new Co;return n.asyncQueue.enqueueAndForget(async()=>HR(await n8(n),s,a)),a.promise}(Mk(e),t)}function T8(e,t,r){const n=r.docs.get(t._key),s=new Kk(e);return new Io(e,s,t._key,n,new fu(r.hasPendingWrites,r.fromCache),t.converter)}(function(t,r=!0){(function(s){Ac=s})(x4),s0(new pc("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new Kh(new o5(n.getProvider("auth-internal")),new u5(i,n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ve(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new l0(c.options.projectId,f)}(i,s),i);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Li(l2,c2,t),Li(l2,c2,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk="firebasestorage.googleapis.com",k8="storageBucket",S8=2*60*1e3,b8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta extends Jo{constructor(t,r,n=0){super(Up(t),`Firebase Storage: ${r} (${Up(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ta.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Up(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ea;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ea||(Ea={}));function Up(e){return"storage/"+e}function A8(){const e="An unknown error occurred, please check the error payload for server response.";return new Ta(Ea.UNKNOWN,e)}function N8(){return new Ta(Ea.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function C8(){return new Ta(Ea.CANCELED,"User canceled the upload/download.")}function I8(e){return new Ta(Ea.INVALID_URL,"Invalid URL '"+e+"'.")}function F8(e){return new Ta(Ea.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function ay(e){return new Ta(Ea.INVALID_ARGUMENT,e)}function Yk(){return new Ta(Ea.APP_DELETED,"The Firebase app was deleted.")}function R8(e){return new Ta(Ea.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=zs.makeFromUrl(t,r)}catch{return new zs(t,"")}if(n.path==="")return n;throw F8(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(R){R.path_=decodeURIComponent(R.path)}const f="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${d}/${f}/b/${s}/o${p}`,"i"),g={bucket:1,path:3},x=r===qk?"(?:storage.googleapis.com|storage.cloud.google.com)":r,_="([^?#]*)",y=new RegExp(`^https?://${x}/${s}/${_}`,"i"),w=[{regex:o,indices:l,postModify:a},{regex:m,indices:g,postModify:c},{regex:y,indices:{bucket:1,path:2},postModify:c}];for(let R=0;R<w.length;R++){const V=w[R],L=V.regex.exec(t);if(L){const T=L[V.indices.bucket];let S=L[V.indices.path];S||(S=""),n=new zs(T,S),V.postModify(n);break}}if(n==null)throw I8(t);return n}}class P8{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D8(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function f(..._){c||(c=!0,t.apply(null,_))}function d(_){s=setTimeout(()=>{s=null,e(m,l())},_)}function p(){a&&clearTimeout(a)}function m(_,...y){if(c){p();return}if(_){p(),f.call(null,_,...y);return}if(l()||i){p(),f.call(null,_,...y);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,d(w)}let g=!1;function x(_){g||(g=!0,p(),!c&&(s!==null?(_||(o=2),clearTimeout(s),d(0)):_||(o=1)))}return d(0),a=setTimeout(()=>{i=!0,x(!0)},r),x}function O8(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(e){return e!==void 0}function iy(e,t,r,n){if(n<t)throw ay(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw ay(`Invalid value for '${e}'. Expected ${r} or less.`)}function L8(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Yh;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Yh||(Yh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M8(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(t,r,n,s,a,i,o,l,c,f,d,p=!0,m=!1){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=f,this.connectionFactory_=d,this.retry=p,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Rf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===Yh.NO_ERROR,l=a.getStatus();if(!o||M8(l,this.additionalRetryCodes_)&&this.retry){const f=a.getErrorCode()===Yh.ABORT;n(!1,new Rf(!1,null,f));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Rf(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());j8(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=A8();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?Yk():C8();i(l)}else{const l=N8();i(l)}};this.canceled_?r(!1,new Rf(!1,null,!0)):this.backoffId_=D8(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&O8(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Rf{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function B8(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function U8(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t!=null?t:"AppManager")}function z8(e,t){t&&(e["X-Firebase-GMPID"]=t)}function W8(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function $8(e,t,r,n,s,a,i=!0,o=!1){const l=L8(e.urlParams),c=e.url+l,f=Object.assign({},e.headers);return z8(f,t),B8(f,r),U8(f,a),W8(f,n),new V8(c,e.method,f,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H8(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function G8(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(t,r){this._service=t,r instanceof zs?this._location=r:this._location=zs.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Qh(t,r)}get root(){const t=new zs(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G8(this._location.path)}get storage(){return this._service}get parent(){const t=H8(this._location.path);if(t===null)return null;const r=new zs(this._location.bucket,t);return new Qh(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw R8(t)}}function oy(e,t){const r=t==null?void 0:t[k8];return r==null?null:zs.makeFromBucketSpec(r,e)}function X8(e,t,r,n={}){e.host=`${t}:${r}`;const s=Id(t);s&&(o4(`https://${e.host}/b`),c4("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:a}=n;a&&(e._overrideAuthToken=typeof a=="string"?a:l4(a,e.app.options.projectId))}class K8{constructor(t,r,n,s,a,i=!1){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=i,this._bucket=null,this._host=qk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=S8,this._maxUploadRetryTime=b8,this._requests=new Set,s!=null?this._bucket=zs.makeFromBucketSpec(s,this._host):this._bucket=oy(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=zs.makeFromBucketSpec(this._url,t):this._bucket=oy(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){iy("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){iy("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(m4(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Qh(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new P8(Yk());{const i=$8(t,this._appId,n,s,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const ly="@firebase/storage",cy="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk="storage";function q8(e=v4(),t){e=dc(e);const n=p4(e,Qk).getImmediate({identifier:t}),s=a4("storage");return s&&Y8(n,...s),n}function Y8(e,t,r,n={}){X8(e,t,r,n)}function Q8(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new K8(r,n,s,t,x4)}function J8(){s0(new pc(Qk,Q8,"PUBLIC").setMultipleInstances(!0)),Li(ly,cy,""),Li(ly,cy,"esm2020")}J8();const Z8={apiKey:"AIzaSyDvj1XYANkW99nEcOu2ma5O1MyOvw2rE28",authDomain:"gaming-center-arcadia.firebaseapp.com",projectId:"gaming-center-arcadia",storageBucket:"gaming-center-arcadia.firebasestorage.app",messagingSenderId:"672088520360",appId:"1:672088520360:web:570589ecf05c62608cf49d",measurementId:"G-LNC8W28P9P"},Jk=g4(Z8),uy=a8(Jk);q8(Jk);function ze(e,t){const[r,n]=te.useState(()=>{try{const o=window.localStorage.getItem(e);return o?JSON.parse(o):t}catch(o){return console.warn(`Error reading localStorage key "${e}":`,o),t}}),[s,a]=te.useState(null);return te.useEffect(()=>{const o=ey(uy,"arcadia_data",e),l=f=>{if(f.key===e&&f.newValue)try{n(JSON.parse(f.newValue))}catch(d){console.error("Error parsing storage change:",d)}};window.addEventListener("storage",l);const c=w8(o,f=>{if(a(null),f.exists()){const d=f.data().value;n(d),window.localStorage.setItem(e,JSON.stringify(d))}setLoading(!1)},f=>{console.error("Firebase Sync Error:",f),a(f),setLoading(!1)});return()=>{c(),window.removeEventListener("storage",l)}},[e]),[r,async o=>{try{const l=o instanceof Function?o(r):o;n(l),window.localStorage.setItem(e,JSON.stringify(l));const c=ey(uy,"arcadia_data",e);await y8(c,{value:l}),a(null)}catch(l){console.error("Error updating value:",l),a(l)}},loading,s]}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Qe=(e,t)=>{const r=te.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:l,...c},f)=>te.createElement("svg",{ref:f,...eP,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${tP(e)}`,o].join(" "),...c},[...t.map(([d,p])=>te.createElement(d,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=Qe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=Qe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=Qe("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=Qe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Qe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=Qe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=Qe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=Qe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=Qe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=Qe("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=Qe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=Qe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=Qe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=Qe("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=Qe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=Qe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=Qe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=Qe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=Qe("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=Qe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=Qe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=Qe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=Qe("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=Qe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Qe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=Qe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=Qe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=Qe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=Qe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=Qe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Qe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=Qe("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=Qe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=Qe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=Qe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=Qe("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=Qe("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Qe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Qe("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Qe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=Qe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=Qe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=Qe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=Qe("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=Qe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Iu={yellow:{value:"#FACC15",name:"Amarillo",text:"text-yellow-400",border:"border-yellow-400/50",shadow:"shadow-[0_0_15px_rgba(250,204,21,0.8)]",glow:"drop-shadow-[0_0_20px_rgba(250,204,21,0.9)]",bg:"bg-yellow-400",ring:"ring-yellow-400"},blue:{value:"#22D3EE",name:"Azul",text:"text-cyan-400",border:"border-cyan-400/50",shadow:"shadow-[0_0_15px_rgba(34,211,238,0.8)]",glow:"drop-shadow-[0_0_20px_rgba(34,211,238,0.9)]",bg:"bg-cyan-400",ring:"ring-cyan-400"},pink:{value:"#F472B6",name:"Rosa",text:"text-pink-400",border:"border-pink-400/50",shadow:"shadow-[0_0_15px_rgba(244,114,182,0.8)]",glow:"drop-shadow-[0_0_20px_rgba(244,114,182,0.9)]",bg:"bg-pink-400",ring:"ring-pink-400"},green:{value:"#4ADE80",name:"Verde",text:"text-green-400",border:"border-green-400/50",shadow:"shadow-[0_0_15px_rgba(74,222,128,0.8)]",glow:"drop-shadow-[0_0_20px_rgba(74,222,128,0.9)]",bg:"bg-green-400",ring:"ring-green-400"},purple:{value:"#A855F7",name:"Morado",text:"text-purple-400",border:"border-purple-400/50",shadow:"shadow-[0_0_15px_rgba(168,85,247,0.8)]",glow:"drop-shadow-[0_0_20px_rgba(168,85,247,0.9)]",bg:"bg-purple-400",ring:"ring-purple-400"}},Jh={sans:{name:"Bsica",class:"font-sans"},serif:{name:"Elegante",class:"font-serif"},mono:{name:"Cdigo",class:"font-mono"},cyber:{name:"Cyber",class:"font-[Orbitron,sans-serif]"},hand:{name:"Manuscrita",class:"font-[Caveat,cursive]"}},yx={megaphone:{name:"Megfono",component:c1},info:{name:"Info",component:Zk},alert:{name:"Alerta",component:l1},gamepad:{name:"Gaming",component:uP},star:{name:"Estrella",component:_P}},wP={scale:1,x:0,y:0,fontSize:24,color:"yellow",font:"sans",icon:"megaphone"},EP="/arcadia-lan-center/assets/logo_arcadia-CW4aINtP.png",hu="/arcadia-lan-center/assets/arcadia_gaming-7fjEVHR_.png",gy="/arcadia-lan-center/assets/qr_whatsapp-BDhbjOkW.jpg",vy="/arcadia-lan-center/assets/qr_wifi-Zl82YEsT.jpg";function TP(){const[e]=ze("arcadia_daily_giveaways",{slots:[]}),[t]=ze("arcadia_announcements_list",[]),[r]=ze("arcadia_qrs",{wifi:null,whatsapp:null,ssid:"",password:"",whatsappMessage:""}),[n]=ze("arcadia_monthly_winners",[{id:1,rank:1,winner:null,points:0},{id:2,rank:2,winner:null,points:0},{id:3,rank:3,winner:null,points:0}]),[s]=ze("arcadia_winners_panel_visible",!0),[a]=ze("arcadia_monthly_subtitle","TOP 3 JUGADORES"),[i]=ze("arcadia_benefits_text",` Descuentos exclusivos
 Acceso a torneos
 Horas gratis acumulables`),[o]=ze("arcadia_benefits_title",`BENEFICIOS EXCLUSIVOS
COMUNIDAD ARCADIA`),[l]=ze("arcadia_benefits_title_font_size",24),[c]=ze("arcadia_benefits_text_font_size",18),[f]=ze("arcadia_display_config",{logo:null,scale:1,x:0,y:0}),[d]=ze("arcadia_title_config",{text:"GAMING CENTER ARCADIA",scale:1,x:0,y:0}),[p]=ze("arcadia_bottom_logo_config_v2",{logo:null,scale:1,x:0,y:0}),[m]=ze("arcadia_particle_count",150),[g]=ze("arcadia_qr_panel_config_v2",{scale:1,x:0,y:0}),[x]=ze("arcadia_qr_panel_visible",!0),[_]=ze("arcadia_display_visible",!0),[y]=ze("arcadia_title_visible",!0),[E]=ze("arcadia_bottom_logo_visible",!0),[w]=ze("arcadia_particles_visible",!0),[R]=ze("arcadia_date_time_visible",!0),[V]=ze("arcadia_winner_panel_config",{scale:1,x:0,y:0}),[L,T]=te.useState("whatsapp"),[S,b]=te.useState("daily");te.useEffect(()=>{},[]);const F=N=>{if(!N)return"";const[C,P]=N.split(":");let ce=parseInt(C,10);const ye=ce>=12?"PM":"AM";return ce=ce%12,ce=ce||12,`${ce}:${P} ${ye}`};return u.jsxs("div",{className:"relative w-full min-h-screen text-white overflow-hidden bg-transparent font-sans selection:bg-neon-pink selection:text-white",children:[w&&u.jsx(Ig,{particleCount:m}),R&&u.jsxs("div",{className:"absolute top-0 w-full p-8 flex justify-between items-start z-10 transition-opacity duration-500 animate-fade-in",children:[u.jsx("div",{className:"text-white font-mono text-4xl font-bold tracking-widest drop-shadow-[0_0_15px_rgba(0,243,255,0.9)]",children:new Date().toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})}),u.jsx(AI,{})]}),u.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center h-screen w-full pointer-events-none -mt-24",children:[_&&u.jsx("div",{className:"mb-16 will-change-transform transition-transform duration-300 ease-out",style:{transform:`translate(${f.x}px, ${f.y}px) scale(${f.scale})`},children:u.jsx("div",{className:"animate-levitate",children:u.jsx("img",{src:f.logo||EP,alt:"Arcadia Logo",className:"max-w-[240px] h-auto object-contain drop-shadow-[0_0_20px_white]",onError:N=>{N.target.onerror=null,N.target.style.display="none"}})})}),y&&u.jsx("div",{className:"will-change-transform transition-transform duration-300 ease-out",style:{transform:`translate(${d.x}px, ${d.y}px) scale(${d.scale})`},children:u.jsx(r4,{text:d.text||"GAMING CENTER ARCADIA"})}),t.map(N=>{const C=Iu[N.config.color]||Iu.yellow,P=Jh[N.config.font]&&Jh[N.config.font].class||"font-sans",ce=yx[N.config.icon||"megaphone"],ye=ce&&ce.component||c1;return N.visible&&u.jsxs("div",{className:`absolute top-[75%] px-10 py-4 border-2 bg-black/80 backdrop-blur-md rounded-2xl transition-transform duration-300 animate-fade-in-up flex items-center space-x-6 pointer-events-auto origin-center ${C.border}`,style:{transform:`translate(${N.config.x}px, ${N.config.y}px) scale(${N.config.scale})`,boxShadow:`0 0 40px ${C.value}40`},children:[u.jsx("div",{className:`${C.bg} text-black p-3 rounded-full ${C.shadow} animate-bounce-custom`,children:u.jsx(ye,{size:32,strokeWidth:2.5})}),u.jsx("p",{className:`font-black tracking-widest animate-pulse uppercase whitespace-pre-wrap text-center ${C.text} ${C.glow} ${P}`,style:{fontSize:`${N.config.fontSize}px`},children:N.text})]},N.id)})]}),E&&u.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 z-50 pointer-events-auto group",children:u.jsx("div",{className:"relative transition-transform duration-300 ease-out",style:{transform:`translate(${p.x}px, ${p.y}px) scale(${p.scale})`},children:u.jsx("img",{src:p.logo||hu,alt:"Arcadia Gaming",className:"w-40 h-auto block opacity-90 hover:opacity-100 transition-all duration-300 hover:scale-110"},p.logo||"default")})}),x&&u.jsxs("div",{className:"absolute left-10 top-1/2 z-30 w-80 p-6 bg-black/60 backdrop-blur-xl border border-neon-blue/30 rounded-2xl shadow-[0_0_30px_rgba(0,243,255,0.1)] transition-colors duration-300 hover:border-neon-blue/50 will-change-transform ease-out",style:{transform:`translate(${g.x}px, calc(-50% + ${g.y}px)) scale(${g.scale})`},children:[u.jsxs("div",{className:"flex space-x-2 mb-6 border-b border-white/10 pb-4",children:[u.jsxs("button",{onClick:()=>T("whatsapp"),className:`flex-1 py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-300 ${L==="whatsapp"?"bg-green-500/20 text-green-400 border border-green-500/50 shadow-[0_0_15px_rgba(74,222,128,0.2)]":"bg-black/40 text-slate-400 hover:text-white hover:bg-white/5"}`,children:[u.jsx(eS,{size:18}),u.jsx("span",{className:"font-bold tracking-wide",children:"WHATSAPP"})]}),u.jsxs("button",{onClick:()=>T("wifi"),className:`flex-1 py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-300 ${L==="wifi"?"bg-neon-blue/20 text-neon-blue border border-neon-blue/50 shadow-[0_0_15px_rgba(0,243,255,0.2)]":"bg-black/40 text-slate-400 hover:text-white hover:bg-white/5"}`,children:[u.jsx(tS,{size:18}),u.jsx("span",{className:"font-bold tracking-wide",children:"WIFI"})]})]}),u.jsxs("div",{className:"flex flex-col items-center text-center min-h-[300px] justify-center transition-opacity duration-500",children:[L==="whatsapp"&&u.jsxs("div",{className:"animate-fade-in flex flex-col items-center w-full",children:[u.jsxs("div",{className:"relative group cursor-pointer mb-6",children:[u.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),u.jsx("div",{className:"relative w-48 h-48 bg-black rounded-xl p-3 flex items-center justify-center",children:r.whatsapp||gy?u.jsx("img",{src:r.whatsapp||gy,alt:"WhatsApp QR",className:"w-full h-full object-cover rounded-lg"}):u.jsx("span",{className:"text-slate-500 text-sm",children:"No QR Loaded"})})]}),u.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Comunidad oficial"}),u.jsx("p",{className:"text-sm text-green-400 font-medium tracking-wide border-t border-green-500/30 pt-3 w-full whitespace-pre-wrap",children:r.whatsappMessage||`nete al grupo de WhatsApp
Arcadia Gaming Center`})]}),L==="wifi"&&u.jsxs("div",{className:"animate-fade-in flex flex-col items-center w-full",children:[u.jsxs("div",{className:"relative group cursor-pointer mb-6",children:[u.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl blur opacity-75 group-hover:opacity-100 transition-opacity duration-300"}),u.jsx("div",{className:"relative w-48 h-48 bg-black rounded-xl p-3 flex items-center justify-center",children:r.wifi||vy?u.jsx("img",{src:r.wifi||vy,alt:"WiFi QR",className:"w-full h-full object-cover rounded-lg"}):u.jsx("span",{className:"text-slate-500 text-sm",children:"No QR Loaded"})})]}),u.jsxs("div",{className:"w-full space-y-4 bg-white/5 p-4 rounded-xl border border-white/10 text-center",children:[u.jsxs("div",{className:"flex flex-col items-center border-b border-white/5 pb-3",children:[u.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-widest mb-1",children:"Red Wi-Fi"}),u.jsx("span",{className:"text-neon-blue font-mono font-bold text-lg leading-tight",children:r.ssid||"---"})]}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"text-[10px] text-slate-400 uppercase tracking-widest mb-1",children:"Contrasea"}),u.jsx("span",{className:"text-neon-pink font-mono font-bold text-lg tracking-widest",children:r.password||"---"})]})]})]})]})]}),e.active!==!1&&s&&u.jsxs("div",{className:"absolute right-[170px] top-1/2 z-10 w-80 p-6 bg-black/40 backdrop-blur-md border border-neon-pink/20 rounded-xl transition-colors duration-300 hover:border-neon-pink/40 will-change-transform ease-out",style:{transform:`translate(${V.x}px, calc(-50% + ${V.y}px)) scale(${V.scale})`},children:[u.jsxs("div",{className:"flex flex-col space-y-2 mb-6 border-b border-white/10 pb-4",children:[u.jsxs("div",{className:"flex space-x-2",children:[u.jsxs("button",{onClick:()=>b("daily"),className:`flex-1 py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-300 ${S==="daily"?"bg-neon-pink/20 text-neon-pink border border-neon-pink/50 shadow-[0_0_15px_rgba(236,72,153,0.2)]":"bg-black/40 text-slate-400 hover:text-white hover:bg-white/5"}`,children:[u.jsx(rP,{size:18}),u.jsx("span",{className:"font-bold tracking-wide text-xs",children:"DIARIOS"})]}),u.jsxs("button",{onClick:()=>b("monthly"),className:`flex-1 py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-300 ${S==="monthly"?"bg-purple-500/20 text-purple-400 border border-purple-500/50 shadow-[0_0_15px_rgba(168,85,247,0.2)]":"bg-black/40 text-slate-400 hover:text-white hover:bg-white/5"}`,children:[u.jsx(Ls,{size:18}),u.jsx("span",{className:"font-bold tracking-wide text-xs",children:"MENSUALES"})]})]}),u.jsxs("button",{onClick:()=>b("benefits"),className:`w-full py-2 rounded-lg flex items-center justify-center space-x-2 transition-colors duration-300 ${S==="benefits"?"bg-pink-500/20 text-pink-400 border border-pink-500/50 shadow-[0_0_15px_rgba(236,72,153,0.2)]":"bg-black/40 text-slate-400 hover:text-white hover:bg-white/5"}`,children:[u.jsx(fP,{size:18}),u.jsx("span",{className:"font-bold tracking-wide text-xs",children:"BENEFICIOS DE SER USUARIO"})]})]}),S==="daily"&&u.jsxs("div",{className:"animate-fade-in custom-scrollbar overflow-y-auto max-h-[60vh]",children:[u.jsx("h2",{className:"text-xl font-bold text-neon-pink mb-1 tracking-wider text-center",children:"GANADORES DEL DIA"}),u.jsx("div",{className:"text-xl font-bold text-neon-pink font-mono text-center mb-4 border-b border-neon-pink/30 pb-2",children:new Date().toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}),u.jsx("div",{className:"space-y-4",children:e.slots&&e.slots.length>0?e.slots.filter(N=>N.enabled!==!1).map(N=>u.jsxs("div",{className:"bg-white/5 p-3 rounded border-l-4 border-neon-pink min-h-[80px] flex flex-col justify-center transition-all hover:bg-white/10",children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[u.jsxs("span",{className:"text-xs text-neon-pink/70 uppercase tracking-widest",children:["Sorteo ",F(N.time)||"--:--"]}),N.winner&&u.jsx("span",{className:"text-lg animate-bounce",children:""})]}),N.winner?u.jsx("div",{className:"animate-fade-in",children:u.jsx("div",{className:"font-bold text-white text-xl truncate",children:N.winner.nickname})}):u.jsx("div",{className:"text-gray-500 italic text-sm animate-pulse",children:"Esperando resultados..."})]},N.id)):u.jsx("div",{className:"text-gray-500 text-center italic py-4",children:"Cargando sorteos..."})})]}),S==="monthly"&&u.jsxs("div",{className:"animate-fade-in custom-scrollbar overflow-y-auto max-h-[60vh]",children:[u.jsx("h2",{className:"text-xl font-bold text-purple-400 mb-0 tracking-wider text-center",children:"GANADORES DEL MES"}),u.jsx("div",{className:"text-xl font-bold text-purple-400/80 mb-4 border-b border-purple-500/30 pb-2 tracking-wider text-center",children:a}),u.jsx("div",{className:"space-y-4",children:n.filter(N=>N.enabled!==!1).map(N=>u.jsxs("div",{className:`bg-white/5 rounded border-l-4 flex flex-col justify-center transition-all hover:bg-white/10 ${N.rank>3?"py-2 px-3":"p-3"} ${N.rank===1?"border-yellow-400 shadow-[inset_0_0_20px_rgba(250,204,21,0.1)]":N.rank===2?"border-slate-400":N.rank===3?"border-amber-700":"border-red-600"}`,children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[u.jsxs("span",{className:`text-xs uppercase tracking-widest font-bold ${N.rank===1?"text-yellow-400":N.rank===2?"text-slate-400":N.rank===3?"text-amber-700":"text-red-500"}`,children:[N.rank," LUGAR"]}),N.winner&&N.rank<=3&&u.jsx(Ls,{size:16,className:N.rank===1?"text-yellow-400":N.rank===2?"text-slate-400":"text-amber-700"})]}),N.winner?u.jsxs("div",{className:"animate-fade-in",children:[u.jsx("div",{className:`font-bold text-white text-xl truncate ${N.rank>3?"text-base":""}`,children:N.winner.nickname}),N.rank<=3&&u.jsx("div",{className:"flex justify-end items-end mt-1",children:u.jsxs("span",{className:"text-sm font-mono text-purple-300 font-bold",children:[N.points," PTS"]})})]}):u.jsx("div",{className:"text-gray-600 italic text-sm",children:"Vacante"})]},N.id))})]}),S==="benefits"&&u.jsxs("div",{className:"animate-fade-in custom-scrollbar overflow-y-auto max-h-[60vh]",children:[u.jsx("h2",{className:"font-bold text-pink-400 mb-4 tracking-wider text-center whitespace-pre-wrap leading-tight border-b border-pink-500/30 pb-2",style:{fontSize:`${l}px`},children:o||`BENEFICIOS EXCLUSIVOS
COMUNIDAD ARCADIA`}),u.jsx("div",{className:"bg-white/5 p-4 rounded-lg border-l-4 border-pink-500 shadow-[inset_0_0_20px_rgba(236,72,153,0.1)]",children:u.jsx("p",{className:"text-white font-medium whitespace-pre-wrap leading-relaxed text-center",style:{fontSize:`${c}px`},children:i||"Consulta en recepcin por los beneficios vigentes."})})]})]})]})}function Wp({isOpen:e,onClose:t,title:r,children:n}){return e?u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:u.jsxs("div",{className:"bg-slate-900 border border-neon-blue/30 rounded-xl p-6 max-w-sm w-full shadow-[0_0_15px_rgba(0,243,255,0.2)] transform transition-all scale-100 flex flex-col relative",children:[u.jsx("button",{onClick:t,className:"absolute top-3 right-3 text-slate-400 hover:text-white transition-colors",children:u.jsx(Nr,{size:20})}),r&&u.jsx("h3",{className:"text-xl font-bold text-white mb-4 pr-6 flex items-center gap-2 border-b border-slate-700/50 pb-2",children:r}),u.jsx("div",{className:"text-slate-300",children:n})]})}):null}const _y=e=>new Promise((t,r)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=s=>{const a=new Image;a.src=s.target.result,a.onload=()=>{const i=document.createElement("canvas");let o=a.width,l=a.height;const c=400;o>l?o>c&&(l*=c/o,o=c):l>c&&(o*=c/l,l=c),i.width=o,i.height=l,i.getContext("2d").drawImage(a,0,0,o,l);const d=i.toDataURL("image/webp",.8);t(d)},a.onerror=i=>r(i)},n.onerror=s=>r(s)});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zh={};Zh.version="0.18.5";var rS=1252,kP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],u1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},f1=function(e){kP.indexOf(e)!=-1&&(rS=u1[0]=e)};function SP(){f1(1252)}var Ws=function(e){f1(e)};function h1(){Ws(1200),SP()}function yy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function bP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function nS(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var du=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?bP(e.slice(2)):t==254&&r==255?nS(e.slice(2)):t==65279?e.slice(1):e},Df=function(t){return String.fromCharCode(t)},wy=function(t){return String.fromCharCode(t)},d0,Si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function p0(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Si.charAt(a)+Si.charAt(i)+Si.charAt(o)+Si.charAt(l);return t}function ns(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Si.indexOf(e.charAt(c++)),i=Si.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Si.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Si.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ri=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Xi(e){return st?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ey(e){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Jn=function(t){return st?ri(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $d(e){if(typeof ArrayBuffer>"u")return Jn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function eo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function AP(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function d1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return d1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vr=st?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ri(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function NP(e){for(var t=[],r=0,n=e.length+250,s=Xi(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Xi(65535),n=65530)}return t.push(s.slice(0,r)),Vr(t)}var Nn=/\u0000/g,pu=/[\u0001-\u0006]/g;function rc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $s(e,t){var r=""+e;return r.length>=t?r:sr("0",t-r.length)+r}function p1(e,t){var r=""+e;return r.length>=t?r:sr(" ",t-r.length)+r}function ed(e,t){var r=""+e;return r.length>=t?r:r+sr(" ",t-r.length)}function CP(e,t){var r=""+Math.round(e);return r.length>=t?r:sr("0",t-r.length)+r}function IP(e,t){var r=""+e;return r.length>=t?r:sr("0",t-r.length)+r}var Ty=Math.pow(2,32);function Sl(e,t){if(e>Ty||e<-Ty)return CP(e,t);var r=Math.round(e);return IP(r,t)}function td(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ky=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function FP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Sy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},RP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rd(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(s);c<t&&(d=Math.floor(s),o=d*i+a,f=d*c+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=a):(f=c,o=i)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function So(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=MP(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var sS=new Date(1899,11,31,0,0,0),PP=sS.getTime(),DP=new Date(1900,2,1,0,0,0);function aS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=DP&&(r+=24*60*60*1e3),(r-(PP+(e.getTimezoneOffset()-sS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function m1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function OP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jP(e){var t=e<0?12:11,r=m1(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function LP(e){var t=m1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function m0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jP(e):t===10?r=e.toFixed(10).substr(0,12):r=LP(e),m1(OP(r.toUpperCase()))}function zo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):m0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return As(14,aS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function MP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function VP(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return $p[r.m-1][1];case 5:return $p[r.m-1][0];default:return $p[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return ky[r.q][0];default:return ky[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$s(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=$s(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?$s(l,c):"";return f}function bi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var iS=/%/g;function BP(e,t,r){var n=t.replace(iS,""),s=t.length-n.length;return $a(e,n,r*Math.pow(10,2*s))+sr("%",s)}function UP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $a(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function oS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+oS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lS=/# (\?+)( ?)\/( ?)(\d+)/;function zP(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?sr(" ",e[1].length+1+e[4].length):p1(i,e[1].length)+e[2]+"/"+e[3]+$s(o,e[4].length))}function WP(e,t,r){return r+(t===0?"":""+t)+sr(" ",e[1].length+2+e[4].length)}var cS=/^#*0*\.([0#]+)/,uS=/\).*[0#]/,fS=/\(###\) ###\\?-####/;function Sn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function by(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ay(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function $P(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function HP(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ds(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ds("n",n,r):"("+ds("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return UP(e,t,r);if(t.indexOf("%")!==-1)return BP(e,t,r);if(t.indexOf("E")!==-1)return oS(t,r);if(t.charCodeAt(0)===36)return"$"+ds(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Sl(l,t.length);if(t.match(/^[#?]+$/))return s=Sl(r,0),s==="0"&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(lS))return zP(a,l,c);if(t.match(/^#+0+$/))return c+Sl(l,t.length-t.indexOf("0"));if(a=t.match(cS))return s=by(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+sr("0",Sn(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+by(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+bi(Sl(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ds(e,t,-r):bi(""+(Math.floor(r)+$P(r,a[1].length)))+"."+$s(Ay(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ds(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=rc(ds(e,t.replace(/[\\-]/g,""),r)),i=0,rc(rc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(fS))return s=ds(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=rd(l,Math.pow(10,i)-1,!1),s=""+c,f=$a("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ed(o[2],i),f.length<a[4].length&&(f=Sn(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=rd(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?p1(o[1],i)+a[2]+"/"+a[3]+ed(o[2],i):sr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Sl(r,0),t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,p=t.length-s.length-d;return Sn(t.substr(0,d)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Ay(r,a[1].length),r<0?"-"+ds(e,t,-r):bi(HP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?$s(0,3-g.length):"")+g})+"."+$s(i,a[1].length);switch(t){case"###,##0.00":return ds(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=bi(Sl(l,0));return m!=="0"?c+m:"";case"###,###.00":return ds(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ds(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function GP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $a(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XP(e,t,r){var n=t.replace(iS,""),s=t.length-n.length;return $a(e,n,r*Math.pow(10,2*s))+sr("%",s)}function hS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function la(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?la("n",n,r):"("+la("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return GP(e,t,r);if(t.indexOf("%")!==-1)return XP(e,t,r);if(t.indexOf("E")!==-1)return hS(t,r);if(t.charCodeAt(0)===36)return"$"+la(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+$s(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(lS))return WP(a,l,c);if(t.match(/^#+0+$/))return c+$s(l,t.length-t.indexOf("0"));if(a=t.match(cS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Sn(a[1])).replace(/\.$/,"."+Sn(a[1])),s=s.replace(/\.(\d*)$/,function(g,x){return"."+x+sr("0",Sn(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+bi(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+la(e,t,-r):bi(""+r)+"."+sr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return la(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=rc(la(e,t.replace(/[\\-]/g,""),r)),i=0,rc(rc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(fS))return s=la(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=rd(l,Math.pow(10,i)-1,!1),s=""+c,f=$a("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ed(o[2],i),f.length<a[4].length&&(f=Sn(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=rd(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?p1(o[1],i)+a[2]+"/"+a[3]+ed(o[2],i):sr(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Sn(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,p=t.length-s.length-d;return Sn(t.substr(0,d)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+la(e,t,-r):bi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?$s(0,3-g.length):"")+g})+"."+$s(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=bi(""+l);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return la(e,t.slice(0,t.lastIndexOf(".")),r)+Sn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $a(e,t,r){return(r|0)===r?la(e,t,r):ds(e,t,r)}function KP(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var dS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":td(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(dS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function qP(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,f,d,p="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!td(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),g=m==="("||m===")"?m:"t";s[s.length]={t:g,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=So(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=So(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=So(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",p="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",i+=5,p="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",i+=5,p="h"):(x.t="t",++i),c==null&&x.t==="T")return"";s[s.length]=x,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(dS)){if(c==null&&(c=So(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fc(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var _=0,y=0,E;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=p,l="h",_<1&&(_=1);break;case"s":(E=s[i].v.match(/\.0+$/))&&(y=Math.max(y,E[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[i].v.match(/[Hh]/)&&(_=1),_<2&&s[i].v.match(/[Mm]/)&&(_=2),_<3&&s[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",R;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=VP(s[i].t.charCodeAt(0),s[i].v,c,y),s[i].t="t";break;case"n":case"?":for(R=i+1;s[R]!=null&&((o=s[R].t)==="?"||o==="D"||(o===" "||o==="t")&&s[R+1]!=null&&(s[R+1].t==="?"||s[R+1].t==="t"&&s[R+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[R].v==="/"||s[R].v===" "&&s[R+1]!=null&&s[R+1].t=="?"));)s[i].v+=s[R].v,s[R]={v:"",t:";"},++R;w+=s[i].v,i=R-1;break;case"G":s[i].t="t",s[i].v=zo(t,r);break}var V="",L,T;if(w.length>0){w.charCodeAt(0)==40?(L=t<0&&w.charCodeAt(0)===45?-t:t,T=$a("n",w,L)):(L=t<0&&n>1?-t:t,T=$a("n",w,L),L<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),R=T.length-1;var S=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){S=i;break}var b=s.length;if(S===s.length&&T.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(R>=s[i].v.length-1?(R-=s[i].v.length,s[i].v=T.substr(R+1,s[i].v.length)):R<0?s[i].v="":(s[i].v=T.substr(0,R+1),R=-1),s[i].t="t",b=i);R>=0&&b<s.length&&(s[b].v=T.substr(0,R+1)+s[b].v)}else if(S!==s.length&&T.indexOf("E")===-1){for(R=T.indexOf(".")-1,i=S;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")-1:s[i].v.length-1,V=s[i].v.substr(f+1);f>=0;--f)R>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(V=T.charAt(R--)+V);s[i].v=V,s[i].t="t",b=i}for(R>=0&&b<s.length&&(s[b].v=T.substr(0,R+1)+s[b].v),R=T.indexOf(".")+1,i=S;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==S)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")+1:0,V=s[i].v.substr(0,f);f<s[i].v.length;++f)R<T.length&&(V+=T.charAt(R++));s[i].v=V,s[i].t="t",b=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(L=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=$a(s[i].t,s[i].v,L),s[i].t="t");var F="";for(i=0;i!==s.length;++i)s[i]!=null&&(F+=s[i].v);return F}var Ny=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Cy(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function YP(e,t){var r=KP(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Ny),o=r[1].match(Ny);return Cy(t,i)?[n,r[0]]:Cy(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function As(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[Sy[e]]||He[Sy[e]]),n==null&&(n=RP[e]||"General");break}if(td(n,0))return zo(t,r);t instanceof Date&&(t=aS(t,r.date1904));var s=YP(n,t);if(td(s[1]))return zo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return qP(s[1],t,r,s[0])}function Ha(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function Hd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ha(e[t],t)}function Rc(){He=FP()}var QP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function JP(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(pS,"(\\d+)"),new RegExp("^"+t+"$")}function ZP(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(pS)||[]).forEach(function(d,p){var m=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?f:c+"T"+f}var eD=function(){var e={};e.version="1.2.0";function t(){for(var T=0,S=new Array(256),b=0;b!=256;++b)T=b,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,S[b]=T;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function n(T){var S=0,b=0,F=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)N[F]=T[F];for(F=0;F!=256;++F)for(b=T[F],S=256+F;S<4096;S+=256)b=N[S]=b>>>8^T[b&255];var C=[];for(F=1;F!=16;++F)C[F-1]=typeof Int32Array<"u"?N.subarray(F*256,F*256+256):N.slice(F*256,F*256+256);return C}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],f=s[5],d=s[6],p=s[7],m=s[8],g=s[9],x=s[10],_=s[11],y=s[12],E=s[13],w=s[14];function R(T,S){for(var b=S^-1,F=0,N=T.length;F<N;)b=b>>>8^r[(b^T.charCodeAt(F++))&255];return~b}function V(T,S){for(var b=S^-1,F=T.length-15,N=0;N<F;)b=w[T[N++]^b&255]^E[T[N++]^b>>8&255]^y[T[N++]^b>>16&255]^_[T[N++]^b>>>24]^x[T[N++]]^g[T[N++]]^m[T[N++]]^p[T[N++]]^d[T[N++]]^f[T[N++]]^c[T[N++]]^l[T[N++]]^o[T[N++]]^i[T[N++]]^a[T[N++]]^r[T[N++]];for(F+=15;N<F;)b=b>>>8^r[(b^T[N++])&255];return~b}function L(T,S){for(var b=S^-1,F=0,N=T.length,C=0,P=0;F<N;)C=T.charCodeAt(F++),C<128?b=b>>>8^r[(b^C)&255]:C<2048?(b=b>>>8^r[(b^(192|C>>6&31))&255],b=b>>>8^r[(b^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,P=T.charCodeAt(F++)&1023,b=b>>>8^r[(b^(240|C>>8&7))&255],b=b>>>8^r[(b^(128|C>>2&63))&255],b=b>>>8^r[(b^(128|P>>6&15|(C&3)<<4))&255],b=b>>>8^r[(b^(128|P&63))&255]):(b=b>>>8^r[(b^(224|C>>12&15))&255],b=b>>>8^r[(b^(128|C>>6&63))&255],b=b>>>8^r[(b^(128|C&63))&255]);return~b}return e.table=r,e.bstr=R,e.buf=V,e.str=L,e}(),Be=function(){var t={};t.version="1.2.1";function r(I,M){for(var O=I.split("/"),j=M.split("/"),B=0,z=0,J=Math.min(O.length,j.length);B<J;++B){if(z=O[B].length-j[B].length)return z;if(O[B]!=j[B])return O[B]<j[B]?-1:1}return O.length-j.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(0,M+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var M=I.lastIndexOf("/");return M===-1?I:I.slice(M+1)}function a(I,M){typeof M=="string"&&(M=new Date(M));var O=M.getHours();O=O<<6|M.getMinutes(),O=O<<5|M.getSeconds()>>>1,I.write_shift(2,O);var j=M.getFullYear()-1980;j=j<<4|M.getMonth()+1,j=j<<5|M.getDate(),I.write_shift(2,j)}function i(I){var M=I.read_shift(2)&65535,O=I.read_shift(2)&65535,j=new Date,B=O&31;O>>>=5;var z=O&15;O>>>=4,j.setMilliseconds(0),j.setFullYear(O+1980),j.setMonth(z-1),j.setDate(B);var J=M&31;M>>>=5;var ae=M&63;return M>>>=6,j.setHours(M),j.setMinutes(ae),j.setSeconds(J<<1),j}function o(I){qr(I,0);for(var M={},O=0;I.l<=I.length-4;){var j=I.read_shift(2),B=I.read_shift(2),z=I.l+B,J={};switch(j){case 21589:O=I.read_shift(1),O&1&&(J.mtime=I.read_shift(4)),B>5&&(O&2&&(J.atime=I.read_shift(4)),O&4&&(J.ctime=I.read_shift(4))),J.mtime&&(J.mt=new Date(J.mtime*1e3));break}I.l=z,M[j]=J}return M}var l;function c(){return l||(l={})}function f(I,M){if(I[0]==80&&I[1]==75)return jt(I,M);if((I[0]|32)==109&&(I[1]|32)==105)return so(I,M);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var O=3,j=512,B=0,z=0,J=0,ae=0,Z=0,re=[],ee=I.slice(0,512);qr(ee,0);var ve=d(ee);switch(O=ve[0],O){case 3:j=512;break;case 4:j=4096;break;case 0:if(ve[1]==0)return jt(I,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}j!==512&&(ee=I.slice(0,j),qr(ee,28));var Te=I.slice(0,j);p(ee,O);var Ie=ee.read_shift(4,"i");if(O===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);ee.l+=4,J=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),ae=ee.read_shift(4,"i"),B=ee.read_shift(4,"i"),Z=ee.read_shift(4,"i"),z=ee.read_shift(4,"i");for(var _e=-1,Ce=0;Ce<109&&(_e=ee.read_shift(4,"i"),!(_e<0));++Ce)re[Ce]=_e;var Ue=m(I,j);_(Z,z,Ue,j,re);var yt=E(Ue,J,re,j);yt[J].name="!Directory",B>0&&ae!==P&&(yt[ae].name="!MiniFAT"),yt[re[0]].name="!FAT",yt.fat_addrs=re,yt.ssz=j;var ut={},Vt=[],nn=[],os=[];w(J,yt,Ue,Vt,B,ut,nn,ae),g(nn,os,Vt),Vt.shift();var Fn={FileIndex:nn,FullPaths:os};return M&&M.raw&&(Fn.raw={header:Te,sectors:Ue}),Fn}function d(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ce,"Header Signature: "),I.l+=16;var M=I.read_shift(2,"u");return[I.read_shift(2,"u"),M]}function p(I,M){var O=9;switch(I.l+=2,O=I.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,M){for(var O=Math.ceil(I.length/M)-1,j=[],B=1;B<O;++B)j[B-1]=I.slice(B*M,(B+1)*M);return j[O-1]=I.slice(O*M),j}function g(I,M,O){for(var j=0,B=0,z=0,J=0,ae=0,Z=O.length,re=[],ee=[];j<Z;++j)re[j]=ee[j]=j,M[j]=O[j];for(;ae<ee.length;++ae)j=ee[ae],B=I[j].L,z=I[j].R,J=I[j].C,re[j]===j&&(B!==-1&&re[B]!==B&&(re[j]=re[B]),z!==-1&&re[z]!==z&&(re[j]=re[z])),J!==-1&&(re[J]=j),B!==-1&&j!=re[j]&&(re[B]=re[j],ee.lastIndexOf(B)<ae&&ee.push(B)),z!==-1&&j!=re[j]&&(re[z]=re[j],ee.lastIndexOf(z)<ae&&ee.push(z));for(j=1;j<Z;++j)re[j]===j&&(z!==-1&&re[z]!==z?re[j]=re[z]:B!==-1&&re[B]!==B&&(re[j]=re[B]));for(j=1;j<Z;++j)if(I[j].type!==0){if(ae=j,ae!=re[ae])do ae=re[ae],M[j]=M[ae]+"/"+M[j];while(ae!==0&&re[ae]!==-1&&ae!=re[ae]);re[j]=-1}for(M[0]+="/",j=1;j<Z;++j)I[j].type!==2&&(M[j]+="/")}function x(I,M,O){for(var j=I.start,B=I.size,z=[],J=j;O&&B>0&&J>=0;)z.push(M.slice(J*C,J*C+C)),B-=C,J=yo(O,J*4);return z.length===0?le(0):Vr(z).slice(0,I.size)}function _(I,M,O,j,B){var z=P;if(I===P){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var J=O[I],ae=(j>>>2)-1;if(!J)return;for(var Z=0;Z<ae&&(z=yo(J,Z*4))!==P;++Z)B.push(z);_(yo(J,j-4),M-1,O,j,B)}}function y(I,M,O,j,B){var z=[],J=[];B||(B=[]);var ae=j-1,Z=0,re=0;for(Z=M;Z>=0;){B[Z]=!0,z[z.length]=Z,J.push(I[Z]);var ee=O[Math.floor(Z*4/j)];if(re=Z*4&ae,j<4+re)throw new Error("FAT boundary crossed: "+Z+" 4 "+j);if(!I[ee])break;Z=yo(I[ee],re)}return{nodes:z,data:Uy([J])}}function E(I,M,O,j){var B=I.length,z=[],J=[],ae=[],Z=[],re=j-1,ee=0,ve=0,Te=0,Ie=0;for(ee=0;ee<B;++ee)if(ae=[],Te=ee+M,Te>=B&&(Te-=B),!J[Te]){Z=[];var _e=[];for(ve=Te;ve>=0;){_e[ve]=!0,J[ve]=!0,ae[ae.length]=ve,Z.push(I[ve]);var Ce=O[Math.floor(ve*4/j)];if(Ie=ve*4&re,j<4+Ie)throw new Error("FAT boundary crossed: "+ve+" 4 "+j);if(!I[Ce]||(ve=yo(I[Ce],Ie),_e[ve]))break}z[Te]={nodes:ae,data:Uy([Z])}}return z}function w(I,M,O,j,B,z,J,ae){for(var Z=0,re=j.length?2:0,ee=M[I].data,ve=0,Te=0,Ie;ve<ee.length;ve+=128){var _e=ee.slice(ve,ve+128);qr(_e,64),Te=_e.read_shift(2),Ie=E1(_e,0,Te-re),j.push(Ie);var Ce={name:Ie,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},Ue=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Ue!==0&&(Ce.ct=R(_e,_e.l-8));var yt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);yt!==0&&(Ce.mt=R(_e,_e.l-8)),Ce.start=_e.read_shift(4,"i"),Ce.size=_e.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=P,Ce.name=""),Ce.type===5?(Z=Ce.start,B>0&&Z!==P&&(M[Z].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",M[Ce.start]===void 0&&(M[Ce.start]=y(O,Ce.start,M.fat_addrs,M.ssz)),M[Ce.start].name=Ce.name,Ce.content=M[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:Z!==P&&Ce.start!==P&&M[Z]&&(Ce.content=x(Ce,M[Z].data,(M[ae]||{}).data))),Ce.content&&qr(Ce.content,0),z[Ie]=Ce,J.push(Ce)}}function R(I,M){return new Date((Qn(I,M+4)/1e7*Math.pow(2,32)+Qn(I,M)/1e7-11644473600)*1e3)}function V(I,M){return c(),f(l.readFileSync(I),M)}function L(I,M){var O=M&&M.type;switch(O||st&&Buffer.isBuffer(I)&&(O="buffer"),O||"base64"){case"file":return V(I,M);case"base64":return f(Jn(ns(I)),M);case"binary":return f(Jn(I),M)}return f(I,M)}function T(I,M){var O=M||{},j=O.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=j+"/",I.FileIndex[0]={name:j,type:5}),O.CLSID&&(I.FileIndex[0].clsid=O.CLSID),S(I)}function S(I){var M="Sh33tJ5";if(!Be.find(I,"/"+M)){var O=le(4);O[0]=55,O[1]=O[3]=50,O[2]=54,I.FileIndex.push({name:M,type:2,content:O,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+M),b(I)}}function b(I,M){T(I);for(var O=!1,j=!1,B=I.FullPaths.length-1;B>=0;--B){var z=I.FileIndex[B];switch(z.type){case 0:j?O=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(z.R*z.L*z.C)&&(O=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!M)){var J=new Date(1987,1,19),ae=0,Z=Object.create?Object.create(null):{},re=[];for(B=0;B<I.FullPaths.length;++B)Z[I.FullPaths[B]]=!0,I.FileIndex[B].type!==0&&re.push([I.FullPaths[B],I.FileIndex[B]]);for(B=0;B<re.length;++B){var ee=n(re[B][0]);j=Z[ee],j||(re.push([ee,{name:s(ee).replace("/",""),type:1,clsid:we,ct:J,mt:J,content:null}]),Z[ee]=!0)}for(re.sort(function(Ie,_e){return r(Ie[0],_e[0])}),I.FullPaths=[],I.FileIndex=[],B=0;B<re.length;++B)I.FullPaths[B]=re[B][0],I.FileIndex[B]=re[B][1];for(B=0;B<re.length;++B){var ve=I.FileIndex[B],Te=I.FullPaths[B];if(ve.name=s(Te).replace("/",""),ve.L=ve.R=ve.C=-(ve.color=1),ve.size=ve.content?ve.content.length:0,ve.start=0,ve.clsid=ve.clsid||we,B===0)ve.C=re.length>1?1:-1,ve.size=0,ve.type=5;else if(Te.slice(-1)=="/"){for(ae=B+1;ae<re.length&&n(I.FullPaths[ae])!=Te;++ae);for(ve.C=ae>=re.length?-1:ae,ae=B+1;ae<re.length&&n(I.FullPaths[ae])!=n(Te);++ae);ve.R=ae>=re.length?-1:ae,ve.type=1}else n(I.FullPaths[B+1]||"")==n(Te)&&(ve.R=B+1),ve.type=2}}}function F(I,M){var O=M||{};if(O.fileType=="mad")return fl(I,O);switch(b(I),O.fileType){case"zip":return ot(I,O)}var j=function(Ie){for(var _e=0,Ce=0,Ue=0;Ue<Ie.FileIndex.length;++Ue){var yt=Ie.FileIndex[Ue];if(yt.content){var ut=yt.content.length;ut>0&&(ut<4096?_e+=ut+63>>6:Ce+=ut+511>>9)}}for(var Vt=Ie.FullPaths.length+3>>2,nn=_e+7>>3,os=_e+127>>7,Fn=nn+Ce+Vt+os,Rn=Fn+127>>7,Xn=Rn<=109?0:Math.ceil((Rn-109)/127);Fn+Rn+Xn+127>>7>Rn;)Xn=++Rn<=109?0:Math.ceil((Rn-109)/127);var Pn=[1,Xn,Rn,os,Vt,Ce,_e,0];return Ie.FileIndex[0].size=_e<<6,Pn[7]=(Ie.FileIndex[0].start=Pn[0]+Pn[1]+Pn[2]+Pn[3]+Pn[4]+Pn[5])+(Pn[6]+7>>3),Pn}(I),B=le(j[7]<<9),z=0,J=0;{for(z=0;z<8;++z)B.write_shift(1,ye[z]);for(z=0;z<8;++z)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),z=0;z<3;++z)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,j[2]),B.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:P),B.write_shift(4,j[3]),B.write_shift(-4,j[1]?j[0]-1:P),B.write_shift(4,j[1]),z=0;z<109;++z)B.write_shift(-4,z<j[2]?j[1]+z:-1)}if(j[1])for(J=0;J<j[1];++J){for(;z<236+J*127;++z)B.write_shift(-4,z<j[2]?j[1]+z:-1);B.write_shift(-4,J===j[1]-1?P:J+1)}var ae=function(Ie){for(J+=Ie;z<J-1;++z)B.write_shift(-4,z+1);Ie&&(++z,B.write_shift(-4,P))};for(J=z=0,J+=j[1];z<J;++z)B.write_shift(-4,ke.DIFSECT);for(J+=j[2];z<J;++z)B.write_shift(-4,ke.FATSECT);ae(j[3]),ae(j[4]);for(var Z=0,re=0,ee=I.FileIndex[0];Z<I.FileIndex.length;++Z)ee=I.FileIndex[Z],ee.content&&(re=ee.content.length,!(re<4096)&&(ee.start=J,ae(re+511>>9)));for(ae(j[6]+7>>3);B.l&511;)B.write_shift(-4,ke.ENDOFCHAIN);for(J=z=0,Z=0;Z<I.FileIndex.length;++Z)ee=I.FileIndex[Z],ee.content&&(re=ee.content.length,!(!re||re>=4096)&&(ee.start=J,ae(re+63>>6)));for(;B.l&511;)B.write_shift(-4,ke.ENDOFCHAIN);for(z=0;z<j[4]<<2;++z){var ve=I.FullPaths[z];if(!ve||ve.length===0){for(Z=0;Z<17;++Z)B.write_shift(4,0);for(Z=0;Z<3;++Z)B.write_shift(4,-1);for(Z=0;Z<12;++Z)B.write_shift(4,0);continue}ee=I.FileIndex[z],z===0&&(ee.start=ee.size?ee.start-1:P);var Te=z===0&&O.root||ee.name;if(re=2*(Te.length+1),B.write_shift(64,Te,"utf16le"),B.write_shift(2,re),B.write_shift(1,ee.type),B.write_shift(1,ee.color),B.write_shift(-4,ee.L),B.write_shift(-4,ee.R),B.write_shift(-4,ee.C),ee.clsid)B.write_shift(16,ee.clsid,"hex");else for(Z=0;Z<4;++Z)B.write_shift(4,0);B.write_shift(4,ee.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ee.start),B.write_shift(4,ee.size),B.write_shift(4,0)}for(z=1;z<I.FileIndex.length;++z)if(ee=I.FileIndex[z],ee.size>=4096)if(B.l=ee.start+1<<9,st&&Buffer.isBuffer(ee.content))ee.content.copy(B,B.l,0,ee.size),B.l+=ee.size+511&-512;else{for(Z=0;Z<ee.size;++Z)B.write_shift(1,ee.content[Z]);for(;Z&511;++Z)B.write_shift(1,0)}for(z=1;z<I.FileIndex.length;++z)if(ee=I.FileIndex[z],ee.size>0&&ee.size<4096)if(st&&Buffer.isBuffer(ee.content))ee.content.copy(B,B.l,0,ee.size),B.l+=ee.size+63&-64;else{for(Z=0;Z<ee.size;++Z)B.write_shift(1,ee.content[Z]);for(;Z&63;++Z)B.write_shift(1,0)}if(st)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function N(I,M){var O=I.FullPaths.map(function(Z){return Z.toUpperCase()}),j=O.map(function(Z){var re=Z.split("/");return re[re.length-(Z.slice(-1)=="/"?2:1)]}),B=!1;M.charCodeAt(0)===47?(B=!0,M=O[0].slice(0,-1)+M):B=M.indexOf("/")!==-1;var z=M.toUpperCase(),J=B===!0?O.indexOf(z):j.indexOf(z);if(J!==-1)return I.FileIndex[J];var ae=!z.match(pu);for(z=z.replace(Nn,""),ae&&(z=z.replace(pu,"!")),J=0;J<O.length;++J)if((ae?O[J].replace(pu,"!"):O[J]).replace(Nn,"")==z||(ae?j[J].replace(pu,"!"):j[J]).replace(Nn,"")==z)return I.FileIndex[J];return null}var C=64,P=-2,ce="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(I,M,O){c();var j=F(I,O);l.writeFileSync(M,j)}function X(I){for(var M=new Array(I.length),O=0;O<I.length;++O)M[O]=String.fromCharCode(I[O]);return M.join("")}function oe(I,M){var O=F(I,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,O),O;case"binary":return typeof O=="string"?O:X(O);case"base64":return p0(typeof O=="string"?O:X(O));case"buffer":if(st)return Buffer.isBuffer(O)?O:ri(O);case"array":return typeof O=="string"?Jn(O):O}return O}var Pe;function U(I){try{var M=I.InflateRaw,O=new M;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)Pe=I;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function q(I,M){if(!Pe)return Ot(I,M);var O=Pe.InflateRaw,j=new O,B=j._processChunk(I.slice(I.l),j._finishFlushFlag);return I.l+=j.bytesRead,B}function H(I){return Pe?Pe.deflateRawSync(I):Ge(I)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(I){var M=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(M>>16|M>>8|M)&255}for(var ge=typeof Uint8Array<"u",ue=ge?new Uint8Array(256):[],$e=0;$e<256;++$e)ue[$e]=fe($e);function W(I,M){var O=ue[I&255];return M<=8?O>>>8-M:(O=O<<8|ue[I>>8&255],M<=16?O>>>16-M:(O=O<<8|ue[I>>16&255],O>>>24-M))}function pt(I,M){var O=M&7,j=M>>>3;return(I[j]|(O<=6?0:I[j+1]<<8))>>>O&3}function tt(I,M){var O=M&7,j=M>>>3;return(I[j]|(O<=5?0:I[j+1]<<8))>>>O&7}function vt(I,M){var O=M&7,j=M>>>3;return(I[j]|(O<=4?0:I[j+1]<<8))>>>O&15}function Le(I,M){var O=M&7,j=M>>>3;return(I[j]|(O<=3?0:I[j+1]<<8))>>>O&31}function Ne(I,M){var O=M&7,j=M>>>3;return(I[j]|(O<=1?0:I[j+1]<<8))>>>O&127}function kt(I,M,O){var j=M&7,B=M>>>3,z=(1<<O)-1,J=I[B]>>>j;return O<8-j||(J|=I[B+1]<<8-j,O<16-j)||(J|=I[B+2]<<16-j,O<24-j)||(J|=I[B+3]<<24-j),J&z}function Et(I,M,O){var j=M&7,B=M>>>3;return j<=5?I[B]|=(O&7)<<j:(I[B]|=O<<j&255,I[B+1]=(O&7)>>8-j),M+3}function _t(I,M,O){var j=M&7,B=M>>>3;return O=(O&1)<<j,I[B]|=O,M+1}function tn(I,M,O){var j=M&7,B=M>>>3;return O<<=j,I[B]|=O&255,O>>>=8,I[B+1]=O,M+8}function Hn(I,M,O){var j=M&7,B=M>>>3;return O<<=j,I[B]|=O&255,O>>>=8,I[B+1]=O&255,I[B+2]=O>>>8,M+16}function Gn(I,M){var O=I.length,j=2*O>M?2*O:M+5,B=0;if(O>=M)return I;if(st){var z=Ey(j);if(I.copy)I.copy(z);else for(;B<I.length;++B)z[B]=I[B];return z}else if(ge){var J=new Uint8Array(j);if(J.set)J.set(I);else for(;B<O;++B)J[B]=I[B];return J}return I.length=j,I}function or(I){for(var M=new Array(I),O=0;O<I;++O)M[O]=0;return M}function Wr(I,M,O){var j=1,B=0,z=0,J=0,ae=0,Z=I.length,re=ge?new Uint16Array(32):or(32);for(z=0;z<32;++z)re[z]=0;for(z=Z;z<O;++z)I[z]=0;Z=I.length;var ee=ge?new Uint16Array(Z):or(Z);for(z=0;z<Z;++z)re[B=I[z]]++,j<B&&(j=B),ee[z]=0;for(re[0]=0,z=1;z<=j;++z)re[z+16]=ae=ae+re[z-1]<<1;for(z=0;z<Z;++z)ae=I[z],ae!=0&&(ee[z]=re[ae+16]++);var ve=0;for(z=0;z<Z;++z)if(ve=I[z],ve!=0)for(ae=W(ee[z],j)>>j-ve,J=(1<<j+4-ve)-1;J>=0;--J)M[ae|J<<ve]=ve&15|z<<4;return j}var $r=ge?new Uint16Array(512):or(512),Ys=ge?new Uint16Array(32):or(32);if(!ge){for(var Mt=0;Mt<512;++Mt)$r[Mt]=0;for(Mt=0;Mt<32;++Mt)Ys[Mt]=0}(function(){for(var I=[],M=0;M<32;M++)I.push(5);Wr(I,Ys,32);var O=[];for(M=0;M<=143;M++)O.push(8);for(;M<=255;M++)O.push(9);for(;M<=279;M++)O.push(7);for(;M<=287;M++)O.push(8);Wr(O,$r,288)})();var wn=function(){for(var M=ge?new Uint8Array(32768):[],O=0,j=0;O<me.length-1;++O)for(;j<me[O+1];++j)M[j]=O;for(;j<32768;++j)M[j]=29;var B=ge?new Uint8Array(259):[];for(O=0,j=0;O<ne.length-1;++O)for(;j<ne[O+1];++j)B[j]=O;function z(ae,Z){for(var re=0;re<ae.length;){var ee=Math.min(65535,ae.length-re),ve=re+ee==ae.length;for(Z.write_shift(1,+ve),Z.write_shift(2,ee),Z.write_shift(2,~ee&65535);ee-- >0;)Z[Z.l++]=ae[re++]}return Z.l}function J(ae,Z){for(var re=0,ee=0,ve=ge?new Uint16Array(32768):[];ee<ae.length;){var Te=Math.min(65535,ae.length-ee);if(Te<10){for(re=Et(Z,re,+(ee+Te==ae.length)),re&7&&(re+=8-(re&7)),Z.l=re/8|0,Z.write_shift(2,Te),Z.write_shift(2,~Te&65535);Te-- >0;)Z[Z.l++]=ae[ee++];re=Z.l*8;continue}re=Et(Z,re,+(ee+Te==ae.length)+2);for(var Ie=0;Te-- >0;){var _e=ae[ee];Ie=(Ie<<5^_e)&32767;var Ce=-1,Ue=0;if((Ce=ve[Ie])&&(Ce|=ee&-32768,Ce>ee&&(Ce-=32768),Ce<ee))for(;ae[Ce+Ue]==ae[ee+Ue]&&Ue<250;)++Ue;if(Ue>2){_e=B[Ue],_e<=22?re=tn(Z,re,ue[_e+1]>>1)-1:(tn(Z,re,3),re+=5,tn(Z,re,ue[_e-23]>>5),re+=3);var yt=_e<8?0:_e-4>>2;yt>0&&(Hn(Z,re,Ue-ne[_e]),re+=yt),_e=M[ee-Ce],re=tn(Z,re,ue[_e]>>3),re-=3;var ut=_e<4?0:_e-2>>1;ut>0&&(Hn(Z,re,ee-Ce-me[_e]),re+=ut);for(var Vt=0;Vt<Ue;++Vt)ve[Ie]=ee&32767,Ie=(Ie<<5^ae[ee])&32767,++ee;Te-=Ue-1}else _e<=143?_e=_e+48:re=_t(Z,re,1),re=tn(Z,re,ue[_e]),ve[Ie]=ee&32767,++ee}re=tn(Z,re,0)-1}return Z.l=(re+7)/8|0,Z.l}return function(Z,re){return Z.length<8?z(Z,re):J(Z,re)}}();function Ge(I){var M=le(50+Math.floor(I.length*1.1)),O=wn(I,M);return M.slice(0,O)}var St=ge?new Uint16Array(32768):or(32768),rr=ge?new Uint16Array(32768):or(32768),Ft=ge?new Uint16Array(128):or(128),Gt=1,Qs=1;function xr(I,M){var O=Le(I,M)+257;M+=5;var j=Le(I,M)+1;M+=5;var B=vt(I,M)+4;M+=4;for(var z=0,J=ge?new Uint8Array(19):or(19),ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,re=ge?new Uint8Array(8):or(8),ee=ge?new Uint8Array(8):or(8),ve=J.length,Te=0;Te<B;++Te)J[G[Te]]=z=tt(I,M),Z<z&&(Z=z),re[z]++,M+=3;var Ie=0;for(re[0]=0,Te=1;Te<=Z;++Te)ee[Te]=Ie=Ie+re[Te-1]<<1;for(Te=0;Te<ve;++Te)(Ie=J[Te])!=0&&(ae[Te]=ee[Ie]++);var _e=0;for(Te=0;Te<ve;++Te)if(_e=J[Te],_e!=0){Ie=ue[ae[Te]]>>8-_e;for(var Ce=(1<<7-_e)-1;Ce>=0;--Ce)Ft[Ie|Ce<<_e]=_e&7|Te<<3}var Ue=[];for(Z=1;Ue.length<O+j;)switch(Ie=Ft[Ne(I,M)],M+=Ie&7,Ie>>>=3){case 16:for(z=3+pt(I,M),M+=2,Ie=Ue[Ue.length-1];z-- >0;)Ue.push(Ie);break;case 17:for(z=3+tt(I,M),M+=3;z-- >0;)Ue.push(0);break;case 18:for(z=11+Ne(I,M),M+=7;z-- >0;)Ue.push(0);break;default:Ue.push(Ie),Z<Ie&&(Z=Ie);break}var yt=Ue.slice(0,O),ut=Ue.slice(O);for(Te=O;Te<286;++Te)yt[Te]=0;for(Te=j;Te<30;++Te)ut[Te]=0;return Gt=Wr(yt,St,286),Qs=Wr(ut,rr,30),M}function cl(I,M){if(I[0]==3&&!(I[1]&3))return[Xi(M),2];for(var O=0,j=0,B=Ey(M||1<<18),z=0,J=B.length>>>0,ae=0,Z=0;!(j&1);){if(j=tt(I,O),O+=3,j>>>1)j>>1==1?(ae=9,Z=5):(O=xr(I,O),ae=Gt,Z=Qs);else{O&7&&(O+=8-(O&7));var re=I[O>>>3]|I[(O>>>3)+1]<<8;if(O+=32,re>0)for(!M&&J<z+re&&(B=Gn(B,z+re),J=B.length);re-- >0;)B[z++]=I[O>>>3],O+=8;continue}for(;;){!M&&J<z+32767&&(B=Gn(B,z+32767),J=B.length);var ee=kt(I,O,ae),ve=j>>>1==1?$r[ee]:St[ee];if(O+=ve&15,ve>>>=4,!(ve>>>8&255))B[z++]=ve;else{if(ve==256)break;ve-=257;var Te=ve<8?0:ve-4>>2;Te>5&&(Te=0);var Ie=z+ne[ve];Te>0&&(Ie+=kt(I,O,Te),O+=Te),ee=kt(I,O,Z),ve=j>>>1==1?Ys[ee]:rr[ee],O+=ve&15,ve>>>=4;var _e=ve<4?0:ve-2>>1,Ce=me[ve];for(_e>0&&(Ce+=kt(I,O,_e),O+=_e),!M&&J<Ie&&(B=Gn(B,Ie+100),J=B.length);z<Ie;)B[z]=B[z-Ce],++z}}}return M?[B,O+7>>>3]:[B.slice(0,z),O+7>>>3]}function Ot(I,M){var O=I.slice(I.l||0),j=cl(O,M);return I.l+=j[1],j[0]}function ba(I,M){if(I)typeof console<"u"&&console.error(M);else throw new Error(M)}function jt(I,M){var O=I;qr(O,0);var j=[],B=[],z={FileIndex:j,FullPaths:B};T(z,{root:M.root});for(var J=O.length-4;(O[J]!=80||O[J+1]!=75||O[J+2]!=5||O[J+3]!=6)&&J>=0;)--J;O.l=J+4,O.l+=4;var ae=O.read_shift(2);O.l+=6;var Z=O.read_shift(4);for(O.l=Z,J=0;J<ae;++J){O.l+=20;var re=O.read_shift(4),ee=O.read_shift(4),ve=O.read_shift(2),Te=O.read_shift(2),Ie=O.read_shift(2);O.l+=8;var _e=O.read_shift(4),Ce=o(O.slice(O.l+ve,O.l+ve+Te));O.l+=ve+Te+Ie;var Ue=O.l;O.l=_e+4,is(O,re,ee,z,Ce),O.l=Ue}return z}function is(I,M,O,j,B){I.l+=2;var z=I.read_shift(2),J=I.read_shift(2),ae=i(I);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var Z=I.read_shift(4),re=I.read_shift(4),ee=I.read_shift(4),ve=I.read_shift(2),Te=I.read_shift(2),Ie="",_e=0;_e<ve;++_e)Ie+=String.fromCharCode(I[I.l++]);if(Te){var Ce=o(I.slice(I.l,I.l+Te));(Ce[21589]||{}).mt&&(ae=Ce[21589].mt),((B||{})[21589]||{}).mt&&(ae=B[21589].mt)}I.l+=Te;var Ue=I.slice(I.l,I.l+re);switch(J){case 8:Ue=q(I,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+J)}var yt=!1;z&8&&(Z=I.read_shift(4),Z==134695760&&(Z=I.read_shift(4),yt=!0),re=I.read_shift(4),ee=I.read_shift(4)),re!=M&&ba(yt,"Bad compressed size: "+M+" != "+re),ee!=O&&ba(yt,"Bad uncompressed size: "+O+" != "+ee),Aa(j,Ie,Ue,{unsafe:!0,mt:ae})}function ot(I,M){var O=M||{},j=[],B=[],z=le(1),J=O.compression?8:0,ae=0,Z=0,re=0,ee=0,ve=0,Te=I.FullPaths[0],Ie=Te,_e=I.FileIndex[0],Ce=[],Ue=0;for(Z=1;Z<I.FullPaths.length;++Z)if(Ie=I.FullPaths[Z].slice(Te.length),_e=I.FileIndex[Z],!(!_e.size||!_e.content||Ie=="Sh33tJ5")){var yt=ee,ut=le(Ie.length);for(re=0;re<Ie.length;++re)ut.write_shift(1,Ie.charCodeAt(re)&127);ut=ut.slice(0,ut.l),Ce[ve]=eD.buf(_e.content,0);var Vt=_e.content;J==8&&(Vt=H(Vt)),z=le(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ae),z.write_shift(2,J),_e.mt?a(z,_e.mt):z.write_shift(4,0),z.write_shift(-4,Ce[ve]),z.write_shift(4,Vt.length),z.write_shift(4,_e.content.length),z.write_shift(2,ut.length),z.write_shift(2,0),ee+=z.length,j.push(z),ee+=ut.length,j.push(ut),ee+=Vt.length,j.push(Vt),z=le(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ae),z.write_shift(2,J),z.write_shift(4,0),z.write_shift(-4,Ce[ve]),z.write_shift(4,Vt.length),z.write_shift(4,_e.content.length),z.write_shift(2,ut.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,yt),Ue+=z.l,B.push(z),Ue+=ut.length,B.push(ut),++ve}return z=le(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,ve),z.write_shift(2,ve),z.write_shift(4,Ue),z.write_shift(4,ee),z.write_shift(2,0),Vr([Vr(j),Vr(B),z])}var Cs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rt(I,M){if(I.ctype)return I.ctype;var O=I.name||"",j=O.match(/\.([^\.]+)$/);return j&&Cs[j[1]]||M&&(j=(O=M).match(/[\.\\]([^\.\\])+$/),j&&Cs[j[1]])?Cs[j[1]]:"application/octet-stream"}function rn(I){for(var M=p0(I),O=[],j=0;j<M.length;j+=76)O.push(M.slice(j,j+76));return O.join(`\r
`)+`\r
`}function ul(I){var M=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ee=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],j=M.split(`\r
`),B=0;B<j.length;++B){var z=j[B];if(z.length==0){O.push("");continue}for(var J=0;J<z.length;){var ae=76,Z=z.slice(J,J+ae);Z.charAt(ae-1)=="="?ae--:Z.charAt(ae-2)=="="?ae-=2:Z.charAt(ae-3)=="="&&(ae-=3),Z=z.slice(J,J+ae),J+=ae,J<z.length&&(Z+="="),O.push(Z)}}return O.join(`\r
`)}function no(I){for(var M=[],O=0;O<I.length;++O){for(var j=I[O];O<=I.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+I[++O];M.push(j)}for(var B=0;B<M.length;++B)M[B]=M[B].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Jn(M.join(`\r
`))}function Is(I,M,O){for(var j="",B="",z="",J,ae=0;ae<10;++ae){var Z=M[ae];if(!Z||Z.match(/^\s*$/))break;var re=Z.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":j=re[2].trim();break;case"content-type":z=re[2].trim();break;case"content-transfer-encoding":B=re[2].trim();break}}switch(++ae,B.toLowerCase()){case"base64":J=Jn(ns(M.slice(ae).join("")));break;case"quoted-printable":J=no(M.slice(ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ee=Aa(I,j.slice(O.length),J,{unsafe:!0});z&&(ee.ctype=z)}function so(I,M){if(X(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=M&&M.root||"",j=(st&&Buffer.isBuffer(I)?I.toString("binary"):X(I)).split(`\r
`),B=0,z="";for(B=0;B<j.length;++B)if(z=j[B],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),O||(O=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),z.slice(0,O.length)!=O););var J=(j[1]||"").match(/boundary="(.*?)"/);if(!J)throw new Error("MAD cannot find boundary");var ae="--"+(J[1]||""),Z=[],re=[],ee={FileIndex:Z,FullPaths:re};T(ee);var ve,Te=0;for(B=0;B<j.length;++B){var Ie=j[B];Ie!==ae&&Ie!==ae+"--"||(Te++&&Is(ee,j.slice(ve,B),O),ve=B)}return ee}function fl(I,M){var O=M||{},j=O.boundary||"SheetJS";j="------="+j;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],z=I.FullPaths[0],J=z,ae=I.FileIndex[0],Z=1;Z<I.FullPaths.length;++Z)if(J=I.FullPaths[Z].slice(z.length),ae=I.FileIndex[Z],!(!ae.size||!ae.content||J=="Sh33tJ5")){J=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var re=ae.content,ee=st&&Buffer.isBuffer(re)?re.toString("binary"):X(re),ve=0,Te=Math.min(1024,ee.length),Ie=0,_e=0;_e<=Te;++_e)(Ie=ee.charCodeAt(_e))>=32&&Ie<128&&++ve;var Ce=ve>=Te*4/5;B.push(j),B.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+J),B.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),B.push("Content-Type: "+Rt(ae,J)),B.push(""),B.push(Ce?ul(ee):rn(ee))}return B.push(j+`--\r
`),B.join(`\r
`)}function Js(I){var M={};return T(M,I),M}function Aa(I,M,O,j){var B=j&&j.unsafe;B||T(I);var z=!B&&Be.find(I,M);if(!z){var J=I.FullPaths[0];M.slice(0,J.length)==J?J=M:(J.slice(-1)!="/"&&(J+="/"),J=(J+M).replace("//","/")),z={name:s(M),type:2},I.FileIndex.push(z),I.FullPaths.push(J),B||Be.utils.cfb_gc(I)}return z.content=O,z.size=O?O.length:0,j&&(j.CLSID&&(z.clsid=j.CLSID),j.mt&&(z.mt=j.mt),j.ct&&(z.ct=j.ct)),z}function ai(I,M){T(I);var O=Be.find(I,M);if(O){for(var j=0;j<I.FileIndex.length;++j)if(I.FileIndex[j]==O)return I.FileIndex.splice(j,1),I.FullPaths.splice(j,1),!0}return!1}function ii(I,M,O){T(I);var j=Be.find(I,M);if(j){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==j)return I.FileIndex[B].name=s(O),I.FullPaths[B]=O,!0}return!1}function Zs(I){b(I,!0)}return t.find=N,t.read=L,t.parse=f,t.write=oe,t.writeFile=ie,t.utils={cfb_new:Js,cfb_add:Aa,cfb_del:ai,cfb_mov:ii,cfb_gc:Zs,ReadShift:Fu,CheckField:jS,prep_blob:qr,bconcat:Vr,use_zlib:U,_deflateRaw:Ge,_inflateRaw:Ot,consts:ke},t}();function tD(e){return typeof e=="string"?$d(e):Array.isArray(e)?AP(e):e}function V0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=$d(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?da(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([tD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=eo(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function rD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ir(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Iy(e,t){for(var r=[],n=ir(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function Gd(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Xd(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function nD(e){for(var t=[],r=ir(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var nd=new Date(1899,11,30,0,0,0);function Dr(e,t){var r=e.getTime(),n=nd.getTime()+(e.getTimezoneOffset()-nd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var mS=new Date,sD=nd.getTime()+(mS.getTimezoneOffset()-nd.getTimezoneOffset())*6e4,Fy=mS.getTimezoneOffset();function Kd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+sD),t.getTimezoneOffset()!==Fy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Fy)*6e4),t}function aD(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var Ry=new Date("2017-02-19T19:06:09.000Z"),xS=isNaN(Ry.getFullYear())?new Date("2/19/17"):Ry,iD=xS.getFullYear()==2017;function $t(e,t){var r=new Date(e);if(iD)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Wo(e,t){if(st&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return da(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return da(nS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return da(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return da(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Ht(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ht(e[r]));return t}function sr(e,t){for(var r="";r.length<t;)r+=e;return r}function Xs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var oD=["january","february","march","april","may","june","july","august","september","october","november","december"];function wc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&oD.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function gS(e){return e?e.content&&e.type?Wo(e.content,!0):e.data?du(e.data):e.asNodeBuffer&&st?du(e.asNodeBuffer().toString("binary")):e.asBinary?du(e.asBinary()):e._data&&e._data.getContent?du(Wo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vS(e){if(!e)return null;if(e.data)return yy(e.data);if(e.asNodeBuffer&&st)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?yy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function cD(e){return e&&e.name.slice(-4)===".bin"?vS(e):gS(e)}function xs(e,t){for(var r=e.FullPaths||ir(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function x1(e,t){var r=xs(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function yr(e,t,r){if(!r)return cD(x1(e,t));if(!t)return null;try{return yr(e,t)}catch{return null}}function Zn(e,t,r){if(!r)return gS(x1(e,t));if(!t)return null;try{return Zn(e,t)}catch{return null}}function uD(e,t,r){return vS(x1(e,t))}function Py(e){for(var t=e.FullPaths||ir(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return st?n=ri(r):n=NP(r),Be.utils.cfb_add(e,t,n)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function g1(){return Be.utils.cfb_new()}function _S(e,t){switch(t.type){case"base64":return Be.read(e,{type:"base64"});case"binary":return Be.read(e,{type:"binary"});case"buffer":case"array":return Be.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Dy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hD=/<[^>]*>/g,yn=mr.match(Dy)?Dy:hD,dD=/<\w*:/,pD=/<(\/?)\w+:/;function qe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(fD),o=0,l="",c=0,f="",d="",p=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(f=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(p=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+p,d.length-p),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function ka(e){return e.replace(pD,"<$1")}var yS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},v1=Gd(yS),xt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return yS[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),_1=/[&<>'"]/g,mD=/[\u0000-\u0008\u000b-\u001f]/g;function Ct(e){var t=e+"";return t.replace(_1,function(r){return v1[r]}).replace(mD,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Oy(e){return Ct(e).replace(/ /g,"_x0020_")}var wS=/[\u0000-\u001f]/g;function y1(e){var t=e+"";return t.replace(_1,function(r){return v1[r]}).replace(/\n/g,"<br/>").replace(wS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function xD(e){var t=e+"";return t.replace(_1,function(r){return v1[r]}).replace(wS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jy=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function gD(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ut(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hp(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Ly(e){var t=Xi(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function My(e){return ri(e,"binary").toString("utf8")}var Of="foo bar baz",Pt=st&&(My(Of)==Hp(Of)&&My||Ly(Of)==Hp(Of)&&Ly)||Hp,da=st?function(e){return ri(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},x0=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ES=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),vD=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_D=/<\/?(?:vt:)?variant>/g,yD=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vy(e,t){var r=qe(e),n=e.match(vD(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(_D,"").match(yD);i&&s.push({v:Pt(i[2]),t:i[1]})}),s}var TS=/(^\s|\s$|\n)/;function Qr(e,t){return"<"+e+(t.match(TS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function g0(e){return ir(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Se(e,t,r){return"<"+e+(r!=null?g0(r):"")+(t!=null?(t.match(TS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function wx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function wD(e,t){switch(typeof e){case"string":var r=Se("vt:lpwstr",Ct(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Se((e|0)==e?"vt:i4":"vt:r8",Ct(String(e)));case"boolean":return Se("vt:bool",e?"true":"false")}if(e instanceof Date)return Se("vt:filetime",wx(e));throw new Error("Unable to serialize "+e)}function w1(e){if(st&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pt(eo(d1(e)));throw new Error("Bad input format: expected Buffer or string")}var v0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},nl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ED(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function TD(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var By=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Uy=st?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ri(t)})):By(e)}:By,zy=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ua(e,s)));return n.join("").replace(Nn,"")},E1=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Nn,""):zy(e,t,r)}:zy,Wy=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},kS=st?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Wy(e,t,r)}:Wy,$y=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Pl(e,s)));return n.join("")},B0=st?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):$y(t,r,n)}:$y,SS=function(e,t){var r=Qn(e,t);return r>0?B0(e,t+4,t+4+r-1):""},bS=SS,AS=function(e,t){var r=Qn(e,t);return r>0?B0(e,t+4,t+4+r-1):""},NS=AS,CS=function(e,t){var r=2*Qn(e,t);return r>0?B0(e,t+4,t+4+r-1):""},IS=CS,FS=function(t,r){var n=Qn(t,r);return n>0?E1(t,r+4,r+4+n):""},RS=FS,PS=function(e,t){var r=Qn(e,t);return r>0?B0(e,t+4,t+4+r):""},DS=PS,OS=function(e,t){return ED(e,t)},sd=OS,T1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};st&&(bS=function(t,r){if(!Buffer.isBuffer(t))return SS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NS=function(t,r){if(!Buffer.isBuffer(t))return AS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},IS=function(t,r){if(!Buffer.isBuffer(t))return CS(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},RS=function(t,r){if(!Buffer.isBuffer(t))return FS(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},DS=function(t,r){if(!Buffer.isBuffer(t))return PS(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},sd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):OS(t,r)},T1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Pl=function(e,t){return e[t]},Ua=function(e,t){return e[t+1]*256+e[t]},kD=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},yo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},SD=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Fu(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,st&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ua(this,c)),c+=2;e*=2;break;case"utf8":r=B0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=E1(this,this.l,this.l+e);break;case"wstr":return Fu.call(this,e,"dbcs");case"lpstr-ansi":r=bS(this,this.l),e=4+Qn(this,this.l);break;case"lpstr-cp":r=NS(this,this.l),e=4+Qn(this,this.l);break;case"lpwstr":r=IS(this,this.l),e=4+2*Qn(this,this.l);break;case"lpp4":e=4+Qn(this,this.l),r=RS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qn(this,this.l),r=DS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Pl(this,this.l+e++))!==0;)a.push(Df(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Ua(this,this.l+e))!==0;)a.push(Df(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Pl(this,c),this.l=c+1,o=Fu.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Df(Ua(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Pl(this,c),this.l=c+1,o=Fu.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Df(Pl(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=Pl(this,this.l),this.l++,n;case 2:return n=(t==="i"?kD:Ua)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?yo:SD)(this,this.l),this.l+=4,n):(s=Qn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=sd(this,this.l):s=sd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=kS(this,this.l,e);break}}return this.l+=e,r}var bD=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},AD=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ND=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CD(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)ND(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,bD(this,t,this.l);break;case 8:if(n=8,r==="f"){TD(this,t,this.l);break}case 16:break;case-4:n=4,AD(this,t,this.l);break}return this.l+=n,this}function jS(e,t){var r=kS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qr(e,t){e.l=t,e.read_shift=Fu,e.chk=jS,e.write_shift=CD}function _n(e,t){e.l+=t}function le(e){var t=Xi(e);return qr(t,0),t}function ni(e,t,r){if(e){var n,s,a;qr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=k0[o]||k0[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var f=c.f&&c.f(e,a,r);if(e.l=l,t(f,c,o))return}}}function Wn(){var e=[],t=st?256:2048,r=function(c){var f=le(c);return qr(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Vr(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function pe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=k0[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&T1(r)&&e.push(r)}}function Ru(e,t,r){var n=Ht(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hy(e,t,r){var n=Ht(e);return n.s=Ru(n.s,t.s,r),n.e=Ru(n.e,t.s,r),n}function Pu(e,t){if(e.cRel&&e.c<0)for(e=Ht(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ht(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xe(e);return!e.cRel&&e.cRel!=null&&(r=RD(r)),!e.rRel&&e.rRel!=null&&(r=ID(r)),r}function Gp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qt(e.s.c)+":"+(e.e.cRel?"":"$")+Qt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pr(e.s.r)+":"+(e.e.rRel?"":"$")+pr(e.e.r):Pu(e.s,t.biff)+":"+Pu(e.e,t.biff)}function k1(e){return parseInt(FD(e),10)-1}function pr(e){return""+(e+1)}function ID(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function FD(e){return e.replace(/\$(\d+)$/,"$1")}function S1(e){for(var t=PD(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Qt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function RD(e){return e.replace(/^([A-Z])/,"$$$1")}function PD(e){return e.replace(/^\$([A-Z])/,"$1")}function DD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Jt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Xe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $n(e){var t=e.indexOf(":");return t==-1?{s:Jt(e),e:Jt(e)}:{s:Jt(e.slice(0,t)),e:Jt(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Xe(e)),typeof t!="string"&&(t=Xe(t)),e==t?e:e+":"+t)}function gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Gy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=As(e.z,r?Dr(t):t)}catch{}try{return e.w=As((e.XF||{}).numFmtId||(r?14:0),r?Dr(t):t)}catch{return""+t}}function ei(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?si[e.v]||e.v:t==null?Gy(e,e.v):Gy(e,t))}function to(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function LS(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Jt(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=gt(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[d].length;++p)if(!(typeof t[d][p]>"u")){var m={v:t[d][p]},g=i+d,x=o+p;if(c.s.r>g&&(c.s.r=g),c.s.c>x&&(c.s.c=x),c.e.r<g&&(c.e.r=g),c.e.c<x&&(c.e.c=x),t[d][p]&&typeof t[d][p]=="object"&&!Array.isArray(t[d][p])&&!(t[d][p]instanceof Date))m=t[d][p];else if(Array.isArray(m.v)&&(m.f=t[d][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||He[14],n.cellDates?(m.t="d",m.w=As(m.z,Dr(m.v))):(m.t="n",m.v=Dr(m.v),m.w=As(m.z,m.v))):m.t="s";if(s)a[g]||(a[g]=[]),a[g][x]&&a[g][x].z&&(m.z=a[g][x].z),a[g][x]=m;else{var _=Xe({c:x,r:g});a[_]&&a[_].z&&(m.z=a[_].z),a[_]=m}}}return c.s.c<1e7&&(a["!ref"]=rt(c)),a}function Pc(e,t){return LS(null,e,t)}function OD(e){return e.read_shift(4,"i")}function Ks(e,t){return t||(t=le(4)),t.write_shift(4,e),t}function gn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ur(e,t){var r=!1;return t==null&&(r=!0,t=le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LD(e,t){return t||(t=le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function b1(e,t){var r=e.l,n=e.read_shift(1),s=gn(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(jD(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function MD(e,t){var r=!1;return t==null&&(r=!0,t=le(15+4*e.t.length)),t.write_shift(1,0),Ur(e.t,t),r?t.slice(0,t.l):t}var VD=b1;function BD(e,t){var r=!1;return t==null&&(r=!0,t=le(23+4*e.t.length)),t.write_shift(1,1),Ur(e.t,t),t.write_shift(4,1),LD({},t),r?t.slice(0,t.l):t}function Ns(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function sl(e,t){return t==null&&(t=le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function al(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function il(e,t){return t==null&&(t=le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var UD=gn,MS=Ur;function A1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ad(e,t){var r=!1;return t==null&&(r=!0,t=le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zD=gn,Ex=A1,N1=ad;function C1(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?sd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):yo(t,0)>>2;return r?s/100:s}function VS(e,t){t==null&&(t=le(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function BS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function WD(e,t){return t||(t=le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ol=BS,Dc=WD;function xn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $o(e,t){return(t||le(8)).write_shift(8,e,"f")}function $D(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Fo[s];c&&(t.rgb=y0(c));break;case 2:t.rgb=y0([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function id(e,t){if(t||(t=le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function HD(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function GD(e,t){t||(t=le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function US(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function XD(e){return US(e,1)}function KD(e){return US(e,2)}var I1=2,jn=3,jf=11,Xy=12,od=19,Lf=64,qD=65,YD=71,QD=4108,JD=4126,Lr=80,zS=81,ZD=[Lr,zS],Tx={1:{n:"CodePage",t:I1},2:{n:"Category",t:Lr},3:{n:"PresentationFormat",t:Lr},4:{n:"ByteCount",t:jn},5:{n:"LineCount",t:jn},6:{n:"ParagraphCount",t:jn},7:{n:"SlideCount",t:jn},8:{n:"NoteCount",t:jn},9:{n:"HiddenCount",t:jn},10:{n:"MultimediaClipCount",t:jn},11:{n:"ScaleCrop",t:jf},12:{n:"HeadingPairs",t:QD},13:{n:"TitlesOfParts",t:JD},14:{n:"Manager",t:Lr},15:{n:"Company",t:Lr},16:{n:"LinksUpToDate",t:jf},17:{n:"CharacterCount",t:jn},19:{n:"SharedDoc",t:jf},22:{n:"HyperlinksChanged",t:jf},23:{n:"AppVersion",t:jn,p:"version"},24:{n:"DigSig",t:qD},26:{n:"ContentType",t:Lr},27:{n:"ContentStatus",t:Lr},28:{n:"Language",t:Lr},29:{n:"Version",t:Lr},255:{},2147483648:{n:"Locale",t:od},2147483651:{n:"Behavior",t:od},1919054434:{}},kx={1:{n:"CodePage",t:I1},2:{n:"Title",t:Lr},3:{n:"Subject",t:Lr},4:{n:"Author",t:Lr},5:{n:"Keywords",t:Lr},6:{n:"Comments",t:Lr},7:{n:"Template",t:Lr},8:{n:"LastAuthor",t:Lr},9:{n:"RevNumber",t:Lr},10:{n:"EditTime",t:Lf},11:{n:"LastPrinted",t:Lf},12:{n:"CreatedDate",t:Lf},13:{n:"ModifiedDate",t:Lf},14:{n:"PageCount",t:jn},15:{n:"WordCount",t:jn},16:{n:"CharCount",t:jn},17:{n:"Thumbnail",t:YD},18:{n:"Application",t:Lr},19:{n:"DocSecurity",t:jn},255:{},2147483648:{n:"Locale",t:od},2147483651:{n:"Behavior",t:od},1919054434:{}},Ky={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tO(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var rO=tO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fo=Ht(rO),si={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},WS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Sx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function F1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nO(e){var t=F1();if(!e||!e.match)return t;var r={};if((e.match(yn)||[]).forEach(function(n){var s=qe(n);switch(s[0].replace(dD,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Sx[s.ContentType]]!==void 0&&t[Sx[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function $S(e,t){var r=nD(Sx),n=[],s;n[n.length]=mr,n[n.length]=Se("Types",null,{xmlns:Fr.CT,"xmlns:xsd":Fr.xsd,"xmlns:xsi":Fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Se("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(s=e[l][0],n[n.length]=Se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Mf[l][t.bookType]||Mf[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Mf[l][t.bookType]||Mf[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var at={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function _0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Du(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(yn)||[]).forEach(function(s){var a=qe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:mu(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function nc(e){var t=[mr,Se("Relationships",null,{xmlns:Fr.RELS})];return ir(e["!id"]).forEach(function(r){t[t.length]=Se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Nt(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[at.HLINK,at.XPATH,at.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var sO="application/vnd.oasis.opendocument.spreadsheet";function aO(e,t){for(var r=w1(e),n,s;n=v0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=qe(n[0],!1),s.path=="/"&&s.type!==sO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function iO(e){var t=[mr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function qy(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function oO(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function lO(e){var t=[mr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(qy(e[r][0],e[r][1])),t.push(oO("",e[r][0]));return t.push(qy("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function HS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zh.version+"</meta:generator></office:meta></office:document-meta>"}var ks=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],cO=function(){for(var e=new Array(ks.length),t=0;t<ks.length;++t){var r=ks[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function GS(e){var t={};e=Pt(e);for(var r=0;r<ks.length;++r){var n=ks[r],s=e.match(cO[r]);s!=null&&s.length>0&&(t[n[1]]=xt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=$t(t[n[1]]))}return t}function Xp(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ct(t),n[n.length]=r?Se(e,t,r):Qr(e,t))}function XS(e,t){var r=t||{},n=[mr,Se("cp:coreProperties",null,{"xmlns:cp":Fr.CORE_PROPS,"xmlns:dc":Fr.dc,"xmlns:dcterms":Fr.dcterms,"xmlns:dcmitype":Fr.dcmitype,"xmlns:xsi":Fr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Xp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:wx(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Xp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:wx(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=ks.length;++a){var i=ks[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Xp(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ro=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qS(e,t,r,n){var s=[];if(typeof e=="string")s=Vy(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?Vy(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function uO(e,t,r){var n={};return t||(t={}),e=Pt(e),Ro.forEach(function(s){var a=(e.match(x0(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=xt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&qS(n.HeadingPairs,n.TitlesOfParts,t,r),t}function YS(e){var t=[],r=Se;return e||(e={}),e.Application="SheetJS",t[t.length]=mr,t[t.length]=Se("Properties",null,{xmlns:Fr.EXT_PROPS,"xmlns:vt":Fr.vt}),Ro.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ct(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ct(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fO=/<[^>]+>[^<]*/g;function hO(e,t){var r={},n="",s=e.match(fO);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=qe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=xt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=xt(f);break;case"bool":r[n]=Ut(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=$t(f);break;case"cy":case"error":r[n]=xt(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function QS(e){var t=[mr,Se("Properties",null,{xmlns:Fr.CUST_PROPS,"xmlns:vt":Fr.vt})];if(!e)return t.join("");var r=1;return ir(e).forEach(function(s){++r,t[t.length]=Se("property",wD(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ct(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var bx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Kp;function dO(e,t,r){Kp||(Kp=Gd(bx)),t=Kp[t]||t,e[t]=r}function pO(e,t){var r=[];return ir(bx).map(function(n){for(var s=0;s<ks.length;++s)if(ks[s][1]==n)return ks[s];for(s=0;s<Ro.length;++s)if(Ro[s][1]==n)return Ro[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Qr(bx[n[1]]||n[1],s))}}),Se("DocumentProperties",r.join(""),{xmlns:Yn.o})}function mO(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ir(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<ks.length;++i)if(a==ks[i][1])return;for(i=0;i<Ro.length;++i)if(a==Ro[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(Se(Oy(a),o,{"dt:dt":l}))}}),t&&ir(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Se(Oy(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Yn.o+'">'+s.join("")+"</"+n+">"}function R1(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function xO(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=le(8);return i.write_shift(4,n),i.write_shift(4,s),i}function JS(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function ZS(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function eb(e,t,r){return t===31?ZS(e):JS(e,t,r)}function Ax(e,t,r){return eb(e,t,r===!1?0:4)}function gO(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return eb(e,t,0)}function vO(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Nn,""),e.l-s&2&&(e.l+=2)}return r}function _O(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Nn,"");return r}function yO(e){var t=e.l,r=ld(e,zS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ld(e,jn);return[r,n]}function wO(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(yO(e));return r}function Yy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Nn,"").replace(pu,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function tb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function EO(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ld(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Xy&&n!==t&&ZD.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Xy?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return JS(e,n,4).replace(Nn,"");case 31:return ZS(e);case 64:return R1(e);case 65:return tb(e);case 71:return EO(e);case 80:return Ax(e,n,!a.raw).replace(Nn,"");case 81:return gO(e,n).replace(Nn,"");case 4108:return wO(e);case 4126:case 4127:return n==4127?vO(e):_O(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Qy(e,t){var r=le(4),n=le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=xO(t);break;case 31:case 80:for(n=le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vr([r,n])}function Jy(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);a[i]=[f,d+r]}a.sort(function(E,w){return E[1]-w[1]});var p={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[a[i][0]];if(p[g.n]=ld(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ws(o=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(a[i][0]===1){if(o=p.CodePage=ld(e,I1),Ws(o),l!==-1){var x=e.l;e.l=a[l][1],c=Yy(e,o),e.l=x}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=Yy(e,o)}else{var _=c[a[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=tb(e);break;case 30:e.l+=4,y=Ax(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Ax(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=fr(e,4);break;case 64:e.l+=4,y=$t(R1(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[_]=y}}return e.l=r+n,p}var rb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function TO(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Zy(e,t,r){var n=le(8),s=[],a=[],i=8,o=0,l=le(8),c=le(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),s.push(c),i+=8+l.length,!t){c=le(8),c.write_shift(4,0),s.unshift(c);var f=[le(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=le(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Vr(f),a.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(rb.indexOf(e[o][0])>-1||KS.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],m=0;if(t){m=+t[e[o][0]];var g=r[m];if(g.p=="version"&&typeof p=="string"){var x=p.split(".");p=(+x[0]<<16)+(+x[1]||0)}l=Qy(g.t,p)}else{var _=TO(p);_==-1&&(_=31,p=String(p)),l=Qy(_,p)}a.push(l),c=le(8),c.write_shift(4,t?m:2+o),s.push(c),i+=8+l.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Vr([n].concat(s).concat(a))}function ew(e,t,r){var n=e.content;if(!n)return{};qr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Be.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Jy(n,t),p={SystemIdentifier:c};for(var m in d)p[m]=d[m];if(p.FMTID=a,s===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Jy(n,null)}catch{}for(m in g)p[m]=g[m];return p.FMTID=[a,i],p}function tw(e,t,r,n,s,a){var i=le(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Be.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=Zy(e,r,n);if(o.push(l),s){var c=Zy(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Vr(o)}function xi(e,t){return e.read_shift(t),null}function kO(e,t){t||(t=le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function SO(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function fr(e,t){return e.read_shift(t)===1}function bn(e,t){return t||(t=le(2)),t.write_shift(2,+!!e),t}function wr(e){return e.read_shift(2,"u")}function gs(e,t){return t||(t=le(2)),t.write_shift(2,e),t}function nb(e,t){return SO(e,t,wr)}function bO(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function sb(e,t,r){return r||(r=le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function U0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function AO(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function NO(e){var t=e.t||"",r=le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Vr(s)}function Ho(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function z0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ho(e,n,r)}function ll(e,t,r){if(r.biff>5)return z0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ab(e,t,r){return r||(r=le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function CO(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function IO(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Nn,"");return n&&(e.l+=24),s}function FO(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Nn,"");return r+i}function RO(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return IO(e);case"0303000000000000c000000000000046":return FO(e);default:throw new Error("Unsupported Moniker "+r)}}function Vf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Nn,""):"";return r}function rw(e,t){t||(t=le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function PO(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",f,d;s&16&&(a=Vf(e,r-e.l)),s&128&&(i=Vf(e,r-e.l)),(s&257)===257&&(o=Vf(e,r-e.l)),(s&257)===1&&(l=RO(e,r-e.l)),s&8&&(c=Vf(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=R1(e)),e.l=r;var p=i||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var m={Target:p};return f&&(m.guid=f),d&&(m.time=d),a&&(m.Tooltip=a),m}function DO(e){var t=le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),rw(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&rw(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ib(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function ob(e,t){var r=ib(e);return r[3]=0,r}function Sa(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Go(e,t,r,n){return n||(n=le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function OO(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function jO(e,t,r){return t===0?"":ll(e,t,r)}function LO(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function lb(e){var t=e.read_shift(2),r=C1(e);return[t,r]}function MO(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=U0(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function qd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function cb(e,t){return t||(t=le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ub(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var VO=ub;function fb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function BO(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function UO(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function cn(e){e.l+=2,e.l+=e.read_shift(2)}var zO={0:cn,4:cn,5:cn,6:cn,7:UO,8:cn,9:cn,10:cn,11:cn,12:cn,13:BO,14:cn,15:cn,16:cn,17:cn,18:cn,19:cn,20:cn,21:fb};function WO(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(zO[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Bf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function P1(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=le(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function $O(e,t){return t===0||e.read_shift(2),1200}function HO(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=ll(e,0,r);return e.read_shift(t+n-e.l),s}function GO(e,t){var r=!t||t.biff==8,n=le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function XO(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function KO(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=U0(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function qO(e,t){var r=!t||t.biff>=8?2:1,n=le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function YO(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(AO(e));return a.Count=n,a.Unique=s,a}function QO(e,t){var r=le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=NO(e[s]);var a=Vr([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function JO(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function ZO(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ej(e){var t=OO(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function tj(e){return e.read_shift(2),e.read_shift(4)}function nw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function rj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function nj(){var e=le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sj(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function aj(e){var t=le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ij(){}function oj(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=U0(e,0,r),n}function lj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=le(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function cj(e){var t=Sa(e);return t.isst=e.read_shift(4),t}function uj(e,t,r,n){var s=le(10);return Go(e,t,n,s),s.write_shift(4,r),s}function fj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Sa(e);r.biff==2&&e.l++;var a=z0(e,n-e.l,r);return s.val=a,s}function hj(e,t,r,n,s){var a=!s||s.biff==8,i=le(8+ +a+(1+a)*r.length);return Go(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function dj(e,t,r){var n=e.read_shift(2),s=ll(e,0,r);return[n,s]}function pj(e,t,r,n){var s=r&&r.biff==5;n||(n=le(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var mj=ll;function sw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function xj(e,t){var r=t.biff==8||!t.biff?4:2,n=le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function gj(e){var t=e.read_shift(2),r=e.read_shift(2),n=lb(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function vj(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(lb(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function _j(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function yj(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=eO[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function wj(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=yj(e,t,n.fStyle,r),n}function aw(e,t,r,n){var s=r&&r.biff==5;n||(n=le(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Ej(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Tj(e){var t=le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function iw(e,t,r){var n=Sa(e);(r.biff==2||t==9)&&++e.l;var s=bO(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function kj(e,t,r,n,s,a){var i=le(8);return Go(e,t,n,i),sb(r,a,i),i}function Sj(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Sa(e),s=xn(e);return n.val=s,n}function bj(e,t,r,n){var s=le(14);return Go(e,t,n,s),$o(r,s),s}var ow=jO;function Aj(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Ho(e,a),o=[];n>e.l;)o.push(z0(e));return[a,s,i,o]}function lw(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=MO(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Nj=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Ho(e,i,r);s&32&&(c=Nj[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:WM(e,f,r,o);return{chKey:a,Name:c,itab:l,rgce:d}}function hb(e,t,r){if(r.biff<8)return Cj(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(LO(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Cj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=U0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Ij(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Ho(e,n,r),i=Ho(e,s,r);return[a,i]}function Fj(e,t,r){var n=ub(e);e.l++;var s=e.read_shift(1);return t-=8,[$M(e,t,r),s,n]}function uw(e,t,r){var n=VO(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,UM(e,t,r)]}function Rj(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Pj(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=ll(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Dj(e,t,r){return Pj(e,t,r)}function Oj(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(qd(e));return r}function jj(e){var t=le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)cb(e[r],t);return t}function Lj(e,t,r){if(r&&r.biff<8)return Vj(e,t,r);var n=fb(e),s=WO(e,t-22,n[1]);return{cmo:n,ft:s}}var Mj={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Vj(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Mj[n]||_n)(e,t,r)),{cmo:[s,n,a],ft:i}}function Bj(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=CO(e,6,r);var o=e.read_shift(2);e.read_shift(2),wr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=Ho(e,e.lens[c+1]-e.lens[c]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Uj(e,t){var r=qd(e);e.l+=16;var n=PO(e,t-24);return[r,n]}function zj(e){var t=le(24),r=Jt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Vr([t,DO(e[1])])}function Wj(e,t){e.read_shift(2);var r=qd(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Nn,""),[r,n]}function $j(e){var t=e[1].Tooltip,r=le(10+2*(t.length+1));r.write_shift(2,2048);var n=Jt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Hj(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ky[r]||r,r=e.read_shift(2),t[1]=Ky[r]||r,t}function Gj(e){return e||(e=le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Xj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ob(e));return r}function Kj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ob(e));return r}function qj(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function db(e,t,r){if(!r.cellStyles)return _n(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Yj(e,t){var r=le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Qj(e,t){var r={};return t<32||(e.l+=16,r.header=xn(e),r.footer=xn(e),e.l+=2),r}function Jj(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Zj(e){for(var t=le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var eL=Sa,tL=nb,rL=z0;function nL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function sL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Sa(e);++e.l;var s=ll(e,t-7,r);return n.t="str",n.val=s,n}function aL(e){var t=Sa(e);++e.l;var r=xn(e);return t.t="n",t.val=r,t}function iL(e,t,r){var n=le(15);return G0(n,e,t),n.write_shift(8,r,"f"),n}function oL(e){var t=Sa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function lL(e,t,r){var n=le(9);return G0(n,e,t),n.write_shift(2,r),n}function cL(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function uL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function fL(e,t,r){var n=e.l+t,s=Sa(e),a=e.read_shift(2),i=Ho(e,a,r);return e.l=n,s.t="str",s.val=i,s}var hL=[2,3,48,49,131,139,140,245],Nx=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Xi(1);switch(l.type){case"base64":f=Jn(ns(o));break;case"binary":f=Jn(o);break;case"buffer":case"array":f=o;break}qr(f,0);var d=f.read_shift(1),p=!!(d&136),m=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,_=521;d==2&&(x=f.read_shift(2)),f.l+=3,d!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(_=f.read_shift(2));var y=f.read_shift(2),E=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var w=[],R={},V=Math.min(f.length,d==2?521:_-10-(m?264:0)),L=g?32:11;f.l<V&&f[f.l]!=13;)switch(R={},R.name=d0.utils.decode(E,f.slice(f.l,f.l+L)).replace(/[\u0000\r\n].*$/g,""),f.l+=L,R.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(R.offset=f.read_shift(4)),R.len=f.read_shift(1),d==2&&(R.offset=f.read_shift(2)),R.dec=f.read_shift(1),R.name.length&&w.push(R),d!=2&&(f.l+=g?13:14),R.type){case"B":(!m||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var T=0,S=0;for(c[0]=[],S=0;S!=w.length;++S)c[0][S]=w[S].name;for(;x-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,c[++T]=[],S=0,S=0;S!=w.length;++S){var b=f.slice(f.l,f.l+w[S].len);f.l+=w[S].len,qr(b,0);var F=d0.utils.decode(E,b);switch(w[S].type){case"C":F.trim().length&&(c[T][S]=F.replace(/\s+$/,""));break;case"D":F.length===8?c[T][S]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):c[T][S]=F;break;case"F":c[T][S]=parseFloat(F.trim());break;case"+":case"I":c[T][S]=g?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":c[T][S]=!0;break;case"N":case"F":c[T][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[T][S]="##MEMO##"+(g?parseInt(F.trim(),10):b.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(c[T][S]=+F||0);break;case"@":c[T][S]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":c[T][S]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":c[T][S]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][S]=-b.read_shift(-8,"f");break;case"B":if(m&&w[S].len==8){c[T][S]=b.read_shift(8,"f");break}case"G":case"P":b.l+=w[S].len;break;case"0":if(w[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[S].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=Pc(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function s(o,l){try{return to(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&Ws(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Wn(),d=fd(o,{header:1,raw:!0,cellDates:!0}),p=d[0],m=d.slice(1),g=o["!cols"]||[],x=0,_=0,y=0,E=1;for(x=0;x<p.length;++x){if(((g[x]||{}).DBF||{}).name){p[x]=g[x].DBF.name,++y;continue}if(p[x]!=null){if(++y,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(_=0;_<1024;++_)if(p.indexOf(p[x]+"_"+_)==-1){p[x]+="_"+_;break}}}}var w=gt(o["!ref"]),R=[],V=[],L=[];for(x=0;x<=w.e.c-w.s.c;++x){var T="",S="",b=0,F=[];for(_=0;_<m.length;++_)m[_][x]!=null&&F.push(m[_][x]);if(F.length==0||p[x]==null){R[x]="?";continue}for(_=0;_<F.length;++_){switch(typeof F[_]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=F[_]instanceof Date?"D":"C";break;default:S="C"}b=Math.max(b,String(F[_]).length),T=T&&T!=S?"C":S}b>250&&(b=250),S=((g[x]||{}).DBF||{}).type,S=="C"&&g[x].DBF.len>b&&(b=g[x].DBF.len),T=="B"&&S=="N"&&(T="N",L[x]=g[x].DBF.dec,b=g[x].DBF.len),V[x]=T=="C"||S=="N"?b:a[T]||0,E+=V[x],R[x]=T}var N=f.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*y),N.write_shift(2,E),x=0;x<4;++x)N.write_shift(4,0);for(N.write_shift(4,0|(+t[rS]||3)<<8),x=0,_=0;x<p.length;++x)if(p[x]!=null){var C=f.next(32),P=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,P,"sbcs"),C.write_shift(1,R[x]=="?"?"C":R[x],"sbcs"),C.write_shift(4,_),C.write_shift(1,V[x]||a[R[x]]||0),C.write_shift(1,L[x]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),_+=V[x]||a[R[x]]||0}var ce=f.next(264);for(ce.write_shift(4,13),x=0;x<65;++x)ce.write_shift(4,0);for(x=0;x<m.length;++x){var ye=f.next(E);for(ye.write_shift(1,0),_=0;_<p.length;++_)if(p[_]!=null)switch(R[_]){case"L":ye.write_shift(1,m[x][_]==null?63:m[x][_]?84:70);break;case"B":ye.write_shift(8,m[x][_]||0,"f");break;case"N":var we="0";for(typeof m[x][_]=="number"&&(we=m[x][_].toFixed(L[_]||0)),y=0;y<V[_]-we.length;++y)ye.write_shift(1,32);ye.write_shift(1,we,"sbcs");break;case"D":m[x][_]?(ye.write_shift(4,("0000"+m[x][_].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(m[x][_].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+m[x][_].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(m[x][_]!=null?m[x][_]:"").slice(0,V[_]);for(ye.write_shift(1,ke,"sbcs"),y=0;y<V[_]-ke.length;++y)ye.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),pb=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ir(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,m){var g=e[m];return typeof g=="number"?wy(g):g},n=function(p,m,g){var x=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?p:wy(x)};e["|"]=254;function s(p,m){switch(m.type){case"base64":return a(ns(p),m);case"binary":return a(p,m);case"buffer":return a(st&&Buffer.isBuffer(p)?p.toString("binary"):eo(p),m);case"array":return a(Wo(p),m)}throw new Error("Unrecognized type "+m.type)}function a(p,m){var g=p.split(/[\n\r]+/),x=-1,_=-1,y=0,E=0,w=[],R=[],V=null,L={},T=[],S=[],b=[],F=0,N;for(+m.codepage>=0&&Ws(+m.codepage);y!==g.length;++y){F=0;var C=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),P=C.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),ce=P[0],ye;if(C.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&R.push(C.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,ke=!1,ie=!1,X=!1,oe=-1,Pe=-1;for(E=1;E<P.length;++E)switch(P[E].charAt(0)){case"A":break;case"X":_=parseInt(P[E].slice(1))-1,ke=!0;break;case"Y":for(x=parseInt(P[E].slice(1))-1,ke||(_=0),N=w.length;N<=x;++N)w[N]=[];break;case"K":ye=P[E].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(Xs(ye))?isNaN(wc(ye).getDate())||(ye=$t(ye)):(ye=Xs(ye),V!==null&&Fc(V)&&(ye=Kd(ye))),we=!0;break;case"E":X=!0;var U=sc(P[E].slice(1),{r:x,c:_});w[x][_]=[w[x][_],U];break;case"S":ie=!0,w[x][_]=[w[x][_],"S5S"];break;case"G":break;case"R":oe=parseInt(P[E].slice(1))-1;break;case"C":Pe=parseInt(P[E].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(we&&(w[x][_]&&w[x][_].length==2?w[x][_][0]=ye:w[x][_]=ye,V=null),ie){if(X)throw new Error("SYLK shared formula cannot have own formula");var q=oe>-1&&w[oe][Pe];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");w[x][_][1]=Rb(q[1],{r:x-oe,c:_-Pe})}break;case"F":var H=0;for(E=1;E<P.length;++E)switch(P[E].charAt(0)){case"X":_=parseInt(P[E].slice(1))-1,++H;break;case"Y":for(x=parseInt(P[E].slice(1))-1,N=w.length;N<=x;++N)w[N]=[];break;case"M":F=parseInt(P[E].slice(1))/20;break;case"F":break;case"G":break;case"P":V=R[parseInt(P[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=P[E].slice(1).split(" "),N=parseInt(b[0],10);N<=parseInt(b[1],10);++N)F=parseInt(b[2],10),S[N-1]=F===0?{hidden:!0}:{wch:F},Ki(S[N-1]);break;case"C":_=parseInt(P[E].slice(1))-1,S[_]||(S[_]={});break;case"R":x=parseInt(P[E].slice(1))-1,T[x]||(T[x]={}),F>0?(T[x].hpt=F,T[x].hpx=Tc(F)):F===0&&(T[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}H<1&&(V=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return T.length>0&&(L["!rows"]=T),S.length>0&&(L["!cols"]=S),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,L]}function i(p,m){var g=s(p,m),x=g[0],_=g[1],y=Pc(x,m);return ir(_).forEach(function(E){y[E]=_[E]}),y}function o(p,m){return to(i(p,m),m)}function l(p,m,g,x){var _="C;Y"+(g+1)+";X"+(x+1)+";K";switch(p.t){case"n":_+=p.v||0,p.f&&!p.F&&(_+=";E"+V1(p.f,{r:g,c:x}));break;case"b":_+=p.v?"TRUE":"FALSE";break;case"e":_+=p.w||p.v;break;case"d":_+='"'+(p.w||p.v)+'"';break;case"s":_+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(p,m){m.forEach(function(g,x){var _="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=w0(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=E0(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&p.push(_)})}function f(p,m){m.forEach(function(g,x){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*T0(g.hpx)+";"),_.length>2&&p.push(_+"R"+(x+1))})}function d(p,m){var g=["ID;PWXL;N;E"],x=[],_=gt(p["!ref"]),y,E=Array.isArray(p),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&c(g,p["!cols"]),p["!rows"]&&f(g,p["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var R=_.s.r;R<=_.e.r;++R)for(var V=_.s.c;V<=_.e.c;++V){var L=Xe({r:R,c:V});y=E?(p[R]||[])[V]:p[L],!(!y||y.v==null&&(!y.f||y.F))&&x.push(l(y,p,R,V))}return g.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),mb=function(){function e(a,i){switch(i.type){case"base64":return t(ns(a),i);case"binary":return t(a,i);case"buffer":return t(st&&Buffer.isBuffer(a)?a.toString("binary"):eo(a),i);case"array":return t(Wo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var p=o[f].trim().split(","),m=p[0],g=p[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+m){case-1:if(x==="BOT"){d[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[l][c]=!0:x==="FALSE"?d[l][c]=!1:isNaN(Xs(g))?isNaN(wc(g).getDate())?d[l][c]=g:d[l][c]=$t(g):d[l][c]=Xs(g),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return Pc(e(a,i),i)}function n(a,i){return to(r(a,i),i)}var s=function(){var a=function(l,c,f,d,p){l.push(c),l.push(f+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=gt(l["!ref"]),d,p=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){i(c,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var x=Xe({r:m,c:g});if(d=p?(l[m]||[])[g]:l[x],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=As(d.z||He[14],Dr($t(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var y=`\r
`,E=c.join(y);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),xb=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var m=d.split(`
`),g=-1,x=-1,_=0,y=[];_!==m.length;++_){var E=m[_].trim().split(":");if(E[0]==="cell"){var w=Jt(E[1]);if(y.length<=w.r)for(g=y.length;g<=w.r;++g)y[g]||(y[g]=[]);switch(g=w.r,x=w.c,E[2]){case"t":y[g][x]=e(E[3]);break;case"v":y[g][x]=+E[3];break;case"vtf":var R=E[E.length-1];case"vtc":switch(E[3]){case"nl":y[g][x]=!!+E[4];break;default:y[g][x]=+E[4];break}E[2]=="vtf"&&(y[g][x]=[y[g][x],R])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function n(d,p){return Pc(r(d,p),p)}function s(d,p){return to(n(d,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var p=[],m=[],g,x="",_=$n(d["!ref"]),y=Array.isArray(d),E=_.s.r;E<=_.e.r;++E)for(var w=_.s.c;w<=_.e.c;++w)if(x=Xe({r:E,c:w}),g=y?(d[E]||[])[w]:d[x],!(!g||g.v==null||g.t==="z")){switch(m=["cell",x,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var R=Dr($t(g.v));m[2]="vtc",m[3]="nd",m[4]=""+R,m[5]=g.w||As(g.z||He[14],R);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[a,i,o,i,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),Ec=function(){function e(f,d,p,m,g){g.raw?d[p][m]=f:f===""||(f==="TRUE"?d[p][m]=!0:f==="FALSE"?d[p][m]=!1:isNaN(Xs(f))?isNaN(wc(f).getDate())?d[p][m]=f:d[p][m]=$t(f):d[p][m]=Xs(f))}function t(f,d){var p=d||{},m=[];if(!f||f.length===0)return m;for(var g=f.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var _=10,y=0,E=0;E<=x;++E)y=g[E].indexOf(" "),y==-1?y=g[E].length:y++,_=Math.max(_,y);for(E=0;E<=x;++E){m[E]=[];var w=0;for(e(g[E].slice(0,_).trim(),m,E,w,p),w=1;w<=(g[E].length-_)/10+1;++w)e(g[E].slice(_+(w-1)*10,_+w*10).trim(),m,E,w,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},p=!1,m=0,g=0;m<f.length;++m)(g=f.charCodeAt(m))==34?p=!p:!p&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&g.push([d[m],m]);if(!g.length){d=n;for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&g.push([d[m],m])}return g.sort(function(x,_){return x[0]-_[0]||n[x[1]]-n[_[1]]}),r[g.pop()[1]]||44}function a(f,d){var p=d||{},m="",g=p.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):p&&p.FS?m=p.FS:m=s(f.slice(0,1024));var _=0,y=0,E=0,w=0,R=0,V=m.charCodeAt(0),L=!1,T=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var b=p.dateNF!=null?JP(p.dateNF):null;function F(){var N=f.slice(w,R),C={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)C.t="z";else if(p.raw)C.t="s",C.v=N;else if(N.trim().length===0)C.t="s",C.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(C.t="s",C.v=N.slice(2,-1).replace(/""/g,'"')):A7(N)?(C.t="n",C.f=N.slice(1)):(C.t="s",C.v=N);else if(N=="TRUE")C.t="b",C.v=!0;else if(N=="FALSE")C.t="b",C.v=!1;else if(!isNaN(E=Xs(N)))C.t="n",p.cellText!==!1&&(C.w=N),C.v=E;else if(!isNaN(wc(N).getDate())||b&&N.match(b)){C.z=p.dateNF||He[14];var P=0;b&&N.match(b)&&(N=ZP(N,p.dateNF,N.match(b)||[]),P=1),p.cellDates?(C.t="d",C.v=$t(N,P)):(C.t="n",C.v=Dr($t(N,P))),p.cellText!==!1&&(C.w=As(C.z,C.v instanceof Date?Dr(C.v):C.v)),p.cellNF||delete C.z}else C.t="s",C.v=N;if(C.t=="z"||(p.dense?(g[_]||(g[_]=[]),g[_][y]=C):g[Xe({c:y,r:_})]=C),w=R+1,S=f.charCodeAt(w),x.e.c<y&&(x.e.c=y),x.e.r<_&&(x.e.r=_),T==V)++y;else if(y=0,++_,p.sheetRows&&p.sheetRows<=_)return!0}e:for(;R<f.length;++R)switch(T=f.charCodeAt(R)){case 34:S===34&&(L=!L);break;case V:case 10:case 13:if(!L&&F())break e;break}return R-w>0&&F(),g["!ref"]=rt(x),g}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):Pc(t(f,d),d)}function o(f,d){var p="",m=d.type=="string"?[0,0,0,0]:X1(f,d);switch(d.type){case"base64":p=ns(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof d0<"u"||(p=st&&Buffer.isBuffer(f)?f.toString("binary"):eo(f));break;case"array":p=Wo(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Pt(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=Pt(p):d.type=="binary"&&typeof d0<"u",p.slice(0,19)=="socialcalc:version:"?xb.to_sheet(d.type=="string"?p:Pt(p),d):i(p,d)}function l(f,d){return to(o(f,d),d)}function c(f){for(var d=[],p=gt(f["!ref"]),m,g=Array.isArray(f),x=p.s.r;x<=p.e.r;++x){for(var _=[],y=p.s.c;y<=p.e.c;++y){var E=Xe({r:x,c:y});if(m=g?(f[x]||[])[y]:f[E],!m||m.v==null){_.push("          ");continue}for(var w=(m.w||(ei(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(y===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function dL(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=pb.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Ec.to_workbook(e,t)}}var Po=function(){function e(U,q,H){if(U){qr(U,U.l||0);for(var G=H.Enum||oe;U.l<U.length;){var ne=U.read_shift(2),me=G[ne]||G[65535],fe=U.read_shift(2),ge=U.l+fe,ue=me.f&&me.f(U,fe,H);if(U.l=ge,q(ue,me,ne))return}}}function t(U,q){switch(q.type){case"base64":return r(Jn(ns(U)),q);case"binary":return r(Jn(U),q);case"buffer":case"array":return r(U,q)}throw"Unsupported type "+q.type}function r(U,q){if(!U)return U;var H=q||{},G=H.dense?[]:{},ne="Sheet1",me="",fe=0,ge={},ue=[],$e=[],W={s:{r:0,c:0},e:{r:0,c:0}},pt=H.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)H.Enum=oe,e(U,function(Ne,kt,Et){switch(Et){case 0:H.vers=Ne,Ne>=4096&&(H.qpro=!0);break;case 6:W=Ne;break;case 204:Ne&&(me=Ne);break;case 222:me=Ne;break;case 15:case 51:H.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:Et==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=H.dateNF||He[14],H.cellDates&&(Ne[1].t="d",Ne[1].v=Kd(Ne[1].v))),H.qpro&&Ne[3]>fe&&(G["!ref"]=rt(W),ge[ne]=G,ue.push(ne),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},fe=Ne[3],ne=me||"Sheet"+(fe+1),me="");var _t=H.dense?(G[Ne[0].r]||[])[Ne[0].c]:G[Xe(Ne[0])];if(_t){_t.t=Ne[1].t,_t.v=Ne[1].v,Ne[1].z!=null&&(_t.z=Ne[1].z),Ne[1].f!=null&&(_t.f=Ne[1].f);break}H.dense?(G[Ne[0].r]||(G[Ne[0].r]=[]),G[Ne[0].r][Ne[0].c]=Ne[1]):G[Xe(Ne[0])]=Ne[1];break}},H);else if(U[2]==26||U[2]==14)H.Enum=Pe,U[2]==14&&(H.qpro=!0,U.l=0),e(U,function(Ne,kt,Et){switch(Et){case 204:ne=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>fe&&(G["!ref"]=rt(W),ge[ne]=G,ue.push(ne),G=H.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},fe=Ne[3],ne="Sheet"+(fe+1)),pt>0&&Ne[0].r>=pt)break;H.dense?(G[Ne[0].r]||(G[Ne[0].r]=[]),G[Ne[0].r][Ne[0].c]=Ne[1]):G[Xe(Ne[0])]=Ne[1],W.e.c<Ne[0].c&&(W.e.c=Ne[0].c),W.e.r<Ne[0].r&&(W.e.r=Ne[0].r);break;case 27:Ne[14e3]&&($e[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:$e[Ne[0]]=Ne[1],Ne[0]==fe&&(ne=Ne[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(G["!ref"]=rt(W),ge[me||ne]=G,ue.push(me||ne),!$e.length)return{SheetNames:ue,Sheets:ge};for(var tt={},vt=[],Le=0;Le<$e.length;++Le)ge[ue[Le]]?(vt.push($e[Le]||ue[Le]),tt[$e[Le]]=ge[$e[Le]]||ge[ue[Le]]):(vt.push($e[Le]),tt[$e[Le]]={"!ref":"A1"});return{SheetNames:vt,Sheets:tt}}function n(U,q){var H=q||{};if(+H.codepage>=0&&Ws(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Wn(),ne=gt(U["!ref"]),me=Array.isArray(U),fe=[];Ae(G,0,a(1030)),Ae(G,6,l(ne));for(var ge=Math.min(ne.e.r,8191),ue=ne.s.r;ue<=ge;++ue)for(var $e=pr(ue),W=ne.s.c;W<=ne.e.c;++W){ue===ne.s.r&&(fe[W]=Qt(W));var pt=fe[W]+$e,tt=me?(U[ue]||[])[W]:U[pt];if(!(!tt||tt.t=="z"))if(tt.t=="n")(tt.v|0)==tt.v&&tt.v>=-32768&&tt.v<=32767?Ae(G,13,m(ue,W,tt.v)):Ae(G,14,x(ue,W,tt.v));else{var vt=ei(tt);Ae(G,15,d(ue,W,vt.slice(0,239)))}}return Ae(G,1),G.end()}function s(U,q){var H=q||{};if(+H.codepage>=0&&Ws(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Wn();Ae(G,0,i(U));for(var ne=0,me=0;ne<U.SheetNames.length;++ne)(U.Sheets[U.SheetNames[ne]]||{})["!ref"]&&Ae(G,27,X(U.SheetNames[ne],me++));var fe=0;for(ne=0;ne<U.SheetNames.length;++ne){var ge=U.Sheets[U.SheetNames[ne]];if(!(!ge||!ge["!ref"])){for(var ue=gt(ge["!ref"]),$e=Array.isArray(ge),W=[],pt=Math.min(ue.e.r,8191),tt=ue.s.r;tt<=pt;++tt)for(var vt=pr(tt),Le=ue.s.c;Le<=ue.e.c;++Le){tt===ue.s.r&&(W[Le]=Qt(Le));var Ne=W[Le]+vt,kt=$e?(ge[tt]||[])[Le]:ge[Ne];if(!(!kt||kt.t=="z"))if(kt.t=="n")Ae(G,23,F(tt,Le,fe,kt.v));else{var Et=ei(kt);Ae(G,22,T(tt,Le,fe,Et.slice(0,239)))}}++fe}}return Ae(G,1),G.end()}function a(U){var q=le(2);return q.write_shift(2,U),q}function i(U){var q=le(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var H=0,G=0,ne=0,me=0;me<U.SheetNames.length;++me){var fe=U.SheetNames[me],ge=U.Sheets[fe];if(!(!ge||!ge["!ref"])){++ne;var ue=$n(ge["!ref"]);H<ue.e.r&&(H=ue.e.r),G<ue.e.c&&(G=ue.e.c)}}return H>8191&&(H=8191),q.write_shift(2,H),q.write_shift(1,ne),q.write_shift(1,G),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(U,q,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&H.qpro?(G.s.c=U.read_shift(1),U.l++,G.s.r=U.read_shift(2),G.e.c=U.read_shift(1),U.l++,G.e.r=U.read_shift(2),G):(G.s.c=U.read_shift(2),G.s.r=U.read_shift(2),q==12&&H.qpro&&(U.l+=2),G.e.c=U.read_shift(2),G.e.r=U.read_shift(2),q==12&&H.qpro&&(U.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(U){var q=le(8);return q.write_shift(2,U.s.c),q.write_shift(2,U.s.r),q.write_shift(2,U.e.c),q.write_shift(2,U.e.r),q}function c(U,q,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=U.read_shift(1),G[3]=U.read_shift(1),G[0].r=U.read_shift(2),U.l+=2):(G[2]=U.read_shift(1),G[0].c=U.read_shift(2),G[0].r=U.read_shift(2)),G}function f(U,q,H){var G=U.l+q,ne=c(U,q,H);if(ne[1].t="s",H.vers==20768){U.l++;var me=U.read_shift(1);return ne[1].v=U.read_shift(me,"utf8"),ne}return H.qpro&&U.l++,ne[1].v=U.read_shift(G-U.l,"cstr"),ne}function d(U,q,H){var G=le(7+H.length);G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(1,39);for(var ne=0;ne<G.length;++ne){var me=H.charCodeAt(ne);G.write_shift(1,me>=128?95:me)}return G.write_shift(1,0),G}function p(U,q,H){var G=c(U,q,H);return G[1].v=U.read_shift(2,"i"),G}function m(U,q,H){var G=le(7);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(2,H,"i"),G}function g(U,q,H){var G=c(U,q,H);return G[1].v=U.read_shift(8,"f"),G}function x(U,q,H){var G=le(13);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(8,H,"f"),G}function _(U,q,H){var G=U.l+q,ne=c(U,q,H);if(ne[1].v=U.read_shift(8,"f"),H.qpro)U.l=G;else{var me=U.read_shift(2);R(U.slice(U.l,U.l+me),ne),U.l+=me}return ne}function y(U,q,H){var G=q&32768;return q&=-32769,q=(G?U:0)+(q>=8192?q-16384:q),(G?"":"$")+(H?Qt(q):pr(q))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(U,q){qr(U,0);for(var H=[],G=0,ne="",me="",fe="",ge="";U.l<U.length;){var ue=U[U.l++];switch(ue){case 0:H.push(U.read_shift(8,"f"));break;case 1:me=y(q[0].c,U.read_shift(2),!0),ne=y(q[0].r,U.read_shift(2),!1),H.push(me+ne);break;case 2:{var $e=y(q[0].c,U.read_shift(2),!0),W=y(q[0].r,U.read_shift(2),!1);me=y(q[0].c,U.read_shift(2),!0),ne=y(q[0].r,U.read_shift(2),!1),H.push($e+W+":"+me+ne)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(U.read_shift(2));break;case 6:{for(var pt="";ue=U[U.l++];)pt+=String.fromCharCode(ue);H.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ge=H.pop(),fe=H.pop(),H.push(["AND","OR"][ue-20]+"("+fe+","+ge+")");break;default:if(ue<32&&w[ue])ge=H.pop(),fe=H.pop(),H.push(fe+w[ue]+ge);else if(E[ue]){if(G=E[ue][1],G==69&&(G=U[U.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+H.join("|")+"|");return}var tt=H.slice(-G);H.length-=G,H.push(E[ue][0]+"("+tt.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}H.length==1?q[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function V(U){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=U.read_shift(2),q[3]=U[U.l++],q[0].c=U[U.l++],q}function L(U,q){var H=V(U);return H[1].t="s",H[1].v=U.read_shift(q-4,"cstr"),H}function T(U,q,H,G){var ne=le(6+G.length);ne.write_shift(2,U),ne.write_shift(1,H),ne.write_shift(1,q),ne.write_shift(1,39);for(var me=0;me<G.length;++me){var fe=G.charCodeAt(me);ne.write_shift(1,fe>=128?95:fe)}return ne.write_shift(1,0),ne}function S(U,q){var H=V(U);H[1].v=U.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function b(U,q){var H=V(U),G=U.read_shift(4),ne=U.read_shift(4),me=U.read_shift(2);if(me==65535)return G===0&&ne===3221225472?(H[1].t="e",H[1].v=15):G===0&&ne===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var fe=me&32768;return me=(me&32767)-16446,H[1].v=(1-fe*2)*(ne*Math.pow(2,me+32)+G*Math.pow(2,me)),H}function F(U,q,H,G){var ne=le(14);if(ne.write_shift(2,U),ne.write_shift(1,H),ne.write_shift(1,q),G==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var me=0,fe=0,ge=0,ue=0;return G<0&&(me=1,G=-G),fe=Math.log2(G)|0,G/=Math.pow(2,fe-31),ue=G>>>0,ue&2147483648||(G/=2,++fe,ue=G>>>0),G-=ue,ue|=2147483648,ue>>>=0,G*=Math.pow(2,32),ge=G>>>0,ne.write_shift(4,ge),ne.write_shift(4,ue),fe+=16383+(me?32768:0),ne.write_shift(2,fe),ne}function N(U,q){var H=b(U);return U.l+=q-14,H}function C(U,q){var H=V(U),G=U.read_shift(4);return H[1].v=G>>6,H}function P(U,q){var H=V(U),G=U.read_shift(8,"f");return H[1].v=G,H}function ce(U,q){var H=P(U);return U.l+=q-10,H}function ye(U,q){return U[U.l+q-1]==0?U.read_shift(q,"cstr"):""}function we(U,q){var H=U[U.l++];H>q-1&&(H=q-1);for(var G="";G.length<H;)G+=String.fromCharCode(U[U.l++]);return G}function ke(U,q,H){if(!(!H.qpro||q<21)){var G=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ne=U.read_shift(q-21,"cstr");return[G,ne]}}function ie(U,q){for(var H={},G=U.l+q;U.l<G;){var ne=U.read_shift(2);if(ne==14e3){for(H[ne]=[0,""],H[ne][0]=U.read_shift(2);U[U.l];)H[ne][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return H}function X(U,q){var H=le(5+U.length);H.write_shift(2,14e3),H.write_shift(2,q);for(var G=0;G<U.length;++G){var ne=U.charCodeAt(G);H[H.l++]=ne>127?95:ne}return H[H.l++]=0,H}var oe={0:{n:"BOF",f:wr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},Pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function pL(e){var t={},r=e.match(yn),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=qe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=u1[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var mL=function(){var e=x0("t"),t=x0("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:xt(i[1])},l=a.match(t);return l&&(o.s=pL(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),xL=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),gL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,vL=/<(?:\w+:)?r>/,_L=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function D1(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xt(Pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pt(e),r&&(n.h=y1(n.t))):e.match(vL)&&(n.r=Pt(e),n.t=xt(Pt((e.replace(_L,"").match(gL)||[]).join("").replace(yn,""))),r&&(n.h=xL(mL(n.r)))),n):{t:""}}var yL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wL=/<(?:\w+:)?(?:si|sstItem)>/g,EL=/<\/(?:\w+:)?(?:si|sstItem)>/;function TL(e,t){var r=[],n="";if(!e)return r;var s=e.match(yL);if(s){n=s[2].replace(wL,"").split(EL);for(var a=0;a!=n.length;++a){var i=D1(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=qe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var kL=/^\s|\s$|[\t\n\r]/;function gb(e,t){if(!t.bookSST)return"";var r=[mr];r[r.length]=Se("sst",null,{xmlns:nl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(kL)&&(a+=' xml:space="preserve"'),a+=">"+Ct(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function SL(e){return[e.read_shift(4),e.read_shift(4)]}function bL(e,t){var r=[],n=!1;return ni(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function AL(e,t){return t||(t=le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var NL=MD;function CL(e){var t=Wn();pe(t,159,AL(e));for(var r=0;r<e.length;++r)pe(t,19,NL(e[r]));return pe(t,160),t.end()}function vb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ga(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function IL(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ga(e,4),t.U=Ga(e,4),t.W=Ga(e,4),t}function FL(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function RL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(FL(e));return t}function PL(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function DL(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ga(e,4),t.U=Ga(e,4),t.W=Ga(e,4),t}function OL(e){var t=DL(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function _b(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function yb(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function jL(e){var t=Ga(e);switch(t.Minor){case 2:return[t.Minor,LL(e)];case 3:return[t.Minor,ML()];case 4:return[t.Minor,VL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LL(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=_b(e,r),s=yb(e,e.length-e.l);return{t:"Std",h:n,v:s}}function ML(){throw new Error("File is password-protected: ECMA-376 Extensible")}function VL(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(yn,function(a){var i=qe(a);switch(ka(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function BL(e,t){var r={},n=r.EncryptionVersionInfo=Ga(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=_b(e,s),t-=s,r.EncryptionVerifier=yb(e,t),r}function UL(e){var t={},r=t.EncryptionVersionInfo=Ga(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function O1(e){var t=0,r,n=vb(e),s=n.length+1,a,i,o,l,c;for(r=Xi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var wb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=vb(i),l=a(o),c=o.length,f=Xi(16),d=0;d!=16;++d)f[d]=0;var p,m,g;for((c&1)===1&&(p=l>>8,f[c]=s(e[0],p),--c,p=l&255,m=o[o.length-1],f[c]=s(m,p));c>0;)--c,p=l>>8,f[c]=s(o[c],p),--c,p=l&255,f[c]=s(o[c],p);for(c=15,g=15-o.length;g>0;)p=l>>8,f[c]=s(e[g],p),--c,--g,p=l&255,f[c]=s(o[c],p),--c,--g;return f}}(),zL=function(e,t,r,n,s){s||(s=t),n||(n=wb(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},WL=function(e){var t=0,r=wb(e);return function(n){var s=zL("",n,t,r);return t=s[1],s[0]}};function $L(e,t,r,n){var s={key:wr(e),verificationBytes:wr(e)};return r.password&&(s.verifier=O1(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=WL(r.password)),s}function HL(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=UL(e):n.Data=BL(e,t),n}function GL(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?HL(e,t-2,n):$L(e,r.biff>=8?t:t-2,r,n),n}var Eb=function(){function e(s,a){switch(a.type){case"base64":return t(ns(s),a);case"binary":return t(s,a);case"buffer":return t(st&&Buffer.isBuffer(s)?s.toString("binary"):eo(s),a);case"array":return t(Wo(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,m=0,g,x=-1;g=p.exec(f);){switch(g[0]){case"\\cell":var _=f.slice(m,p.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++x,_.length){var y={v:_,t:"s"};Array.isArray(o)?o[d][x]=y:o[Xe({r:d,c:x})]=y}break}m=p.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=rt(c),o}function r(s,a){return to(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=gt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Xe({r:c,c:f});o=l?(s[c]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ei(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function XL(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function y0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function KL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function qL(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function cd(e,t){if(t===0)return e;var r=KL(XL(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),y0(qL(r))}var Tb=6,YL=15,QL=1,mn=Tb;function w0(e){return Math.floor((e+Math.round(128/mn)/256)*mn)}function E0(e){return Math.floor((e-5)/mn*100+.5)/100}function ud(e){return Math.round((e*mn+5)/mn*256)/256}function qp(e){return ud(E0(w0(e)))}function j1(e){var t=Math.abs(e-qp(e)),r=mn;if(t>.005)for(mn=QL;mn<YL;++mn)Math.abs(e-qp(e))<=t&&(t=Math.abs(e-qp(e)),r=mn);mn=r}function Ki(e){e.width?(e.wpx=w0(e.width),e.wch=E0(e.wpx),e.MDW=mn):e.wpx?(e.wch=E0(e.wpx),e.width=ud(e.wch),e.MDW=mn):typeof e.wch=="number"&&(e.width=ud(e.wch),e.wpx=w0(e.width),e.MDW=mn),e.customWidth&&delete e.customWidth}var JL=96,kb=JL;function T0(e){return e*96/kb}function Tc(e){return e*kb/96}var ZL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function e9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(yn)||[]).forEach(function(i){var o=qe(i);switch(ka(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Ut(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Ut(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function t9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(yn)||[]).forEach(function(i){var o=qe(i);switch(ka(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function r9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(yn)||[]).forEach(function(i){var o=qe(i);switch(ka(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Pt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Ut(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Ut(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Ut(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Ut(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Ut(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Ut(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Ut(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=u1[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Ut(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Fo[s.color.index];s.color.index==81&&(l=Fo[1]),l||(l=Fo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=cd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function n9(e,t,r){t.NumberFmt=[];for(var n=ir(He),s=0;s<n.length;++s)t.NumberFmt[n[s]]=He[n[s]];var a=e[0].match(yn);if(a)for(s=0;s<a.length;++s){var i=qe(a[s]);switch(ka(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=xt(Pt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Ha(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function s9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Se("numFmt",null,{numFmtId:n,formatCode:Ct(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Uf=["numFmtId","fillId","fontId","borderId","xfId"],zf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function a9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(yn)||[]).forEach(function(a){var i=qe(a),o=0;switch(ka(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Uf.length;++o)n[Uf[o]]&&(n[Uf[o]]=parseInt(n[Uf[o]],10));for(o=0;o<zf.length;++o)n[zf[o]]&&(n[zf[o]]=Ut(n[zf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Ut(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function i9(e){var t=[];return t[t.length]=Se("cellXfs",null),e.forEach(function(r){t[t.length]=Se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var o9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&n9(d,f,c),(d=o.match(s))&&r9(d,f,l,c),(d=o.match(n))&&t9(d,f,l,c),(d=o.match(a))&&e9(d,f,l,c),(d=o.match(r))&&a9(d,f,c),f}}();function Sb(e,t){var r=[mr,Se("styleSheet",null,{xmlns:nl[0],"xmlns:vt":Fr.vt})],n;return e.SSF&&(n=s9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=i9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function l9(e,t){var r=e.read_shift(2),n=gn(e);return[r,n]}function c9(e,t,r){r||(r=le(6+4*t.length)),r.write_shift(2,e),Ur(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function u9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=HD(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=$D(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gn(e),n}function f9(e,t){t||(t=le(25+4*32)),t.write_shift(2,e.sz*20),GD(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),id(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ur(e.name,t),t.length>t.l?t.slice(0,t.l):t}var h9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Yp,d9=_n;function fw(e,t){t||(t=le(4*3+8*7+16*1)),Yp||(Yp=Gd(h9));var r=Yp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(id({auto:1},t),id({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function p9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function bb(e,t,r){r||(r=le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nu(e,t){return t||(t=le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var m9=_n;function x9(e,t){return t||(t=le(51)),t.write_shift(1,0),nu(null,t),nu(null,t),nu(null,t),nu(null,t),nu(null,t),t.length>t.l?t.slice(0,t.l):t}function g9(e,t){return t||(t=le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ad(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function v9(e,t,r){var n=le(2052);return n.write_shift(4,e),ad(t,n),ad(r,n),n.length>n.l?n.slice(0,n.l):n}function _9(e,t,r){var n={};n.NumberFmt=[];for(var s in He)n.NumberFmt[s]=He[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ni(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Ha(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=cd(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(f);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function y9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(pe(e,615,Ks(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&pe(e,44,c9(s,t[s]))}),pe(e,616))}}function w9(e){var t=1;pe(e,611,Ks(t)),pe(e,43,f9({sz:12,color:{theme:1},name:"Calibri",family:2})),pe(e,612)}function E9(e){var t=2;pe(e,603,Ks(t)),pe(e,45,fw({patternType:"none"})),pe(e,45,fw({patternType:"gray125"})),pe(e,604)}function T9(e){var t=1;pe(e,613,Ks(t)),pe(e,46,x9()),pe(e,614)}function k9(e){var t=1;pe(e,626,Ks(t)),pe(e,47,bb({numFmtId:0},65535)),pe(e,627)}function S9(e,t){pe(e,617,Ks(t.length)),t.forEach(function(r){pe(e,47,bb(r,0))}),pe(e,618)}function b9(e){var t=1;pe(e,619,Ks(t)),pe(e,48,g9({xfId:0,name:"Normal"})),pe(e,620)}function A9(e){var t=0;pe(e,505,Ks(t)),pe(e,506)}function N9(e){var t=0;pe(e,508,v9(t,"TableStyleMedium9","PivotStyleMedium4")),pe(e,509)}function C9(e,t){var r=Wn();return pe(r,278),y9(r,e.SSF),w9(r),E9(r),T9(r),k9(r),S9(r,t.cellXfs),b9(r),A9(r),N9(r),pe(r,279),r.end()}var I9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function F9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(yn)||[]).forEach(function(s){var a=qe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[I9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function R9(){}function P9(){}var D9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,O9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,j9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function L9(e,t,r){t.themeElements={};var n;[["clrScheme",D9,F9],["fontScheme",O9,R9],["fmtScheme",j9,P9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var M9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ab(e,t){(!e||e.length===0)&&(e=L1());var r,n={};if(!(r=e.match(M9)))throw new Error("themeElements not found in theme");return L9(r[0],n,t),n.raw=e,n}function L1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[mr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function V9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=_S(a,{type:"array"})}catch{return}var o=Zn(i,"theme/theme/theme1.xml",!0);if(o)return Ab(o,r)}}function B9(e){return e.read_shift(4)}function U9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=z9(e,4);break;case 2:t.xclrValue=ib(e);break;case 3:t.xclrValue=B9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function z9(e,t){return _n(e,t)}function W9(e,t){return _n(e,t)}function $9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=U9(e);break;case 6:n[1]=W9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function H9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push($9(e,r-e.l));return{ixfe:n,ext:a}}function G9(e,t){t.forEach(function(r){switch(r[0]){}})}function X9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:gn(e)}}function K9(e){var t=le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ur(e.name,t),t.slice(0,t.l)}function q9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Y9(e){var t=le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Q9(e,t){var r=le(8+2*t.length);return r.write_shift(4,e),Ur(t,r),r.slice(0,r.l)}function J9(e){return e.l+=4,e.read_shift(4)!=0}function Z9(e,t){var r=le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function e7(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ni(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function t7(){var e=Wn();return pe(e,332),pe(e,334,Ks(1)),pe(e,335,K9({name:"XLDAPR",version:12e4,flags:3496657072})),pe(e,336),pe(e,339,Q9(1,"XLDAPR")),pe(e,52),pe(e,35,Ks(514)),pe(e,4096,Ks(0)),pe(e,4097,gs(1)),pe(e,36),pe(e,53),pe(e,340),pe(e,337,Z9(1)),pe(e,51,Y9([[1,0]])),pe(e,338),pe(e,333),e.end()}function r7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(yn,function(o){var l=qe(o);switch(ka(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Nb(){var e=[mr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function n7(e){var t=[];if(!e)return t;var r=1;return(e.match(yn)||[]).forEach(function(n){var s=qe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function s7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function a7(e,t,r){var n=[];return ni(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function i7(e,t,r,n){if(!e)return e;var s=n||{},a=!1;ni(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function o7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gl=1024;function Cb(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Se("xml",null,{"xmlns:v":Yn.v,"xmlns:o":Yn.o,"xmlns:x":Yn.x,"xmlns:mv":Yn.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gl<e*1e3;)Gl+=1e3;return t.forEach(function(a){var i=Jt(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Se("v:fill",l,o),f={on:"t",obscured:"t"};++Gl,s=s.concat(["<v:shape"+g0({id:"_x0000_s"+Gl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Se("v:shadow",null,f),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Qr("x:AutoFill","False"),Qr("x:Row",String(i.r)),Qr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function hw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Jt(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=gt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=rt(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}a.c.push(f)})}function l7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=qe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Jt(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!d&&!!d[1]&&D1(d[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function Ib(e){var t=[mr,Se("comments",null,{xmlns:nl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Ct(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Ct(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Qr("t",Ct(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Qr("t",Ct(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function c7(e,t){var r=[],n=!1,s={},a=0;return e.replace(yn,function(o,l){var c=qe(o);switch(ka(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function u7(e,t,r){var n=[mr,Se("ThreadedComments",null,{xmlns:Fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Se("threadedComment",Qr("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function f7(e,t){var r=[],n=!1;return e.replace(yn,function(a){var i=qe(a);switch(ka(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function h7(e){var t=[mr,Se("personList",null,{xmlns:Fr.TCMNT,"xmlns:x":nl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function d7(e){var t={};t.iauthor=e.read_shift(4);var r=ol(e);return t.rfx=r.s,t.ref=Xe(r.s),e.l+=16,t}function p7(e,t){return t==null&&(t=le(36)),t.write_shift(4,e[1].iauthor),Dc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var m7=gn;function x7(e){return Ur(e.slice(0,54))}function g7(e,t){var r=[],n=[],s={},a=!1;return ni(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function v7(e){var t=Wn(),r=[];return pe(t,628),pe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),pe(t,632,x7(s.a)))})}),pe(t,631),pe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Jt(n[0]),e:Jt(n[0])};pe(t,635,p7([a,s])),s.t&&s.t.length>0&&pe(t,637,BD(s)),pe(t,636),delete s.iauthor})}),pe(t,634),pe(t,629),t.end()}var _7="application/vnd.ms-office.vbaProject";function y7(e){var t=Be.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Be.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Be.write(t)}function w7(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Be.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Fb=["xlsb","xlsm","xlam","biff8","xla"];function E7(){return{"!type":"dialog"}}function T7(){return{"!type":"dialog"}}function k7(){return{"!type":"macro"}}function S7(){return{"!type":"macro"}}var sc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,s+(o?"":"$")+Qt(f)+(l?"":"$")+pr(c)}return function(s,a){return t=a,s.replace(e,r)}}(),M1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,V1=function(){return function(t,r){return t.replace(M1,function(n,s,a,i,o,l){var c=S1(i)-(a?0:r.c),f=k1(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=c==0?"":a?c+1:"["+c+"]";return s+"R"+d+"C"+p})}}();function Rb(e,t){return e.replace(M1,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Qt(S1(a)+t.c))+(i=="$"?i+o:pr(k1(o)+t.r))})}function b7(e,t,r){var n=$n(t),s=n.s,a=Jt(r),i={r:a.r-s.r,c:a.c-s.c};return Rb(e,i)}function A7(e){return e.length!=1}function dw(e){return e.replace(/_xlfn\./g,"")}function vr(e){e.l+=1}function qi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Pb(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Db(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=qi(e),o=qi(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Db(e){var t=qi(e),r=qi(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function N7(e,t,r){if(r.biff<8)return Db(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=qi(e),i=qi(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function Ob(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return C7(e);var n=e.read_shift(r&&r.biff==12?4:2),s=qi(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function C7(e){var t=qi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function I7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F7(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return R7(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function R7(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function P7(e,t,r){var n=(e[e.l++]&96)>>5,s=Pb(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function D7(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=Pb(e,a,r);return[n,s,i]}function O7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function j7(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function L7(e,t,r){var n=(e[e.l++]&96)>>5,s=N7(e,t-1,r);return[n,s]}function M7(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function V7(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function B7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function U7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function z7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function W7(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jb(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $7(e){return e.read_shift(2),jb(e)}function H7(e){return e.read_shift(2),jb(e)}function G7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Ob(e,0,r);return[n,s]}function X7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=F7(e,0,r);return[n,s]}function K7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=Ob(e,0,r);return[n,s,a]}function q7(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[JM[s],Vb[s],n]}function Y7(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Q7(e);return[s,(a[0]===0?Vb:QM)[a[1]]]}function Q7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function J7(e,t,r){e.l+=r&&r.biff==2?3:4}function Z7(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function eM(e){return e.l++,si[e.read_shift(1)]}function tM(e){return e.l++,e.read_shift(2)}function rM(e){return e.l++,e.read_shift(1)!==0}function nM(e){return e.l++,xn(e)}function sM(e,t,r){return e.l++,U0(e,t-1,r)}function aM(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=fr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=si[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=xn(e);break;case 2:r[1]=ll(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function iM(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ol:qd)(e));return s}function oM(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=aM(e,r.biff);return i}function lM(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function cM(e,t,r){if(r.biff==5)return uM(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function uM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function fM(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function hM(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function dM(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function pM(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var mM=_n,xM=_n,gM=_n;function W0(e,t,r){return e.l+=2,[I7(e)]}function B1(e){return e.l+=6,[]}var vM=W0,_M=B1,yM=B1,wM=W0;function Lb(e){return e.l+=2,[wr(e),e.read_shift(2)&1]}var EM=W0,TM=Lb,kM=B1,SM=W0,bM=W0,AM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=AM[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function CM(e){return e.l+=2,[e.read_shift(4)]}function IM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function FM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function RM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function DM(e){return e.l+=4,[0,0]}var mw={1:{n:"PtgExp",f:Z7},2:{n:"PtgTbl",f:gM},3:{n:"PtgAdd",f:vr},4:{n:"PtgSub",f:vr},5:{n:"PtgMul",f:vr},6:{n:"PtgDiv",f:vr},7:{n:"PtgPower",f:vr},8:{n:"PtgConcat",f:vr},9:{n:"PtgLt",f:vr},10:{n:"PtgLe",f:vr},11:{n:"PtgEq",f:vr},12:{n:"PtgGe",f:vr},13:{n:"PtgGt",f:vr},14:{n:"PtgNe",f:vr},15:{n:"PtgIsect",f:vr},16:{n:"PtgUnion",f:vr},17:{n:"PtgRange",f:vr},18:{n:"PtgUplus",f:vr},19:{n:"PtgUminus",f:vr},20:{n:"PtgPercent",f:vr},21:{n:"PtgParen",f:vr},22:{n:"PtgMissArg",f:vr},23:{n:"PtgStr",f:sM},26:{n:"PtgSheet",f:IM},27:{n:"PtgEndSheet",f:FM},28:{n:"PtgErr",f:eM},29:{n:"PtgBool",f:rM},30:{n:"PtgInt",f:tM},31:{n:"PtgNum",f:nM},32:{n:"PtgArray",f:M7},33:{n:"PtgFunc",f:q7},34:{n:"PtgFuncVar",f:Y7},35:{n:"PtgName",f:lM},36:{n:"PtgRef",f:G7},37:{n:"PtgArea",f:P7},38:{n:"PtgMemArea",f:fM},39:{n:"PtgMemErr",f:mM},40:{n:"PtgMemNoMem",f:xM},41:{n:"PtgMemFunc",f:hM},42:{n:"PtgRefErr",f:dM},43:{n:"PtgAreaErr",f:O7},44:{n:"PtgRefN",f:X7},45:{n:"PtgAreaN",f:L7},46:{n:"PtgMemAreaN",f:RM},47:{n:"PtgMemNoMemN",f:PM},57:{n:"PtgNameX",f:cM},58:{n:"PtgRef3d",f:K7},59:{n:"PtgArea3d",f:D7},60:{n:"PtgRefErr3d",f:pM},61:{n:"PtgAreaErr3d",f:j7},255:{}},OM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jM={1:{n:"PtgElfLel",f:Lb},2:{n:"PtgElfRw",f:SM},3:{n:"PtgElfCol",f:vM},6:{n:"PtgElfRwV",f:bM},7:{n:"PtgElfColV",f:wM},10:{n:"PtgElfRadical",f:EM},11:{n:"PtgElfRadicalS",f:kM},13:{n:"PtgElfColS",f:_M},15:{n:"PtgElfColSV",f:yM},16:{n:"PtgElfRadicalLel",f:TM},25:{n:"PtgList",f:NM},29:{n:"PtgSxName",f:CM},255:{}},LM={0:{n:"PtgAttrNoop",f:DM},1:{n:"PtgAttrSemi",f:W7},2:{n:"PtgAttrIf",f:U7},4:{n:"PtgAttrChoose",f:V7},8:{n:"PtgAttrGoto",f:B7},16:{n:"PtgAttrSum",f:J7},32:{n:"PtgAttrBaxcel",f:pw},33:{n:"PtgAttrBaxcel",f:pw},64:{n:"PtgAttrSpace",f:$7},65:{n:"PtgAttrSpaceSemi",f:H7},128:{n:"PtgAttrIfError",f:z7},255:{}};function $0(e,t,r,n){if(n.biff<8)return _n(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=oM(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=iM(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(_n(e,t)),a}function H0(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=mw[a]||mw[OM[a]],(a===24||a===25)&&(s=(a===24?jM:LM)[e[e.l+1]]),!s||!s.f?_n(e,t):i.push([s.n,s.f(e,t,r)]);return i}function MM(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var VM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function BM(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Mb(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xw(e,t,r){var n=Mb(e,t,r);return n=="#REF"?n:BM(n,r)}function hn(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,d=0,p=0,m,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,_="",y=0,E=e[0].length;y<E;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:_=sr(" ",e[0][x][1][1]);break;case 1:_=sr("\r",e[0][x][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+_,x=-1}o.push(c+VM[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ru(w[1][1],i,s),o.push(Pu(f,a));break;case"PtgRefN":f=r?Ru(w[1][1],r,s):w[1][1],o.push(Pu(f,a));break;case"PtgRef3d":d=w[1][1],f=Ru(w[1][2],i,s),g=xw(n,d,s),o.push(g+"!"+Pu(f,a));break;case"PtgFunc":case"PtgFuncVar":var R=w[1][0],V=w[1][1];R||(R=0),R&=127;var L=R==0?[]:o.slice(-R);o.length-=R,V==="User"&&(V=L.shift()),o.push(V+"("+L.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=Hy(w[1][1],r?{s:r}:i,s),o.push(Gp(m,s));break;case"PtgArea":m=Hy(w[1][1],i,s),o.push(Gp(m,s));break;case"PtgArea3d":d=w[1][1],m=w[1][2],g=xw(n,d,s),o.push(g+"!"+Gp(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var T=(n.names||[])[p-1]||(n[0]||[])[p],S=T?T.Name:"SH33TJSNAME"+String(p);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var b=w[1][1];p=w[1][2];var F;if(s.biff<=5)b<0&&(b=-b),n[b]&&(F=n[b][p]);else{var N="";if(((n[b]||[])[0]||[])[0]==14849||(((n[b]||[])[0]||[])[0]==1025?n[b][p]&&n[b][p].itab>0&&(N=n.SheetNames[n[b][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[b]&&n[b][p])N+=n[b][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var C=(Mb(n,b,s)||"").split(";;");C[p-1]?N=C[p-1]:N+="SH33TJSERRX"}o.push(N);break}F||(F={Name:"SH33TJSERRY"}),o.push(F.Name);break;case"PtgParen":var P="(",ce=")";if(x>=0){switch(_="",e[0][x][1][0]){case 2:P=sr(" ",e[0][x][1][1])+P;break;case 3:P=sr("\r",e[0][x][1][1])+P;break;case 4:ce=sr(" ",e[0][x][1][1])+ce;break;case 5:ce=sr("\r",e[0][x][1][1])+ce;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(P+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var ye={c:r.c,r:r.r};if(n.sharedf[Xe(f)]){var we=n.sharedf[Xe(f)];o.push(hn(we,i,ye,n,s))}else{var ke=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(hn(c[1],i,ye,n,s)),ke=!0;break}ke||o.push(w[1])}break;case"PtgArray":o.push("{"+MM(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&ie.indexOf(e[0][y][0])==-1){w=e[0][x];var X=!0;switch(w[1][0]){case 4:X=!1;case 0:_=sr(" ",w[1][1]);break;case 5:X=!1;case 1:_=sr("\r",w[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((X?_:"")+o.pop()+(X?"":_)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function UM(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],_n(e,t-2)];var o=H0(e,i,r);return t!==i+s&&(a=$0(e,t-i-s,o,r)),e.l=n,[o,a]}function zM(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],_n(e,t-2)];var o=H0(e,i,r);return t!==i+s&&(a=$0(e,t-i-s,o,r)),e.l=n,[o,a]}function WM(e,t,r,n){var s=e.l+t,a=H0(e,n,r),i;return s!==e.l&&(i=$0(e,s-e.l,a,r)),[a,i]}function $M(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=H0(e,a,r);return a==65535?[[],_n(e,t-2)]:(t!==a+2&&(s=$0(e,n-a-2,i,r)),[i,s])}function HM(e){var t;if(Ua(e,e.l+6)!==65535)return[xn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function GM(e){if(e==null){var t=le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $o(e);return $o(0)}function Qp(e,t,r){var n=e.l+t,s=Sa(e);r.biff==2&&++e.l;var a=HM(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=zM(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function XM(e,t,r,n,s){var a=Go(t,r,s),i=GM(e.v),o=le(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=le(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var d=Vr([a,i,o,c]);return d}function Yd(e,t,r){var n=e.read_shift(4),s=H0(e,n,r),a=e.read_shift(4),i=a>0?$0(e,a,s,r):null;return[s,i]}var KM=Yd,Qd=Yd,qM=Yd,YM=Yd,QM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Vb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},JM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ZM(e){var t="of:="+e.replace(M1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Jp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function eV(e){return e.replace(/\./,"!")}var Ou={},ac={},ju=typeof Map<"u";function U1(e,t,r){var n=0,s=e.length;if(r){if(ju?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=ju?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ju?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Jd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(mn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=E0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ud(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Do(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ro(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Ha(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Bb(e,t,r,n,s,a){try{n.cellNF&&(e.z=He[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=$t(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&Ha(QP[t]||"General",t),e.t==="e")e.w=e.w||si[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=m0(e.v);else if(e.t==="d"){var i=Dr(e.v);(i|0)===i?e.w=i.toString(10):e.w=m0(i)}else{if(e.v===void 0)return"";e.w=zo(e.v,ac)}else e.t==="d"?e.w=As(t,Dr(e.v),ac):e.w=As(t,e.v,ac)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=cd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=cd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function tV(e,t,r){if(e&&e["!ref"]){var n=gt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function rV(e,t){var r=gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rt(r))}var nV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aV=/<(?:\w:)?hyperlink [^>]*>/mg,iV=/"(\w*:\w*)"/,oV=/<(?:\w:)?col\b[^>]*[\/]?>/g,lV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,cV=/<(?:\w:)?pageMargins[^>]*\/>/g,Ub=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,uV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,fV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hV(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(sV);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var p=c.match(Ub);p?z1(p[0],o,s,r):(p=c.match(uV))&&pV(p[0],p[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=c.slice(m,m+50).match(iV);g&&rV(o,g[1])}var x=c.match(fV);x&&x[1]&&AV(x[1],s);var _=[];if(t.cellStyles){var y=c.match(oV);y&&EV(_,y)}d&&IV(d[1],o,t,l,a,i);var E=f.match(lV);E&&(o["!autofilter"]=kV(E[0]));var w=[],R=f.match(nV);if(R)for(m=0;m!=R.length;++m)w[m]=gt(R[m].slice(R[m].indexOf('"')+1));var V=f.match(aV);V&&_V(o,V,n);var L=f.match(cV);if(L&&(o["!margins"]=yV(qe(L[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=rt(l)),t.sheetRows>0&&o["!ref"]){var T=gt(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rt(T))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function dV(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+rt(e[r])+'"/>';return t+"</mergeCells>"}function z1(e,t,r,n){var s=qe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=xt(Pt(s.codeName)))}function pV(e,t,r,n,s){z1(e.slice(0,e.indexOf(">")),r,n,s)}function mV(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=da(Ct(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Se("outlinePr",null,c)}!a&&!o||(s[s.length]=Se("sheetPr",o,i))}var xV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vV(e){var t={sheet:1};return xV.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),gV.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=O1(e.password).toString(16).toUpperCase()),Se("sheetProtection",null,t)}function _V(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=qe(Pt(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+xt(a.location))):(a.Target="#"+xt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=gt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Xe({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function yV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wV(e){return Do(e),Se("pageMargins",null,e)}function EV(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=qe(t[n],!0);s.hidden&&(s.hidden=Ut(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,j1(s.width)),Ki(s);a<=i;)e[a++]=Ht(s)}}function TV(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Se("col",null,Jd(s,n)));return r[r.length]="</cols>",r.join("")}function kV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function SV(e,t,r,n){var s=typeof e.ref=="string"?e.ref:rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=$n(s);i.s.r==i.e.r&&(i.e.r=$n(t["!ref"]).e.r,s=rt(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Se("autoFilter",null,{ref:s})}var bV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function AV(e,t){t.Views||(t.Views=[{}]),(e.match(bV)||[]).forEach(function(r,n){var s=qe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Ut(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function NV(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,s),{})}function CV(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=si[e.v];break;case"d":n&&n.cellDates?s=$t(e.v,-1).toISOString():(e=Ht(e),e.t="n",s=""+(e.v=Dr($t(e.v)))),typeof e.z>"u"&&(e.z=He[14]);break;default:s=e.v;break}var o=Qr("v",Ct(s)),l={r:t},c=ro(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qr("v",""+U1(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Se("f",Ct(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Se("c",o,l)}var IV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=x0("v"),i=x0("f");return function(l,c,f,d,p,m){for(var g=0,x="",_=[],y=[],E=0,w=0,R=0,V="",L,T,S=0,b=0,F,N,C=0,P=0,ce=Array.isArray(m.CellXf),ye,we=[],ke=[],ie=Array.isArray(c),X=[],oe={},Pe=!1,U=!!f.sheetStubs,q=l.split(t),H=0,G=q.length;H!=G;++H){x=q[H].trim();var ne=x.length;if(ne!==0){var me=0;e:for(g=0;g<ne;++g)switch(x[g]){case">":if(x[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(T=qe(x.slice(me,g),!0),S=T.r!=null?parseInt(T.r,10):S+1,b=-1,f.sheetRows&&f.sheetRows<S)continue;oe={},Pe=!1,T.ht&&(Pe=!0,oe.hpt=parseFloat(T.ht),oe.hpx=Tc(oe.hpt)),T.hidden=="1"&&(Pe=!0,oe.hidden=!0),T.outlineLevel!=null&&(Pe=!0,oe.level=+T.outlineLevel),Pe&&(X[S-1]=oe)}break;case"<":me=g;break}if(me>=g)break;if(T=qe(x.slice(me,g),!0),S=T.r!=null?parseInt(T.r,10):S+1,b=-1,!(f.sheetRows&&f.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),f&&f.cellStyles&&(oe={},Pe=!1,T.ht&&(Pe=!0,oe.hpt=parseFloat(T.ht),oe.hpx=Tc(oe.hpt)),T.hidden=="1"&&(Pe=!0,oe.hidden=!0),T.outlineLevel!=null&&(Pe=!0,oe.level=+T.outlineLevel),Pe&&(X[S-1]=oe)),_=x.slice(g).split(e);for(var fe=0;fe!=_.length&&_[fe].trim().charAt(0)=="<";++fe);for(_=_.slice(fe),g=0;g!=_.length;++g)if(x=_[g].trim(),x.length!==0){if(y=x.match(r),E=g,w=0,R=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,y!=null&&y.length===2){for(E=0,V=y[1],w=0;w!=V.length&&!((R=V.charCodeAt(w)-64)<1||R>26);++w)E=26*E+R;--E,b=E}else++b;for(w=0;w!=x.length&&x.charCodeAt(w)!==62;++w);if(++w,T=qe(x.slice(0,w),!0),T.r||(T.r=Xe({r:S-1,c:b})),V=x.slice(w),L={t:""},(y=V.match(a))!=null&&y[1]!==""&&(L.v=xt(y[1])),f.cellFormula){if((y=V.match(i))!=null&&y[1]!==""){if(L.f=xt(Pt(y[1])).replace(/\r\n/g,`
`),f.xlfn||(L.f=dw(L.f)),y[0].indexOf('t="array"')>-1)L.F=(V.match(s)||[])[1],L.F.indexOf(":")>-1&&we.push([gt(L.F),L.F]);else if(y[0].indexOf('t="shared"')>-1){N=qe(y[0]);var ge=xt(Pt(y[1]));f.xlfn||(ge=dw(ge)),ke[parseInt(N.si,10)]=[N,ge,T.r]}}else(y=V.match(/<f[^>]*\/>/))&&(N=qe(y[0]),ke[N.si]&&(L.f=b7(ke[N.si][1],ke[N.si][2],T.r)));var ue=Jt(T.r);for(w=0;w<we.length;++w)ue.r>=we[w][0].s.r&&ue.r<=we[w][0].e.r&&ue.c>=we[w][0].s.c&&ue.c<=we[w][0].e.c&&(L.F=we[w][1])}if(T.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(U)L.t="z";else continue;else L.t=T.t||"n";switch(d.s.c>b&&(d.s.c=b),d.e.c<b&&(d.e.c=b),L.t){case"n":if(L.v==""||L.v==null){if(!U)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!U)continue;L.t="z"}else F=Ou[parseInt(L.v,10)],L.v=F.t,L.r=F.r,f.cellHTML&&(L.h=F.h);break;case"str":L.t="s",L.v=L.v!=null?Pt(L.v):"",f.cellHTML&&(L.h=y1(L.v));break;case"inlineStr":y=V.match(n),L.t="s",y!=null&&(F=D1(y[1]))?(L.v=F.t,f.cellHTML&&(L.h=F.h)):L.v="";break;case"b":L.v=Ut(L.v);break;case"d":f.cellDates?L.v=$t(L.v,1):(L.v=Dr($t(L.v,1)),L.t="n");break;case"e":(!f||f.cellText!==!1)&&(L.w=L.v),L.v=WS[L.v];break}if(C=P=0,ye=null,ce&&T.s!==void 0&&(ye=m.CellXf[T.s],ye!=null&&(ye.numFmtId!=null&&(C=ye.numFmtId),f.cellStyles&&ye.fillId!=null&&(P=ye.fillId))),Bb(L,C,P,f,p,m),f.cellDates&&ce&&L.t=="n"&&Fc(He[C])&&(L.t="d",L.v=Kd(L.v)),T.cm&&f.xlmeta){var $e=(f.xlmeta.Cell||[])[+T.cm-1];$e&&$e.type=="XLDAPR"&&(L.D=!0)}if(ie){var W=Jt(T.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=L}else c[T.r]=L}}}}X.length>0&&(c["!rows"]=X)}}();function FV(e,t,r,n){var s=[],a=[],i=gt(e["!ref"]),o="",l,c="",f=[],d=0,p=0,m=e["!rows"],g=Array.isArray(e),x={r:c},_,y=-1;for(p=i.s.c;p<=i.e.c;++p)f[p]=Qt(p);for(d=i.s.r;d<=i.e.r;++d){for(a=[],c=pr(d),p=i.s.c;p<=i.e.c;++p){l=f[p]+c;var E=g?(e[d]||[])[p]:e[l];E!==void 0&&(o=CV(E,l,e,t))!=null&&a.push(o)}(a.length>0||m&&m[d])&&(x={r:c},m&&m[d]&&(_=m[d],_.hidden&&(x.hidden=1),y=-1,_.hpx?y=T0(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(x.ht=y,x.customHeight=1),_.level&&(x.outlineLevel=_.level)),s[s.length]=Se("row",a.join(""),x))}if(m)for(;d<m.length;++d)m&&m[d]&&(x={r:d+1},_=m[d],_.hidden&&(x.hidden=1),y=-1,_.hpx?y=T0(_.hpx):_.hpt&&(y=_.hpt),y>-1&&(x.ht=y,x.customHeight=1),_.level&&(x.outlineLevel=_.level),s[s.length]=Se("row","",x));return s.join("")}function zb(e,t,r,n){var s=[mr,Se("worksheet",null,{xmlns:nl[0],"xmlns:r":Fr.r})],a=r.SheetNames[e],i=0,o="",l=r.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",f=gt(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=rt(f)}n||(n={}),l["!comments"]=[];var d=[];mV(l,r,e,t,s),s[s.length]=Se("dimension",null,{ref:c}),s[s.length]=NV(l,t,e,r),t.sheetFormat&&(s[s.length]=Se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=TV(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=FV(l,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=vV(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=SV(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=dV(l["!merges"]));var p=-1,m,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=Nt(n,-1,Ct(x[1].Target).replace(/#.*$/,""),at.HLINK),m["r:id"]="rId"+g),(p=x[1].Target.indexOf("#"))>-1&&(m.location=Ct(x[1].Target.slice(p+1))),x[1].Tooltip&&(m.tooltip=Ct(x[1].Tooltip)),s[s.length]=Se("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=wV(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Qr("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(g=Nt(n,-1,"../drawings/drawing"+(e+1)+".xml",at.DRAW),s[s.length]=Se("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=Nt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",at.VML),s[s.length]=Se("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function RV(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function PV(e,t,r){var n=le(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=T0(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,p=-1,m=f<<10;m<f+1<<10;++m){c.c=m;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Xe(c)];g&&(d<0&&(d=m),p=m)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var x=n.l;return n.l=l,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function DV(e,t,r,n){var s=PV(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&pe(e,0,s)}var OV=ol,jV=Dc;function LV(){}function MV(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=UD(e),r}function VV(e,t,r){r==null&&(r=le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return id({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),MS(e,r),r.slice(0,r.l)}function BV(e){var t=Ns(e);return[t]}function UV(e,t,r){return r==null&&(r=le(8)),sl(t,r)}function zV(e){var t=al(e);return[t]}function WV(e,t,r){return r==null&&(r=le(4)),il(t,r)}function $V(e){var t=Ns(e),r=e.read_shift(1);return[t,r,"b"]}function HV(e,t,r){return r==null&&(r=le(9)),sl(t,r),r.write_shift(1,e.v?1:0),r}function GV(e){var t=al(e),r=e.read_shift(1);return[t,r,"b"]}function XV(e,t,r){return r==null&&(r=le(5)),il(t,r),r.write_shift(1,e.v?1:0),r}function KV(e){var t=Ns(e),r=e.read_shift(1);return[t,r,"e"]}function qV(e,t,r){return r==null&&(r=le(9)),sl(t,r),r.write_shift(1,e.v),r}function YV(e){var t=al(e),r=e.read_shift(1);return[t,r,"e"]}function QV(e,t,r){return r==null&&(r=le(8)),il(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function JV(e){var t=Ns(e),r=e.read_shift(4);return[t,r,"s"]}function ZV(e,t,r){return r==null&&(r=le(12)),sl(t,r),r.write_shift(4,t.v),r}function eB(e){var t=al(e),r=e.read_shift(4);return[t,r,"s"]}function tB(e,t,r){return r==null&&(r=le(8)),il(t,r),r.write_shift(4,t.v),r}function rB(e){var t=Ns(e),r=xn(e);return[t,r,"n"]}function nB(e,t,r){return r==null&&(r=le(16)),sl(t,r),$o(e.v,r),r}function Wb(e){var t=al(e),r=xn(e);return[t,r,"n"]}function sB(e,t,r){return r==null&&(r=le(12)),il(t,r),$o(e.v,r),r}function aB(e){var t=Ns(e),r=C1(e);return[t,r,"n"]}function iB(e,t,r){return r==null&&(r=le(12)),sl(t,r),VS(e.v,r),r}function oB(e){var t=al(e),r=C1(e);return[t,r,"n"]}function lB(e,t,r){return r==null&&(r=le(8)),il(t,r),VS(e.v,r),r}function cB(e){var t=Ns(e),r=b1(e);return[t,r,"is"]}function uB(e){var t=Ns(e),r=gn(e);return[t,r,"str"]}function fB(e,t,r){return r==null&&(r=le(12+4*e.v.length)),sl(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hB(e){var t=al(e),r=gn(e);return[t,r,"str"]}function dB(e,t,r){return r==null&&(r=le(8+4*e.v.length)),il(t,r),Ur(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pB(e,t,r){var n=e.l+t,s=Ns(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=Qd(e,n-e.l,r);i[3]=hn(o,null,s,r.supbooks,r)}else e.l=n;return i}function mB(e,t,r){var n=e.l+t,s=Ns(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=Qd(e,n-e.l,r);i[3]=hn(o,null,s,r.supbooks,r)}else e.l=n;return i}function xB(e,t,r){var n=e.l+t,s=Ns(e);s.r=r["!row"];var a=xn(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=Qd(e,n-e.l,r);i[3]=hn(o,null,s,r.supbooks,r)}else e.l=n;return i}function gB(e,t,r){var n=e.l+t,s=Ns(e);s.r=r["!row"];var a=gn(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=Qd(e,n-e.l,r);i[3]=hn(o,null,s,r.supbooks,r)}else e.l=n;return i}var vB=ol,_B=Dc;function yB(e,t){return t==null&&(t=le(4)),t.write_shift(4,e),t}function wB(e,t){var r=e.l+t,n=ol(e),s=A1(e),a=gn(e),i=gn(e),o=gn(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function EB(e,t){var r=le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Dc({s:Jt(e[0]),e:Jt(e[0])},r),N1("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Ur(s||"",r),Ur(e[1].Tooltip||"",r),Ur("",r),r.slice(0,r.l)}function TB(){}function kB(e,t,r){var n=e.l+t,s=BS(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=KM(e,n-e.l,r);i[1]=o}else e.l=n;return i}function SB(e,t,r){var n=e.l+t,s=ol(e),a=[s];if(r.cellFormula){var i=YM(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function bB(e,t,r){r==null&&(r=le(18));var n=Jd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var $b=["left","right","top","bottom","header","footer"];function AB(e){var t={};return $b.forEach(function(r){t[r]=xn(e)}),t}function NB(e,t){return t==null&&(t=le(6*8)),Do(e),$b.forEach(function(r){$o(e[r],t)}),t}function CB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function IB(e,t,r){r==null&&(r=le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function FB(e){var t=le(24);return t.write_shift(4,4),t.write_shift(4,1),Dc(e,t),t}function RB(e,t){return t==null&&(t=le(16*4+2)),t.write_shift(2,e.password?O1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function PB(){}function DB(){}function OB(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,p=!1,m,g,x,_,y,E,w,R,V,L=[];o.biff=12,o["!row"]=0;var T=0,S=!1,b=[],F={},N=o.supbooks||s.supbooks||[[]];if(N.sharedf=F,N.arrayf=b,N.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=N,s.Names))for(var C=0;C<s.Names.length;++C)N[0][C+1]=s.Names[C];var P=[],ce=[],ye=!1;k0[16]={n:"BrtShortReal",f:Wb};var we;if(ni(e,function(X,oe,Pe){if(!p)switch(Pe){case 148:c=X;break;case 0:m=X,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),R=pr(_=m.r),o["!row"]=m.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=Tc(X.hpt)),ce[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:X[2]},X[2]){case"n":g.v=X[1];break;case"s":w=Ou[X[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!X[1];break;case"e":g.v=X[1],o.cellText!==!1&&(g.w=si[g.v]);break;case"str":g.t="s",g.v=X[1];break;case"is":g.t="s",g.v=X[1].t;break}if((x=i.CellXf[X[0].iStyleRef])&&Bb(g,x.numFmtId,null,o,a,i),y=X[0].c==-1?y+1:X[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[Qt(y)+R]=g,o.cellFormula){for(S=!1,T=0;T<b.length;++T){var U=b[T];m.r>=U[0].s.r&&m.r<=U[0].e.r&&y>=U[0].s.c&&y<=U[0].e.c&&(g.F=rt(U[0]),S=!0)}!S&&X.length>3&&(g.f=X[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),o.cellDates&&x&&g.t=="n"&&Fc(He[x.numFmtId])){var q=So(g.v);q&&(g.t="d",g.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}we&&(we.type=="XLDAPR"&&(g.D=!0),we=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},y=X[0].c==-1?y+1:X[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[Qt(y)+R]=g,f.s.r>m.r&&(f.s.r=m.r),f.s.c>y&&(f.s.c=y),f.e.r<m.r&&(f.e.r=m.r),f.e.c<y&&(f.e.c=y),we&&(we.type=="XLDAPR"&&(g.D=!0),we=void 0);break;case 176:L.push(X);break;case 49:we=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var H=n["!id"][X.relId];for(H?(X.Target=H.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=H):X.relId==""&&(X.Target="#"+X.loc),_=X.rfx.s.r;_<=X.rfx.e.r;++_)for(y=X.rfx.s.c;y<=X.rfx.e.c;++y)o.dense?(l[_]||(l[_]=[]),l[_][y]||(l[_][y]={t:"z",v:void 0}),l[_][y].l=X):(E=Xe({c:y,r:_}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=X);break;case 426:if(!o.cellFormula)break;b.push(X),V=o.dense?l[_][y]:l[Qt(y)+R],V.f=hn(X[1],f,{r:m.r,c:y},N,o),V.F=rt(X[0]);break;case 427:if(!o.cellFormula)break;F[Xe(X[0].s)]=X[1],V=o.dense?l[_][y]:l[Qt(y)+R],V.f=hn(X[1],f,{r:m.r,c:y},N,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)P[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},ye||(ye=!0,j1(X.w/256)),Ki(P[X.e+1]);break;case 161:l["!autofilter"]={ref:rt(X)};break;case 476:l["!margins"]=X;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),X.name&&(s.Sheets[r].CodeName=X.name),(X.above||X.left)&&(l["!outline"]={above:X.above,left:X.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),X.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!oe.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Pe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=rt(c||f)),o.sheetRows&&l["!ref"]){var ke=gt(l["!ref"]);o.sheetRows<=+ke.e.r&&(ke.e.r=o.sheetRows-1,ke.e.r>f.e.r&&(ke.e.r=f.e.r),ke.e.r<ke.s.r&&(ke.s.r=ke.e.r),ke.e.c>f.e.c&&(ke.e.c=f.e.c),ke.e.c<ke.s.c&&(ke.s.c=ke.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rt(ke))}return L.length>0&&(l["!merges"]=L),P.length>0&&(l["!cols"]=P),ce.length>0&&(l["!rows"]=ce),l}function jB(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ht(t),t.z=t.z||He[14],t.v=Dr($t(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ro(s.cellXfs,t,s),t.l&&a["!links"].push([Xe(l),t.l]),t.c&&a["!comments"].push([Xe(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=U1(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,i?pe(e,18,tB(t,l)):pe(e,7,ZV(t,l))):(l.t="str",i?pe(e,17,dB(t,l)):pe(e,6,fB(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?pe(e,13,lB(t,l)):pe(e,2,iB(t,l)):i?pe(e,16,sB(t,l)):pe(e,5,nB(t,l)),!0;case"b":return l.t="b",i?pe(e,15,XV(t,l)):pe(e,4,HV(t,l)),!0;case"e":return l.t="e",i?pe(e,14,QV(t,l)):pe(e,3,qV(t,l)),!0}return i?pe(e,12,WV(t,l)):pe(e,1,UV(t,l)),!0}function LB(e,t,r,n){var s=gt(t["!ref"]||"A1"),a,i="",o=[];pe(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=c;++f){i=pr(f),DV(e,t,s,f);var d=!1;if(f<=s.e.r)for(var p=s.s.c;p<=s.e.c;++p){f===s.s.r&&(o[p]=Qt(p)),a=o[p]+i;var m=l?(t[f]||[])[p]:t[a];if(!m){d=!1;continue}d=jB(e,m,f,p,n,t,d)}}pe(e,146)}function MB(e,t){!t||!t["!merges"]||(pe(e,177,yB(t["!merges"].length)),t["!merges"].forEach(function(r){pe(e,176,_B(r))}),pe(e,178))}function VB(e,t){!t||!t["!cols"]||(pe(e,390),t["!cols"].forEach(function(r,n){r&&pe(e,60,bB(n,r))}),pe(e,391))}function BB(e,t){!t||!t["!ref"]||(pe(e,648),pe(e,649,FB(gt(t["!ref"]))),pe(e,650))}function UB(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Nt(r,-1,n[1].Target.replace(/#.*$/,""),at.HLINK);pe(e,494,EB(n,s))}}),delete t["!links"]}function zB(e,t,r,n){if(t["!comments"].length>0){var s=Nt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",at.VML);pe(e,551,N1("rId"+s)),t["!legacy"]=s}}function WB(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:rt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=$n(a);o.s.r==o.e.r&&(o.e.r=$n(t["!ref"]).e.r,a=rt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),pe(e,161,Dc(gt(a))),pe(e,162)}}function $B(e,t,r){pe(e,133),pe(e,137,IB(t,r)),pe(e,138),pe(e,134)}function HB(e,t){t["!protect"]&&pe(e,535,RB(t["!protect"]))}function GB(e,t,r,n){var s=Wn(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=gt(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],pe(s,129),(r.vbaraw||i["!outline"])&&pe(s,147,VV(o,i["!outline"])),pe(s,148,jV(l)),$B(s,i,r.Workbook),VB(s,i),LB(s,i,e,t),HB(s,i),WB(s,i,r,e),MB(s,i),UB(s,i,n),i["!margins"]&&pe(s,476,NB(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&BB(s,i),zB(s,i,e,n),pe(s,130),s.end()}function XB(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=xt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function KB(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var p=XB(d);f.s.r=f.s.c=0,f.e.c=o,c=Qt(o),p[0].forEach(function(m,g){i[c+pr(g)]={t:"n",v:m,z:p[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=rt(f)),i}function qB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(Ub);return o&&z1(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function YB(e,t){e.l+=10;var r=gn(e);return{name:r}}function QB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ni(e,function(l,c,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var W1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZB=[],eU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function vw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ut(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function _w(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ut(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function Hb(e){_w(e.WBProps,W1),_w(e.CalcPr,eU),vw(e.WBView,JB),vw(e.Sheets,ZB),ac.date1904=Ut(e.WBProps.date1904)}function tU(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ut(e.Workbook.WBProps.date1904)?"true":"false"}var rU="][*?/\\".split("");function Gb(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return rU.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function nU(e,t,r){e.forEach(function(n,s){Gb(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function sU(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];nU(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)tV(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var aU=/<\w+:workbook/;function iU(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(yn,function(l,c){var f=qe(l);switch(ka(f[0])){case"<?xml":break;case"<workbook":l.match(aU)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":W1.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Ut(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=Pt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=xt(Pt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Pt(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Ut(f.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=xt(Pt(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),nl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Hb(r),r}function Xb(e){var t=[mr];t[t.length]=Se("workbook",null,{xmlns:nl[0],"xmlns:r":Fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(W1.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Se("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Ct(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Se("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Se("definedName",Ct(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oU(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ex(e),r.name=gn(e),r}function lU(e,t){return t||(t=le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),N1(e.strRelID,t),Ur(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function cU(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?gn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function uU(e,t){t||(t=le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),MS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fU(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hU(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=zD(e),i=qM(e,0,r),o=A1(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function dU(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],k0[16]={n:"BrtFRTArchID$",f:fU},ni(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=hn(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Hb(r),r.Names=a,r.supbooks=i,r}function pU(e,t){pe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};pe(e,156,lU(s))}pe(e,144)}function mU(e,t){t||(t=le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ur("SheetJS",t),Ur(Zh.version,t),Ur(Zh.version,t),Ur("7262",t),t.length>t.l?t.slice(0,t.l):t}function xU(e,t){t||(t=le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function gU(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(pe(e,135),pe(e,158,xU(s)),pe(e,136))}}function vU(e,t){var r=Wn();return pe(r,131),pe(r,128,mU()),pe(r,153,uU(e.Workbook&&e.Workbook.WBProps||null)),gU(r,e),pU(r,e),pe(r,132),r.end()}function _U(e,t,r){return t.slice(-4)===".bin"?dU(e,r):iU(e,r)}function yU(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?OB(e,n,r,s,a,i,o):hV(e,n,r,s,a,i,o)}function wU(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?QB(e,n,r,s,a):qB(e,n,r,s,a)}function EU(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?k7():S7()}function TU(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?E7():T7()}function kU(e,t,r,n){return t.slice(-4)===".bin"?_9(e,r,n):o9(e,r,n)}function SU(e,t,r){return Ab(e,r)}function bU(e,t,r){return t.slice(-4)===".bin"?bL(e,r):TL(e,r)}function AU(e,t,r){return t.slice(-4)===".bin"?g7(e,r):l7(e,r)}function NU(e,t,r){return t.slice(-4)===".bin"?a7(e):n7(e)}function CU(e,t,r,n){return r.slice(-4)===".bin"?i7(e,t,r,n):void 0}function IU(e,t,r){return t.slice(-4)===".bin"?e7(e,t,r):r7(e,t,r)}function FU(e,t,r){return(t.slice(-4)===".bin"?vU:Xb)(e)}function RU(e,t,r,n,s){return(t.slice(-4)===".bin"?GB:zb)(e,r,n,s)}function PU(e,t,r){return(t.slice(-4)===".bin"?C9:Sb)(e,r)}function DU(e,t,r){return(t.slice(-4)===".bin"?CL:gb)(e,r)}function OU(e,t,r){return(t.slice(-4)===".bin"?v7:Ib)(e)}function jU(e){return(e.slice(-4)===".bin"?t7:Nb)()}var Kb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,qb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function js(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(Kb),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(qb),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function LU(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(Kb),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(qb),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Lu;function MU(e,t){var r=Lu[e]||xt(e);return r==="General"?zo(t):As(r,t)}function VU(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ut(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=$t(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xt(t)]=s}function BU(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||si[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=m0(e.v):e.w=zo(e.v):e.w=MU(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Lu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Fc(n)){var s=So(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function UU(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ZL[n.Pattern]||n.Pattern)}e[t.ID]=t}function zU(e,t,r,n,s,a,i,o,l,c){var f="General",d=n.StyleID,p={};c=c||{};var m=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(f=a[d].nf),a[d].Interior&&m.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ut(e);break;case"String":n.t="s",n.r=jy(xt(e)),n.v=e.indexOf("<")>-1?xt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=($t(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=xt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=WS[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=jy(t||e));break}if(BU(n,f,c),c.cellFormula!==!1)if(n.Formula){var x=xt(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=sc(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=sc("RC:RC",s):n.ArrayRange&&(n.F=sc(n.ArrayRange,s),l.push([gt(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(m.forEach(function(_){!p.patternType&&_.patternType&&(p.patternType=_.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function WU(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Zp(e,t){var r=t||{};Rc();var n=du(w1(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Ht(r);return i.type="string",Ec.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(kt){s.indexOf("<"+kt)>=0&&(a=!0)}),a)return Nz(n,r);Lu={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],p=r.dense?[]:{},m="",g={},x={},_=js('<Data ss:Type="String">'),y=0,E=0,w=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},L={},T="",S=0,b=[],F={},N={},C=0,P=[],ce=[],ye={},we=[],ke,ie=!1,X=[],oe=[],Pe={},U=0,q=0,H={Sheets:[],WBProps:{date1904:!1}},G={};v0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=v0.exec(n);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?zU(n.slice(y,o.index),T,_,l[l.length-1][0]=="comment"?ye:g,{c:E,r:w},V,we[E],x,X,r):(T="",_=js(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ce.length>0&&(g.c=ce),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(p[w]||(p[w]=[]),p[w][E]=g):p[Qt(E)+pr(w)]=g),g.HRef&&(g.l={Target:xt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(U=E+(parseInt(g.MergeAcross,10)|0),q=w+(parseInt(g.MergeDown,10)|0),b.push({s:{c:E,r:w},e:{c:U,r:q}})),!r.sheetStubs)g.MergeAcross?E=U+1:++E;else if(g.MergeAcross||g.MergeDown){for(var me=E;me<=U;++me)for(var fe=w;fe<=q;++fe)(me>E||fe>w)&&(r.dense?(p[fe]||(p[fe]=[]),p[fe][me]={t:"z"}):p[Qt(me)+pr(fe)]={t:"z"});E=U+1}else++E;else g=LU(o[0]),g.Index&&(E=+g.Index-1),E<R.s.c&&(R.s.c=E),E>R.e.c&&(R.e.c=E),o[0].slice(-2)==="/>"&&++E,ce=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<R.s.r&&(R.s.r=w),w>R.e.r&&(R.e.r=w),o[0].slice(-2)==="/>"&&(x=js(o[0]),x.Index&&(w=+x.Index-1)),E=0,++w):(x=js(o[0]),x.Index&&(w=+x.Index-1),Pe={},(x.AutoFitHeight=="0"||x.Height)&&(Pe.hpx=parseInt(x.Height,10),Pe.hpt=T0(Pe.hpx),oe[w]=Pe),x.Hidden=="1"&&(Pe.hidden=!0,oe[w]=Pe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(m),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(p["!ref"]=rt(R),r.sheetRows&&r.sheetRows<=R.e.r&&(p["!fullref"]=p["!ref"],R.e.r=r.sheetRows-1,p["!ref"]=rt(R))),b.length&&(p["!merges"]=b),we.length>0&&(p["!cols"]=we),oe.length>0&&(p["!rows"]=oe),f[m]=p}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=E=0,l.push([o[3],!1]),c=js(o[0]),m=xt(c.Name),p=r.dense?[]:{},b=[],X=[],oe=[],G={name:m,Hidden:0},H.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),we=[],ie=!1}break;case"style":o[1]==="/"?UU(V,L,r):L=js(o[0]);break;case"numberformat":L.nf=xt(js(o[0]).Format||"General"),Lu[L.nf]&&(L.nf=Lu[L.nf]);for(var ge=0;ge!=392&&He[ge]!=L.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(He[ge]==null){Ha(L.nf,ge);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ke=js(o[0]),ke.Hidden&&(ke.hidden=!0,delete ke.Hidden),ke.Width&&(ke.wpx=parseInt(ke.Width,10)),!ie&&ke.wpx>10){ie=!0,mn=Tb;for(var ue=0;ue<we.length;++ue)we[ue]&&Ki(we[ue])}ie&&Ki(ke),we[ke.Index-1||we.length]=ke;for(var $e=0;$e<+ke.Span;++$e)we[we.length]=Ht(ke);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var W=qe(o[0]),pt={Name:W.Name,Ref:sc(W.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(pt.Sheet=H.Sheets.length-1),H.Names.push(pt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=js(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dO(F,ne,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));WU(ye),ce.push(ye)}else l.push([o[3],!1]),c=js(o[0]),ye={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var tt=js(o[0]);p["!autofilter"]={ref:sc(tt.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return kw(n,r);var vt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:vt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:vt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:vt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:vt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else C=o.index+o[0].length;break;case"header":p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+qe(o[0]).Margin)||(p["!margins"].header=+qe(o[0]).Margin);break;case"footer":p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+qe(o[0]).Margin)||(p["!margins"].footer=+qe(o[0]).Margin);break;case"pagemargins":var Le=qe(o[0]);p["!margins"]||Do(p["!margins"]={},"xlml"),isNaN(+Le.Top)||(p["!margins"].top=+Le.Top),isNaN(+Le.Left)||(p["!margins"].left=+Le.Left),isNaN(+Le.Right)||(p["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(p["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:vt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:vt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:vt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:vt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:vt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:vt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:vt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:vt=!1}break;case"smarttags":break;default:vt=!1;break}if(vt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?VU(N,ne,P,n.slice(C,o.index)):(P=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=f),Ne.SheetNames=d,Ne.Workbook=H,Ne.SSF=Ht(He),Ne.Props=F,Ne.Custprops=N,Ne}function Cx(e,t){switch(H1(t=t||{}),t.type||"base64"){case"base64":return Zp(ns(e),t);case"binary":case"buffer":case"file":return Zp(e,t);case"array":return Zp(eo(e),t)}}function $U(e,t){var r=[];return e.Props&&r.push(pO(e.Props,t)),e.Custprops&&r.push(mO(e.Props,e.Custprops)),r.join("")}function HU(){return""}function GU(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Se("NumberFormat",null,{"ss:Format":Ct(He[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Se("Style",a.join(""),i))}),Se("Styles",r.join(""))}function Yb(e){return Se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+V1(e.Ref,{r:0,c:0})})}function XU(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Yb(s)))}return Se("Names",r.join(""))}function KU(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(Yb(o)))}return a.join("")}function qU(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Se("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Qr("ProtectContents","True")),e["!protect"].objects&&s.push(Qr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Qr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Qr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Qr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Se("WorksheetOptions",s.join(""),{xmlns:Yn.x})}function YU(e){return e.map(function(t){var r=gD(t.t||""),n=Se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Se("Comment",n,{"ss:Author":t.a})}).join("")}function QU(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ct(V1(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Jt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ct(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ct(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=i.c||c[f].s.r!=i.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var d="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(e.v);break;case"b":d="Boolean",p=e.v?"1":"0";break;case"e":d="Error",p=si[e.v];break;case"d":d="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||He[14]);break;case"s":d="String",p=xD(e.v||"");break}var m=ro(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var g=e.v!=null?p:"",x=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(x+=YU(e.c)),Se("Cell",x,o)}function JU(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Tc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ZU(e,t,r,n){if(!e["!ref"])return"";var s=gt(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(_,y){Ki(_);var E=!!_.width,w=Jd(y,_),R={"ss:Index":y+1};E&&(R["ss:Width"]=w0(w.width)),_.hidden&&(R["ss:Hidden"]="1"),o.push(Se("Column",null,R))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var f=[JU(c,(e["!rows"]||[])[c])],d=s.s.c;d<=s.e.c;++d){var p=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>d)&&!(a[i].s.r>c)&&!(a[i].e.c<d)&&!(a[i].e.r<c)){(a[i].s.c!=d||a[i].s.r!=c)&&(p=!0);break}if(!p){var m={r:c,c:d},g=Xe(m),x=l?(e[c]||[])[d]:e[g];f.push(QU(x,g,e,t,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function ez(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?KU(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?ZU(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(qU(a,t,e,r)),n.join("")}function tz(e,t){t||(t={}),e.SSF||(e.SSF=Ht(He)),e.SSF&&(Rc(),Hd(e.SSF),t.revssf=Xd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ro(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($U(e,t)),r.push(HU()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Se("Worksheet",ez(n,t,e),{"ss:Name":Ct(e.SheetNames[n])}));return r[2]=GU(e,t),r[3]=XU(e),mr+Se("Workbook",r.join(""),{xmlns:Yn.ss,"xmlns:o":Yn.o,"xmlns:x":Yn.x,"xmlns:ss":Yn.ss,"xmlns:dt":Yn.dt,"xmlns:html":Yn.html})}function rz(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=XD(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=KD(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nz=[60,1084,2066,2165,2175];function sz(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Ua(r,r.l),c=Ix[l],f=0;c!=null&&nz.indexOf(l)>-1;)a=Ua(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,c=Ix[l=Ua(r,r.l)];var d=Vr(i);qr(d,0);var p=0;d.lens=[];for(var m=0;m<i.length;++m)d.lens.push(p),p+=i[m].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function oa(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||si[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=m0(e.v):e.w=zo(e.v):e.w=As(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Fc(He[n]||String(n))){var s=So(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Wf(e,t,r){return{v:e,ixfe:t,t:r}}function az(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",f={},d,p="",m,g,x,_,y={},E=[],w,R,V=[],L=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},b=function(Ge){return Ge<8?Fo[Ge]:Ge<64&&L[Ge-8]||Fo[Ge]},F=function(Ge,St,rr){var Ft=St.XF.data;if(!(!Ft||!Ft.patternType||!rr||!rr.cellStyles)){St.s={},St.s.patternType=Ft.patternType;var Gt;(Gt=y0(b(Ft.icvFore)))&&(St.s.fgColor={rgb:Gt}),(Gt=y0(b(Ft.icvBack)))&&(St.s.bgColor={rgb:Gt})}},N=function(Ge,St,rr){if(!(Pe>1)&&!(rr.sheetRows&&Ge.r>=rr.sheetRows)){if(rr.cellStyles&&St.XF&&St.XF.data&&F(Ge,St,rr),delete St.ixfe,delete St.XF,d=Ge,p=Xe(Ge),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ge.r<i.s.r&&(i.s.r=Ge.r),Ge.c<i.s.c&&(i.s.c=Ge.c),Ge.r+1>i.e.r&&(i.e.r=Ge.r+1),Ge.c+1>i.e.c&&(i.e.c=Ge.c+1),rr.cellFormula&&St.f){for(var Ft=0;Ft<E.length;++Ft)if(!(E[Ft][0].s.c>Ge.c||E[Ft][0].s.r>Ge.r)&&!(E[Ft][0].e.c<Ge.c||E[Ft][0].e.r<Ge.r)){St.F=rt(E[Ft][0]),(E[Ft][0].s.c!=Ge.c||E[Ft][0].s.r!=Ge.r)&&delete St.f,St.f&&(St.f=""+hn(E[Ft][1],i,Ge,X,C));break}}rr.dense?(s[Ge.r]||(s[Ge.r]=[]),s[Ge.r][Ge.c]=St):s[p]=St}},C={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var P,ce=[],ye=[],we=[],ke=[],ie=!1,X=[];X.SheetNames=C.snames,X.sharedf=C.sharedf,X.arrayf=C.arrayf,X.names=[],X.XTI=[];var oe=0,Pe=0,U=0,q=[],H=[],G;C.codepage=1200,Ws(1200);for(var ne=!1;e.l<e.length-1;){var me=e.l,fe=e.read_shift(2);if(fe===0&&oe===10)break;var ge=e.l===e.length?0:e.read_shift(2),ue=Ix[fe];if(ue&&ue.f){if(t.bookSheets&&oe===133&&fe!==133)break;if(oe=fe,ue.r===2||ue.r==12){var $e=e.read_shift(2);if(ge-=2,!C.enc&&$e!==fe&&(($e&255)<<8|$e>>8)!==fe)throw new Error("rt mismatch: "+$e+"!="+fe);ue.r==12&&(e.l+=10,ge-=10)}var W={};if(fe===10?W=ue.f(e,ge,C):W=sz(fe,ue,e,ge,C),Pe==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(fe){case 34:r.opts.Date1904=T.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=W;break;case 66:var pt=Number(W);switch(pt){case 21010:pt=1200;break;case 32768:pt=1e4;break;case 32769:pt=1252;break}Ws(C.codepage=pt),ne=!0;break;case 317:C.rrtabid=W;break;case 25:C.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:C.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(s["!type"]="dialog"),W.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),W.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:V.push(W);break;case 430:X.push([W]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(W);break;case 24:case 536:G={Name:W.Name,Ref:hn(W.rgce,i,null,X,C)},W.itab>0&&(G.Sheet=W.itab-1),X.names.push(G),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(H[W.itab-1]={ref:rt(W.rgce[0][0][1][2])});break;case 22:C.ExternCount=W;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(W),X.XTI=X.XTI.concat(W);break;case 2196:if(C.biff<8)break;G!=null&&(G.Comment=W[1]);break;case 18:s["!protect"]=W;break;case 19:W!==0&&C.WTF&&console.error("Password verifier: "+W);break;case 133:a[W.pos]=W,C.snames.push(W.name);break;case 10:{if(--Pe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=rt(i),t.sheetRows&&t.sheetRows<=i.e.r){var tt=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=rt(i),i.e.r=tt}i.e.r++,i.e.c++}ce.length>0&&(s["!merges"]=ce),ye.length>0&&(s["!objects"]=ye),we.length>0&&(s["!cols"]=we),ke.length>0&&(s["!rows"]=ke),T.Sheets.push(S)}c===""?f=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),C.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(C.biff=5,ne=!0,Ws(C.codepage=28591)),C.biff==8&&W.BIFFVer==0&&W.dt==16&&(C.biff=2),Pe++)break;if(s=t.dense?[]:{},C.biff<8&&!ne&&(ne=!0,Ws(C.codepage=t.codepage||1252)),C.biff<5||W.BIFFVer==0&&W.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var vt={pos:e.l-ge,name:c};a[vt.pos]=vt,C.snames.push(c)}else c=(a[me]||{name:""}).name;W.dt==32&&(s["!type"]="chart"),W.dt==64&&(s["!type"]="macro"),ce=[],ye=[],C.arrayf=E=[],we=[],ke=[],ie=!1,S={Hidden:(a[me]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[W.r]||[])[W.c]:s[Xe({c:W.c,r:W.r})])&&++W.c,w={ixfe:W.ixfe,XF:V[W.ixfe]||{},v:W.val,t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t);break;case 5:case 517:w={ixfe:W.ixfe,XF:V[W.ixfe],v:W.val,t:W.t},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t);break;case 638:w={ixfe:W.ixfe,XF:V[W.ixfe],v:W.rknum,t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t);break;case 189:for(var Le=W.c;Le<=W.C;++Le){var Ne=W.rkrec[Le-W.c][0];w={ixfe:Ne,XF:V[Ne],v:W.rkrec[Le-W.c][1],t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:Le,r:W.r},w,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(w=Wf(W.val,W.cell.ixfe,W.tt),w.XF=V[w.ixfe],t.cellFormula){var kt=W.formula;if(kt&&kt[0]&&kt[0][0]&&kt[0][0][0]=="PtgExp"){var Et=kt[0][0][1][0],_t=kt[0][0][1][1],tn=Xe({r:Et,c:_t});y[tn]?w.f=""+hn(W.formula,i,W.cell,X,C):w.F=((t.dense?(s[Et]||[])[_t]:s[tn])||{}).F}else w.f=""+hn(W.formula,i,W.cell,X,C)}U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N(W.cell,w,t),o=W}break;case 7:case 519:if(o)o.val=W,w=Wf(W,o.cell.ixfe,"s"),w.XF=V[w.ixfe],t.cellFormula&&(w.f=""+hn(o.formula,i,o.cell,X,C)),U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(W);var Hn=Xe(W[0].s);if(m=t.dense?(s[W[0].s.r]||[])[W[0].s.c]:s[Hn],t.cellFormula&&m){if(!o||!Hn||!m)break;m.f=""+hn(W[1],i,W[0],X,C),m.F=rt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;y[Xe(o.cell)]=W[0],m=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Xe(o.cell)],(m||{}).f=""+hn(W[0],i,d,X,C)}}break;case 253:w=Wf(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(w.h=l[W.isst].h),w.XF=V[w.ixfe],U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:W.ixfe,XF:V[W.ixfe],t:"z"},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t));break;case 190:if(t.sheetStubs)for(var Gn=W.c;Gn<=W.C;++Gn){var or=W.ixfe[Gn-W.c];w={ixfe:or,XF:V[or],t:"z"},U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:Gn,r:W.r},w,t)}break;case 214:case 516:case 4:w=Wf(W.val,W.ixfe,"s"),w.XF=V[w.ixfe],U>0&&(w.z=q[w.ixfe>>8&63]),oa(w,t,r.opts.Date1904),N({c:W.c,r:W.r},w,t);break;case 0:case 512:Pe===1&&(i=W);break;case 252:l=W;break;case 1054:if(C.biff==4){q[U++]=W[1];for(var Wr=0;Wr<U+163&&He[Wr]!=W[1];++Wr);Wr>=163&&Ha(W[1],U+163)}else Ha(W[1],W[0]);break;case 30:{q[U++]=W;for(var $r=0;$r<U+163&&He[$r]!=W;++$r);$r>=163&&Ha(W,U+163)}break;case 229:ce=ce.concat(W);break;case 93:ye[W.cmo[0]]=C.lastobj=W;break;case 438:C.lastobj.TxO=W;break;case 127:C.lastobj.ImData=W;break;case 440:for(_=W[0].s.r;_<=W[0].e.r;++_)for(x=W[0].s.c;x<=W[0].e.c;++x)m=t.dense?(s[_]||[])[x]:s[Xe({c:x,r:_})],m&&(m.l=W[1]);break;case 2048:for(_=W[0].s.r;_<=W[0].e.r;++_)for(x=W[0].s.c;x<=W[0].e.c;++x)m=t.dense?(s[_]||[])[x]:s[Xe({c:x,r:_})],m&&m.l&&(m.l.Tooltip=W[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;m=t.dense?(s[W[0].r]||[])[W[0].c]:s[Xe(W[0])];var Ys=ye[W[2]];m||(t.dense?(s[W[0].r]||(s[W[0].r]=[]),m=s[W[0].r][W[0].c]={t:"z"}):m=s[Xe(W[0])]={t:"z"},i.e.r=Math.max(i.e.r,W[0].r),i.s.r=Math.min(i.s.r,W[0].r),i.e.c=Math.max(i.e.c,W[0].c),i.s.c=Math.min(i.s.c,W[0].c)),m.c||(m.c=[]),g={a:W[1],t:Ys.TxO.t},m.c.push(g)}break;case 2173:G9(V[W.ixfe],W.ext);break;case 125:{if(!C.cellStyles)break;for(;W.e>=W.s;)we[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},ie||(ie=!0,j1(W.w/256)),Ki(we[W.e+1])}break;case 520:{var Mt={};W.level!=null&&(ke[W.r]=Mt,Mt.level=W.level),W.hidden&&(ke[W.r]=Mt,Mt.hidden=!0),W.hpt&&(ke[W.r]=Mt,Mt.hpt=W.hpt,Mt.hpx=Tc(W.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Do(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=W;break;case 161:s["!margins"]||Do(s["!margins"]={}),s["!margins"].header=W.header,s["!margins"].footer=W.footer;break;case 574:W.RTL&&(T.Views[0].RTL=!0);break;case 146:L=W;break;case 2198:P=W;break;case 140:R=W;break;case 442:c?S.CodeName=W||S.name:T.WBProps.CodeName=W||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),e.l+=ge}return r.SheetNames=ir(a).sort(function(wn,Ge){return Number(wn)-Number(Ge)}).map(function(wn){return a[wn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&H.forEach(function(wn,Ge){r.Sheets[r.SheetNames[Ge]]["!autofilter"]=wn}),r.Strings=l,r.SSF=Ht(He),C.enc&&(r.Encryption=C.enc),P&&(r.Themes=P),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),X.names.length>0&&(T.Names=X.names),r.Workbook=T,r}var Mu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function iz(e,t,r){var n=Be.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ew(n,Tx,Mu.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=Be.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=ew(i,kx,Mu.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(qS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function oz(e,t){var r=[],n=[],s=[],a=0,i,o=Iy(Tx,"n"),l=Iy(kx,"n");if(e.Props)for(i=ir(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=ir(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var c=[];for(a=0;a<s.length;++a)rb.indexOf(s[a][0])>-1||KS.indexOf(s[a][0])>-1||s[a][1]!=null&&c.push(s[a]);n.length&&Be.utils.cfb_add(t,"/SummaryInformation",tw(n,Mu.SI,l,kx)),(r.length||c.length)&&Be.utils.cfb_add(t,"/DocumentSummaryInformation",tw(r,Mu.DSI,o,Tx,c.length?c:null,Mu.UDI))}function Qb(e,t){t||(t={}),H1(t),h1(),t.codepage&&f1(t.codepage);var r,n;if(e.FullPaths){if(Be.find(e,"/encryption"))throw new Error("File is password-protected");r=Be.find(e,"!CompObj"),n=Be.find(e,"/Workbook")||Be.find(e,"/Book")}else{switch(t.type){case"base64":e=Jn(ns(e));break;case"binary":e=Jn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qr(e,0),n={content:e}}var s,a;if(r&&rz(r),t.bookProps&&!t.bookSheets)s={};else{var i=st?"buffer":"array";if(n&&n.content)s=az(n.content,t);else if((a=Be.find(e,"PerfectOffice_MAIN"))&&a.content)s=Po.to_workbook(a.content,(t.type=i,t));else if((a=Be.find(e,"NativeContent_MAIN"))&&a.content)s=Po.to_workbook(a.content,(t.type=i,t));else throw(a=Be.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Be.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=y7(e))}var o={};return e.FullPaths&&iz(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function lz(e,t){var r=t||{},n=Be.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Be.utils.cfb_add(n,s,Jb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&oz(e,n),r.biff==8&&e.vbaraw&&w7(n,Be.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var k0={0:{f:RV},1:{f:BV},2:{f:aB},3:{f:KV},4:{f:$V},5:{f:rB},6:{f:uB},7:{f:JV},8:{f:gB},9:{f:xB},10:{f:pB},11:{f:mB},12:{f:zV},13:{f:oB},14:{f:YV},15:{f:GV},16:{f:Wb},17:{f:hB},18:{f:eB},19:{f:b1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hU},40:{},42:{},43:{f:u9},44:{f:l9},45:{f:d9},46:{f:m9},47:{f:p9},48:{},49:{f:OD},50:{},51:{f:q9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:db},62:{f:cB},63:{f:s7},64:{f:PB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MV},148:{f:OV,p:16},151:{f:TB},152:{},153:{f:cU},154:{},155:{},156:{f:oU},157:{},158:{},159:{T:1,f:SL},160:{T:-1},161:{T:1,f:ol},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:X9},336:{T:-1},337:{f:J9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ex},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:kB},427:{f:SB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:AB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ex},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m7},633:{T:1},634:{T:-1},635:{T:1,f:d7},636:{T:-1},637:{f:VD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:DB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ix={6:{f:Qp},10:{f:xi},12:{f:wr},13:{f:wr},14:{f:fr},15:{f:fr},16:{f:xn},17:{f:fr},18:{f:fr},19:{f:wr},20:{f:ow},21:{f:ow},23:{f:hb},24:{f:cw},25:{f:fr},26:{},27:{},28:{f:Dj},29:{},34:{f:fr},35:{f:lw},38:{f:xn},39:{f:xn},40:{f:xn},41:{f:xn},42:{f:fr},43:{f:fr},47:{f:GL},49:{f:oj},51:{f:wr},60:{},61:{f:rj},64:{f:fr},65:{f:ij},66:{f:wr},77:{},80:{},81:{},82:{},85:{f:wr},89:{},90:{},91:{},92:{f:HO},93:{f:Lj},94:{},95:{f:fr},96:{},97:{},99:{f:fr},125:{f:db},128:{f:Ej},129:{f:XO},130:{f:wr},131:{f:fr},132:{f:fr},133:{f:KO},134:{},140:{f:Hj},141:{f:wr},144:{},146:{f:Kj},151:{},152:{},153:{},154:{},155:{},156:{f:wr},157:{},158:{},160:{f:tL},161:{f:Qj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:vj},190:{f:_j},193:{f:xi},197:{},198:{},199:{},200:{},201:{},202:{f:fr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wr},220:{},221:{f:fr},222:{},224:{f:wj},225:{f:$O},226:{f:xi},227:{},229:{f:Oj},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YO},253:{f:cj},255:{f:JO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:nb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fr},353:{f:xi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Aj},431:{f:fr},432:{},433:{},434:{},437:{},438:{f:Bj},439:{f:fr},440:{f:Uj},441:{},442:{f:z0},443:{},444:{f:wr},445:{},446:{},448:{f:xi},449:{f:tj,r:2},450:{f:xi},512:{f:sw},513:{f:eL},515:{f:Sj},516:{f:fj},517:{f:iw},519:{f:rL},520:{f:ZO},523:{},545:{f:uw},549:{f:nw},566:{},574:{f:sj},638:{f:gj},659:{},1048:{},1054:{f:dj},1084:{},1212:{f:Fj},2048:{f:Wj},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:qj,r:12},2173:{f:H9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Ij,r:12},2197:{},2198:{f:V9,r:12},2199:{},2200:{},2201:{},2202:{f:Rj,r:12},2203:{f:xi},2204:{},2205:{},2206:{},2207:{},2211:{f:ej},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Jj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Xj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sw},1:{},2:{f:oL},3:{f:aL},4:{f:sL},5:{f:iw},7:{f:cL},8:{},9:{f:Bf},11:{},22:{f:wr},30:{f:mj},31:{},32:{},33:{f:uw},36:{},37:{f:nw},50:{f:uL},62:{},52:{},67:{},68:{f:wr},69:{},86:{},126:{},127:{f:nL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:fL},223:{},234:{},354:{},421:{},518:{f:Qp},521:{f:Bf},536:{f:cw},547:{f:lw},561:{},579:{},1030:{f:Qp},1033:{f:Bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&T1(r)&&e.push(r)}}function cz(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Ae(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function G0(e,t,r){return e||(e=le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function uz(e,t,r,n){var s=le(9);return G0(s,e,t),sb(r,n||"b",s),s}function fz(e,t,r){var n=le(8+2*r.length);return G0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hz(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Dr($t(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ae(e,2,lL(r,n,s)):Ae(e,3,iL(r,n,s));return;case"b":case"e":Ae(e,5,uz(r,n,t.v,t.t));return;case"s":case"str":Ae(e,4,fz(r,n,(t.v||"").slice(0,255)));return}Ae(e,1,G0(null,r,n))}function dz(e,t,r,n){var s=Array.isArray(t),a=gt(t["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=rt(a)}for(var c=a.s.r;c<=a.e.r;++c){o=pr(c);for(var f=a.s.c;f<=a.e.c;++f){c===a.s.r&&(l[f]=Qt(f)),i=l[f]+o;var d=s?(t[c]||[])[f]:t[i];d&&hz(e,d,c,f)}}}function pz(e,t){for(var r=t||{},n=Wn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,P1(e,16,r)),dz(n,e.Sheets[e.SheetNames[s]],s,r),Ae(n,10),n.end()}function mz(e,t,r){Ae(e,49,lj({sz:12,name:"Arial"},r))}function xz(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ae(e,1054,pj(s,t[s],r))})}function gz(e,t){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(e,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),cb(gt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ae(e,2152,r)}function vz(e,t){for(var r=0;r<16;++r)Ae(e,224,aw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ae(e,224,aw(n,0,t))})}function _z(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ae(e,440,zj(n)),n[1].Tooltip&&Ae(e,2048,$j(n))}delete t["!links"]}function yz(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Ae(e,125,Yj(Jd(s,n),s))})}}function wz(e,t,r,n,s){var a=16+ro(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ae(e,513,Go(r,n,a));return}if(t.bf)Ae(e,6,XM(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Dr($t(t.v)):t.v;Ae(e,515,bj(r,n,i,a));break;case"b":case"e":Ae(e,517,kj(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=U1(s.Strings,t.v,s.revStrings);Ae(e,253,uj(r,n,o,a))}else Ae(e,516,hj(r,n,(t.v||"").slice(0,255),a,s));break;default:Ae(e,513,Go(r,n,a))}}function Ez(e,t,r){var n=Wn(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(a),c=t.biff==8,f,d="",p=[],m=gt(a["!ref"]||"A1"),g=c?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}Ae(n,2057,P1(r,16,t)),Ae(n,13,gs(1)),Ae(n,12,gs(100)),Ae(n,15,bn(!0)),Ae(n,17,bn(!1)),Ae(n,16,$o(.001)),Ae(n,95,bn(!0)),Ae(n,42,bn(!1)),Ae(n,43,bn(!1)),Ae(n,130,gs(1)),Ae(n,128,Tj()),Ae(n,131,bn(!1)),Ae(n,132,bn(!1)),c&&yz(n,a["!cols"]),Ae(n,512,xj(m,t)),c&&(a["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){d=pr(x);for(var _=m.s.c;_<=m.e.c;++_){x===m.s.r&&(p[_]=Qt(_)),f=p[_]+d;var y=l?(a[x]||[])[_]:a[f];y&&(wz(n,y,x,_,t),c&&y.l&&a["!links"].push([f,y.l]))}}var E=o.CodeName||o.name||s;return c&&Ae(n,574,aj((i.Views||[])[0])),c&&(a["!merges"]||[]).length&&Ae(n,229,jj(a["!merges"])),c&&_z(n,a),Ae(n,442,ab(E)),c&&gz(n,a),Ae(n,10),n.end()}function Tz(e,t,r){var n=Wn(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ae(n,2057,P1(e,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,o?gs(1200):null),Ae(n,193,kO(2)),l&&Ae(n,191),l&&Ae(n,192),Ae(n,226),Ae(n,92,GO("SheetJS",r)),Ae(n,66,gs(o?1200:1252)),o&&Ae(n,353,gs(0)),o&&Ae(n,448),Ae(n,317,Zj(e.SheetNames.length)),o&&e.vbaraw&&Ae(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";Ae(n,442,ab(c))}Ae(n,156,gs(17)),Ae(n,25,bn(!1)),Ae(n,18,bn(!1)),Ae(n,19,gs(0)),o&&Ae(n,431,bn(!1)),o&&Ae(n,444,gs(0)),Ae(n,61,nj()),Ae(n,64,bn(!1)),Ae(n,141,gs(0)),Ae(n,34,bn(tU(e)=="true")),Ae(n,14,bn(!0)),o&&Ae(n,439,bn(!1)),Ae(n,218,gs(0)),mz(n,e,r),xz(n,e.SSF,r),vz(n,r),o&&Ae(n,352,bn(!1));var f=n.end(),d=Wn();o&&Ae(d,140,Gj()),o&&r.Strings&&cz(d,252,QO(r.Strings)),Ae(d,10);var p=d.end(),m=Wn(),g=0,x=0;for(x=0;x<e.SheetNames.length;++x)g+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var _=f.length+g+p.length;for(x=0;x<e.SheetNames.length;++x){var y=a[x]||{};Ae(m,133,qO({pos:_,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),_+=t[x].length}var E=m.end();if(g!=E.length)throw new Error("BS8 "+g+" != "+E.length);var w=[];return f.length&&w.push(f),E.length&&w.push(E),p.length&&w.push(p),Vr(w)}function kz(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ht(He)),e&&e.SSF&&(Rc(),Hd(e.SSF),r.revssf=Xd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,G1(r),r.cellXfs=[],ro(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=Ez(s,r,e);return n.unshift(Tz(e,n,r)),Vr(n)}function Jb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=$n(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return kz(e,t);case 4:case 3:case 2:return pz(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function yw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=lD(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var x=l[i].trim(),_=x.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var y=x.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var E=y[o].trim();if(E.match(/<t[dh]/i)){for(var w=E,R=0;w.charAt(0)=="<"&&(R=w.indexOf(">"))>-1;)w=w.slice(R+1);for(var V=0;V<g.length;++V){var L=g[V];L.s.c==f&&L.s.r<c&&c<=L.e.r&&(f=L.e.c+1,V=-1)}var T=qe(E.slice(0,E.indexOf(">")));p=T.colspan?+T.colspan:1,((d=+T.rowspan)>1||p>1)&&g.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+p-1}});var S=T.t||T["data-t"]||"";if(!w.length){f+=p;continue}if(w=ES(w),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!w.length){f+=p;continue}var b={t:"s",v:w};r.raw||!w.trim().length||S=="s"||(w==="TRUE"?b={t:"b",v:!0}:w==="FALSE"?b={t:"b",v:!1}:isNaN(Xs(w))?isNaN(wc(w).getDate())||(b={t:"d",v:$t(w)},r.cellDates||(b={t:"n",v:Dr(b.v)}),b.z=r.dateNF||He[14]):b={t:"n",v:Xs(w)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=b):n[Xe({r:c,c:f})]=b,f+=p}}}}return n["!ref"]=rt(m),g.length&&(n["!merges"]=g),n}function Sz(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var f=Xe({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],p=d&&d.v!=null&&(d.h||y1(d.w||(ei(d),d.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(m["data-t"]=d&&d.t||"z",d.v!=null&&(m["data-v"]=d.v),d.z!=null&&(m["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),m.id=(n.id||"sjs")+"-"+f,a.push(Se("td",p,m))}}var g="<tr>";return g+a.join("")+"</tr>"}var bz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Az="</body></html>";function Nz(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return to(yw(r[0],t),t);var n=q1();return r.forEach(function(s,a){Y1(n,yw(s,t),"Sheet"+(a+1))}),n}function Cz(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Zb(e,t){var r=t||{},n=r.header!=null?r.header:bz,s=r.footer!=null?r.footer:Az,a=[n],i=$n(e["!ref"]);r.dense=Array.isArray(e),a.push(Cz(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(Sz(e,i,o,r));return a.push("</table>"+s),a.join("")}function eA(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Jt(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=$n(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var d=[],p=0,m=e["!rows"]||(e["!rows"]=[]),g=0,x=0,_=0,y=0,E=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&x<l;++g){var R=o[g];if(ww(R)){if(n.display)continue;m[x]={hidden:!0}}var V=R.children;for(_=y=0;_<V.length;++_){var L=V[_];if(!(n.display&&ww(L))){var T=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):ES(L.innerHTML),S=L.getAttribute("data-z")||L.getAttribute("z");for(p=0;p<d.length;++p){var b=d[p];b.s.c==y+a&&b.s.r<x+s&&x+s<=b.e.r&&(y=b.e.c+1-a,p=-1)}w=+L.getAttribute("colspan")||1,((E=+L.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:x+s,c:y+a},e:{r:x+s+(E||1)-1,c:y+a+(w||1)-1}});var F={t:"s",v:T},N=L.getAttribute("data-t")||L.getAttribute("t")||"";T!=null&&(T.length==0?F.t=N||"z":n.raw||T.trim().length==0||N=="s"||(T==="TRUE"?F={t:"b",v:!0}:T==="FALSE"?F={t:"b",v:!1}:isNaN(Xs(T))?isNaN(wc(T).getDate())||(F={t:"d",v:$t(T)},n.cellDates||(F={t:"n",v:Dr(F.v)}),F.z=n.dateNF||He[14]):F={t:"n",v:Xs(T)})),F.z===void 0&&S!=null&&(F.z=S);var C="",P=L.getElementsByTagName("A");if(P&&P.length)for(var ce=0;ce<P.length&&!(P[ce].hasAttribute("href")&&(C=P[ce].getAttribute("href"),C.charAt(0)!="#"));++ce);C&&C.charAt(0)!="#"&&(F.l={Target:C}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][y+a]=F):e[Xe({c:y+a,r:x+s})]=F,c.e.c<y+a&&(c.e.c=y+a),y+=w}}++x}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,x-1+s),e["!ref"]=rt(c),x>=l&&(e["!fullref"]=rt((c.e.r=o.length-g+x-1+s,c))),e}function tA(e,t){var r=t||{},n=r.dense?[]:{};return eA(n,e,t)}function Iz(e,t){return to(tA(e,t),t)}function ww(e){var t="",r=Fz(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Fz(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Rz(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xt(t.replace(/<[^>]*>/g,""));return[r]}var Ew={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function rA(e,t){var r=t||{},n=w1(e),s=[],a,i,o={name:""},l="",c=0,f,d,p={},m=[],g=r.dense?[]:{},x,_,y={value:""},E="",w=0,R=[],V=-1,L=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,b={},F=[],N={},C=0,P=0,ce=[],ye=1,we=1,ke=[],ie={Names:[]},X={},oe=["",""],Pe=[],U={},q="",H=0,G=!1,ne=!1,me=0;for(v0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=v0.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=rt(T):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=rt(T)),F.length&&(g["!merges"]=F),ce.length&&(g["!rows"]=ce),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),p[f.name]=g,ne=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=qe(x[0],!1),V=L=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=r.dense?[]:{},F=[],ce=[],ne=!0);break;case"table-row-group":x[1]==="/"?--S:++S;break;case"table-row":case"":if(x[1]==="/"){V+=ye,ye=1;break}if(d=qe(x[0],!1),d.?V=d.-1:V==-1&&(V=0),ye=+d["number-rows-repeated"]||1,ye<10)for(me=0;me<ye;++me)S>0&&(ce[V+me]={level:S});L=-1;break;case"covered-table-cell":x[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(g[V]||(g[V]=[]),g[V][L]={t:"z"}):g[Xe({r:V,c:L})]={t:"z"}),E="",R=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++L,y=qe(x[0],!1),we=parseInt(y["number-columns-repeated"]||"1",10),_={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(_.f=gw(xt(y.formula))),(y.||y["value-type"])=="string"&&(_.t="s",_.v=xt(y["string-value"]||""),r.dense?(g[V]||(g[V]=[]),g[V][L]=_):g[Xe({r:V,c:L})]=_),L+=we-1;else if(x[1]!=="/"){++L,E="",w=0,R=[],we=1;var fe=ye?V+ye-1:V;if(L>T.e.c&&(T.e.c=L),L<T.s.c&&(T.s.c=L),V<T.s.r&&(T.s.r=V),fe>T.e.r&&(T.e.r=fe),y=qe(x[0],!1),Pe=[],U={},_={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=xt(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(C=parseInt(y["number-matrix-rows-spanned"],10)||0,P=parseInt(y["number-matrix-columns-spanned"],10)||0,N={s:{r:V,c:L},e:{r:V+C-1,c:L+P-1}},_.F=rt(N),ke.push([N,_.F])),y.formula)_.f=gw(y.formula);else for(me=0;me<ke.length;++me)V>=ke[me][0].s.r&&V<=ke[me][0].e.r&&L>=ke[me][0].s.c&&L<=ke[me][0].e.c&&(_.F=ke[me][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(C=parseInt(y["number-rows-spanned"],10)||0,P=parseInt(y["number-columns-spanned"],10)||0,N={s:{r:V,c:L},e:{r:V+C-1,c:L+P-1}},F.push(N)),y["number-columns-repeated"]&&(we=parseInt(y["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ut(y["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(y.value);break;case"percentage":_.t="n",_.v=parseFloat(y.value);break;case"currency":_.t="n",_.v=parseFloat(y.value);break;case"date":_.t="d",_.v=$t(y["date-value"]),r.cellDates||(_.t="n",_.v=Dr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=aD(y["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Kd(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(y.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",y["string-value"]!=null&&(E=xt(y["string-value"]),R=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(G=!1,_.t==="s"&&(_.v=E||"",R.length&&(_.R=R),G=w==0),X.Target&&(_.l=X),Pe.length>0&&(_.c=Pe,Pe=[]),E&&r.cellText!==!1&&(_.w=E),G&&(_.t="z",delete _.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=V))for(var ge=0;ge<ye;++ge){if(we=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[V+ge]||(g[V+ge]=[]),g[V+ge][L]=ge==0?_:Ht(_);--we>0;)g[V+ge][L+we]=Ht(_);else for(g[Xe({r:V+ge,c:L})]=_;--we>0;)g[Xe({r:V+ge,c:L+we})]=Ht(_);T.e.c<=L&&(T.e.c=L)}we=parseInt(y["number-columns-repeated"]||"1",10),L+=we-1,we=0,_={},E="",R=[]}X={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a;U.t=E,R.length&&(U.R=R),U.a=q,Pe.push(U)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);q="",H=0,E="",w=0,R=[];break;case"creator":x[1]==="/"?q=n.slice(H,x.index):H=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);E="",w=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(b[o.name]=l,(a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=qe(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=qe(x[0],!1),l+=Ew[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=qe(x[0],!1),l+=Ew[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":i=qe(x[0],!1),oe=Jp(i["cell-range-address"]);var ue={Name:i.name,Ref:oe[0]+"!"+oe[1]};ne&&(ue.Sheet=m.length),ie.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!y||!y["string-value"])){var $e=Rz(n.slice(w,x.index));E=(E.length>0?E+`
`:"")+$e[0]}else qe(x[0],!1),w=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{oe=Jp(qe(x[0])["target-range-address"]),p[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(X=qe(x[0],!1),!X.href)break;X.Target=xt(X.href),delete X.href,X.Target.charAt(0)=="#"&&X.Target.indexOf(".")>-1?(oe=Jp(X.Target.slice(1)),X.Target="#"+oe[0]+"!"+oe[1]):X.Target.match(/^\.\.[\\\/]/)&&(X.Target=X.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var W={Sheets:p,SheetNames:m,Workbook:ie};return r.bookSheets&&delete W.Sheets,W}function Tw(e,t){t=t||{},xs(e,"META-INF/manifest.xml")&&aO(yr(e,"META-INF/manifest.xml"),t);var r=Zn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=rA(Pt(r),t);return xs(e,"meta.xml")&&(n.Props=GS(yr(e,"meta.xml"))),n}function kw(e,t){return rA(e,t)}var Pz=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+g0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mr+t}}(),Sw=function(){var e=function(a){return Ct(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+Ct(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,d=$n(a["!ref"]||"A1"),p=a["!merges"]||[],m=0,g=Array.isArray(a);if(a["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",_=a["!rows"]||[];for(c=0;c<d.s.r;++c)x=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+x+`></table:table-row>
`);for(;c<=d.e.r;++c){for(x=_[c]?' table:style-name="ro'+_[c].ods+'"':"",l.push("        <table:table-row"+x+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var y=!1,E={},w="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>f)&&!(p[m].s.r>c)&&!(p[m].e.c<f)&&!(p[m].e.r<c)){(p[m].s.c!=f||p[m].s.r!=c)&&(y=!0),E["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,E["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(y){l.push(r);continue}var R=Xe({r:c,c:f}),V=g?(a[c]||[])[f]:a[R];if(V&&V.f&&(E["table:formula"]=Ct(ZM(V.f)),V.F&&V.F.slice(0,R.length)==R)){var L=$n(V.F);E["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,E["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!V){l.push(t);continue}switch(V.t){case"b":w=V.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=V.v?"true":"false";break;case"n":w=V.w||String(V.v||0),E["office:value-type"]="float",E["office:value"]=V.v||0;break;case"s":case"str":w=V.v==null?"":V.v,E["office:value-type"]="string";break;case"d":w=V.w||$t(V.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=$t(V.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(w);if(V.l&&V.l.Target){var S=V.l.Target;S=S.charAt(0)=="#"?"#"+eV(S.slice(1)):S,S.charAt(0)!="#"&&!S.match(/^\w+:/)&&(S="../"+S),T=Se("text:a",T,{"xlink:href":S.replace(/&/g,"&amp;")})}l.push("          "+Se("table:table-cell",Se("text:p",T,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var d=c["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Ki(d),d.ods=o;var p=c["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var d=c["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[mr],c=g0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=g0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(HS().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function nA(e,t){if(t.bookType=="fods")return Sw(e,t);var r=g1(),n="",s=[],a=[];return n="mimetype",nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nt(r,n,Sw(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",nt(r,n,Pz(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",nt(r,n,mr+HS()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",nt(r,n,lO(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nt(r,n,iO(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pt(eo(e))}function Dz(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Jn(da(e))}function Oz(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Yi(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function bw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jz(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Lz(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function S0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function At(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ar(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function wt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=S0(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=S0(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function Gr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(At(n*8+s.type)),s.type==2&&t.push(At(s.data.length)),t.push(s.data))})}),Yi(t)}function $1(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ps(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=S0(e,n),a=wt(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:ar(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=wt(o.data),c=ar(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=ar(a[3][0].data)>>>0>0),r.push(i)}return r}function bl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:At(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:At(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:At(i.data.length)}],n[2].push({data:Gr(i.meta),type:2})});var a=Gr(n);t.push(At(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Yi(t)}function Mz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=S0(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Yi(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var f=Yi(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ms(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Mz(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Yi(t)}function Al(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=At(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Yi(t)}function Vz(e,t,r,n){var s=Xo(e),a=s.getUint32(4,!0),i=(n>1?12:8)+bw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=bw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function Bz(e,t,r){var n=Xo(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);s&1&&(l=jz(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function em(e,t){var r=new Uint8Array(32),n=Xo(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Lz(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function tm(e,t){var r=new Uint8Array(32),n=Xo(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Uz(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Vz(e,t,r,e[0]);case 5:return Bz(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function fn(e){var t=wt(e);return S0(t[1][0].data)}function Aw(e,t){var r=wt(t.data),n=ar(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=wt(i.data),l=ar(o[1][0].data)>>>0;switch(n){case 1:a[l]=Fx(o[3][0].data);break;case 8:{var c=e[fn(o[9][0].data)][0],f=wt(c.data),d=e[fn(f[1][0].data)][0],p=ar(d.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var m=wt(d.data);a[l]=m[3].map(function(g){return Fx(g.data)}).join("")}break}}),a}function zz(e,t){var r,n,s,a,i,o,l,c,f,d,p,m,g,x,_=wt(e),y=ar(_[1][0].data)>>>0,E=ar(_[2][0].data)>>>0,w=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&ar(_[8][0].data)>0||!1,R,V;if((a=(s=_[7])==null?void 0:s[0])!=null&&a.data&&t!=0)R=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,V=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=_[4])==null?void 0:f[0])!=null&&d.data&&t!=1)R=(m=(p=_[4])==null?void 0:p[0])==null?void 0:m.data,V=(x=(g=_[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=w?4:1,T=Xo(R),S=[],b=0;b<R.length/2;++b){var F=T.getUint16(b*2,!0);F<65535&&S.push([b,F])}if(S.length!=E)throw"Expected ".concat(E," cells, found ").concat(S.length);var N=[];for(b=0;b<S.length-1;++b)N[S[b][0]]=V.subarray(S[b][1]*L,S[b+1][1]*L);return S.length>=1&&(N[S[S.length-1][0]]=V.subarray(S[S.length-1][1]*L)),{R:y,cells:N}}function Wz(e,t){var r,n=wt(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?ar(n[7][0].data)>>>0>0?1:0:-1,a=$1(n[5],function(i){return zz(i,s)});return{nrows:ar(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function $z(e,t,r){var n,s=wt(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ar(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(ar(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=rt(a);var i=wt(s[4][0].data),o=Aw(e,e[fn(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Aw(e,e[fn(i[17][0].data)][0]):[],c=wt(i[3][0].data),f=0;c[1].forEach(function(d){var p=wt(d.data),m=e[fn(p[2][0].data)][0],g=ar(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var x=Wz(e,m);x.data.forEach(function(_,y){_.forEach(function(E,w){var R=Xe({r:f+y,c:w}),V=Uz(E,o,l);V&&(r[R]=V)})}),f+=x.nrows})}function Hz(e,t){var r=wt(t.data),n={"!ref":"A1"},s=e[fn(r[2][0].data)],a=ar(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return $z(e,s[0],n),n}function Gz(e,t){var r,n=wt(t.data),s={name:(r=n[1])!=null&&r[0]?Fx(n[1][0].data):"",sheets:[]},a=$1(n[2],fn);return a.forEach(function(i){e[i].forEach(function(o){var l=ar(o.meta[1][0].data);l==6e3&&s.sheets.push(Hz(e,o))})}),s}function Xz(e,t){var r=q1(),n=wt(t.data),s=$1(n[1],fn);if(s.forEach(function(a){e[a].forEach(function(i){var o=ar(i.meta[1][0].data);if(o==2){var l=Gz(e,i);l.sheets.forEach(function(c,f){Y1(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rm(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=ms(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=ps(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ar(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var f=ar(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Xz(a,o)}function Kz(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&ar(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Xo(e[7][0].data),f=0,d=[],p=Xo(e[4][0].data),m=0,g=[],x=0;x<t.length;++x){if(t[x]==null){c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535);continue}c.setUint16(x*2,f,!0),p.setUint16(x*2,m,!0);var _,y;switch(typeof t[x]){case"string":_=em({t:"s",v:t[x]},r),y=tm({t:"s",v:t[x]},r);break;case"number":_=em({t:"n",v:t[x]},r),y=tm({t:"n",v:t[x]},r);break;case"boolean":_=em({t:"b",v:t[x]},r),y=tm({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}d.push(_),f+=_.length,g.push(y),m+=y.length,++l}for(e[2][0].data=At(l);x<e[7][0].data.length/2;++x)c.setUint16(x*2,65535,!0),p.setUint16(x*2,65535,!0);return e[6][0].data=Yi(d),e[3][0].data=Yi(g),l}function qz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=$n(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(rt(n)));var a=fd(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(q){return q.forEach(function(H){typeof H=="string"&&i.push(H)})});var o={},l=[],c=Be.read(t.numbers,{type:"base64"});c.FileIndex.map(function(q,H){return[q,c.FullPaths[H]]}).forEach(function(q){var H=q[0],G=q[1];if(H.type==2&&H.name.match(/\.iwa/)){var ne=H.content,me=ms(ne),fe=ps(me);fe.forEach(function(ge){l.push(ge.id),o[ge.id]={deps:[],location:G,type:ar(ge.messages[0].meta[1][0].data)}})}}),l.sort(function(q,H){return q-H});var f=l.filter(function(q){return q>1}).map(function(q){return[q,At(q)]});c.FileIndex.map(function(q,H){return[q,c.FullPaths[H]]}).forEach(function(q){var H=q[0];if(q[1],!!H.name.match(/\.iwa/)){var G=ps(ms(H.content));G.forEach(function(ne){ne.messages.forEach(function(me){f.forEach(function(fe){ne.messages.some(function(ge){return ar(ge.meta[1][0].data)!=11006&&Oz(ge.data,fe[1])})&&o[fe[0]].deps.push(ne.id)})})})}});for(var d=Be.find(c,o[1].location),p=ps(ms(d.content)),m,g=0;g<p.length;++g){var x=p[g];x.id==1&&(m=x)}var _=fn(wt(m.messages[0].data)[1][0].data);for(d=Be.find(c,o[_].location),p=ps(ms(d.content)),g=0;g<p.length;++g)x=p[g],x.id==_&&(m=x);for(_=fn(wt(m.messages[0].data)[2][0].data),d=Be.find(c,o[_].location),p=ps(ms(d.content)),g=0;g<p.length;++g)x=p[g],x.id==_&&(m=x);for(_=fn(wt(m.messages[0].data)[2][0].data),d=Be.find(c,o[_].location),p=ps(ms(d.content)),g=0;g<p.length;++g)x=p[g],x.id==_&&(m=x);var y=wt(m.messages[0].data);{y[6][0].data=At(n.e.r+1),y[7][0].data=At(n.e.c+1);var E=fn(y[46][0].data),w=Be.find(c,o[E].location),R=ps(ms(w.content));{for(var V=0;V<R.length&&R[V].id!=E;++V);if(R[V].id!=E)throw"Bad ColumnRowUIDMapArchive";var L=wt(R[V].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var T=0;T<=n.e.c;++T){var S=[];S[1]=S[2]=[{type:0,data:At(T+420690)}],L[1].push({type:2,data:Gr(S)}),L[2].push({type:0,data:At(T)}),L[3].push({type:0,data:At(T)})}L[4]=[],L[5]=[],L[6]=[];for(var b=0;b<=n.e.r;++b)S=[],S[1]=S[2]=[{type:0,data:At(b+726270)}],L[4].push({type:2,data:Gr(S)}),L[5].push({type:0,data:At(b)}),L[6].push({type:0,data:At(b)});R[V].messages[0].data=Gr(L)}w.content=Al(bl(R)),w.size=w.content.length,delete y[46];var F=wt(y[4][0].data);{F[7][0].data=At(n.e.r+1);var N=wt(F[1][0].data),C=fn(N[2][0].data);w=Be.find(c,o[C].location),R=ps(ms(w.content));{if(R[0].id!=C)throw"Bad HeaderStorageBucket";var P=wt(R[0].messages[0].data);for(b=0;b<a.length;++b){var ce=wt(P[2][0].data);ce[1][0].data=At(b),ce[4][0].data=At(a[b].length),P[2][b]={type:P[2][0].type,data:Gr(ce)}}R[0].messages[0].data=Gr(P)}w.content=Al(bl(R)),w.size=w.content.length;var ye=fn(F[2][0].data);w=Be.find(c,o[ye].location),R=ps(ms(w.content));{if(R[0].id!=ye)throw"Bad HeaderStorageBucket";for(P=wt(R[0].messages[0].data),T=0;T<=n.e.c;++T)ce=wt(P[2][0].data),ce[1][0].data=At(T),ce[4][0].data=At(n.e.r+1),P[2][T]={type:P[2][0].type,data:Gr(ce)};R[0].messages[0].data=Gr(P)}w.content=Al(bl(R)),w.size=w.content.length;var we=fn(F[4][0].data);(function(){for(var q=Be.find(c,o[we].location),H=ps(ms(q.content)),G,ne=0;ne<H.length;++ne){var me=H[ne];me.id==we&&(G=me)}var fe=wt(G.messages[0].data);{fe[3]=[];var ge=[];i.forEach(function(W,pt){ge[1]=[{type:0,data:At(pt)}],ge[2]=[{type:0,data:At(1)}],ge[3]=[{type:2,data:Dz(W)}],fe[3].push({type:2,data:Gr(ge)})})}G.messages[0].data=Gr(fe);var ue=bl(H),$e=Al(ue);q.content=$e,q.size=q.content.length})();var ke=wt(F[3][0].data);{var ie=ke[1][0];delete ke[2];var X=wt(ie.data);{var oe=fn(X[2][0].data);(function(){for(var q=Be.find(c,o[oe].location),H=ps(ms(q.content)),G,ne=0;ne<H.length;++ne){var me=H[ne];me.id==oe&&(G=me)}var fe=wt(G.messages[0].data);{delete fe[6],delete ke[7];var ge=new Uint8Array(fe[5][0].data);fe[5]=[];for(var ue=0,$e=0;$e<=n.e.r;++$e){var W=wt(ge);ue+=Kz(W,a[$e],i),W[1][0].data=At($e),fe[5].push({data:Gr(W),type:2})}fe[1]=[{type:0,data:At(n.e.c+1)}],fe[2]=[{type:0,data:At(n.e.r+1)}],fe[3]=[{type:0,data:At(ue)}],fe[4]=[{type:0,data:At(n.e.r+1)}]}G.messages[0].data=Gr(fe);var pt=bl(H),tt=Al(pt);q.content=tt,q.size=q.content.length})()}ie.data=Gr(X)}F[3][0].data=Gr(ke)}y[4][0].data=Gr(F)}m.messages[0].data=Gr(y);var Pe=bl(p),U=Al(Pe);return d.content=U,d.size=d.content.length,c}function sA(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function H1(e){sA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function G1(e){sA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Yz(e){return at.WS.indexOf(e)>-1?"sheet":e==at.CS?"chart":e==at.DS?"dialog":e==at.MS?"macro":e&&e.length?e:"sheet"}function Qz(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Yz(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Jz(e,t,r,n,s,a,i,o,l,c,f,d){try{a[n]=Du(Zn(e,r,!0),t);var p=yr(e,t),m;switch(o){case"sheet":m=yU(p,t,s,l,a[n],c,f,d);break;case"chart":if(m=wU(p,t,s,l,a[n],c,f,d),!m||!m["!drawel"])break;var g=mu(m["!drawel"].Target,t),x=_0(g),_=o7(Zn(e,g,!0),Du(Zn(e,x,!0),g)),y=mu(_,g),E=_0(y);m=KB(Zn(e,y,!0),y,l,Du(Zn(e,E,!0),y),c,m);break;case"macro":m=EU(p,t,s,l,a[n],c,f,d);break;case"dialog":m=TU(p,t,s,l,a[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var w=[];a&&a[n]&&ir(a[n]).forEach(function(R){var V="";if(a[n][R].Type==at.CMNT){V=mu(a[n][R].Target,t);var L=AU(yr(e,V,!0),V,l);if(!L||!L.length)return;hw(m,L,!1)}a[n][R].Type==at.TCMNT&&(V=mu(a[n][R].Target,t),w=w.concat(c7(yr(e,V,!0),l)))}),w&&w.length&&hw(m,w,!0,l.people||[])}catch(R){if(l.WTF)throw R}}function hs(e){return e.charAt(0)=="/"?e.slice(1):e}function Zz(e,t){if(Rc(),t=t||{},H1(t),xs(e,"META-INF/manifest.xml")||xs(e,"objectdata.xml"))return Tw(e,t);if(xs(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rm<"u"){if(e.FileIndex)return rm(e);var r=Be.utils.cfb_new();return Py(e).forEach(function(ce){nt(r,ce,uD(e,ce))}),rm(r)}throw new Error("Unsupported NUMBERS file")}if(!xs(e,"[Content_Types].xml"))throw xs(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):xs(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Py(e),s=nO(Zn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",yr(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!yr(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Ou=[],s.sst)try{Ou=bU(yr(e,hs(s.sst)),s.sst,t)}catch(ce){if(t.WTF)throw ce}t.cellStyles&&s.themes.length&&(l=SU(Zn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=kU(yr(e,hs(s.style)),s.style,l,t))}s.links.map(function(ce){try{var ye=Du(Zn(e,_0(hs(ce))),ce);return CU(yr(e,hs(ce)),ye,ce,t)}catch{}});var f=_U(yr(e,hs(s.workbooks[0])),s.workbooks[0],t),d={},p="";s.coreprops.length&&(p=yr(e,hs(s.coreprops[0]),!0),p&&(d=GS(p)),s.extprops.length!==0&&(p=yr(e,hs(s.extprops[0]),!0),p&&uO(p,d,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(p=Zn(e,hs(s.custprops[0]),!0),p&&(m=hO(p,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(ye){return ye.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=m),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var x={};t.bookDeps&&s.calcchain&&(x=NU(yr(e,hs(s.calcchain)),s.calcchain));var _=0,y={},E,w;{var R=f.Sheets;d.Worksheets=R.length,d.SheetNames=[];for(var V=0;V!=R.length;++V)d.SheetNames[V]=R[V].name}var L=a?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");xs(e,S)||(S="xl/_rels/workbook."+L+".rels");var b=Du(Zn(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=IU(yr(e,hs(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=f7(yr(e,hs(s.people[0])),t)),b&&(b=Qz(b,f.Sheets));var F=yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var N="sheet";if(b&&b[_]?(E="xl/"+b[_][1].replace(/[\/]?xl\//,""),xs(e,E)||(E=b[_][1]),xs(e,E)||(E=S.replace(/_rels\/.*$/,"")+b[_][1]),N=b[_][2]):(E="xl/worksheets/sheet"+(_+1-F)+"."+L,E=E.replace(/sheet0\./,"sheet.")),w=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,P=0;P!=t.sheets.length;++P)typeof t.sheets[P]=="number"&&t.sheets[P]==_&&(C=1),typeof t.sheets[P]=="string"&&t.sheets[P].toLowerCase()==d.SheetNames[_].toLowerCase()&&(C=1);if(!C)continue e}}Jz(e,E,w,d.SheetNames[_],_,y,i,N,t,f,l,c)}return g={Directory:s,Workbook:f,Props:d,Custprops:m,Deps:x,Sheets:i,SheetNames:d.SheetNames,Strings:Ou,Styles:c,Themes:l,SSF:Ht(He)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ce,ye){ce=ce.replace(/^Root Entry[\/]/,""),g.keys.push(ce),g.files[ce]=e.FileIndex[ye]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=yr(e,hs(s.vba[0]),!0):s.defaults&&s.defaults.bin===_7&&(g.vbaraw=yr(e,"xl/vbaProject.bin",!0))),g}function eW(e,t){var r=t||{},n="Workbook",s=Be.find(e,n);try{if(n="/!DataSpaces/Version",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(IL(s.content),n="/!DataSpaces/DataSpaceMap",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=RL(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=PL(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);OL(s.content)}catch{}if(n="/EncryptionInfo",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=jL(s.content);if(n="/EncryptedPackage",s=Be.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function tW(e,t){return t.bookType=="ods"?nA(e,t):t.bookType=="numbers"?qz(e,t):t.bookType=="xlsb"?rW(e,t):nW(e,t)}function rW(e,t){Gl=1024,e&&!e.SSF&&(e.SSF=Ht(He)),e&&e.SSF&&(Rc(),Hd(e.SSF),t.revssf=Xd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ju?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Fb.indexOf(t.bookType)>-1,s=F1();G1(t=t||{});var a=g1(),i="",o=0;if(t.cellXfs=[],ro(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",nt(a,i,XS(e.Props,t)),s.coreprops.push(i),Nt(t.rels,2,i,at.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,nt(a,i,YS(e.Props)),s.extprops.push(i),Nt(t.rels,3,i,at.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(i="docProps/custom.xml",nt(a,i,QS(e.Custprops)),s.custprops.push(i),Nt(t.rels,4,i,at.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,nt(a,i,RU(o-1,i,t,e,f)),s.sheets.push(i),Nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,at.WS[0])}if(d){var m=d["!comments"],g=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,nt(a,x,OU(m,x)),s.comments.push(x),Nt(f,-1,"../comments"+o+"."+r,at.CMNT),g=!0),d["!legacy"]&&g&&nt(a,"xl/drawings/vmlDrawing"+o+".vml",Cb(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&nt(a,_0(i),nc(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,nt(a,i,DU(t.Strings,i,t)),s.strs.push(i),Nt(t.wbrels,-1,"sharedStrings."+r,at.SST)),i="xl/workbook."+r,nt(a,i,FU(e,i)),s.workbooks.push(i),Nt(t.rels,1,i,at.WB),i="xl/theme/theme1.xml",nt(a,i,L1(e.Themes,t)),s.themes.push(i),Nt(t.wbrels,-1,"theme/theme1.xml",at.THEME),i="xl/styles."+r,nt(a,i,PU(e,i,t)),s.styles.push(i),Nt(t.wbrels,-1,"styles."+r,at.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",nt(a,i,e.vbaraw),s.vba.push(i),Nt(t.wbrels,-1,"vbaProject.bin",at.VBA)),i="xl/metadata."+r,nt(a,i,jU(i)),s.metadata.push(i),Nt(t.wbrels,-1,"metadata."+r,at.XLMETA),nt(a,"[Content_Types].xml",$S(s,t)),nt(a,"_rels/.rels",nc(t.rels)),nt(a,"xl/_rels/workbook."+r+".rels",nc(t.wbrels)),delete t.revssf,delete t.ssf,a}function nW(e,t){Gl=1024,e&&!e.SSF&&(e.SSF=Ht(He)),e&&e.SSF&&(Rc(),Hd(e.SSF),t.revssf=Xd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ju?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Fb.indexOf(t.bookType)>-1,s=F1();G1(t=t||{});var a=g1(),i="",o=0;if(t.cellXfs=[],ro(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",nt(a,i,XS(e.Props,t)),s.coreprops.push(i),Nt(t.rels,2,i,at.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,nt(a,i,YS(e.Props)),s.extprops.push(i),Nt(t.rels,3,i,at.EXT_PROPS),e.Custprops!==e.Props&&ir(e.Custprops||{}).length>0&&(i="docProps/custom.xml",nt(a,i,QS(e.Custprops)),s.custprops.push(i),Nt(t.rels,4,i,at.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,nt(a,i,zb(o-1,t,e,d)),s.sheets.push(i),Nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,at.WS[0])}if(p){var g=p["!comments"],x=!1,_="";if(g&&g.length>0){var y=!1;g.forEach(function(E){E[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(_="xl/threadedComments/threadedComment"+o+"."+r,nt(a,_,u7(g,f,t)),s.threadedcomments.push(_),Nt(d,-1,"../threadedComments/threadedComment"+o+"."+r,at.TCMNT)),_="xl/comments"+o+"."+r,nt(a,_,Ib(g)),s.comments.push(_),Nt(d,-1,"../comments"+o+"."+r,at.CMNT),x=!0}p["!legacy"]&&x&&nt(a,"xl/drawings/vmlDrawing"+o+".vml",Cb(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&nt(a,_0(i),nc(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,nt(a,i,gb(t.Strings,t)),s.strs.push(i),Nt(t.wbrels,-1,"sharedStrings."+r,at.SST)),i="xl/workbook."+r,nt(a,i,Xb(e)),s.workbooks.push(i),Nt(t.rels,1,i,at.WB),i="xl/theme/theme1.xml",nt(a,i,L1(e.Themes,t)),s.themes.push(i),Nt(t.wbrels,-1,"theme/theme1.xml",at.THEME),i="xl/styles."+r,nt(a,i,Sb(e,t)),s.styles.push(i),Nt(t.wbrels,-1,"styles."+r,at.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",nt(a,i,e.vbaraw),s.vba.push(i),Nt(t.wbrels,-1,"vbaProject.bin",at.VBA)),i="xl/metadata."+r,nt(a,i,Nb()),s.metadata.push(i),Nt(t.wbrels,-1,"metadata."+r,at.XLMETA),f.length>1&&(i="xl/persons/person.xml",nt(a,i,h7(f)),s.people.push(i),Nt(t.wbrels,-1,"persons/person.xml",at.PEOPLE)),nt(a,"[Content_Types].xml",$S(s,t)),nt(a,"_rels/.rels",nc(t.rels)),nt(a,"xl/_rels/workbook."+r+".rels",nc(t.wbrels)),delete t.revssf,delete t.ssf,a}function X1(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ns(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sW(e,t){return Be.find(e,"EncryptedPackage")?eW(e,t):Qb(e,t)}function aW(e,t){var r,n=e,s=t||{};return s.type||(s.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),r=_S(n,s),Zz(r,s)}function aA(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cx(e.slice(r),t);default:break e}return Ec.to_workbook(e,t)}function iW(e,t){var r="",n=X1(e,t);switch(t.type){case"base64":r=ns(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Wo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pt(r)),t.type="binary",aA(r,t)}function oW(e,t){var r=e;return t.type=="base64"&&(r=ns(r)),r=d0.utils.decode(1200,r.slice(2),"str"),t.type="binary",aA(r,t)}function lW(e){return e.match(/[^\x00-\x7F]/)?da(e):e}function nm(e,t,r,n){return n?(r.type="string",Ec.to_workbook(e,r)):Ec.to_workbook(t,r)}function Rx(e,t){h1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rx(new Uint8Array(e),(r=Ht(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ac={},r.dateNF&&(ac.dateNF=r.dateNF),r.type||(r.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=st?"buffer":"binary",n=rD(e),typeof Uint8Array<"u"&&!st&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=lW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Ht(r),r.type="array",Rx(d1(n),r)}switch((s=X1(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return sW(Be.read(n,r),r);break;case 9:if(s[1]<=8)return Qb(n,r);break;case 60:return Cx(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return dL(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return mb.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?aW(n,r):nm(e,n,r,a);case 239:return s[3]===60?Cx(n,r):nm(e,n,r,a);case 255:if(s[1]===254)return oW(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Po.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Po.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Nx.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Eb.to_workbook(n,r);break;case 10:case 13:case 32:return iW(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return hL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Nx.to_workbook(n,r):nm(e,n,r,a)}function iA(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return V0(t.file,Be.write(e,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Be.write(e,t)}function cW(e,t){var r=Ht(t||{}),n=tW(e,r);return uW(n,r)}function uW(e,t){var r={},n=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Be.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array($d(s))}return t.password&&typeof encrypt_agile<"u"?iA(encrypt_agile(s,t.password),t):t.type==="file"?V0(t.file,s):t.type=="string"?Pt(s):s}function fW(e,t){var r=t||{},n=lz(e,r);return iA(n,r)}function ca(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return p0(da(n));case"binary":return da(n);case"string":return e;case"file":return V0(t.file,n,"utf8");case"buffer":return st?ri(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ca(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hW(e,t){switch(t.type){case"base64":return p0(e);case"binary":return e;case"string":return e;case"file":return V0(t.file,e,"binary");case"buffer":return st?ri(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $f(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?p0(r):t.type=="string"?Pt(r):r;case"file":return V0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function oA(e,t){h1(),sU(e);var r=Ht(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=oA(e,r);return r.type="array",$d(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ca(tz(e,r),r);case"slk":case"sylk":return ca(pb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return ca(Zb(e.Sheets[e.SheetNames[s]],r),r);case"txt":return hW(lA(e.Sheets[e.SheetNames[s]],r),r);case"csv":return ca(K1(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return ca(mb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return $f(Nx.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return ca(Ec.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return ca(Eb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return ca(xb.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return ca(nA(e,r),r);case"wk1":return $f(Po.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return $f(Po.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$f(Jb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function pW(e,t,r){var n={};return n.type="file",n.file=t,dW(n),oA(e,n)}function mW(e,t,r,n,s,a,i,o){var l=pr(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=i?e[r][m]:e[n[m]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[m]!=null&&(p[a[m]]=c);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[m]!=null){if(x==null)if(g.t=="e"&&x===null)p[a[m]]=null;else if(c!==void 0)p[a[m]]=c;else if(f&&x===null)p[a[m]]=null;else continue;else p[a[m]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?x:ei(g,x,o);x!=null&&(d=!1)}}return{row:p,isempty:d}}function fd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=gt(f);break;case"number":l=gt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var d=pr(l.s.r),p=[],m=[],g=0,x=0,_=Array.isArray(e),y=l.s.r,E=0,w={};_&&!e[y]&&(e[y]=[]);var R=c.skipHidden&&e["!cols"]||[],V=c.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(R[E]||{}).hidden)switch(p[E]=Qt(E),r=_?e[y][E]:e[p[E]+d],n){case 1:a[E]=E-l.s.c;break;case 2:a[E]=p[E];break;case 3:a[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ei(r,null,c),x=w[i]||0,!x)w[i]=1;else{do o=i+"_"+x++;while(w[o]);w[i]=x,w[o]=1}a[E]=o}for(y=l.s.r+s;y<=l.e.r;++y)if(!(V[y]||{}).hidden){var L=mW(e,l,y,p,n,a,_,c);(L.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[g++]=L.row)}return m.length=g,m}var Nw=/"/g;function xW(e,t,r,n,s,a,i,o){for(var l=!0,c=[],f="",d=pr(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var m=o.dense?(e[r]||[])[p]:e[n[p]+d];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:ei(m,null,o));for(var g=0,x=0;g!==f.length;++g)if((x=f.charCodeAt(g))===s||x===a||x===34||o.forceQuotes){f='"'+f.replace(Nw,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(Nw,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function K1(e,t){var r=[],n=t==null?{}:t;if(e==null||e["!ref"]==null)return"";var s=gt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(p[g]||{}).hidden||(d[g]=Qt(g));for(var x=0,_=s.s.r;_<=s.e.r;++_)(m[_]||{}).hidden||(f=xW(e,s,_,d,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function lA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=K1(e,t);return r}function gW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=gt(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Qt(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=pr(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function cA(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Jt(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=gt(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var p=n.header||[],m=0;t.forEach(function(x,_){ir(x).forEach(function(y){(m=p.indexOf(y))==-1&&(p[m=p.length]=y);var E=x[y],w="z",R="",V=Xe({c:o+m,r:i+_+s});c=b0(a,V),E&&typeof E=="object"&&!(E instanceof Date)?a[V]=E:(typeof E=="number"?w="n":typeof E=="boolean"?w="b":typeof E=="string"?w="s":E instanceof Date?(w="d",n.cellDates||(w="n",E=Dr(E)),R=n.dateNF||He[14]):E===null&&n.nullError&&(w="e",E=0),c?(c.t=w,c.v=E,delete c.w,delete c.R,R&&(c.z=R)):a[V]=c={t:w,v:E},R&&(c.z=R))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var g=pr(i);if(s)for(m=0;m<p.length;++m)a[Qt(m+o)+g]={t:"s",v:p[m]};return a["!ref"]=rt(f),a}function vW(e,t){return cA(null,e,t)}function b0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Jt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?b0(e,Xe(t)):b0(e,Xe({r:t,c:r||0}))}function _W(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function q1(){return{SheetNames:[],Sheets:{}}}function Y1(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(Gb(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function yW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=_W(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function wW(e,t){return e.z=t,e}function uA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function EW(e,t,r){return uA(e,"#"+t,r)}function TW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function kW(e,t,r,n){for(var s=typeof t!="string"?t:gt(t),a=typeof t=="string"?t:rt(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=b0(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Hf={encode_col:Qt,encode_row:pr,encode_cell:Xe,encode_range:rt,decode_col:S1,decode_row:k1,split_cell:DD,decode_cell:Jt,decode_range:$n,format_cell:ei,sheet_add_aoa:LS,sheet_add_json:cA,sheet_add_dom:eA,aoa_to_sheet:Pc,json_to_sheet:vW,table_to_sheet:tA,table_to_book:Iz,sheet_to_csv:K1,sheet_to_txt:lA,sheet_to_json:fd,sheet_to_html:Zb,sheet_to_formulae:gW,sheet_to_row_object_array:fd,sheet_get_cell:b0,book_new:q1,book_append_sheet:Y1,book_set_sheet_visibility:yW,cell_set_number_format:wW,cell_set_hyperlink:uA,cell_set_internal_link:EW,cell_add_comment:TW,sheet_set_array_formula:kW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function SW(){var sv,av,iv,ov,lv,cv,uv,fv,hv,dv,pv,mv,xv,gv,vv,_v,yv,wv,Ev,Tv,kv,Sv,bv,Av;const e=Cg(),[t,r,,n]=ze("arcadia_users",[]),[s,a]=ze("arcadia_daily_giveaways",{date:`${new Date().getFullYear()}-${(new Date().getMonth()+1).toString().padStart(2,"0")}-${new Date().getDate().toString().padStart(2,"0")}`,active:!0,slots:[{id:1,time:"13:00",winner:null,enabled:!0},{id:2,time:"17:00",winner:null,enabled:!0},{id:3,time:"21:00",winner:null,enabled:!1}]}),[i,o]=ze("arcadia_winner_history",[]),[l,c]=ze("arcadia_monthly_winners",[{id:1,rank:1,winner:null,points:0},{id:2,rank:2,winner:null,points:0},{id:3,rank:3,winner:null,points:0},{id:4,rank:4,winner:null,points:0,enabled:!1}]),[f,d]=ze("arcadia_monthly_subtitle","TOP 3 JUGADORES"),[p,m]=ze("arcadia_announcements_list",[]),[g,x]=te.useState(null),[_,y]=te.useState({text:"",visible:!0,config:{scale:1,x:0,y:0,fontSize:24}}),[E,w]=ze("arcadia_qrs",{wifi:null,whatsapp:null,ssid:"",password:"",whatsappMessage:""}),[R,V]=ze("arcadia_benefits_text",` Descuentos exclusivos
 Acceso a torneos
 Horas gratis acumulables`),[L,T]=ze("arcadia_benefits_title",`BENEFICIOS EXCLUSIVOS
COMUNIDAD ARCADIA`),[S,b]=ze("arcadia_benefits_title_font_size",24),[F,N]=ze("arcadia_benefits_text_font_size",18),[C,P]=ze("arcadia_display_config",{logo:null,scale:1,x:0,y:0}),[ce,ye]=te.useState(!1),[we,ke]=te.useState({logo:null,scale:1,x:0,y:0}),[ie,X]=ze("arcadia_title_config",{text:"GAMING CENTER ARCADIA",scale:1,x:0,y:0}),[oe,Pe]=ze("arcadia_bottom_logo_config_v2",{logo:null,scale:1,x:0,y:0}),[U,q]=ze("arcadia_particle_count",150),[H,G]=te.useState(!1),[ne,me]=te.useState({text:"GAMING CENTER ARCADIA",scale:1,x:0,y:0}),[fe,ge]=te.useState(!1),[ue,$e]=te.useState({logo:null,scale:1,x:0,y:0}),[W,pt]=te.useState(!1),[tt,vt]=te.useState(150),[Le,Ne]=ze("arcadia_qr_panel_config_v2",{scale:1,x:0,y:0}),[kt,Et]=ze("arcadia_qr_panel_visible",!0),[_t,tn]=ze("arcadia_display_visible",!0),[Hn,Gn]=ze("arcadia_title_visible",!0),[or,Wr]=ze("arcadia_bottom_logo_visible",!0),[$r,Ys]=ze("arcadia_particles_visible",!0),[Mt,wn]=ze("arcadia_date_time_visible",!0),[Ge,St]=te.useState(!1),[rr,Ft]=te.useState(!0),[Gt,Qs]=ze("arcadia_winners_panel_visible",!0),[xr,cl]=ze("arcadia_winner_panel_config",{scale:1,x:0,y:0}),[Ot,ba]=te.useState(!1),[jt,is]=te.useState({scale:1,x:0,y:0}),[ot,Cs]=te.useState(!1),[Rt,rn]=te.useState({scale:1,x:0,y:0}),[ul,no]=te.useState(!1),[Is,so]=te.useState(!1),[fl,Js]=te.useState(""),[Aa,ai]=te.useState(""),[ii,Zs]=ze("arcadia_last_reset_month",new Date().toLocaleDateString("es-ES",{month:"2-digit",year:"numeric"})),[I,M]=ze("arcadia_tariff_images",[]),[O,j]=te.useState(null),[B,z]=te.useState(!1),[J,ae]=te.useState(null),[Z,re]=te.useState(null),[ee,ve]=te.useState(null),[Te,Ie]=te.useState({isOpen:!1,type:null,data:null,index:null}),[_e,Ce]=te.useState({isOpen:!1,slotId:null}),[Ue,yt]=ze("arcadia_tariff_banners",[]),[ut,Vt]=ze("arcadia_tariff_top_banners",[]),[nn,os]=te.useState(null),[Fn,Rn]=ze("arcadia_finance_services",[{id:1,concept:"Alquiler local",date:"",amount:""},{id:2,concept:"Electricidad 1",date:"",amount:""},{id:3,concept:"Electricidad 2",date:"",amount:""},{id:4,concept:"Agua",date:"",amount:""},{id:5,concept:"Servicio internet 1",date:"",amount:""},{id:6,concept:"Servicio internet 2",date:"",amount:""},{id:7,concept:"Servicio internet 3",date:"",amount:""},{id:8,concept:"Personal",date:"",amount:""},{id:9,concept:"Otros",date:"",amount:""}]),[Xn,Pn]=te.useState({}),[Fs,Dn]=te.useState(null),ao=A=>{Pn(K=>({...K,[A]:!K[A]})),Dn(null)},Na=(A,K,Y)=>{Rn(Fn.map(Fe=>Fe.id===A?{...Fe,[K]:Y}:Fe))},Oc=(A,K)=>{const Y=new Date().getFullYear(),Fe=new Date().getMonth()+1,Me=`${Y}-${Fe.toString().padStart(2,"0")}-${K.toString().padStart(2,"0")}`;Na(A,"date",Me),Dn(null)},Dt=()=>{const A={id:Date.now(),concept:"",date:"",amount:""};Rn([...Fn,A]),Pn(K=>({...K,[A.id]:!0}))},hl=A=>{window.confirm("Eliminar esta fila?")&&Rn(Fn.filter(K=>K.id!==A))},io=()=>Fn.reduce((A,K)=>A+(parseFloat(K.amount)||0),0).toFixed(2);te.useEffect(()=>{const A=new Date;A.setMonth(A.getMonth()-3);const K=i.filter(Y=>new Date(Y.timestamp)>A);K.length!==i.length&&o(K)},[i,o]),te.useEffect(()=>{const A=new Date,K=`${A.getFullYear()}-${(A.getMonth()+1).toString().padStart(2,"0")}-${A.getDate().toString().padStart(2,"0")}`;s.date!==K&&a({date:K,slots:s.slots.map(Y=>({...Y,winner:null}))})},[s,a]),te.useEffect(()=>{const A=()=>{const Y=new Date().toLocaleDateString("es-ES",{month:"2-digit",year:"numeric"});if(ii!==Y){const Fe=l.map(Me=>({...Me,winner:null,points:0}));c(Fe),Zs(Y),d("TOP 3 JUGADORES"),ci({isOpen:!0,title:"Nuevo Mes Iniciado",message:`Bienvenido a ${new Date().toLocaleDateString("es-ES",{month:"long",year:"numeric"})}!

Se han restablecido los ganadores mensuales y los puntos para comenzar el nuevo ciclo.`,type:"info"})}};A();const K=setInterval(A,6e4);return()=>clearInterval(K)},[ii,Zs,l,c,d]);const[lr,oi]=te.useState({name:"",nickname:""}),[dl,Zd]=te.useState(""),[oo,jc]=te.useState(null),[lo,ea]=te.useState(""),[Rs,li]=te.useState(null),[pl,ml]=te.useState(null),[Lc,xl]=te.useState(null),[ls,Mc]=te.useState(null),[ep,tp]=te.useState({}),[En,X0]=te.useState({}),[gl,vl]=te.useState(!1),[K0,Ca]=te.useState(!1),[cs,ci]=te.useState({isOpen:!1,title:"",message:"",type:"info"}),[de,je]=te.useState({isOpen:!1,type:null,data:null}),[ui,Vc]=te.useState(!1),[Ia,co]=te.useState({ssid:"",password:""}),[Fa,fi]=te.useState(!1),[us,_l]=te.useState({message:""});te.useEffect(()=>{ui||co({ssid:E.ssid||"",password:E.password||""})},[E,ui]),te.useEffect(()=>{Fa||_l({message:E.whatsappMessage||""})},[E,Fa]);const rp=()=>{w({...E,ssid:Ia.ssid,password:Ia.password}),Vc(!1)},uo=()=>{co({ssid:E.ssid||"",password:E.password||""}),Vc(!1)},q0=()=>{w({...E,whatsappMessage:us.message}),fi(!1)},Bc=()=>{_l({message:E.whatsappMessage||""}),fi(!1)},[fo,Tn]=te.useState(""),ho=A=>{if(A&&A.preventDefault(),Tn(""),!lr.name||!lr.nickname){Tn("Por favor complete todos los campos.");return}if(t.length>=1e3){Tn("Error: Se ha alcanzado el lmite mximo de 1000 usuarios.");return}if(t.some(Y=>Y.nickname.toLowerCase()===lr.nickname.toLowerCase())){Tn(`Error: El nickname "${lr.nickname}" ya est registrado.`);return}if(de.isOpen&&de.type==="ADD"){const Y={id:Date.now().toString(),...lr};r([...t,Y]),oi({name:"",nickname:""}),je({isOpen:!1,type:null,data:null})}else je({isOpen:!0,type:"ADD",data:{...lr}})},Y0=A=>{if(A.preventDefault(),Tn(""),!(!lr.name||!lr.nickname)&&oo){if(t.some(Y=>Y.id!==oo&&Y.nickname.toLowerCase()===lr.nickname.toLowerCase())){Tn(`Error: El nickname "${lr.nickname}" ya est en uso por otro usuario.`);return}r(t.map(Y=>Y.id===oo?{...Y,...lr}:Y)),jc(null),oi({name:"",nickname:""})}},Uc=A=>{Tn(""),de.isOpen&&de.type==="EDIT_START"?(oi({name:A.name,nickname:A.nickname}),jc(A.id),je({isOpen:!1,type:null,data:null})):je({isOpen:!0,type:"EDIT_START",data:A})},po=()=>{oi({name:"",nickname:""}),jc(null),Tn("")},zc=A=>{Tn("");const K=t.find(Y=>Y.id===A);de.isOpen&&de.type==="DELETE"?(r(t.filter(Y=>Y.id!==A)),je({isOpen:!1,type:null,data:null})):je({isOpen:!0,type:"DELETE",data:K})},Q0=A=>{const K=A.target.files[0];if(!K)return;const Y=new FileReader;Y.onload=Fe=>{try{const Me=Fe.target.result,Re=Rx(Me,{type:"binary"}),Je=Re.SheetNames[0],ur=Re.Sheets[Je],na=Hf.sheet_to_json(ur),br=Ds=>Ds.toString().trim().toLowerCase();let Da=0,sa=0,aa=0;const Hc=[];if(na.forEach((Ds,rN)=>{const Nv=Object.keys(Ds),Cv=Nv.find(Gc=>["usuario","user","nickname"].includes(br(Gc))),Iv=Nv.find(Gc=>["nombre","name","full name"].includes(br(Gc))),cf=Cv?Ds[Cv]:null,Fv=Iv?Ds[Iv]:null;if(cf&&Fv){const Gc=t.some(sp=>sp.nickname.toLowerCase()===cf.toString().toLowerCase()),nN=Hc.some(sp=>sp.nickname.toLowerCase()===cf.toString().toLowerCase());!Gc&&!nN?(Hc.push({id:(Date.now()+rN).toString(),nickname:cf.toString(),name:Fv.toString()}),Da++):sa++}else aa++}),Hc.length>0){if(t.length+Hc.length>1e3){Tn(`Error: La importacin excedera el lmite de 1000 usuarios. Capacidad disponible: ${1e3-t.length}`);return}r(Ds=>[...Ds,...Hc]),ci({isOpen:!0,title:"Importacin Completada",message:`Agregados: ${Da}
Duplicados omitidos: ${sa}
Formato invlido: ${aa}`,type:"success"})}else{let Ds="No se agregaron usuarios.";sa>0&&(Ds+=`
- ${sa} usuarios ya existan (duplicados).`),aa>0&&(Ds+=`
- ${aa} filas no tenan las columnas 'USUARIO' y 'NOMBRE'.`),ci({isOpen:!0,title:"Resultado de Importacin",message:Ds,type:"info"})}}catch(Me){console.error("Excel Import Error:",Me),Tn("Error al procesar el archivo Excel. Verifica el formato.")}},Y.readAsBinaryString(K)},Wc=()=>{try{const A=t.map(Me=>({USUARIO:Me.nickname,NOMBRE:Me.name})),K=Hf.json_to_sheet(A),Y=Hf.book_new();Hf.book_append_sheet(Y,K,"Usuarios");const Fe=new Date().toISOString().slice(0,10);pW(Y,`Arcadia_Usuarios_${Fe}.xlsx`)}catch(A){console.error("Export Error:",A),Tn("Error al exportar usuarios.")}},yl=t.filter(A=>A.name.toLowerCase().includes(dl.toLowerCase())||A.nickname.toLowerCase().includes(dl.toLowerCase())).sort((A,K)=>K.id-A.id),[ft,Sr]=te.useState("users"),[hi,Kn]=te.useState(!1),[On,Ra]=te.useState(!1),[di,ta]=te.useState(!1),J0=()=>{const K={id:Date.now(),text:"NUEVO ANUNCIO",visible:!0,config:{...wP}};m([...p,K])},wl=A=>{y({text:A.text,visible:A.visible,config:{color:"yellow",font:"sans",icon:"megaphone",...A.config}}),x(A.id)},sn=()=>{x(null),y({text:"",visible:!0,config:{}})},Z0=A=>{m(K=>K.map(Y=>Y.id===A?{...Y,visible:!Y.visible}:Y))},ef=()=>{var A,K;je({isOpen:!0,type:"ANNOUNCEMENT_SAVE",data:{id:g,..._,visible:(K=(A=p.find(Y=>Y.id===g))==null?void 0:A.visible)!=null?K:!0}})},pi=A=>{je({isOpen:!0,type:"ANNOUNCEMENT_DELETE",data:{id:A}})},[h,v]=te.useState(!1),[k,D]=te.useState("confirm"),[Q,se]=te.useState(""),[be,et]=te.useState(""),cr=()=>{D("confirm"),se(""),et(""),v(!0)},bt=()=>{D("password")},gr=()=>{Q==="pichicome"?(r([]),v(!1),Ca(!0)):et("Contrasea incorrecta")};te.useEffect(()=>{let A=s.slots||[],K=!1;A.some(Y=>Y.id===3)&&(A=A.filter(Y=>Y.id!==3),K=!0),A.some(Y=>Y.id===1)||(A=[...A,{id:1,time:"20:00",winner:null,enabled:!0}],K=!0),A.some(Y=>Y.id===2)||(A=[...A,{id:2,time:"21:00",winner:null,enabled:!0}],K=!0),K&&a(Y=>({...Y,slots:A})),(l.length<5||l.some(Y=>Y.enabled===!1))&&c(Y=>{const Fe=Y.length;let Me=[...Y];if(Fe<5)for(let Re=Fe+1;Re<=5;Re++)Me.push({id:Re,rank:Re,winner:null,points:0,enabled:!0});return Me=Me.map(Re=>({...Re,enabled:!0})),Me})},[s,a,l.length,c]),te.useEffect(()=>{const A=()=>{const Y=new Date().toLocaleDateString("es-ES");s.date!==Y&&a(Fe=>({...Fe,date:Y,slots:Fe.slots.map(Me=>({...Me,winner:null}))}))};A();const K=setInterval(A,6e4);return()=>clearInterval(K)},[s.date,a]);const fs=(A,K)=>{a({...s,slots:s.slots.map(Y=>Y.id===A?{...Y,time:K}:Y)})},Pa=A=>{ml(A),li(A),ea("")},Ps=A=>{Lc?(je({isOpen:!0,type:"MONTHLY_USER_SET",data:{slotId:Lc,user:A}}),xl(null),li(null)):(Mc(A),li(null))},[ra,mo]=te.useState(null),$c=A=>{if(!ls)return;const K={id:Date.now(),user:ls,selectionTime:new Date().toLocaleString(),timestamp:new Date().toISOString(),prize:"Pendiente"};o([K,...i]),a({...s,slots:s.slots.map(Y=>Y.id===A?{...Y,winner:ls}:Y)}),Mc(null),ml(null)},fA=()=>{const A=s.slots,K=Date.now();let Y="20:00";if(A.length>0){const Me=A[A.length-1].time,[Re,Je]=Me.split(":").map(Number);let ur=Re+1;ur>23&&(ur=0),Y=`${ur.toString().padStart(2,"0")}:${Je.toString().padStart(2,"0")}`}const Fe={id:K,time:Y,winner:null,enabled:!0,points:null};a({...s,slots:[...s.slots,Fe]})},hA=A=>{Ce({isOpen:!0,slotId:A})},dA=()=>{_e.slotId&&(a({...s,slots:s.slots.filter(A=>A.id!==_e.slotId)}),Ce({isOpen:!1,slotId:null}))},pA=A=>{window.confirm("Eliminar este registro del historial?")&&o(i.filter(K=>K.id!==A))},mA=(A,K)=>{o(i.map(Y=>Y.id===A?{...Y,prize:K}:Y))},xA=A=>{a({...s,slots:s.slots.map(K=>K.id===A?{...K,winner:null}:K)})},tf=t.filter(A=>{var K;return(((K=A.nickname)==null?void 0:K.toLowerCase())||"").includes(lo.toLowerCase())}),gA=(A,K)=>{c(l.map(Y=>Y.id===A?{...Y,points:K}:Y))},vA=A=>{const K=l.find(Y=>Y.id===A);K.winner&&je({isOpen:!0,type:"MONTHLY_CLEAR",data:{slotId:A,winnerName:K.winner.nickname}})},_A=A=>{xl(A),li("monthly-"+A),ea("")},Q1=A=>{tp(K=>({...K,[A]:!K[A]}))},yA=A=>{X0(K=>({...K,[A]:!K[A]})),En[A]&&(li(null),xl(null))},wA=A=>{je({isOpen:!0,type:"MONTHLY_POINTS_SAVE",data:{slotId:A.id,points:A.points}})},np=()=>{vl(!gl)},EA=()=>{je({isOpen:!0,type:"SUBTITLE_SAVE",data:{subtitle:f}})},TA=()=>{je({isOpen:!0,type:"SUBTITLE_CLEAR",data:{}})},kA=()=>{Js(L),no(!0)},SA=()=>{Js(""),no(!1)},bA=()=>{je({isOpen:!0,type:"BENEFITS_TITLE_SAVE",data:{}})},AA=()=>{ai(R),so(!0)},NA=()=>{ai(""),so(!1)},CA=()=>{je({isOpen:!0,type:"BENEFITS_TEXT_SAVE",data:{}})},rf=(A,K)=>{if(A==="title"){const Y=Math.max(12,Math.min(48,S+K));b(Y)}else{const Y=Math.max(10,Math.min(32,F+K));N(Y)}},J1=(A,K)=>{const Y=A.target.files[0];if(Y){const Fe=new FileReader;Fe.onloadend=()=>{w({...E,[K]:Fe.result})},Fe.readAsDataURL(Y)}},IA=()=>{ke({...C}),ye(!0)},FA=()=>{ke({logo:null,scale:1,x:0,y:0}),ye(!1)},RA=()=>{je({isOpen:!0,type:"DISPLAY_CONFIG_SAVE",data:{}})},PA=A=>{if(!ce)return;const K=A.target.files[0];if(K){const Y=new FileReader;Y.onloadend=()=>{ke({...we,logo:Y.result})},Y.readAsDataURL(K)}},Z1=A=>{if(!ce)return;const K=we.scale,Y=Math.max(.2,Math.min(5,K+A));ke({...we,scale:parseFloat(Y.toFixed(2))})},nf=(A,K)=>{ce&&ke({...we,[A]:we[A]+K})},DA=()=>{ce&&window.confirm("Restablecer configuracin de imagen por defecto (Temp)?")&&ke({logo:null,scale:1,x:0,y:0})},OA=()=>{me({...ie}),G(!0)},jA=()=>{me({text:"GAMING CENTER ARCADIA",scale:1,x:0,y:0}),G(!1)},LA=()=>{je({isOpen:!0,type:"TITLE_CONFIG_SAVE",data:{}})},ev=A=>{if(!H)return;const K=ne.scale,Y=Math.max(.5,Math.min(3,K+A));me({...ne,scale:parseFloat(Y.toFixed(2))})},sf=(A,K)=>{H&&me({...ne,[A]:ne[A]+K})},MA=A=>{H&&me({...ne,text:A})},VA=()=>{H&&window.confirm("Restablecer configuracin de ttulo por defecto (Temp)?")&&me({text:"GAMING CENTER ARCADIA",scale:1,x:0,y:0})},BA=()=>{$e({...oe}),ge(!0)},UA=()=>{$e({logo:null,scale:1,x:0,y:0}),ge(!1)},zA=()=>{je({isOpen:!0,type:"BOTTOM_LOGO_CONFIG_SAVE",data:{}})},WA=async A=>{if(!fe)return;const K=A.target.files[0];if(K)try{const Y=await _y(K);$e({...ue,logo:Y})}catch(Y){console.error("Error processing image:",Y),alert("Error al procesar la imagen (posiblemente corrupta).")}},tv=A=>{if(!fe)return;const K=ue.scale,Y=Math.max(.2,Math.min(5,K+A));$e({...ue,scale:parseFloat(Y.toFixed(2))})},af=(A,K)=>{fe&&$e({...ue,[A]:ue[A]+K})},$A=()=>{fe&&window.confirm("Restablecer configuracin de logo inferior por defecto (Temp)?")&&$e({logo:null,scale:1,x:0,y:0})},HA=()=>{var A,K,Y;is({scale:(A=Le==null?void 0:Le.scale)!=null?A:1,x:(K=Le==null?void 0:Le.x)!=null?K:0,y:(Y=Le==null?void 0:Le.y)!=null?Y:0}),ba(!0)},GA=()=>{ba(!1)},XA=()=>{je({isOpen:!0,type:"QR_PANEL_CONFIG_SAVE",data:{}})},rv=A=>{var Fe;if(!Ot)return;const K=(Fe=jt.scale)!=null?Fe:1,Y=Math.max(.2,Math.min(5,K+A));is({...jt,scale:parseFloat(Y.toFixed(2))})},of=(A,K)=>{var Fe;if(!Ot)return;const Y=(Fe=jt[A])!=null?Fe:0;is({...jt,[A]:Y+K})},KA=()=>{Ot&&window.confirm("Restablecer configuracin de panel QR por defecto (Temp)?")&&is({scale:1,x:0,y:0})},qA=()=>{rn({...xr}),Cs(!0)},YA=()=>{rn({scale:1,x:0,y:0}),Cs(!1)},QA=()=>{je({isOpen:!0,type:"WINNER_PANEL_CONFIG_SAVE",data:{}})},nv=A=>{if(!ot)return;const K=Rt.scale,Y=Math.max(.2,Math.min(5,K+A));rn({...Rt,scale:parseFloat(Y.toFixed(2))})},lf=(A,K)=>{ot&&rn({...Rt,[A]:Rt[A]+K})},JA=()=>{ot&&window.confirm("Restablecer configuracin de panel de ganadores por defecto (Temp)?")&&rn({scale:1,x:0,y:0})},ZA=()=>{Ft(Mt),St(!0)},eN=()=>{St(!1)},tN=()=>{je({isOpen:!0,type:"DATE_TIME_SAVE",data:{visible:rr}})};return u.jsxs("div",{className:"min-h-screen bg-slate-900 text-slate-100 p-8 font-sans relative",children:[u.jsxs("header",{className:"mb-8 flex items-center justify-between border-b border-slate-700 pb-4 relative z-50",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>{Kn(!hi),Ra(!1),ta(!1)},className:`text-slate-300 hover:text-white p-2 hover:bg-slate-800 rounded-lg transition flex items-center gap-2 ${hi?"bg-slate-800 text-white":""}`,children:[hi?u.jsx(Nr,{size:24}):u.jsx(ru,{size:24}),u.jsx("span",{className:"font-bold text-sm hidden md:inline",children:"Pantalla Cliente"}),u.jsx(Xt,{size:16,className:`transition-transform duration-300 ${hi?"rotate-180":""}`})]}),hi&&u.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-slate-800 border border-slate-700 shadow-xl rounded-lg z-50 overflow-hidden animate-fade-in",children:[u.jsxs("button",{onClick:()=>{Sr("users"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors ${ft==="users"?"text-neon-blue bg-white/5":""}`,children:[u.jsx(ru,{size:18,className:"text-neon-blue"})," Gestin de Usuarios"]}),u.jsxs("button",{onClick:()=>{Sr("qrs"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="qrs"?"text-green-400 bg-white/5":""}`,children:[u.jsx(tu,{size:18,className:"text-green-400"})," Gestor de QRs"]}),u.jsxs("button",{onClick:()=>{Sr("giveaways"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="giveaways"?"text-yellow-400 bg-white/5":""}`,children:[u.jsx(Ls,{size:18,className:"text-yellow-400"})," Gestor de Sorteos Diarios"]}),u.jsxs("button",{onClick:()=>{Sr("monthly"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="monthly"?"text-purple-400 bg-white/5":""}`,children:[u.jsx(Ls,{size:18,className:"text-purple-400"})," Gestor de Ganadores Mensuales"]}),u.jsxs("button",{onClick:()=>{Sr("announcement"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="announcement"?"text-cyan-400 bg-white/5":""}`,children:[u.jsx(zp,{size:18,className:"text-cyan-400"})," Anuncio"]}),u.jsxs("button",{onClick:()=>{Sr("benefits"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="benefits"?"text-pink-400 bg-white/5":""}`,children:[u.jsx(Ls,{size:18,className:"text-pink-400"})," Beneficios cliente"]}),u.jsxs("button",{onClick:()=>{Sr("display"),Kn(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="display"?"text-cyan-400 bg-white/5":""}`,children:[u.jsx(xo,{size:18,className:"text-cyan-400"})," Administrador de Display"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>{Ra(!On),Kn(!1),ta(!1)},className:`text-slate-300 hover:text-white p-2 hover:bg-slate-800 rounded-lg transition flex items-center gap-2 ${On?"bg-slate-800 text-white":""}`,children:[On?u.jsx(Nr,{size:24}):u.jsx(xo,{size:24}),u.jsx("span",{className:"font-bold text-sm hidden md:inline",children:"Pantalla Tarifario"}),u.jsx(Xt,{size:16,className:`transition-transform duration-300 ${On?"rotate-180":""}`})]}),On&&u.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-slate-800 border border-slate-700 shadow-xl rounded-lg z-50 overflow-hidden animate-fade-in",children:[u.jsxs("button",{onClick:()=>{Sr("tariff-images"),Ra(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors ${ft==="tariff-images"?"text-purple-400 bg-white/5":""}`,children:[u.jsx(dP,{size:18,className:"text-purple-400"}),"Gestor de Imgenes"]}),u.jsxs("button",{onClick:()=>{Sr("tariff-banner"),Ra(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="tariff-banner"?"text-cyan-400 bg-white/5":""}`,children:[u.jsx(Tl,{size:18,className:"text-cyan-400"}),"Banner Inferior"]}),u.jsxs("button",{onClick:()=>{Sr("tariff-top-banner"),Ra(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="tariff-top-banner"?"text-neon-pink bg-white/5":""}`,children:[u.jsx(Tl,{size:18,className:"text-neon-pink"}),"Banner Superior"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>{ta(!di),Kn(!1),Ra(!1)},className:`text-slate-300 hover:text-white p-2 hover:bg-slate-800 rounded-lg transition flex items-center gap-2 ${di?"bg-slate-800 text-white":""}`,children:[di?u.jsx(Nr,{size:24}):u.jsx(oP,{size:24}),u.jsx("span",{className:"font-bold text-sm hidden md:inline",children:"Control Financiero"}),u.jsx(Xt,{size:16,className:`transition-transform duration-300 ${di?"rotate-180":""}`})]}),di&&u.jsxs("div",{className:"absolute top-full left-0 mt-2 w-64 bg-slate-800 border border-slate-700 shadow-xl rounded-lg z-50 overflow-hidden animate-fade-in",children:[u.jsxs("button",{onClick:()=>{Sr("finance-cash"),ta(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors ${ft==="finance-cash"?"text-green-400 bg-white/5":""}`,children:[u.jsx(vP,{size:18,className:"text-green-400"}),"Cajas"]}),u.jsxs("button",{onClick:()=>{Sr("finance-snacks"),ta(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="finance-snacks"?"text-yellow-400 bg-white/5":""}`,children:[u.jsx(iP,{size:18,className:"text-yellow-400"}),"Golosinas"]}),u.jsxs("button",{onClick:()=>{Sr("finance-services"),ta(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="finance-services"?"text-blue-400 bg-white/5":""}`,children:[u.jsx(fy,{size:18,className:"text-blue-400"}),"Servicios"]}),u.jsxs("button",{onClick:()=>{Sr("finance-banks"),ta(!1)},className:`w-full text-left px-4 py-3 hover:bg-slate-700 flex items-center gap-2 text-sm text-slate-200 transition-colors border-t border-slate-700/50 ${ft==="finance-banks"?"text-purple-400 bg-white/5":""}`,children:[u.jsx(pP,{size:18,className:"text-purple-400"}),"Bancos"]})]})]})]}),u.jsx("h1",{className:"absolute left-1/2 transform -translate-x-1/2 text-3xl font-bold text-neon-blue hidden md:block",children:"Arcadia Admin Panel"}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 bg-slate-800/50 px-3 py-2 rounded-lg border border-slate-700",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-red-500 shadow-[0_0_10px_rgba(239,68,68,0.5)]":"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.5)]"}`}),u.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-slate-400",children:n?"Firebase Offline":"Firebase Online"})]}),u.jsxs("a",{href:"/tarifario",target:"_blank",className:"text-sm bg-slate-800 px-4 py-2 rounded hover:bg-slate-700 transition flex items-center gap-2",children:[u.jsx(xo,{size:16})," Ver Pantalla Tarifario "]}),u.jsx("a",{href:"/display",target:"_blank",className:"text-sm bg-slate-800 px-4 py-2 rounded hover:bg-slate-700 transition",children:"Ver Pantalla Cliente "}),u.jsx("button",{onClick:()=>{localStorage.removeItem("arcadia_is_authenticated"),e("/login")},className:"bg-red-500/10 hover:bg-red-500/20 text-red-400 p-2 rounded transition-colors border border-red-500/20",title:"Cerrar Sesin",children:u.jsx(xP,{size:20})})]})]}),On&&u.jsx("div",{className:"absolute top-16 left-0 animate-fade-in z-50"}),u.jsxs("div",{className:"max-w-7xl mx-auto animate-fade-in",children:[ft==="tariff-images"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg",children:[u.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-purple-400",children:[u.jsx(Image,{size:24})," Gestor de Carrusel Tarifario"]}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[I.map((A,K)=>u.jsxs("div",{draggable:!0,onDragStart:()=>ae(K),onDragEnter:()=>re(K),onDragOver:Y=>Y.preventDefault(),onDragEnd:()=>{ae(null),re(null)},onDrop:()=>{if(J===null||J===K){ae(null),re(null);return}const Y=[...I],Fe=Y.splice(J,1)[0];Y.splice(K,0,Fe),M(Y),ae(null),re(null)},className:`bg-slate-900 rounded-xl overflow-hidden border transition-all duration-300 relative 
                                            ${J===K?"opacity-40 scale-95 grayscale border-dashed border-2 border-slate-500":Z===K?"scale-105 border-2 border-neon-pink shadow-[0_0_20px_rgba(255,0,255,0.3)] z-10":"border-slate-700 hover:border-purple-500/50 hover:scale-[1.02]"}`,children:[u.jsxs("div",{className:"absolute top-2 right-2 z-20 flex gap-2",children:[u.jsx("button",{onClick:Y=>{Y.stopPropagation(),Ie({isOpen:!0,type:"EDIT",data:{...A},index:K})},className:"bg-black/50 hover:bg-cyan-600 text-slate-300 hover:text-white p-1.5 rounded-full transition-colors",title:"Editar Ajustes",children:u.jsx(Pf,{size:16})}),u.jsx("button",{onClick:Y=>{Y.stopPropagation(),Ie({isOpen:!0,type:"DELETE",data:{...A},index:K})},className:"bg-black/50 hover:bg-red-500 text-slate-300 hover:text-white p-1.5 rounded-full transition-colors",children:u.jsx(Hr,{size:16})})]}),u.jsx("div",{className:"absolute top-2 left-2 z-20 cursor-move bg-black/50 p-1.5 rounded hover:bg-black/80 text-slate-300",children:u.jsx(hP,{size:16})}),u.jsx("div",{className:"relative aspect-[9/16] bg-black group selection:bg-transparent",children:u.jsx("img",{src:A.src,alt:`Slide ${K+1}`,className:"w-full h-full object-contain select-none pointer-events-none"})}),u.jsx("div",{className:"p-3 bg-slate-900/50",children:u.jsxs("div",{className:"flex justify-between items-center text-lg text-slate-400 font-bold",children:[u.jsxs("span",{children:[A.duration||10,"s"]}),u.jsx("div",{className:"flex gap-1.5",children:["D","L","M","M","J","V","S"].map((Y,Fe)=>{var Me,Re;return u.jsx("span",{className:`${(Re=(Me=A.activeDays)==null?void 0:Me.includes(Fe))==null||Re?"text-purple-400 drop-shadow-sm":"text-slate-800"}`,children:Y},Fe)})})]})})]},A.id||K)),u.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-slate-600 rounded-xl min-h-[14rem] p-6 hover:bg-slate-900 transition-colors cursor-pointer relative",children:[u.jsx("input",{type:"file",accept:"image/*",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:async A=>{const K=A.target.files[0];if(K)try{const Y=await _y(K),Fe={id:Date.now().toString(),src:Y,duration:15,activeDays:[0,1,2,3,4,5,6]};M([...I,Fe])}catch(Y){console.error(Y),alert("Error subiendo imagen")}}}),u.jsx(ja,{size:48,className:"text-slate-500 mb-2"}),u.jsx("span",{className:"text-slate-400 font-bold",children:"Agregar Imagen"})]})]}),u.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-700",children:u.jsxs("a",{href:"/tarifario",target:"_blank",className:"text-purple-400 hover:text-purple-300 flex items-center gap-2",children:[u.jsx(xo,{size:16})," Ver Carrusel en Pantalla Completa "]})})]})]}),ft==="tariff-banner"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-cyan-400",children:[u.jsx(Tl,{size:24})," Gestor de Banner Inferior"]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-700 space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("label",{className:"block text-sm font-bold text-slate-400",children:"Lista de Banners"}),u.jsxs("button",{onClick:()=>{const A={id:Date.now(),text:"",duration:7,active:!0};yt([...Ue,A]),ve(A.id)},className:"bg-purple-600 hover:bg-purple-500 text-white px-3 py-1 rounded text-sm flex items-center gap-1 transition",children:[u.jsx(ja,{size:16})," Agregar Banner"]})]}),u.jsxs("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[Ue.length===0&&u.jsx("p",{className:"text-slate-500 text-sm italic text-center py-4",children:"No hay banners creados."}),Ue.map((A,K)=>u.jsxs("div",{className:"flex gap-2 items-center animate-fade-in-up bg-slate-900 border border-slate-700 p-2 rounded-lg",children:[u.jsx("span",{className:"text-slate-500 text-xs font-mono w-4 text-center",children:K+1}),u.jsxs("div",{className:"flex flex-col items-center bg-slate-800 rounded p-1 border border-slate-700",children:[u.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"SEG"}),u.jsx("input",{type:"number",min:"3",value:A.duration||7,onChange:Y=>{const Fe=parseInt(Y.target.value)||7,Me=[...Ue];Me[K].duration=Fe,yt(Me)},className:"w-10 bg-transparent text-center text-cyan-400 font-bold text-sm focus:outline-none"})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("input",{type:"text",value:A.text,readOnly:ee!==A.id,onChange:Y=>{const Fe=[...Ue];Fe[K].text=Y.target.value,yt(Fe)},placeholder:"Escribe el texto del banner...",className:`w-full bg-slate-800 border-b ${ee===A.id?"border-cyan-500 text-white":"border-transparent text-slate-300"} px-3 py-2 text-sm focus:outline-none transition-colors ${!A.active&&"opacity-50"}`}),!A.active&&u.jsx("div",{className:"absolute inset-0 bg-slate-900/50 pointer-events-none"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>ve(ee===A.id?null:A.id),className:`p-2 transition ${ee===A.id?"text-cyan-400 hover:text-cyan-300":"text-slate-500 hover:text-slate-300"}`,title:ee===A.id?"Terminar Edicin":"Editar Texto",children:ee===A.id?u.jsx(Oa,{size:16}):u.jsx(Pf,{size:16})}),u.jsx("button",{onClick:()=>{const Y=[...Ue];Y[K].active=!Y[K].active,yt(Y)},className:`p-2 transition ${A.active!==!1?"text-green-400 hover:text-green-300":"text-slate-600 hover:text-slate-400"}`,title:A.active!==!1?"Desactivar Banner":"Activar Banner",children:A.active!==!1?u.jsx(xy,{size:24}):u.jsx(my,{size:24})}),u.jsx("button",{onClick:()=>{const Y=Ue.filter(Fe=>Fe.id!==A.id);yt(Y)},className:"text-slate-500 hover:text-red-400 p-2 transition",title:"Eliminar Banner",children:u.jsx(Hr,{size:16})})]})]},A.id))]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-slate-400 mb-2",children:"Vista Previa (Secuencial 3s)"}),u.jsx(Cw,{banners:Ue})]})]})]}),ft==="tariff-top-banner"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-neon-pink",children:[u.jsx(Tl,{size:24})," Gestor de Banner Superior"]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-700 space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("label",{className:"block text-sm font-bold text-slate-400",children:"Lista de Banners Superiores"}),u.jsxs("button",{onClick:()=>{const A={id:Date.now(),text:"",duration:7,active:!0};Vt([...ut,A]),os(A.id)},className:"bg-purple-600 hover:bg-purple-500 text-white px-3 py-1 rounded text-sm flex items-center gap-1 transition",children:[u.jsx(ja,{size:16})," Agregar Banner"]})]}),u.jsxs("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[ut.length===0&&u.jsx("p",{className:"text-slate-500 text-sm italic text-center py-4",children:"No hay banners creados."}),ut.map((A,K)=>u.jsxs("div",{className:"flex gap-2 items-center animate-fade-in-up bg-slate-900 border border-slate-700 p-2 rounded-lg",children:[u.jsx("span",{className:"text-slate-500 text-xs font-mono w-4 text-center",children:K+1}),u.jsxs("div",{className:"flex flex-col items-center bg-slate-800 rounded p-1 border border-slate-700",children:[u.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"SEG"}),u.jsx("input",{type:"number",min:"3",value:A.duration||7,onChange:Y=>{const Fe=parseInt(Y.target.value)||7,Me=[...ut];Me[K].duration=Fe,Vt(Me)},className:"w-10 bg-transparent text-center text-neon-pink font-bold text-sm focus:outline-none"})]}),u.jsxs("div",{className:"flex-1 relative",children:[u.jsx("input",{type:"text",value:A.text,readOnly:nn!==A.id,onChange:Y=>{const Fe=[...ut];Fe[K].text=Y.target.value,Vt(Fe)},placeholder:"Escribe el texto del banner superior...",className:`w-full bg-slate-800 border-b ${nn===A.id?"border-neon-pink text-white":"border-transparent text-slate-300"} px-3 py-2 text-sm focus:outline-none transition-colors ${!A.active&&"opacity-50"}`}),!A.active&&u.jsx("div",{className:"absolute inset-0 bg-slate-900/50 pointer-events-none"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>os(nn===A.id?null:A.id),className:`p-2 transition ${nn===A.id?"text-neon-pink hover:text-pink-400":"text-slate-500 hover:text-slate-300"}`,title:nn===A.id?"Terminar Edicin":"Editar Texto",children:nn===A.id?u.jsx(Oa,{size:16}):u.jsx(Pf,{size:16})}),u.jsx("button",{onClick:()=>{const Y=[...ut];Y[K].active=!Y[K].active,Vt(Y)},className:`p-2 transition ${A.active!==!1?"text-green-400 hover:text-green-300":"text-slate-600 hover:text-slate-400"}`,title:A.active!==!1?"Desactivar Banner":"Activar Banner",children:A.active!==!1?u.jsx(xy,{size:24}):u.jsx(my,{size:24})}),u.jsx("button",{onClick:()=>{const Y=ut.filter(Fe=>Fe.id!==A.id);Vt(Y)},className:"text-slate-500 hover:text-red-400 p-2 transition",title:"Eliminar Banner",children:u.jsx(Hr,{size:16})})]})]},A.id))]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-slate-400 mb-2",children:"Vista Previa (Secuencial 3s)"}),u.jsx("div",{className:"bg-black p-4 border-t-4 border-neon-pink shadow-lg flex items-center justify-center overflow-hidden h-20",children:u.jsx(Cw,{banners:ut})})]})]})]}),ft==="users"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center justify-between text-neon-pink",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ru,{size:20})," Gestin de Usuarios"]}),u.jsxs("span",{className:`text-sm font-mono ${t.length>=1e3?"text-red-500":"text-slate-400"}`,children:[t.length," / 1000"]})]}),fo&&u.jsxs("div",{className:"mb-4 bg-red-500/10 border border-red-500/50 text-red-200 px-4 py-2 rounded text-sm flex items-center gap-2",children:[u.jsx("span",{className:"font-bold",children:"!"})," ",fo]}),u.jsxs("form",{onSubmit:oo?Y0:ho,className:"flex gap-2 mb-6",children:[u.jsx("input",{type:"text",placeholder:"Nombre Real",className:"bg-slate-900 border border-slate-700 px-3 py-2 rounded w-full focus:outline-none focus:border-neon-pink",value:lr.name,onChange:A=>oi({...lr,name:A.target.value})}),u.jsx("input",{type:"text",placeholder:"Nickname",className:"bg-slate-900 border border-slate-700 px-3 py-2 rounded w-full focus:outline-none focus:border-neon-pink",value:lr.nickname,onChange:A=>oi({...lr,nickname:A.target.value})}),oo?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"submit",className:"bg-green-500 text-black font-bold px-4 py-2 rounded hover:brightness-110",title:"Update User",children:u.jsx(Or,{size:20})}),u.jsx("button",{type:"button",onClick:po,className:"bg-slate-600 text-white font-bold px-4 py-2 rounded hover:bg-slate-500",title:"Cancel Edit",children:u.jsx(Nr,{size:20})})]}):u.jsx("button",{type:"submit",className:"bg-neon-pink text-black font-bold px-4 py-2 rounded hover:brightness-110",title:"Add User",children:u.jsx(ja,{size:20})})]}),u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h3",{className:"text-sm font-bold text-slate-400",children:"Importar/Exportar Usuarios"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:Wc,className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-sm font-bold flex items-center gap-2 transition shadow-lg",title:"Descargar lista de usuarios",children:[u.jsx(lP,{size:16})," Exportar"]}),u.jsxs("button",{onClick:cr,className:"bg-red-600 hover:bg-red-500 text-white px-3 py-1.5 rounded text-sm font-bold flex items-center gap-2 transition shadow-lg",title:"Eliminar todos los usuarios",children:[u.jsx(Hr,{size:16})," Eliminar Todo"]}),u.jsxs("label",{className:"cursor-pointer bg-green-600 hover:bg-green-500 text-white px-3 py-1.5 rounded text-sm font-bold flex items-center gap-2 transition shadow-lg",children:[u.jsx(kl,{size:16})," Importar Excel",u.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:Q0})]})]})]}),u.jsxs("p",{className:"text-xs text-slate-500 mb-4 italic",children:["* El archivo Excel debe tener las columnas: ",u.jsx("strong",{children:"USUARIO"})," y ",u.jsx("strong",{children:"NOMBRE"})," en la primera fila."]}),u.jsx("input",{type:"search",placeholder:"Buscar usuario...",className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded mb-4 focus:outline-none focus:border-neon-blue",value:dl,onChange:A=>Zd(A.target.value)}),u.jsxs("div",{className:"h-[600px] overflow-y-auto space-y-2 pr-2 custom-scrollbar",children:[yl.map(A=>u.jsxs("div",{className:"flex justify-between items-center bg-slate-700/50 p-3 rounded",children:[u.jsxs("div",{className:"w-1/3",children:[u.jsx("div",{className:"font-bold truncate",title:A.nickname,children:A.nickname}),u.jsx("div",{className:"text-xs text-slate-400 truncate",title:A.name,children:A.name})]}),u.jsx("div",{className:"flex-1 text-center text-xs sm:text-sm text-slate-300 font-mono",children:new Date(Number(A.id)).toLocaleString()}),u.jsxs("div",{className:"flex gap-2 shrink-0",children:[u.jsx("button",{onClick:()=>Uc(A),className:"text-blue-400 hover:text-blue-300",title:"Edit",children:u.jsx(Ar,{size:18})}),u.jsx("button",{onClick:()=>zc(A.id),className:"text-red-400 hover:text-red-300",title:"Delete",children:u.jsx(Hr,{size:18})})]})]},A.id)),yl.length===0&&u.jsx("p",{className:"text-slate-500 text-center py-4",children:"No users found."})]})]}),ft==="giveaways"&&u.jsxs("div",{className:`bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg ${s.active?"":"opacity-75"}`,children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-yellow-500",children:[u.jsx(Ls,{size:20})," Gestor de Sorteos Diarios"]}),u.jsxs("div",{onClick:()=>{const A=!Gt;Qs(A),a({...s,active:A})},className:`relative w-14 h-7 rounded-full cursor-pointer transition-colors duration-300 shadow-inner ${Gt?"bg-green-500":"bg-slate-700"}`,children:[u.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform duration-300 ${Gt?"translate-x-7":"translate-x-0"}`}),u.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] font-bold text-white pointer-events-none uppercase tracking-wider select-none",children:Gt?"ON":"OFF"})]})]})}),u.jsxs("div",{className:"space-y-6",children:[s.slots.sort((A,K)=>A.id-K.id).map((A,K)=>{const Y=Fe=>{if(!Fe)return"";const[Me,Re]=Fe.split(":");let Je=parseInt(Me,10);const ur=Je>=12?"PM":"AM";return Je=Je%12,Je=Je||12,`${Je}:${Re} ${ur}`};return u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsxs("div",{className:"text-sm font-mono text-slate-400 uppercase tracking-wider flex items-center gap-2",children:["Sorteo #",K+1,A.time&&u.jsxs("span",{className:"text-neon-blue font-bold",children:["(",Y(A.time),")"]}),K>=2&&u.jsx("div",{className:"flex items-center gap-4 ml-4",children:u.jsx("button",{onClick:()=>hA(A.id),className:"text-slate-500 hover:text-red-400 transition hover:bg-slate-700 p-1 rounded",title:"Eliminar Sorteo",children:u.jsx(Hr,{size:16})})})]}),u.jsx("div",{className:"flex items-center gap-2 bg-slate-900 border border-slate-700 p-1 rounded-lg",children:(()=>{const[Fe,Me]=(A.time||"12:00").split(":"),Re=parseInt(Fe,10),Je=Re>=12,ur=Re%12||12,na=(br,Da,sa)=>{let aa=parseInt(br,10);sa&&aa!==12&&(aa+=12),!sa&&aa===12&&(aa=0),fs(A.id,`${aa.toString().padStart(2,"0")}:${Da}`)};return u.jsxs(u.Fragment,{children:[u.jsx("select",{className:"bg-transparent text-xl font-bold text-white focus:outline-none appearance-none text-center w-12 cursor-pointer hover:text-yellow-500 transition-colors",value:ur,disabled:!s.active,onChange:br=>na(br.target.value,Me,Je),children:Array.from({length:12},(br,Da)=>Da+1).map(br=>u.jsx("option",{value:br,className:"bg-slate-800",children:br},br))}),u.jsx("span",{className:"text-slate-500 font-bold",children:":"}),u.jsx("select",{className:"bg-transparent text-xl font-bold text-white focus:outline-none appearance-none text-center w-12 cursor-pointer hover:text-yellow-500 transition-colors",value:Me,disabled:!s.active,onChange:br=>na(ur,br.target.value,Je),children:["00","15","30","45"].map(br=>u.jsx("option",{value:br,className:"bg-slate-800",children:br},br))}),u.jsx("button",{onClick:()=>na(ur,Me,!Je),disabled:!s.active,className:`px-2 py-1 rounded text-sm font-bold ml-1 transition-colors ${Je?"bg-purple-500/20 text-purple-400":"bg-yellow-500/20 text-yellow-400"} hover:bg-white/10`,children:Je?"PM":"AM"})]})})()})]}),A.winner?u.jsxs("div",{className:"flex justify-between items-center bg-green-500/10 border border-green-500/30 p-3 rounded animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-green-400 font-bold uppercase",children:"Ganador Seleccionado"}),u.jsxs("div",{className:"text-lg font-bold text-white flex items-center gap-2",children:[A.winner.nickname,u.jsxs("span",{className:"text-xs font-normal text-slate-400",children:["(",A.winner.name,")"]})]})]}),u.jsx("button",{onClick:()=>xA(A.id),className:"text-red-400 hover:text-red-300 p-2 hover:bg-slate-700 rounded transition",title:"Reset Winner",children:u.jsx(Hr,{size:18})})]}):u.jsxs("div",{className:"space-y-2 relative",children:[pl===A.id&&ls?u.jsxs("div",{className:"flex justify-between items-center bg-yellow-500/10 border border-yellow-500/30 p-2 rounded",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-xs text-yellow-500 block",children:"Confirmar Ganador?"}),u.jsx("span",{className:"font-bold",children:ls.nickname})]}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:()=>$c(A.id),className:"bg-green-500 text-black px-3 py-1 rounded text-sm font-bold hover:brightness-110",children:"OK"}),u.jsx("button",{onClick:()=>{Mc(null),ml(null)},className:"bg-slate-600 px-3 py-1 rounded text-sm hover:bg-slate-500",children:"Cancel"})]})]}):u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",placeholder:`Seleccionar Ganador Sorteo #${A.id}...`,className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded focus:outline-none focus:border-yellow-500 placeholder:text-slate-600 disabled:opacity-50",value:pl===A.id?lo:"",onFocus:()=>Pa(A.id),onChange:Fe=>ea(Fe.target.value),disabled:!s.active}),pl===A.id&&u.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-500",children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]}),Rs===A.id&&lo&&s.active&&u.jsx("div",{className:"absolute top-full left-0 w-full bg-slate-800 border border-slate-600 rounded mt-1 z-50 max-h-40 overflow-y-auto shadow-xl",children:tf.length>0?tf.map(Fe=>u.jsxs("div",{className:"p-2 hover:bg-slate-700 cursor-pointer border-b border-slate-700/50 last:border-0",onClick:()=>Ps(Fe),children:[u.jsx("div",{className:"font-bold text-sm text-white",children:Fe.nickname}),u.jsx("div",{className:"text-xs text-slate-400",children:Fe.name})]},Fe.id)):u.jsx("div",{className:"p-2 text-slate-500 text-sm",children:"No users found"})})]})]},A.id)}),u.jsxs("button",{onClick:fA,className:"w-full py-4 border-2 border-dashed border-slate-600 rounded-xl flex items-center justify-center text-slate-400 hover:text-green-400 hover:border-green-400 hover:bg-slate-800/50 transition group",children:[u.jsx(ja,{size:24,className:"group-hover:scale-110 transition-transform"}),u.jsx("span",{className:"ml-2 font-bold uppercase tracking-wider",children:"Agregar Nuevo Sorteo"})]})]}),u.jsxs("div",{className:"mt-8 border-t border-slate-700 pt-6 animate-fade-in",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-bold text-slate-300 flex items-center gap-2",children:[u.jsx(ru,{size:18})," Historial de Ganadores"]}),u.jsxs("div",{className:"text-sm font-mono text-slate-400 bg-slate-900 px-3 py-1 rounded border border-slate-700",children:["Total: ",u.jsx("span",{className:"text-neon-pink font-bold",children:i.length})]})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-700",children:u.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[u.jsx("thead",{className:"bg-slate-700/50 text-slate-200 uppercase font-bold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Fecha / Hora"}),u.jsx("th",{className:"px-4 py-3",children:"Da"}),u.jsx("th",{className:"px-4 py-3",children:"Ganador"}),u.jsx("th",{className:"px-4 py-3",children:"Premio"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Acciones"})]})}),u.jsxs("tbody",{className:"divide-y divide-slate-700",children:[i.map(A=>u.jsxs("tr",{className:"hover:bg-slate-700/30 transition",children:[u.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:A.selectionTime}),u.jsx("td",{className:"px-4 py-3 text-xs uppercase text-slate-300 font-bold",children:new Date(A.timestamp).toLocaleDateString("es-ES",{weekday:"long"})}),u.jsxs("td",{className:"px-4 py-3",children:[u.jsx("div",{className:"font-bold text-white",children:A.user.nickname}),u.jsx("div",{className:"text-xs text-slate-500",children:A.user.name})]}),u.jsx("td",{className:"px-4 py-3",children:ra===A.id?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:A.prize,onChange:K=>mA(A.id,K.target.value),className:"bg-slate-900 border border-slate-600 rounded px-2 py-1 text-xs text-white focus:border-neon-pink focus:outline-none",children:[u.jsx("option",{value:"Pendiente",children:"Pendiente"}),u.jsx("option",{value:"Galleta",children:"Galleta"}),u.jsx("option",{value:"Helado",children:"Helado"}),u.jsx("option",{value:"Gaseosa",children:"Gaseosa"}),u.jsx("option",{value:"No Entregado",children:"No Entregado"}),u.jsx("option",{value:"Otro",children:"Otro"})]}),u.jsx("button",{onClick:()=>mo(null),className:"text-green-400 hover:text-green-300 p-1 hover:bg-slate-700 rounded transition",title:"Guardar",children:u.jsx(Oa,{size:16})})]}):u.jsxs("div",{className:"flex items-center gap-2 group",children:[u.jsx("span",{className:`text-xs font-bold ${A.prize==="Pendiente"?"text-yellow-400":A.prize==="No Entregado"?"text-red-400":"text-slate-300"}`,children:A.prize}),u.jsx("button",{onClick:()=>mo(A.id),className:"text-blue-400 hover:text-blue-300 p-1 opacity-0 group-hover:opacity-100 transition hover:bg-slate-700 rounded",title:"Editar Premio",children:u.jsx(Ar,{size:14})})]})}),u.jsx("td",{className:"px-4 py-3 text-right",children:u.jsx("button",{onClick:()=>pA(A.id),className:"text-red-400 hover:text-red-300 p-1 hover:bg-slate-700 rounded transition",title:"Eliminar Registro",children:u.jsx(Hr,{size:16})})})]},A.id)),i.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:"4",className:"px-4 py-8 text-center italic text-slate-500",children:"No hay historial de ganadores an."})})]})]})})]}),u.jsxs("div",{className:"mt-6 bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-purple-400",children:[u.jsx(Ls,{size:20})," Estadsticas Mensuales"]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(()=>{const A={};i.forEach(Y=>{const Fe=Y.timestamp?new Date(Y.timestamp):new Date,Me=`${Fe.getFullYear()}-${Fe.getMonth()}`;A[Me]||(A[Me]={date:Fe,total:0,prizes:{}});const Re=Y.prize||"Pendiente";Re!=="Pendiente"&&Re!=="No Entregado"&&A[Me].total++,A[Me].prizes[Re]=(A[Me].prizes[Re]||0)+1});const K=Object.values(A).sort((Y,Fe)=>Fe.date-Y.date).slice(0,3);return K.length===0?u.jsx("div",{className:"text-slate-500 italic col-span-3 text-center py-4",children:"No hay datos suficientes an."}):K.map((Y,Fe)=>u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600 hover:border-purple-500/50 transition",children:[u.jsxs("h3",{className:"text-lg font-bold text-white capitalize mb-2 border-b border-slate-600 pb-2 flex justify-between",children:[Y.date.toLocaleDateString("es-ES",{month:"long",year:"numeric"}),u.jsx("span",{className:"text-xs bg-slate-800 px-2 py-0.5 rounded text-slate-400 self-center",children:Fe===0?"Actual":"Pasado"})]}),u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("span",{className:"text-slate-400 text-sm uppercase font-bold",children:"Total Premios"}),u.jsx("span",{className:"text-2xl font-bold text-green-400",children:Y.total})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(Y.prizes).sort(([,Me],[,Re])=>Re-Me).map(([Me,Re])=>u.jsxs("div",{className:"flex justify-between text-sm bg-slate-800/50 px-2 py-1 rounded",children:[u.jsx("span",{className:Me==="Pendiente"?"text-yellow-400 font-bold":Me==="No Entregado"?"text-red-400":"text-slate-300",children:Me}),u.jsx("span",{className:"text-white font-mono font-bold",children:Re})]},Me))})]},Fe))})()})]})]}),ft==="qrs"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2 text-green-400",children:[u.jsx(tu,{size:20})," Gestor de QRs"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsxs("h3",{className:"text-sm font-bold text-green-400 flex items-center gap-2",children:[u.jsx(tS,{size:16})," WiFi Config"]}),!ui&&u.jsx("button",{onClick:()=>Vc(!0),className:"text-slate-400 hover:text-green-400",title:"Edit WiFi Config",children:u.jsx(Ar,{size:16})})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-1",children:"QR Image"}),u.jsxs("label",{className:"cursor-pointer flex flex-col items-center justify-center h-40 border-2 border-dashed border-slate-600 rounded hover:border-green-400 transition bg-slate-800/50",children:[E.wifi?u.jsxs("div",{className:"relative group w-full h-full p-2",children:[u.jsx("img",{src:E.wifi,alt:"WiFi QR",className:"w-full h-full object-contain"}),ui&&u.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition",children:u.jsx("span",{className:"text-xs text-white",children:"Click to Change"})})]}):u.jsxs("div",{className:"text-center p-2",children:[u.jsx(kl,{size:24,className:"mx-auto mb-2 text-slate-400"}),u.jsx("span",{className:"text-xs text-slate-400",children:"Upload WiFi QR"})]}),u.jsx("input",{type:"file",className:"hidden",accept:"image/*",disabled:!ui,onChange:A=>J1(A,"wifi")})]})]}),ui?u.jsxs("div",{className:"space-y-3 animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Network Name (SSID)"}),u.jsx("input",{type:"text",className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded text-sm focus:border-green-400 focus:outline-none",placeholder:"e.g. Arcadia_5G",value:Ia.ssid,onChange:A=>co({...Ia,ssid:A.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Password"}),u.jsx("input",{type:"text",className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded text-sm focus:border-green-400 focus:outline-none",placeholder:"Network Password",value:Ia.password,onChange:A=>co({...Ia,password:A.target.value})})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsxs("button",{onClick:rp,className:"flex-1 bg-green-500 text-black text-sm font-bold py-1.5 rounded hover:brightness-110 flex justify-center items-center gap-1",children:[u.jsx(Or,{size:14})," Save"]}),u.jsx("button",{onClick:uo,className:"bg-slate-600 text-white text-sm font-bold px-3 py-1.5 rounded hover:bg-slate-500",children:u.jsx(Nr,{size:14})})]})]}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"bg-slate-800/50 p-2 rounded border border-slate-700/50",children:[u.jsx("span",{className:"block text-[10px] text-slate-500 uppercase",children:"SSID"}),u.jsx("div",{className:"font-mono text-sm text-green-300 truncate",children:E.ssid||"Not Set"})]}),u.jsxs("div",{className:"bg-slate-800/50 p-2 rounded border border-slate-700/50",children:[u.jsx("span",{className:"block text-[10px] text-slate-500 uppercase",children:"Password"}),u.jsx("div",{className:"font-mono text-sm text-slate-300 truncate",children:E.password||"Not Set"})]})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsxs("h3",{className:"text-sm font-bold text-green-400 flex items-center gap-2",children:[u.jsx(eS,{size:16})," WhatsApp Config"]}),!Fa&&u.jsx("button",{onClick:()=>fi(!0),className:"text-slate-400 hover:text-green-400",title:"Edit WhatsApp Config",children:u.jsx(Ar,{size:16})})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-1",children:"QR Image"}),u.jsxs("label",{className:"cursor-pointer flex flex-col items-center justify-center h-40 border-2 border-dashed border-slate-600 rounded hover:border-green-400 transition bg-slate-800/50",children:[E.whatsapp?u.jsxs("div",{className:"relative group w-full h-full p-2",children:[u.jsx("img",{src:E.whatsapp,alt:"WA QR",className:"w-full h-full object-contain"}),Fa&&u.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center opacity-0 group-hover:opacity-100 transition",children:u.jsx("span",{className:"text-xs text-white",children:"Click to Change"})})]}):u.jsxs("div",{className:"text-center p-2",children:[u.jsx(kl,{size:24,className:"mx-auto mb-2 text-slate-400"}),u.jsx("span",{className:"text-xs text-slate-400",children:"Upload WhatsApp QR"})]}),u.jsx("input",{type:"file",className:"hidden",accept:"image/*",disabled:!Fa,onChange:A=>J1(A,"whatsapp")})]})]}),Fa?u.jsxs("div",{className:"space-y-3 animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-1",children:"Display Message"}),u.jsx("textarea",{rows:3,className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded text-sm focus:border-green-400 focus:outline-none resize-none",placeholder:"Enter the text to display below the WhatsApp QR...",value:us.message,onChange:A=>_l({...us,message:A.target.value})})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsxs("button",{onClick:q0,className:"flex-1 bg-green-500 text-black text-sm font-bold py-1.5 rounded hover:brightness-110 flex justify-center items-center gap-1",children:[u.jsx(Or,{size:14})," Save"]}),u.jsx("button",{onClick:Bc,className:"bg-slate-600 text-white text-sm font-bold px-3 py-1.5 rounded hover:bg-slate-500",children:u.jsx(Nr,{size:14})})]})]}):u.jsx("div",{className:"space-y-3",children:u.jsxs("div",{className:"bg-slate-800/50 p-2 rounded border border-slate-700/50",children:[u.jsx("span",{className:"block text-[10px] text-slate-500 uppercase",children:"Display Message"}),u.jsx("p",{className:"text-sm text-slate-300 whitespace-pre-wrap",children:E.whatsappMessage||"Not Set"})]})})]})]})]}),ft==="display"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-green-400",children:[u.jsx(tu,{size:24})," Administrador de Panel QR"]}),u.jsxs("div",{onClick:()=>Et(!kt),className:`relative w-14 h-7 rounded-full cursor-pointer transition-colors duration-300 shadow-inner ${kt?"bg-green-500":"bg-slate-700"}`,children:[u.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform duration-300 ${kt?"translate-x-7":"translate-x-0"}`}),u.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] font-bold text-white pointer-events-none uppercase tracking-wider select-none",children:kt?"ON":"OFF"})]})]}),u.jsx("div",{className:"flex gap-2",children:Ot?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:XA,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:GA,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]}),u.jsx("button",{onClick:KA,className:"text-xs bg-red-900/50 px-3 py-1 rounded text-red-300 hover:text-white hover:bg-red-600 transition border border-red-500/30",children:"Restablecer"})]}):u.jsxs("button",{onClick:HA,className:"text-xs bg-green-600 px-3 py-1 rounded text-black font-bold hover:bg-green-500 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${Ot?"opacity-100":"opacity-50 pointer-events-none"}`,children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold flex justify-between",children:["Escala (Tamao)",u.jsxs("span",{className:"text-green-400",children:[Ot?jt.scale:Le.scale,"x"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>rv(-.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"-"}),u.jsx("input",{type:"range",min:"0.2",max:"3",step:"0.1",value:Ot?jt.scale:Le.scale,onChange:A=>Ot&&is({...jt,scale:parseFloat(A.target.value)}),className:"w-full accent-green-500 bg-slate-900 h-2 rounded-lg appearance-none cursor-pointer",disabled:!Ot}),u.jsx("button",{onClick:()=>rv(.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"+"})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-4 font-bold",children:["Posicin (X: ",Ot?jt.x:Le.x,", Y: ",Ot?jt.y:Le.y,")"]}),u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx("button",{onClick:()=>of("y",-10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"rotate-180"})}),u.jsxs("div",{className:"flex gap-10",children:[u.jsx("button",{onClick:()=>of("x",-10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"rotate-90"})}),u.jsx("div",{className:"w-10 h-10 bg-green-500/20 rounded-full border border-green-500/50 flex items-center justify-center",children:u.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"})}),u.jsx("button",{onClick:()=>of("x",10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"-rotate-90"})})]}),u.jsx("button",{onClick:()=>of("y",10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Eje Horizontal (X)"}),u.jsx("input",{type:"number",value:Ot?jt.x:Le.x,onChange:A=>Ot&&is({...jt,x:parseInt(A.target.value)||0}),className:"bg-slate-900 border border-slate-600 rounded p-1 text-sm text-green-400 text-center font-mono"})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Eje Vertical (Y)"}),u.jsx("input",{type:"number",value:Ot?jt.y:Le.y,onChange:A=>Ot&&is({...jt,y:parseInt(A.target.value)||0}),className:"bg-slate-900 border border-slate-600 rounded p-1 text-sm text-green-400 text-center font-mono"})]})]})]})]}),u.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-full min-h-[300px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0)",backgroundSize:"24px 24px"}}),u.jsxs("div",{className:"w-48 h-64 bg-slate-800 rounded-xl border-2 border-green-500/50 shadow-[0_0_30px_rgba(34,197,94,0.2)] flex flex-col items-center p-4 transition-transform duration-300 ease-out will-change-transform",style:{transform:`translate(${(Ot?jt.x:Le.x)/5}px, ${(Ot?jt.y:Le.y)/5}px) scale(${(Ot?jt.scale:Le.scale)*.8})`},children:[u.jsxs("div",{className:"w-full flex gap-2 mb-4",children:[u.jsx("div",{className:"flex-1 h-6 bg-green-500/20 rounded"}),u.jsx("div",{className:"flex-1 h-6 bg-slate-700/50 rounded"})]}),u.jsx("div",{className:"w-32 h-32 bg-slate-900 rounded-lg flex items-center justify-center mb-4 border border-slate-700",children:u.jsx(tu,{size:40,className:"text-green-500/50"})}),u.jsx("div",{className:"w-full h-2 bg-slate-700/50 rounded mb-2"}),u.jsx("div",{className:"w-2/3 h-2 bg-slate-700/30 rounded"}),u.jsx("span",{className:"absolute bottom-2 right-4 text-[10px] text-slate-600 font-mono",children:"Vista Previa"})]})]})]})]}),ft==="display"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-purple-400",children:[u.jsx(Ls,{size:24})," Administrador de Panel de Ganadores"]}),u.jsxs("div",{onClick:()=>{const A=!Gt;Qs(A),a({...s,active:A})},className:`relative w-14 h-7 rounded-full cursor-pointer transition-colors duration-300 shadow-inner ${Gt?"bg-green-500":"bg-slate-700"}`,children:[u.jsx("div",{className:`absolute top-1 left-1 bg-white w-5 h-5 rounded-full shadow-md transform transition-transform duration-300 ${Gt?"translate-x-7":"translate-x-0"}`}),u.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-[9px] font-bold text-white pointer-events-none uppercase tracking-wider select-none",children:Gt?"ON":"OFF"})]})]}),u.jsx("div",{className:"flex gap-2",children:ot?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:QA,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:YA,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]}),u.jsx("button",{onClick:JA,className:"text-xs bg-red-900/50 px-3 py-1 rounded text-red-300 hover:text-white hover:bg-red-600 transition border border-red-500/30",children:"Restablecer"})]}):u.jsxs("button",{onClick:qA,className:"text-xs bg-purple-600 px-3 py-1 rounded text-white font-bold hover:bg-purple-500 transition shadow-[0_0_10px_rgba(168,85,247,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${ot?"opacity-100":"opacity-50 pointer-events-none"}`,children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold flex justify-between",children:["Escala (Tamao)",u.jsxs("span",{className:"text-purple-400",children:[ot?Rt.scale:xr.scale,"x"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>nv(-.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"-"}),u.jsx("input",{type:"range",min:"0.2",max:"3",step:"0.1",value:ot?Rt.scale:xr.scale,onChange:A=>ot&&rn({...Rt,scale:parseFloat(A.target.value)}),className:"w-full accent-purple-500 bg-slate-900 h-2 rounded-lg appearance-none cursor-pointer",disabled:!ot}),u.jsx("button",{onClick:()=>nv(.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"+"})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-4 font-bold",children:["Posicin (X: ",ot?Rt.x:xr.x,", Y: ",ot?Rt.y:xr.y,")"]}),u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx("button",{onClick:()=>lf("y",-10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"rotate-180"})}),u.jsxs("div",{className:"flex gap-10",children:[u.jsx("button",{onClick:()=>lf("x",-10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"rotate-90"})}),u.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-full border border-purple-500/50 flex items-center justify-center",children:u.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"})}),u.jsx("button",{onClick:()=>lf("x",10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20,className:"-rotate-90"})})]}),u.jsx("button",{onClick:()=>lf("y",10),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:u.jsx(Xt,{size:20})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Eje Horizontal (X)"}),u.jsx("input",{type:"number",value:ot?Rt.x:xr.x,onChange:A=>ot&&rn({...Rt,x:parseInt(A.target.value)||0}),className:"bg-slate-900 border border-slate-600 rounded p-1 text-sm text-purple-400 text-center font-mono"})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[10px] text-slate-500 uppercase font-bold",children:"Eje Vertical (Y)"}),u.jsx("input",{type:"number",value:ot?Rt.y:xr.y,onChange:A=>ot&&rn({...Rt,y:parseInt(A.target.value)||0}),className:"bg-slate-900 border border-slate-600 rounded p-1 text-sm text-purple-400 text-center font-mono"})]})]})]})]}),u.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-full min-h-[300px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"radial-gradient(circle at 2px 2px, rgba(255,255,255,0.05) 1px, transparent 0)",backgroundSize:"24px 24px"}}),u.jsxs("div",{className:"w-64 h-48 bg-slate-800 rounded-xl border-2 border-purple-500/50 shadow-[0_0_30px_rgba(168,85,247,0.2)] flex flex-col items-center p-4 transition-transform duration-300 ease-out will-change-transform",style:{transform:`translate(${(ot?Rt.x:xr.x)/5}px, ${(ot?Rt.y:xr.y)/5}px) scale(${(ot?Rt.scale:xr.scale)*.8})`},children:[u.jsx("div",{className:"text-purple-400 font-bold mb-2",children:"GANADORES"}),u.jsxs("div",{className:"w-full flex flex-col gap-2",children:[u.jsx("div",{className:"h-8 bg-slate-700/50 rounded flex items-center px-2",children:u.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full"})}),u.jsx("div",{className:"h-8 bg-slate-700/50 rounded flex items-center px-2",children:u.jsx("div",{className:"w-4 h-4 bg-slate-400 rounded-full"})})]}),u.jsx("span",{className:"absolute bottom-2 right-4 text-[10px] text-slate-600 font-mono",children:"Vista Previa"})]})]})]})]}),ft==="monthly"&&u.jsxs("div",{className:`bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg ${Gt?"":"opacity-75"}`,children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-purple-400",children:[u.jsx(Ls,{size:20})," Gestor de Ganadores Mensuales"]}),u.jsx("button",{onClick:()=>{const A=!Gt;Qs(A),a(K=>({...K,active:A}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none ${Gt?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${Gt?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]}),u.jsxs("div",{className:"mb-6 bg-slate-700/50 p-4 rounded-lg border border-slate-600",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-2",children:"Subttulo (Visible en Pantalla)"}),u.jsx("div",{className:"flex gap-2 items-center",children:gl?u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",className:"flex-1 bg-slate-900 border border-slate-700 px-3 py-2 rounded focus:outline-none focus:border-purple-500 font-bold text-lg text-purple-400 tracking-wider",value:f,onChange:A=>d(A.target.value),placeholder:"Ej: TOP 3 JUGADORES"}),u.jsx("button",{onClick:EA,className:"bg-green-500 text-black p-2 rounded hover:brightness-110 transition shrink-0",title:"Guardar Subttulo",children:u.jsx(Oa,{size:20})}),u.jsx("button",{onClick:np,className:"bg-slate-600 text-white p-2 rounded hover:bg-slate-500 transition shrink-0",title:"Cancelar",children:u.jsx(Nr,{size:20})})]}):u.jsxs("div",{className:"flex-1 flex justify-between items-center bg-slate-800/50 px-3 py-2 rounded border border-slate-700/50",children:[u.jsx("span",{className:"font-bold text-lg text-purple-400 tracking-wider",children:f||u.jsx("span",{className:"text-slate-600 italic font-normal text-sm",children:"Sin subttulo"})}),u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:np,className:"text-blue-400 hover:text-blue-300 p-1 hover:bg-slate-700 rounded transition",title:"Editar Subttulo",children:u.jsx(Ar,{size:18})}),u.jsx("button",{onClick:TA,className:"text-red-400 hover:text-red-300 p-1 hover:bg-slate-700 rounded transition",title:"Borrar Subttulo",children:u.jsx(Hr,{size:18})})]})]})})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:l.map(A=>u.jsxs("div",{className:`bg-slate-700/30 p-4 rounded-lg border border-slate-600 flex flex-col relative transition-all ${A.enabled===!1?"opacity-50 grayscale":""}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-slate-600",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:`text-lg font-bold ${A.rank===1?"text-yellow-400":A.rank===2?"text-slate-300":A.rank===3?"text-amber-600":"text-red-500"}`,children:[A.rank," Lugar"]})}),u.jsx("div",{className:"flex gap-1",children:A.winner&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>yA(A.id),className:`p-1 rounded transition ${En[A.id]?"bg-slate-600 text-white":"text-blue-400 hover:text-blue-300 hover:bg-slate-700"}`,title:En[A.id]?"Cancelar Edicin":"Cambiar Usuario",children:En[A.id]?u.jsx(Nr,{size:16}):u.jsx(Ar,{size:16})}),u.jsx("button",{onClick:()=>vA(A.id),className:"text-red-400 hover:text-red-300 p-1 hover:bg-slate-700 rounded transition",title:"Borrar Ganador",children:u.jsx(Hr,{size:16})})]})})]}),A.winner&&!En[A.id]?u.jsxs("div",{className:"bg-slate-800 p-3 rounded mb-4 text-center border border-slate-700",children:[u.jsx("div",{className:"font-bold text-white text-lg",children:A.winner.nickname}),u.jsx("div",{className:"text-xs text-slate-500",children:A.winner.name})]}):u.jsxs("div",{className:"relative mb-4 animate-fade-in",children:[u.jsx("input",{type:"text",placeholder:"Buscar usuario...",className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded focus:outline-none focus:border-purple-500 text-sm",value:Rs==="monthly-"+A.id?lo:"",onFocus:()=>_A(A.id),onChange:K=>ea(K.target.value)}),Rs==="monthly-"+A.id&&lo&&u.jsx("div",{className:"absolute top-full left-0 w-full bg-slate-800 border border-slate-600 rounded mt-1 z-50 max-h-40 overflow-y-auto shadow-xl",children:tf.length>0?tf.map(K=>u.jsxs("div",{className:"p-2 hover:bg-slate-700 cursor-pointer border-b border-slate-700/50 last:border-0",onClick:()=>Ps(K),children:[u.jsx("div",{className:"font-bold text-sm text-white",children:K.nickname}),u.jsx("div",{className:"text-xs text-slate-400",children:K.name})]},K.id)):u.jsx("div",{className:"p-2 text-slate-500 text-sm",children:"No users found"})})]}),A.rank<=3&&u.jsxs("div",{className:"mt-auto",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-500 mb-1",children:"Puntos Ganados"}),u.jsx("div",{className:"flex items-center gap-2",children:ep[A.id]?u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"number",className:"w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded focus:outline-none focus:border-purple-500 font-mono text-center",value:A.points,onChange:K=>gA(A.id,K.target.value),placeholder:"0"}),u.jsx("button",{onClick:()=>wA(A),className:"bg-green-500 text-black p-2 rounded hover:brightness-110 transition",title:"Guardar Cambios",children:u.jsx(Oa,{size:18})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-full bg-slate-800/50 border border-slate-700/50 px-3 py-2 rounded font-mono text-center text-purple-300",children:A.points||0}),A.winner&&u.jsx("button",{onClick:()=>Q1(A.id),className:"bg-slate-700 text-slate-300 p-2 rounded hover:bg-slate-600 hover:text-white transition",title:"Editar Puntos",children:u.jsx(Ar,{size:18})})]})})]})]},A.id))})]}),ft==="announcement"&&u.jsxs("div",{className:"space-y-8 pb-10",children:[u.jsxs("div",{className:"flex justify-between items-center bg-slate-800 p-4 rounded-xl border border-slate-700 shadow-lg",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-cyan-400",children:[u.jsx(zp,{size:24})," Gestor de Anuncios"]}),u.jsxs("button",{onClick:J0,className:"bg-green-500 hover:bg-green-400 text-black font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition shadow-[0_0_15px_rgba(74,222,128,0.4)] hover:scale-105 active:scale-95",children:[u.jsx(ja,{size:20,strokeWidth:3}),u.jsx("span",{className:"hidden md:inline",children:"Nuevo Anuncio"})]})]}),p.length===0&&u.jsxs("div",{className:"bg-slate-800 p-12 rounded-xl border border-slate-700 text-center text-slate-400 flex flex-col items-center justify-center animate-fade-in",children:[u.jsx("div",{className:"bg-slate-700/50 p-6 rounded-full mb-4",children:u.jsx(zp,{size:48,className:"opacity-50"})}),u.jsx("p",{className:"text-lg font-medium",children:"No hay anuncios creados."}),u.jsx("p",{className:"text-sm opacity-70",children:'Haz clic en "Nuevo Anuncio" para comenzar.'})]}),p.map(A=>{const K=g===A.id,Y=K?_.config:A.config,Fe=K?_.text:A.text,Me=A.visible;return u.jsxs("div",{className:`bg-slate-800 p-6 rounded-xl border transition-all duration-300 shadow-lg ${K?"border-cyan-500/50 ring-1 ring-cyan-500/30":"border-slate-700"}`,children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 border-b border-slate-700 pb-4 gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"bg-slate-900 p-2 rounded-lg text-slate-400 font-mono text-xs border border-slate-700",children:["ID: ",A.id.toString().slice(-4)]}),u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${Me?"text-green-400":"text-slate-500"}`,children:Me?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>Z0(A.id),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${Me?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${Me?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]})]}),u.jsx("div",{className:"flex gap-2 self-end md:self-auto",children:K?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:ef,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:sn,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>wl(A),className:"text-xs bg-cyan-600 px-3 py-1 rounded text-black font-bold hover:bg-cyan-500 transition shadow-[0_0_10px_rgba(34,211,238,0.4)] flex items-center gap-1",disabled:g!==null&&g!==A.id,children:[u.jsx(Ar,{size:14})," Editar"]}),u.jsx("button",{onClick:()=>pi(A.id),className:"text-xs bg-red-500/10 border border-red-500/30 px-3 py-1 rounded text-red-500 font-bold hover:bg-red-500 hover:text-white transition flex items-center gap-1",disabled:g!==null,children:u.jsx(Hr,{size:14})})]})})]}),K&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6 animate-fade-in bg-slate-800/50 p-6 rounded-lg border border-slate-700",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700",children:[u.jsx("label",{className:"text-[10px] uppercase text-slate-400 font-bold tracking-wider mb-3 block",children:"Tipografa"}),u.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-2",children:Object.entries(Jh).map(([Re,Je])=>u.jsx("button",{onClick:()=>y(ur=>({...ur,config:{...ur.config,font:Re}})),className:`px-2 py-2 rounded text-xs transition-all border ${_.config.font===Re?"bg-cyan-500/20 text-cyan-400 border-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.3)]":"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700"}`,children:u.jsx("span",{className:Je.class,children:Je.name})},Re))})]}),u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("label",{className:"text-[10px] uppercase text-slate-400 font-bold tracking-wider",children:"Escala (Tamao)"}),u.jsxs("span",{className:"text-purple-400 font-mono font-bold",children:[_.config.scale.toFixed(1),"X"]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,scale:Math.max(.5,parseFloat((Re.config.scale-.1).toFixed(1)))}})),className:"w-8 h-8 flex items-center justify-center bg-slate-800 rounded-lg hover:bg-slate-700 text-slate-300 transition-colors border border-slate-600",children:u.jsx(gP,{size:16})}),u.jsx("div",{className:"flex-grow relative group cursor-pointer",children:u.jsx("input",{type:"range",min:"0.5",max:"3.0",step:"0.1",value:_.config.scale,onChange:Re=>y(Je=>({...Je,config:{...Je.config,scale:parseFloat(Re.target.value)}})),className:"w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-purple-500 z-10 relative"})}),u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,scale:Math.min(3,parseFloat((Re.config.scale+.1).toFixed(1)))}})),className:"w-8 h-8 flex items-center justify-center bg-slate-800 rounded-lg hover:bg-slate-700 text-slate-300 transition-colors border border-slate-600",children:u.jsx(ja,{size:16})})]})]}),u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700 mt-4",children:[u.jsx("label",{className:"text-[10px] uppercase text-slate-400 font-bold tracking-wider mb-3 block",children:"Icono"}),u.jsx("div",{className:"flex gap-2 justify-center",children:Object.entries(yx).map(([Re,Je])=>{const ur=Je.component;return u.jsx("button",{onClick:()=>y(na=>({...na,config:{...na.config,icon:Re}})),className:`p-2 rounded-lg transition-all border ${_.config.icon===Re?"bg-cyan-500/20 text-cyan-400 border-cyan-500 shadow-[0_0_10px_rgba(6,182,212,0.3)]":"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700"}`,title:Je.name,children:u.jsx(ur,{size:20})},Re)})})]})]}),u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700 flex flex-col items-center",children:[u.jsxs("div",{className:"w-full mb-6",children:[u.jsx("label",{className:"text-[10px] uppercase text-slate-400 font-bold tracking-wider mb-3 block text-center",children:"Color de Nen"}),u.jsx("div",{className:"flex justify-center gap-3",children:Object.entries(Iu).map(([Re,Je])=>u.jsx("button",{onClick:()=>y(ur=>({...ur,config:{...ur.config,color:Re}})),className:`w-8 h-8 rounded-full border-2 transition-all duration-300 ${Je.bg} ${_.config.color===Re?"scale-125 ring-2 ring-white border-transparent":"opacity-60 hover:opacity-100 hover:scale-110 border-slate-800"}`,title:Je.name},Re))})]}),u.jsxs("div",{className:"flex justify-between items-center w-full mb-4 px-2 border-t border-slate-800 pt-4",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-400 font-bold tracking-wider",children:["Posicin (X: ",_.config.x,", Y: ",_.config.y,")"]}),u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,x:0,y:0}})),className:"text-[10px] text-red-400 hover:text-white bg-red-500/10 hover:bg-red-500 px-2 py-1 rounded transition-colors",title:"Resetear Posicin",children:"RESET"})]}),u.jsxs("div",{className:"relative w-48 h-48 bg-slate-800 rounded-full border border-slate-700 shadow-inner flex items-center justify-center mb-6",children:[u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,y:Re.config.y-10}})),className:"absolute top-2 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-slate-700 hover:bg-cyan-600 rounded-lg flex items-center justify-center text-white transition shadow-lg active:scale-95",children:u.jsx(aP,{size:24})}),u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,y:Re.config.y+10}})),className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 w-10 h-10 bg-slate-700 hover:bg-cyan-600 rounded-lg flex items-center justify-center text-white transition shadow-lg active:scale-95",children:u.jsx(Xt,{size:24})}),u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,x:Re.config.x-10}})),className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-slate-700 hover:bg-cyan-600 rounded-lg flex items-center justify-center text-white transition shadow-lg active:scale-95",children:u.jsx(nP,{size:24})}),u.jsx("button",{onClick:()=>y(Re=>({...Re,config:{...Re.config,x:Re.config.x+10}})),className:"absolute right-2 top-1/2 transform -translate-y-1/2 w-10 h-10 bg-slate-700 hover:bg-cyan-600 rounded-lg flex items-center justify-center text-white transition shadow-lg active:scale-95",children:u.jsx(sP,{size:24})}),u.jsx("div",{className:"w-12 h-12 bg-slate-900 rounded-full border border-slate-600 flex items-center justify-center shadow-inner",children:u.jsx("div",{className:"w-2 h-2 bg-cyan-500 rounded-full animate-pulse"})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-slate-500 block mb-1 uppercase text-center",children:"Eje Horizontal (X)"}),u.jsx("input",{type:"number",value:_.config.x,onChange:Re=>y(Je=>({...Je,config:{...Je.config,x:parseInt(Re.target.value)||0}})),className:"w-full bg-slate-950 border border-slate-700 rounded px-2 py-1 text-center text-cyan-300 font-mono text-sm focus:border-cyan-500 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-slate-500 block mb-1 uppercase text-center",children:"Eje Vertical (Y)"}),u.jsx("input",{type:"number",value:_.config.y,onChange:Re=>y(Je=>({...Je,config:{...Je.config,y:parseInt(Re.target.value)||0}})),className:"w-full bg-slate-950 border border-slate-700 rounded px-2 py-1 text-center text-cyan-300 font-mono text-sm focus:border-cyan-500 outline-none"})]})]})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-2",children:"Texto del Anuncio"}),u.jsx("textarea",{rows:4,className:`w-full bg-slate-900 border border-slate-700 px-3 py-2 rounded focus:outline-none focus:border-cyan-500 font-mono text-cyan-300 text-lg tracking-wider resize-none ${K?"":"opacity-50 cursor-not-allowed"}`,value:Fe||"",onChange:Re=>K&&y(Je=>({...Je,text:Re.target.value})),placeholder:"Escribe el anuncio aqu...",disabled:!K})]}),u.jsxs("div",{className:"mt-6 border-t border-slate-700 pt-6",children:[u.jsxs("h3",{className:"text-sm uppercase text-slate-400 font-bold mb-3 flex items-center gap-2",children:[u.jsx(cP,{size:16})," Vista Previa en Vivo"]}),u.jsx("div",{className:"bg-black/90 rounded-xl p-8 flex justify-center items-center border border-slate-700 shadow-inner min-h-[150px] overflow-hidden relative",children:(()=>{var Da,sa;const Re=Y.color||"yellow",Je=Iu[Re]||Iu.yellow,ur=Y.font||"sans",na=((Da=Jh[ur])==null?void 0:Da.class)||"font-sans",br=((sa=yx[Y.icon||"megaphone"])==null?void 0:sa.component)||c1;return u.jsxs("div",{className:`px-6 py-4 border-2 bg-black/80 backdrop-blur-md rounded-2xl flex items-center gap-4 md:gap-6 transition-transform duration-300 origin-center ${Je.border}`,style:{transform:`translate(${Y.x}px, ${Y.y}px) scale(${Y.scale})`,boxShadow:`0 0 40px ${Je.value}40`},children:[u.jsx("div",{className:`${Je.bg} text-black p-2 md:p-3 rounded-full ${Je.shadow} animate-bounce-custom`,children:u.jsx(br,{size:24,className:"md:w-8 md:h-8",strokeWidth:2.5})}),u.jsx("p",{className:`font-black tracking-widest animate-pulse uppercase whitespace-pre-wrap text-center transition-all duration-300 ${Je.text} ${Je.glow} ${na}`,style:{fontSize:`${Y.fontSize}px`},children:Fe||"ESCRIBE AQU"})]})})()})]})]},A.id)})]}),ft==="benefits"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2 text-pink-400",children:[u.jsx(Ls,{size:20})," Gestor de Beneficios cliente"]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400",children:"Ttulo de la Seccin"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"flex bg-slate-800 rounded border border-slate-600 mr-2",children:[u.jsx("button",{onClick:()=>rf("title",-2),className:"px-2 py-1 hover:bg-slate-700 text-slate-300 border-r border-slate-600",title:"Disminuir Letra",children:u.jsx("span",{className:"text-xs font-bold",children:"A-"})}),u.jsx("button",{onClick:()=>rf("title",2),className:"px-2 py-1 hover:bg-slate-700 text-slate-300",title:"Aumentar Letra",children:u.jsx("span",{className:"text-sm font-bold",children:"A+"})})]}),ul?u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:bA,className:"text-green-400 hover:text-green-300 transition bg-slate-800 p-1 rounded",title:"Guardar",children:u.jsx(Oa,{size:18})}),u.jsx("button",{onClick:SA,className:"text-red-400 hover:text-red-300 transition bg-slate-800 p-1 rounded",title:"Cancelar",children:u.jsx(Nr,{size:18})})]}):u.jsx("button",{onClick:kA,className:"text-slate-400 hover:text-blue-400 transition",title:"Editar Ttulo",children:u.jsx(Ar,{size:18})})]})]}),ul?u.jsx("textarea",{rows:2,className:"w-full bg-slate-900 border border-slate-500 px-3 py-2 rounded focus:outline-none focus:border-pink-500 font-bold text-pink-400 tracking-wider resize-none whitespace-pre-wrap text-center",style:{fontSize:`${S}px`},value:fl,onChange:A=>Js(A.target.value),placeholder:"Escribe el ttulo aqu..."}):u.jsx("div",{className:"w-full bg-slate-900/50 border border-slate-700/50 px-3 py-2 rounded font-bold text-pink-400 tracking-wider text-center whitespace-pre-wrap",style:{fontSize:`${S}px`},children:L})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400",children:"Texto de Beneficios"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"flex bg-slate-800 rounded border border-slate-600 mr-2",children:[u.jsx("button",{onClick:()=>rf("text",-2),className:"px-2 py-1 hover:bg-slate-700 text-slate-300 border-r border-slate-600",title:"Disminuir Letra",children:u.jsx("span",{className:"text-xs font-bold",children:"A-"})}),u.jsx("button",{onClick:()=>rf("text",2),className:"px-2 py-1 hover:bg-slate-700 text-slate-300",title:"Aumentar Letra",children:u.jsx("span",{className:"text-sm font-bold",children:"A+"})})]}),Is?u.jsxs("div",{className:"flex gap-1",children:[u.jsx("button",{onClick:CA,className:"text-green-400 hover:text-green-300 transition bg-slate-800 p-1 rounded",title:"Guardar",children:u.jsx(Oa,{size:18})}),u.jsx("button",{onClick:NA,className:"text-red-400 hover:text-red-300 transition bg-slate-800 p-1 rounded",title:"Cancelar",children:u.jsx(Nr,{size:18})})]}):u.jsx("button",{onClick:AA,className:"text-slate-400 hover:text-blue-400 transition",title:"Editar Texto",children:u.jsx(Ar,{size:18})})]})]}),Is?u.jsx("textarea",{rows:10,className:"w-full bg-slate-900 border border-slate-500 px-3 py-2 rounded focus:outline-none focus:border-pink-500 font-mono text-slate-300 resize-none whitespace-pre-wrap",style:{fontSize:`${F}px`},value:Aa,onChange:A=>ai(A.target.value),placeholder:"Escribe los beneficios aqu..."}):u.jsx("div",{className:"w-full bg-slate-900/50 border border-slate-700/50 px-3 py-2 rounded font-mono text-slate-300 whitespace-pre-wrap min-h-[200px]",style:{fontSize:`${F}px`},children:R}),u.jsxs("p",{className:"text-xs text-slate-500 mt-2 italic flex justify-between",children:[u.jsx("span",{children:'* Este texto se mostrar cuando se seleccione "Beneficios de ser usuario" en la pantalla de visualizacin.'}),u.jsxs("span",{children:["Tamaos: Ttulo ",S,"px, Texto ",F,"px"]})]})]})]}),ft==="display"&&(C?u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-slate-700 pb-4",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-cyan-400",children:[u.jsx(xo,{size:24})," Administrador de Display"]}),u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${_t?"text-green-400":"text-slate-500"}`,children:_t?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>tn(!_t),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${_t?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${_t?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),u.jsx("div",{className:"flex gap-2",children:ce?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:RA,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:FA,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]}),u.jsx("button",{onClick:DA,className:"text-xs bg-red-900/50 px-3 py-1 rounded text-red-300 hover:text-white hover:bg-red-600 transition border border-red-500/30",children:"Restablecer"})]}):u.jsxs("button",{onClick:IA,className:"text-xs bg-cyan-600 px-3 py-1 rounded text-black font-bold hover:bg-cyan-500 transition shadow-[0_0_10px_rgba(34,211,238,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${ce?"opacity-100":"opacity-50 pointer-events-none"}`,children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold",children:"Imagen Principal"}),u.jsxs("div",{className:"relative group",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:PA,disabled:!ce,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-50 disabled:cursor-not-allowed"}),u.jsx("div",{className:`bg-slate-900 border-2 border-dashed border-slate-600 rounded-lg p-4 text-center transition-colors relative overflow-hidden h-32 flex items-center justify-center ${ce?"group-hover:border-cyan-500":""}`,children:(ce?we.logo:C!=null&&C.logo)?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 blur-sm",style:{backgroundImage:`url(${ce?we.logo:C==null?void 0:C.logo})`}}),u.jsx("img",{src:ce?we.logo:C==null?void 0:C.logo,alt:"Upload Preview",className:"relative z-10 max-h-full max-w-full object-contain shadow-lg"}),ce&&u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity z-20",children:[u.jsx(kl,{size:24,className:"text-cyan-400 mb-1"}),u.jsx("span",{className:"text-xs text-white font-bold",children:"Cambiar Imagen"})]})]}):u.jsxs("div",{className:`flex flex-col items-center justify-center gap-2 text-slate-400 ${ce?"group-hover:text-cyan-400":""}`,children:[u.jsx(kl,{size:24}),u.jsx("span",{className:"text-sm font-medium",children:"Click para subir nueva imagen"})]})})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold flex justify-between",children:["Escala (Tamao)",u.jsxs("span",{className:"text-cyan-400",children:[ce?we.scale:(sv=C==null?void 0:C.scale)!=null?sv:1,"x"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>Z1(-.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"-"}),u.jsx("input",{type:"range",min:"0.2",max:"3",step:"0.1",value:ce?we.scale:(av=C==null?void 0:C.scale)!=null?av:1,onChange:A=>ce&&ke({...we,scale:parseFloat(A.target.value)}),className:"w-full accent-cyan-500 bg-slate-900 h-2 rounded-lg appearance-none cursor-pointer",disabled:!ce}),u.jsx("button",{onClick:()=>Z1(.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"+"})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold text-center",children:["Posicin (X: ",ce?we.x:(iv=C==null?void 0:C.x)!=null?iv:0,", Y: ",ce?we.y:(ov=C==null?void 0:C.y)!=null?ov:0,")"]}),u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx("button",{onClick:()=>nf("y",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-cyan-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-180"})}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>nf("x",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-cyan-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-90"})}),u.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-900 border border-slate-700 flex items-center justify-center",children:u.jsx("div",{className:"w-2 h-2 bg-cyan-500 rounded-full animate-pulse"})}),u.jsx("button",{onClick:()=>nf("x",10),className:"bg-slate-800 p-2 rounded-full hover:bg-cyan-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform -rotate-90"})})]}),u.jsx("button",{onClick:()=>nf("y",10),className:"bg-slate-800 p-2 rounded-full hover:bg-cyan-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{})})]})]})]}),u.jsxs("div",{className:"bg-black/50 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-[400px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-700 via-slate-900 to-black pointer-events-none"}),u.jsx("div",{className:"relative transition-all duration-300 ease-out",style:{transform:`translate(${ce?we.x:(lv=C==null?void 0:C.x)!=null?lv:0}px, ${ce?we.y:(cv=C==null?void 0:C.y)!=null?cv:0}px) scale(${ce?we.scale:(uv=C==null?void 0:C.scale)!=null?uv:1})`},children:(ce?we.logo:C!=null&&C.logo)?u.jsx("img",{src:ce?we.logo:C==null?void 0:C.logo,alt:"Logo Preview",className:"max-w-[200px] h-auto drop-shadow-[0_0_15px_rgba(34,211,238,0.5)]"}):u.jsxs("div",{className:"p-8 border-2 border-dashed border-slate-700 rounded-lg text-slate-600 flex flex-col items-center",children:[u.jsx("span",{className:"text-4xl opacity-50 mb-2",children:""}),u.jsx("span",{className:"text-sm",children:"Sin imagen personalizada"})]})}),u.jsx("div",{className:"absolute bottom-4 right-4 text-xs text-slate-500 font-mono",children:"Vista Previa"})]})]})]}):u.jsx("div",{className:"flex items-center justify-center h-64 bg-slate-800 rounded-xl border border-slate-700",children:u.jsx("div",{className:"text-cyan-400 font-bold animate-pulse",children:"Cargando configuracin de display..."})})),ft==="display"&&(ie?u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-slate-700 pb-4",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-pink-500",children:[u.jsx(Tl,{size:24})," Administrador de Ttulo"]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${Hn?"text-green-400":"text-slate-500"}`,children:Hn?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>Gn(!Hn),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${Hn?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${Hn?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),H?u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:LA,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:jA,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]}),u.jsx("button",{onClick:VA,className:"text-xs bg-red-900/50 px-3 py-1 rounded text-red-300 hover:text-white hover:bg-red-600 transition border border-red-500/30",children:"Restablecer"})]}):u.jsxs("button",{onClick:OA,className:"text-xs bg-cyan-600 px-3 py-1 rounded text-black font-bold hover:bg-cyan-500 transition shadow-[0_0_10px_rgba(34,211,238,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})]})]}),u.jsxs("div",{className:"flex flex-col gap-8",children:[u.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-6 transition-opacity duration-300 ${H?"opacity-100":"opacity-50 pointer-events-none"}`,children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600 md:col-span-2",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold",children:"Texto Principal"}),u.jsx("input",{type:"text",value:H?ne.text:(fv=ie==null?void 0:ie.text)!=null?fv:"",onChange:A=>MA(A.target.value),disabled:!H,className:"w-full bg-slate-900 border border-slate-600 rounded p-3 text-white focus:outline-none focus:border-pink-500 transition font-bold tracking-wider"})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold flex justify-between",children:["Escala (Tamao)",u.jsxs("span",{className:"text-pink-400",children:[H?ne.scale:(hv=ie==null?void 0:ie.scale)!=null?hv:1,"x"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>ev(-.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"-"}),u.jsx("input",{type:"range",min:"0.5",max:"3",step:"0.1",value:H?ne.scale:(dv=ie==null?void 0:ie.scale)!=null?dv:1,onChange:A=>H&&me({...ne,scale:parseFloat(A.target.value)}),className:"w-full accent-pink-500 bg-slate-900 h-2 rounded-lg appearance-none cursor-pointer",disabled:!H}),u.jsx("button",{onClick:()=>ev(.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"+"})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold text-center",children:["Posicin (X: ",H?ne.x:(pv=ie==null?void 0:ie.x)!=null?pv:0,", Y: ",H?ne.y:(mv=ie==null?void 0:ie.y)!=null?mv:0,")"]}),u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx("button",{onClick:()=>sf("y",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-pink-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-180"})}),u.jsxs("div",{className:"flex gap-4",children:[u.jsx("button",{onClick:()=>sf("x",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-pink-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-90"})}),u.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-700"}),u.jsx("button",{onClick:()=>sf("x",10),className:"bg-slate-800 p-2 rounded-full hover:bg-pink-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform -rotate-90"})})]}),u.jsx("button",{onClick:()=>sf("y",10),className:"bg-slate-800 p-2 rounded-full hover:bg-pink-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{})})]})]})]}),u.jsxs("div",{className:"bg-black/50 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-[350px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-700 via-slate-900 to-black pointer-events-none"}),u.jsx("div",{className:"transition-all duration-300 ease-out",style:{transform:`translate(${H?ne.x:(xv=ie==null?void 0:ie.x)!=null?xv:0}px, ${H?ne.y:(gv=ie==null?void 0:ie.y)!=null?gv:0}px) scale(${H?ne.scale:(vv=ie==null?void 0:ie.scale)!=null?vv:1})`},children:u.jsx(r4,{text:H?ne.text:(_v=ie==null?void 0:ie.text)!=null?_v:""})}),u.jsx("div",{className:"absolute bottom-4 right-4 text-xs text-slate-500 font-mono",children:H?"Vista Previa (Edicin)":"Vista Previa"})]})]})]}):u.jsx("div",{className:"flex items-center justify-center h-64 bg-slate-800 rounded-xl border border-slate-700 mt-8",children:u.jsx("div",{className:"text-pink-400 font-bold animate-pulse",children:"Cargando configuracin de ttulo..."})})),ft==="display"&&(oe?u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-slate-700 pb-4",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-indigo-500",children:[u.jsx(xo,{size:24})," Administrador de Logo Inferior"]}),u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${or?"text-green-400":"text-slate-500"}`,children:or?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>Wr(!or),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${or?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${or?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),u.jsx("div",{className:"flex gap-2",children:fe?u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:zA,className:"text-xs bg-green-500 px-3 py-1 rounded text-black font-bold hover:bg-green-400 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:UA,className:"text-xs bg-slate-700 px-3 py-1 rounded text-red-400 hover:text-red-300 hover:bg-slate-600 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]}),u.jsx("button",{onClick:$A,className:"text-xs bg-red-900/50 px-3 py-1 rounded text-red-300 hover:text-white hover:bg-red-600 transition border border-red-500/30",children:"Restablecer"})]}):u.jsxs("button",{onClick:BA,className:"text-xs bg-indigo-600 px-3 py-1 rounded text-white font-bold hover:bg-indigo-500 transition shadow-[0_0_10px_rgba(99,102,241,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[u.jsxs("div",{className:`space-y-6 transition-opacity duration-300 ${fe?"opacity-100":"opacity-50 pointer-events-none"}`,children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsx("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold",children:"Imagen del Logo"}),u.jsxs("div",{className:"relative group",children:[u.jsx("input",{type:"file",accept:"image/*",onChange:WA,disabled:!fe,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-50 disabled:cursor-not-allowed"}),u.jsx("div",{className:`bg-slate-900 border-2 border-dashed border-slate-600 rounded-lg p-4 text-center transition-colors relative overflow-hidden h-32 flex items-center justify-center ${fe?"group-hover:border-indigo-500":""}`,children:u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-40 blur-sm",style:{backgroundImage:`url(${(fe?ue.logo:oe==null?void 0:oe.logo)||hu})`}}),u.jsx("img",{src:(fe?ue.logo:oe==null?void 0:oe.logo)||hu,alt:"Upload Preview",className:"relative z-10 max-h-full max-w-full object-contain shadow-lg"}),fe&&u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity z-20",children:[u.jsx(kl,{size:24,className:"text-indigo-400 mb-1"}),u.jsx("span",{className:"text-xs text-white font-bold",children:"Cambiar Imagen"})]})]})})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold flex justify-between",children:["Escala (Tamao)",u.jsxs("span",{className:"text-indigo-400",children:[fe?ue.scale:(yv=oe==null?void 0:oe.scale)!=null?yv:1,"x"]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{onClick:()=>tv(-.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"-"}),u.jsx("input",{type:"range",min:"0.2",max:"3",step:"0.1",value:fe?ue.scale:(wv=oe==null?void 0:oe.scale)!=null?wv:1,onChange:A=>fe&&$e({...ue,scale:parseFloat(A.target.value)}),className:"w-full accent-indigo-500 bg-slate-900 h-2 rounded-lg appearance-none cursor-pointer",disabled:!fe}),u.jsx("button",{onClick:()=>tv(.1),className:"bg-slate-800 p-2 rounded hover:bg-slate-600 text-slate-300",children:"+"})]})]}),u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("label",{className:"block text-xs uppercase text-slate-400 mb-3 font-bold text-center",children:["Posicin (X: ",fe?ue.x:(Ev=oe==null?void 0:oe.x)!=null?Ev:0,", Y: ",fe?ue.y:(Tv=oe==null?void 0:oe.y)!=null?Tv:0,")"]}),u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsx("button",{onClick:()=>af("y",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-indigo-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-180"})}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>af("x",-10),className:"bg-slate-800 p-2 rounded-full hover:bg-indigo-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform rotate-90"})}),u.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-900 border border-slate-700 flex items-center justify-center",children:u.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"})}),u.jsx("button",{onClick:()=>af("x",10),className:"bg-slate-800 p-2 rounded-full hover:bg-indigo-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{className:"transform -rotate-90"})})]}),u.jsx("button",{onClick:()=>af("y",10),className:"bg-slate-800 p-2 rounded-full hover:bg-indigo-500 hover:text-black transition shadow-lg w-10 h-10 flex items-center justify-center",children:u.jsx(Xt,{})})]})]})]}),u.jsxs("div",{className:"bg-black/50 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-[400px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-700 via-slate-900 to-black pointer-events-none"}),u.jsx("div",{className:"relative transition-all duration-300 ease-out",style:{transform:`translate(${fe?ue.x:(kv=oe==null?void 0:oe.x)!=null?kv:0}px, ${fe?ue.y:(Sv=oe==null?void 0:oe.y)!=null?Sv:0}px) scale(${fe?ue.scale:(bv=oe==null?void 0:oe.scale)!=null?bv:1})`},children:(fe?ue.logo:oe!=null&&oe.logo)||hu?u.jsx("img",{src:(fe?ue.logo:oe==null?void 0:oe.logo)||hu,alt:"Logo Preview",className:"max-w-[200px] h-auto drop-shadow-[0_0_15px_rgba(99,102,241,0.5)]"}):u.jsxs("div",{className:"p-8 border-2 border-dashed border-slate-700 rounded-lg text-slate-600 flex flex-col items-center",children:[u.jsx("span",{className:"text-4xl opacity-50 mb-2",children:""}),u.jsx("span",{className:"text-sm",children:"Sin imagen"})]})}),u.jsx("div",{className:"absolute bottom-4 right-4 text-xs text-slate-500 font-mono",children:"Vista Previa"})]})]})]}):u.jsx("div",{className:"flex items-center justify-center h-64 bg-slate-800 rounded-xl border border-slate-700",children:u.jsx("div",{className:"text-indigo-400 font-bold animate-pulse",children:"Cargando configuracin..."})})),ft==="display"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-slate-700 pb-4",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-cyan-400",children:[u.jsx(py,{size:24})," Administrador de Partculas"]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${$r?"text-green-400":"text-slate-500"}`,children:$r?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>Ys(!$r),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${$r?"bg-green-500":"bg-slate-600"}`,children:u.jsx("span",{className:`${$r?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),u.jsx("div",{className:"flex gap-2",children:W?u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:()=>{je({isOpen:!0,type:"PARTICLE_COUNT_SAVE",data:{count:tt}})},className:"text-xs bg-green-600 px-3 py-1 rounded text-black font-bold hover:bg-green-500 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:()=>pt(!1),className:"text-xs bg-slate-600 px-3 py-1 rounded text-white font-bold hover:bg-slate-500 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]})]}):u.jsxs("button",{onClick:()=>{vt(U),pt(!0)},className:"text-xs bg-cyan-600 px-3 py-1 rounded text-white font-bold hover:bg-cyan-500 transition shadow-[0_0_10px_rgba(6,182,212,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-slate-700/30 p-4 rounded-lg border border-slate-600",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("label",{className:"text-xs uppercase text-slate-400 font-bold",children:"Cantidad de Partculas"}),u.jsx("span",{className:"text-cyan-400 font-mono font-bold",children:W?tt:U})]}),u.jsx("input",{type:"range",min:"200",max:"1000",step:"10",value:W?tt:U,onChange:A=>vt(parseInt(A.target.value)),disabled:!W,className:"w-full h-2 bg-slate-900 rounded-lg appearance-none cursor-pointer accent-cyan-500 disabled:opacity-50 disabled:cursor-not-allowed"}),u.jsxs("div",{className:"flex justify-between text-[10px] text-slate-500 mt-2 font-mono",children:[u.jsx("span",{children:"MIN: 200"}),u.jsx("span",{children:"MAX: 1000"})]})]}),u.jsx("p",{className:"text-xs text-slate-500 italic",children:"Nota: Aumentar demasiado la cantidad de partculas puede afectar el rendimiento en equipos con poca potencia grfica."})]}),u.jsxs("div",{className:"bg-black/50 rounded-xl border border-slate-700 flex items-center justify-center relative overflow-hidden h-[350px]",children:[u.jsx("div",{className:"absolute inset-0 opacity-20 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-slate-700 via-slate-900 to-black pointer-events-none"}),u.jsxs("div",{className:"text-center z-10",children:[u.jsx("span",{className:"text-4xl block mb-2 opacity-50",children:""}),u.jsx("span",{className:"text-sm text-slate-400",children:"Previsualizacin de Densidad"})]}),u.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-30",children:Array.from({length:Math.min(50,(W?tt:U)/5)}).map((A,K)=>u.jsx("div",{className:"absolute bg-white rounded-full",style:{width:Math.random()*3+"px",height:Math.random()*3+"px",top:Math.random()*100+"%",left:Math.random()*100+"%",animation:`pulse ${Math.random()*3+2}s infinite alternate`}},K))})]})]})]}),ft==="display"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-slate-700 pb-4",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-cyan-400",children:[u.jsx(hy,{size:24})," Administrador de Fecha y Hora"]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 px-3 py-1 rounded-full border border-slate-700",children:[u.jsx("span",{className:`text-xs font-bold ${(Ge?rr:Mt)?"text-green-400":"text-slate-500"}`,children:(Ge?rr:Mt)?"VISIBLE":"OCULTO"}),u.jsx("button",{onClick:()=>Ge&&Ft(!rr),disabled:!Ge,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none ${(Ge?rr:Mt)?"bg-green-500":"bg-slate-600"} ${Ge?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,children:u.jsx("span",{className:`${(Ge?rr:Mt)?"translate-x-4":"translate-x-1"} inline-block h-3 w-3 transform rounded-full bg-white transition-transform`})})]}),u.jsx("div",{className:"flex gap-2",children:Ge?u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:tN,className:"text-xs bg-green-600 px-3 py-1 rounded text-black font-bold hover:bg-green-500 transition shadow-[0_0_10px_rgba(74,222,128,0.4)] flex items-center gap-1",children:[u.jsx(Or,{size:14})," Guardar"]}),u.jsxs("button",{onClick:eN,className:"text-xs bg-slate-600 px-3 py-1 rounded text-white font-bold hover:bg-slate-500 transition flex items-center gap-1",children:[u.jsx(Nr,{size:14})," Cancelar"]})]}):u.jsxs("button",{onClick:ZA,className:"text-xs bg-cyan-600 px-3 py-1 rounded text-white font-bold hover:bg-cyan-500 transition shadow-[0_0_10px_rgba(6,182,212,0.4)] flex items-center gap-1",children:[u.jsx(Ar,{size:14})," Editar"]})})]})]}),u.jsx("p",{className:"text-sm text-slate-400",children:"Controla la visibilidad de la fecha y el reloj digital en la parte superior de la pantalla de clientes. Al desactivarlo, se ocultar tanto la fecha como la hora."})]}),ft==="finance-services"&&u.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg animate-fade-in",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-blue-400",children:[u.jsx(fy,{size:24})," Gestin de Pagos Mensuales"]}),u.jsxs("button",{onClick:Dt,className:"bg-green-500 hover:bg-green-400 text-black font-bold py-2 px-4 rounded flex items-center gap-2 transition shadow-[0_0_10px_rgba(74,222,128,0.3)]",children:[u.jsx(ja,{size:18})," Agregar"]})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-700",children:u.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[u.jsx("thead",{className:"bg-slate-700/50 text-slate-200 uppercase font-bold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Concepto"}),u.jsx("th",{className:"px-4 py-3 w-48",children:"Vencimiento"}),u.jsx("th",{className:"px-4 py-3 w-40 text-right",children:"Monto (S/.)"}),u.jsx("th",{className:"px-4 py-3 w-10"})]})}),u.jsx("tbody",{className:"divide-y divide-slate-700",children:Fn.map(A=>u.jsxs("tr",{className:"hover:bg-slate-700/30 transition group",children:[u.jsx("td",{className:"px-4 py-2",children:Xn[A.id]?u.jsx("input",{type:"text",value:A.concept,onChange:K=>Na(A.id,"concept",K.target.value),placeholder:"Concepto...",className:"w-full bg-transparent border-b border-transparent focus:border-blue-500 focus:outline-none text-white placeholder:text-slate-600 py-1"}):u.jsx("span",{className:"text-slate-300 font-medium",children:A.concept})}),u.jsx("td",{className:"px-4 py-2 relative",children:Xn[A.id]?u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>Dn(Fs===A.id?null:A.id),className:"w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white focus:border-blue-500 focus:outline-none flex items-center justify-between gap-2 hover:bg-slate-800 transition",children:[u.jsx("span",{children:A.date?A.date.split("-").reverse().join("/"):"Seleccionar"}),u.jsx(hy,{size:14,className:"text-slate-400"})]}),Fs===A.id&&u.jsx("div",{className:"absolute top-full left-0 mt-2 z-50 bg-slate-800 border border-slate-600 rounded-lg shadow-xl p-3 w-64 animate-fade-in",children:u.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:31},(K,Y)=>Y+1).map(K=>u.jsx("button",{onClick:()=>Oc(A.id,K),className:"w-8 h-8 flex items-center justify-center rounded hover:bg-blue-500 hover:text-white transition text-xs font-bold text-slate-300 bg-slate-700/50",children:K},K))})})]}):u.jsx("span",{className:"text-slate-400",children:A.date?A.date.split("-").reverse().join("/"):"-"})}),u.jsx("td",{className:"px-4 py-2 text-right",children:Xn[A.id]?u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute left-2 top-1.5 text-slate-500",children:"S/."}),u.jsx("input",{type:"number",step:"0.01",value:A.amount,onChange:K=>Na(A.id,"amount",K.target.value),placeholder:"0.00",className:"w-full bg-slate-900 border border-slate-600 rounded pl-8 pr-2 py-1 text-white text-right focus:border-blue-500 focus:outline-none font-mono"})]}):u.jsxs("span",{className:"text-neon-blue font-mono font-bold",children:["S/. ",parseFloat(A.amount||0).toFixed(2)]})}),u.jsxs("td",{className:"px-4 py-2 text-right flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>ao(A.id),className:`transition p-1.5 rounded-full ${Xn[A.id]?"text-green-400 hover:bg-green-400/10":"text-slate-500 hover:text-green-400 hover:bg-slate-700"}`,title:Xn[A.id]?"Guardar":"Editar",children:Xn[A.id]?u.jsx(Oa,{size:18}):u.jsx(Pf,{size:18})}),u.jsx("button",{onClick:()=>hl(A.id),className:"text-slate-600 hover:text-red-400 transition p-1.5 rounded-full hover:bg-red-400/10",title:"Eliminar Fila",children:u.jsx(Hr,{size:16})})]})]},A.id))}),u.jsx("tfoot",{className:"bg-slate-700/50 font-bold text-white",children:u.jsxs("tr",{children:[u.jsx("td",{colSpan:"2",className:"px-4 py-3 text-right text-blue-300 uppercase tracking-wider",children:"Sumatoria Total"}),u.jsxs("td",{className:"px-4 py-3 text-right font-mono text-neon-blue text-lg",children:["S/. ",io()]}),u.jsx("td",{})]})})]})})]})]}),u.jsx(Wp,{isOpen:de.isOpen,onClose:()=>je({isOpen:!1,type:null,data:null}),title:u.jsxs("div",{className:"flex items-center gap-2",children:[de.type==="ADD"&&u.jsx(ja,{className:"text-green-400"}),de.type==="UPDATE"&&u.jsx(Or,{className:"text-green-400"}),de.type==="EDIT_START"&&u.jsx(Ar,{className:"text-blue-400"}),de.type==="DELETE"&&u.jsx(Hr,{className:"text-red-400"}),de.type==="MONTHLY_USER_SET"&&u.jsx(ru,{className:"text-purple-400"}),de.type==="MONTHLY_POINTS_SAVE"&&u.jsx(Or,{className:"text-green-400"}),de.type==="MONTHLY_CLEAR"&&u.jsx(Hr,{className:"text-red-400"}),de.type==="SUBTITLE_SAVE"&&u.jsx(Or,{className:"text-green-400"}),de.type==="SUBTITLE_CLEAR"&&u.jsx(Hr,{className:"text-red-400"}),de.type==="ANNOUNCEMENT_SAVE"&&u.jsx(Or,{className:"text-cyan-400"}),de.type==="BENEFITS_TITLE_SAVE"&&u.jsx(Or,{className:"text-pink-400"}),de.type==="BENEFITS_TEXT_SAVE"&&u.jsx(Or,{className:"text-pink-400"}),de.type==="DISPLAY_CONFIG_SAVE"&&u.jsx(Or,{className:"text-cyan-400"}),de.type==="TITLE_CONFIG_SAVE"&&u.jsx(Tl,{className:"text-pink-500"}),de.type==="PARTICLE_COUNT_SAVE"&&u.jsx(py,{className:"text-cyan-400"}),de.type==="QR_PANEL_CONFIG_SAVE"&&u.jsx(tu,{className:"text-green-400"}),de.type==="WINNER_PANEL_CONFIG_SAVE"&&u.jsx(Ls,{className:"text-purple-400"}),de.type==="BOTTOM_LOGO_CONFIG_SAVE"&&u.jsx(xo,{className:"text-indigo-500"}),u.jsx("span",{className:["DELETE","MONTHLY_CLEAR","SUBTITLE_CLEAR"].includes(de.type)?"text-red-400":["EDIT_START"].includes(de.type)?"text-blue-400":["ANNOUNCEMENT_SAVE","DISPLAY_CONFIG_SAVE","PARTICLE_COUNT_SAVE","QR_PANEL_CONFIG_SAVE"].includes(de.type)?"text-cyan-400":["BENEFITS_TITLE_SAVE","BENEFITS_TEXT_SAVE","TITLE_CONFIG_SAVE"].includes(de.type)?"text-pink-400":["BOTTOM_LOGO_CONFIG_SAVE"].includes(de.type)?"text-indigo-400":"text-green-400",children:de.type==="DELETE"||de.type==="MONTHLY_CLEAR"||de.type==="SUBTITLE_CLEAR"?"Confirmar Eliminacin":de.type==="EDIT_START"?"Confirmar Edicin":"Confirmar Guardado"})]}),children:u.jsxs("div",{children:[u.jsxs("p",{className:"text-slate-300 mb-6 text-lg",children:[de.type==="ADD"&&u.jsxs("span",{children:["Ests seguro de que deseas agregar a ",u.jsx("strong",{children:de.data.nickname}),"?"]}),de.type==="UPDATE"&&u.jsxs("span",{children:["Ests seguro de que deseas guardar los cambios para ",u.jsx("strong",{children:de.data.nickname}),"?"]}),de.type==="EDIT_START"&&u.jsxs("span",{children:["Deseas editar a ",u.jsx("strong",{children:de.data.nickname}),"?"]}),de.type==="DELETE"&&u.jsxs("span",{children:["Ests seguro de que deseas eliminar a ",u.jsx("strong",{children:de.data.nickname}),"?"]}),de.type==="MONTHLY_USER_SET"&&u.jsxs("span",{children:["Asignar a ",u.jsx("strong",{children:de.data.user.nickname})," como ganador del ",(Av=l.find(A=>A.id===de.data.slotId))==null?void 0:Av.rank," Lugar?"]}),de.type==="MONTHLY_POINTS_SAVE"&&u.jsxs("span",{children:["Guardar ",u.jsx("strong",{children:de.data.points})," puntos?"]}),de.type==="MONTHLY_CLEAR"&&u.jsxs("span",{children:["Eliminar al ganador ",u.jsx("strong",{children:de.data.winnerName}),"?"]}),de.type==="SUBTITLE_SAVE"&&u.jsx("span",{children:"Guardar cambios en el subttulo?"}),de.type==="SUBTITLE_CLEAR"&&u.jsxs("span",{children:['Borrar el subttulo "',u.jsx("strong",{children:f}),'"?']}),de.type==="ANNOUNCEMENT_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en Anuncio?"}),u.jsxs("ul",{className:"list-disc list-inside text-slate-400",children:[u.jsxs("li",{children:["Estado: ",de.data.visible?"VISIBLE":"OCULTO"]}),u.jsxs("li",{children:["Texto: ",u.jsx("span",{className:"font-mono text-xs overflow-hidden max-h-12 block",children:de.data.text})]}),u.jsxs("li",{children:["Config: Tamao ",de.data.config.fontSize,"px | Escala ",de.data.config.scale,"x"]}),u.jsxs("li",{children:["Posicin: X=",de.data.config.x,", Y=",de.data.config.y]})]})]}),de.type==="BENEFITS_TITLE_SAVE"&&u.jsx("span",{children:"Guardar el nuevo ttulo de Beneficios?"}),de.type==="BENEFITS_TEXT_SAVE"&&u.jsx("span",{children:"Guardar el nuevo texto de Beneficios?"}),de.type==="DISPLAY_CONFIG_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar los cambios en la configuracin del Display?"}),u.jsxs("ul",{className:"list-disc list-inside text-slate-400",children:[u.jsxs("li",{children:["Escala: ",we.scale,"x"]}),u.jsxs("li",{children:["Posicin: X=",we.x,", Y=",we.y]}),u.jsxs("li",{children:["Imagen: ",we.logo!==C.logo?"Nueva imagen seleccionada":"Sin cambios"]})]})]}),de.type==="DATE_TIME_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en Fecha y Hora?"}),u.jsx("ul",{className:"list-disc list-inside text-slate-400",children:u.jsxs("li",{children:["Estado: ",de.data.visible?"VISIBLE":"OCULTO"]})})]}),de.type==="TITLE_CONFIG_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en Ttulo Principal?"}),u.jsxs("ul",{className:"list-disc list-inside text-slate-400",children:[u.jsxs("li",{children:['Texto: "',ne.text,'"']}),u.jsxs("li",{children:["Escala: ",ne.scale,"x"]}),u.jsxs("li",{children:["Posicin: X=",ne.x,", Y=",ne.y]})]})]}),de.type==="BOTTOM_LOGO_CONFIG_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en Logo Inferior?"}),u.jsxs("ul",{className:"list-disc list-inside text-slate-400",children:[u.jsxs("li",{children:["Escala: ",ue.scale,"x"]}),u.jsxs("li",{children:["Posicin: X=",ue.x,", Y=",ue.y]}),u.jsxs("li",{children:["Imagen: ",ue.logo!==oe.logo?"Nueva imagen seleccionada":"Sin cambios"]})]})]}),de.type==="PARTICLE_COUNT_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en la densidad de partculas?"}),u.jsx("ul",{className:"list-disc list-inside text-slate-400",children:u.jsxs("li",{children:["Nueva Cantidad: ",de.data.count," partculas"]})})]}),de.type==="WINNER_PANEL_CONFIG_SAVE"&&u.jsxs("div",{className:"text-sm mt-2",children:[u.jsx("p",{className:"mb-2",children:"Confirmar cambios en Panel de Ganadores?"}),u.jsxs("ul",{className:"list-disc list-inside text-slate-400",children:[u.jsxs("li",{children:["Escala: ",Rt.scale,"x"]}),u.jsxs("li",{children:["Posicin: X=",Rt.x,", Y=",Rt.y]})]})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:()=>je({isOpen:!1,type:null,data:null}),className:"flex-1 px-4 py-2 rounded bg-slate-700 text-white hover:bg-slate-600 font-bold transition border border-slate-600",children:"Cancelar"}),u.jsx("button",{onClick:()=>{if(de.type==="ADD"&&ho(null),de.type==="UPDATE"&&Y0(null),de.type==="EDIT_START"&&Uc(de.data),de.type==="DELETE"&&zc(de.data.id),de.type==="MONTHLY_USER_SET"){const{slotId:A,user:K}=de.data;c(l.map(Y=>Y.id===A?{...Y,winner:K}:Y)),X0({...En,[A]:!1}),je({isOpen:!1,type:null,data:null})}if(de.type==="MONTHLY_POINTS_SAVE"){const{slotId:A}=de.data;Q1(A),je({isOpen:!1,type:null,data:null})}if(de.type==="MONTHLY_CLEAR"){const{slotId:A}=de.data;c(l.map(K=>K.id===A?{...K,winner:null,points:0}:K)),je({isOpen:!1,type:null,data:null})}if(de.type==="SUBTITLE_SAVE"&&(np(),je({isOpen:!1,type:null,data:null})),de.type==="SUBTITLE_CLEAR"&&(d(""),je({isOpen:!1,type:null,data:null})),de.type==="ANNOUNCEMENT_SAVE"){const{id:A,text:K,visible:Y,config:Fe}=de.data;m(p.map(Me=>Me.id===A?{...Me,text:K,visible:Y,config:Fe}:Me)),x(null),y({text:"",visible:!0,config:{}}),je({isOpen:!1,type:null,data:null})}if(de.type==="ANNOUNCEMENT_DELETE"){const{id:A}=de.data;m(p.filter(K=>K.id!==A)),g===A&&sn(),je({isOpen:!1,type:null,data:null})}de.type==="BENEFITS_TITLE_SAVE"&&(T(fl),no(!1),je({isOpen:!1,type:null,data:null})),de.type==="BENEFITS_TEXT_SAVE"&&(V(Aa),so(!1),je({isOpen:!1,type:null,data:null})),de.type==="DISPLAY_CONFIG_SAVE"&&(P(we),ye(!1),je({isOpen:!1,type:null,data:null})),de.type==="TITLE_CONFIG_SAVE"&&(X(ne),G(!1),je({isOpen:!1,type:null,data:null})),de.type==="BOTTOM_LOGO_CONFIG_SAVE"&&(Pe(ue),ge(!1),je({isOpen:!1,type:null,data:null})),de.type==="DATE_TIME_SAVE"&&(wn(de.data.visible),St(!1),je({isOpen:!1,type:null,data:null})),de.type==="QR_PANEL_CONFIG_SAVE"&&(Ne(jt),ba(!1),je({isOpen:!1,type:null,data:null})),de.type==="WINNER_PANEL_CONFIG_SAVE"&&(cl(Rt),Cs(!1),je({isOpen:!1,type:null,data:null})),de.type==="PARTICLE_COUNT_SAVE"&&(q(de.data.count),q(de.data.count),pt(!1),je({isOpen:!1,type:null,data:null})),de.type==="DATE_TIME_SAVE"&&(wn(de.data.visible),St(!1),je({isOpen:!1,type:null,data:null}))},className:`flex-1 px-4 py-2 rounded text-black font-bold transition shadow-lg
                                ${["ADD","UPDATE","MONTHLY_POINTS_SAVE","MONTHLY_USER_SET","SUBTITLE_SAVE","ANNOUNCEMENT_SAVE","BENEFITS_TITLE_SAVE","BENEFITS_TEXT_SAVE","DISPLAY_CONFIG_SAVE","TITLE_CONFIG_SAVE","BOTTOM_LOGO_CONFIG_SAVE","PARTICLE_COUNT_SAVE","DATE_TIME_SAVE"].includes(de.type)?"bg-green-500 hover:bg-green-400":""}
                                ${de.type==="EDIT_START"?"bg-blue-500 hover:bg-blue-400":""}
                                ${["DELETE","MONTHLY_CLEAR","SUBTITLE_CLEAR"].includes(de.type)?"bg-red-500 hover:bg-red-400":""}
                            `,children:"Confirmar"})]})]})}),u.jsx(bW,{isOpen:Te.isOpen,type:Te.type,data:Te.data,onClose:()=>Ie({...Te,isOpen:!1}),onConfirm:A=>{if(Te.type==="DELETE"){const K=I.filter((Y,Fe)=>Fe!==Te.index);M(K)}else if(Te.type==="EDIT"){const K=[...I];K[Te.index]={...K[Te.index],...A},M(K)}Ie({isOpen:!1,type:null,data:null,index:null})}}),_e.isOpen&&u.jsx("div",{className:"fixed inset-0 z-[160] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:u.jsxs("div",{className:"bg-slate-800 border border-red-500/30 rounded-xl p-6 max-w-sm w-full shadow-2xl transform transition-all scale-100",children:[u.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[u.jsx(Hr,{className:"text-red-400"})," Confirmar Eliminacin"]}),u.jsx("p",{className:"text-slate-300 mb-6",children:"Ests seguro de que deseas eliminar este sorteo?"}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:()=>Ce({isOpen:!1,slotId:null}),className:"flex-1 px-4 py-2 rounded bg-slate-700 text-white hover:bg-slate-600 font-bold transition",children:"Cancelar"}),u.jsx("button",{onClick:dA,className:"flex-1 px-4 py-2 rounded bg-red-500 text-white hover:bg-red-400 font-bold transition shadow-lg",children:"Eliminar"})]})]})}),h&&u.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[200] p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-slate-800 border border-slate-700 p-6 rounded-2xl w-full max-w-sm shadow-2xl relative animate-fade-in",children:[u.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[u.jsx(l1,{size:24,className:"text-red-500"}),k==="confirm"?"Eliminar Todos?":"Verificacin Requerida"]}),k==="confirm"?u.jsxs(u.Fragment,{children:[u.jsxs("p",{className:"text-slate-300 mb-6",children:["Ests seguro de que deseas eliminar ",u.jsx("strong",{className:"text-white",children:"TODOS"})," los usuarios? Esta accin no se puede deshacer."]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:bt,className:"flex-1 bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded transition",children:"S, Eliminar"}),u.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-bold py-2 rounded transition",children:"No, Cancelar"})]})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-slate-300 mb-4",children:"Ingresa la contrasea de administrador para confirmar esta accin destructiva."}),u.jsx("input",{type:"password",value:Q,onChange:A=>se(A.target.value),placeholder:"Contrasea",className:"w-full bg-slate-900 border border-slate-600 text-white px-3 py-2 rounded mb-2 focus:border-red-500 focus:outline-none",autoFocus:!0}),be&&u.jsx("p",{className:"text-red-400 text-xs mb-4 font-bold",children:be}),u.jsxs("div",{className:"flex gap-3 mt-4",children:[u.jsx("button",{onClick:gr,className:"flex-1 bg-red-600 hover:bg-red-500 text-white font-bold py-2 rounded transition",children:"Confirmar"}),u.jsx("button",{onClick:()=>v(!1),className:"flex-1 bg-slate-600 hover:bg-slate-500 text-white font-bold py-2 rounded transition",children:"Cancelar"})]})]})]})}),u.jsx(Wp,{isOpen:K0,onClose:()=>Ca(!1),title:u.jsxs("div",{className:"flex items-center gap-2 text-green-400",children:[u.jsx(Oa,{size:24})," Operacin Exitosa"]}),children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("p",{className:"text-lg text-white mb-6",children:"Todos los usuarios han sido eliminados correctamente."}),u.jsx("button",{onClick:()=>Ca(!1),className:"w-full bg-neon-blue hover:bg-cyan-400 text-black font-bold py-2 rounded shadow-[0_0_10px_rgba(0,243,255,0.4)] transition-all",children:"Aceptar"})]})}),u.jsx(Wp,{isOpen:cs.isOpen,onClose:()=>ci({...cs,isOpen:!1}),title:u.jsxs("div",{className:`flex items-center gap-2 ${cs.type==="success"?"text-green-400":"text-cyan-400"}`,children:[u.jsx(Zk,{size:24})," ",cs.title]}),children:u.jsxs("div",{className:"text-center py-4",children:[u.jsx("p",{className:"text-slate-200 mb-6 whitespace-pre-wrap text-left bg-slate-800/50 p-4 rounded border border-slate-700/50 font-mono text-sm leading-relaxed",children:cs.message}),u.jsx("button",{onClick:()=>ci({...cs,isOpen:!1}),className:"w-full bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 rounded shadow-lg transition-all border border-slate-600",children:"Cerrar"})]})})]})}function Cw({banners:e}){var i;const[t,r]=te.useState(0),n=e.filter(o=>o.text.trim());if(te.useEffect(()=>{if(n.length===0)return;const o=setInterval(()=>{r(l=>(l+1)%n.length)},3e3);return()=>clearInterval(o)},[n.length]),n.length===0)return u.jsx("div",{className:"bg-black text-white h-16 flex items-center justify-center rounded-lg shadow-inner",children:u.jsx("div",{className:"text-slate-600 italic text-sm text-center px-4",children:"(Banner vaco - agrega texto arriba)"})});const s=((i=n[t])==null?void 0:i.text)||"",a=s.length>50;return u.jsx("div",{className:"bg-black text-white h-16 flex items-center overflow-hidden border-t-4 border-purple-600 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] relative justify-center",children:u.jsx("div",{className:`whitespace-nowrap px-4 font-bold text-xl ${a?"animate-marquee inline-block min-w-full":"animate-fade-in"}`,children:s},t)})}function bW({isOpen:e,type:t,data:r,onClose:n,onConfirm:s}){const[a,i]=te.useState(r||{});return te.useEffect(()=>{i(r||{})},[r]),e?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:u.jsxs("div",{className:"bg-slate-800 border border-purple-500/30 rounded-xl p-6 max-w-sm w-full shadow-2xl transform transition-all scale-100",children:[u.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[t==="DELETE"?u.jsx(Hr,{className:"text-red-400"}):u.jsx(Ar,{className:"text-cyan-400"}),t==="DELETE"?"Eliminar Imagen":"Editar Imagen"]}),t==="DELETE"?u.jsx("p",{className:"text-slate-300 mb-6",children:"Ests seguro de que deseas eliminar esta imagen del tarifario?"}):u.jsxs("div",{className:"space-y-4 mb-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase text-slate-500 font-bold mb-1",children:"Duracin (segundos)"}),u.jsx("input",{type:"number",min:"3",value:a.duration||10,onChange:o=>i({...a,duration:parseInt(o.target.value)||10}),className:"bg-slate-900 border border-slate-600 text-white text-sm rounded px-3 py-2 w-full focus:outline-none focus:border-cyan-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase text-slate-500 font-bold mb-2",children:"Das Activos"}),u.jsx("div",{className:"flex justify-between gap-1",children:["D","L","M","M","J","V","S"].map((o,l)=>{const c=a.activeDays||[0,1,2,3,4,5,6],f=c.includes(l);return u.jsx("button",{onClick:()=>{let d;f?d=c.filter(p=>p!==l):d=[...c,l],i({...a,activeDays:d})},className:`w-8 h-8 rounded text-xs font-bold transition-all ${f?"bg-purple-600 text-white shadow shadow-purple-500/50 transform scale-105":"bg-slate-900 text-slate-600 border border-slate-800 hover:border-slate-600"}`,children:o},l)})})]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 rounded bg-slate-700 text-white hover:bg-slate-600 font-bold transition",children:"Cancelar"}),u.jsx("button",{onClick:()=>s(a),className:`flex-1 px-4 py-2 rounded text-black font-bold transition shadow-lg ${t==="DELETE"?"bg-red-500 hover:bg-red-400":"bg-cyan-500 hover:bg-cyan-400"}`,children:t==="DELETE"?"Eliminar":"Guardar"})]})]})}):null}function AW(){const[e]=ze("arcadia_tariff_images",[]),[t]=ze("arcadia_tariff_banners",[]),[r]=ze("arcadia_tariff_top_banners",[]),[n,s]=te.useState(0),[a,i]=te.useState([]);te.useEffect(()=>{if(!e)return;const y=new Date().getDay(),E=e.filter(w=>w.activeDays?w.activeDays.includes(y):!0);i(E)},[e]),te.useEffect(()=>{if(a.length===0)return;n>=a.length&&s(0);const y=a[n];if(!y)return;const E=(y.duration||10)*1e3,w=setTimeout(()=>{s(R=>(R+1)%a.length)},E);return()=>clearTimeout(w)},[n,a]);const[o,l]=te.useState(0),c=te.useMemo(()=>(t==null?void 0:t.filter(y=>y.text.trim()&&y.active!==!1))||[],[t]);te.useEffect(()=>{if(c.length<=1)return;const y=c[o],E=((y==null?void 0:y.duration)||7)*1e3,w=setTimeout(()=>{l(R=>(R+1)%c.length)},E);return()=>clearTimeout(w)},[c,o]),te.useEffect(()=>{o>=c.length&&l(0)},[c.length,o]);const f=c[o],d=(f==null?void 0:f.text.length)>60,[p,m]=te.useState(0),g=te.useMemo(()=>(r==null?void 0:r.filter(y=>y.text.trim()&&y.active!==!1))||[],[r]);te.useEffect(()=>{if(g.length<=1)return;const y=g[p],E=((y==null?void 0:y.duration)||7)*1e3,w=setTimeout(()=>{m(R=>(R+1)%g.length)},E);return()=>clearTimeout(w)},[g,p]),te.useEffect(()=>{p>=g.length&&m(0)},[g.length,p]);const x=g[p],_=(x==null?void 0:x.text.length)>60;return u.jsxs("div",{className:"min-h-screen bg-slate-900 overflow-hidden relative",children:[u.jsx(Ig,{}),u.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-black/20",children:a.length>0?u.jsx("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:a.map((y,E)=>u.jsx("img",{src:y.src,alt:`Tariff Slide ${E}`,className:`absolute inset-0 w-full h-full object-contain ${E===n?"block":"hidden"}`},`${y.id}-${E}`))}):u.jsxs("div",{className:"text-center text-slate-500 animate-pulse",children:[u.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Tarifario no disponible"}),u.jsx("p",{children:"Esperando contenido del administrador..."})]})}),f&&u.jsx("div",{className:"absolute bottom-0 inset-x-0 h-20 bg-black z-50 flex items-center overflow-hidden border-t-4 border-purple-600 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] justify-center",children:u.jsx("div",{className:`whitespace-nowrap px-4 font-bold text-4xl text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.5)] ${d?"animate-marquee inline-block min-w-full":"animate-fade-in"}`,children:f.text},f.id)}),x&&u.jsx("div",{className:"absolute top-0 inset-x-0 h-20 bg-black z-50 flex items-center overflow-hidden border-b-4 border-neon-pink shadow-[0_10px_40px_rgba(0,0,0,0.8)] justify-center",children:u.jsx("div",{className:`whitespace-nowrap px-4 font-bold text-4xl text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.5)] ${_?"animate-marquee inline-block min-w-full":"animate-fade-in"}`,children:x.text},x.id)})]})}function NW(){const[e,t]=te.useState(""),[r,n]=te.useState(""),[s,a]=te.useState(""),i=Cg();te.useEffect(()=>{localStorage.getItem("arcadia_is_authenticated")==="true"&&i("/admin")},[i]);const o=l=>{l.preventDefault(),a(""),e==="arcadia"&&r==="pichicome"?(localStorage.setItem("arcadia_is_authenticated","true"),i("/admin")):a("Credenciales incorrectas")};return u.jsxs("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center relative overflow-hidden",children:[u.jsx(Ig,{}),u.jsx("div",{className:"relative z-10 w-full max-w-md p-8",children:u.jsxs("div",{className:"bg-slate-800/80 backdrop-blur-md border border-slate-700 rounded-2xl shadow-2xl p-8 animate-fade-in ring-1 ring-purple-500/20",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-purple-500/10 mb-4 border border-purple-500/30",children:u.jsx(dy,{size:32,className:"text-purple-400"})}),u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Acceso Admin"}),u.jsx("p",{className:"text-slate-400 text-sm",children:"Arcadia Gaming Center"})]}),u.jsxs("form",{onSubmit:o,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase text-slate-500 font-bold mb-2 ml-1",children:"Usuario"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(yP,{size:18,className:"text-slate-500"})}),u.jsx("input",{type:"text",value:e,onChange:l=>t(l.target.value),className:"w-full bg-slate-900/50 border border-slate-600 text-white rounded-lg py-3 pl-10 pr-4 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors",placeholder:"Usuario",autoFocus:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase text-slate-500 font-bold mb-2 ml-1",children:"Contrasea"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:u.jsx(dy,{size:18,className:"text-slate-500"})}),u.jsx("input",{type:"password",value:r,onChange:l=>n(l.target.value),className:"w-full bg-slate-900/50 border border-slate-600 text-white rounded-lg py-3 pl-10 pr-4 focus:outline-none focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-colors",placeholder:""})]})]}),s&&u.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg flex items-center gap-2 text-sm",children:[u.jsx(l1,{size:16}),s]}),u.jsxs("button",{type:"submit",className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white font-bold py-3 rounded-lg transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg shadow-purple-900/20 flex items-center justify-center gap-2",children:[u.jsx(mP,{size:20}),"Ingresar"]})]})]})})]})}const CW=({children:e})=>localStorage.getItem("arcadia_is_authenticated")==="true"?e:u.jsx(t4,{to:"/login",replace:!0});function IW(){return u.jsx(bI,{children:u.jsxs(TI,{children:[u.jsx(Nl,{path:"/",element:u.jsx(t4,{to:"/display",replace:!0})}),u.jsx(Nl,{path:"/login",element:u.jsx(NW,{})}),u.jsx(Nl,{path:"/display",element:u.jsx(TP,{})}),u.jsx(Nl,{path:"/admin",element:u.jsx(CW,{children:u.jsx(SW,{})})}),u.jsx(Nl,{path:"/tarifario",element:u.jsx(AW,{})})]})})}sm.createRoot(document.getElementById("root")).render(u.jsx(Bw.StrictMode,{children:u.jsx(IW,{})}));
